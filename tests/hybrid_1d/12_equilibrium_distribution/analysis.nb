(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[   1137778,      27223]
NotebookOptionsPosition[   1120026,      26955]
NotebookOutlinePosition[   1120438,      26971]
CellTagsIndexPosition[   1120395,      26968]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"Clear", "[", "\"\<`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]}], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"35414358-9cce-404a-b33a-abdb7a6986c5"],

Cell[BoxData[
 RowBox[{"Get", "[", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{"\"\<../..\>\"", ",", "\"\<imports.wl\>\""}], "}"}], "]"}], 
  "]"}]], "Input",
 CellLabel->"In[3]:=",ExpressionUUID->"98642d0f-5832-45f9-b8ed-04467496a470"],

Cell[BoxData[
 RowBox[{"wd", "=", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{"\"\<.\>\"", ",", "\"\<data\>\""}], "}"}], "]"}]}]], "Input",
 CellLabel->"In[4]:=",ExpressionUUID->"7640abcc-40a3-4b02-a665-ad3c9af5d4f1"],

Cell[CellGroupData[{

Cell["Inhomogeneous Parameter", "Section",ExpressionUUID->"9f12e1c2-203b-454a-a884-7860554e9154"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["B", "x"]},
       {
        SubscriptBox["B", "y"]},
       {
        SubscriptBox["B", "z"]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["B", "0"], "(", GridBox[{
        {
         RowBox[{"1", "+", 
          RowBox[{
           SuperscriptBox["\[Xi]", "2"], 
           SuperscriptBox["x", "2"]}]}]},
        {
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["\[Xi]", "2"]}], "x", " ", "y"}]},
        {
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["\[Xi]", "2"]}], "x", " ", "z"}]}
       }], ")"}], "=", 
     RowBox[{
      SubscriptBox["B", "0"], "(", GridBox[{
        {
         RowBox[{
          SuperscriptBox["sec", "2"], 
          RowBox[{"(", 
           RowBox[{"\[Xi]", " ", 
            SubscriptBox["\[CapitalDelta]", "1"], 
            SuperscriptBox["q", "1"]}], ")"}]}]},
        {
         RowBox[{
          RowBox[{"-", "\[Xi]"}], " ", 
          SubscriptBox["\[CapitalDelta]", "2"], 
          SuperscriptBox["q", "2"], 
          RowBox[{"sin", "(", 
           RowBox[{"\[Xi]", " ", 
            SubscriptBox["\[CapitalDelta]", "1"], 
            SuperscriptBox["q", "1"]}], ")"}]}]},
        {
         RowBox[{
          RowBox[{"-", "\[Xi]"}], " ", 
          SubscriptBox["\[CapitalDelta]", "3"], 
          SuperscriptBox["q", "3"], 
          RowBox[{"sin", "(", 
           RowBox[{"\[Xi]", " ", 
            SubscriptBox["\[CapitalDelta]", "1"], 
            SuperscriptBox["q", "1"]}], ")"}]}]}
       }], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "8f13adcc-c76f-4d27-8999-3fa68c042baf"],
 ".\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Xi]", " ", 
     SubscriptBox["\[CapitalDelta]", "1"], 
     SuperscriptBox["q", "1"]}], "=", 
    RowBox[{
     SuperscriptBox["cos", 
      RowBox[{"-", "1"}]], 
     SqrtBox[
      FractionBox["1", 
       RowBox[{
        SubscriptBox["B", "x"], "/", 
        SubscriptBox["B", "0"]}]]]}]}], TraditionalForm]],ExpressionUUID->
  "74594919-e3b9-4832-8b0d-55788a5a9d30"],
 "."
}], "Text",ExpressionUUID->"e412d333-35f8-4d7e-9c38-00959af76376"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"BOB0", "=", "2.1"}], ",", 
     RowBox[{"\[CapitalDelta]1", "=", ".5"}], ",", 
     RowBox[{"q1max", "=", "60"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[Xi]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Xi]", "=", 
      RowBox[{"Divide", "[", 
       RowBox[{
        RowBox[{"ArcCos", "[", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"1", "/", "BOB0"}], "]"}], "]"}], ",", 
        RowBox[{"\[CapitalDelta]1", " ", "q1max"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[620]:=",ExpressionUUID->"a0285dff-a04c-4fa0-9f2b-daf585a3e673"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Hybrid", "Section",ExpressionUUID->"847df2fa-4921-4ad3-8a12-772ae439a795"],

Cell[CellGroupData[{

Cell["Energy", "Subsection",ExpressionUUID->"d0695e24-7f9d-4334-8478-e96567942d55"],

Cell[BoxData[
 RowBox[{
  RowBox[{"energy", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"stride", "=", "6"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "step", ",", "time", ",", "dB2O2", ",", "dE2O2", ",", "mv2O2", ",", 
         "m\[Theta]2O2", ",", "\[IndentingNewLine]", 
         RowBox[{"data", "=", 
          RowBox[{
           RowBox[{"Chop", "@", 
            RowBox[{"Map", "[", 
             RowBox[{"Last", ",", 
              RowBox[{"SplitBy", "[", 
               RowBox[{
                RowBox[{"SortBy", "[", 
                 RowBox[{
                  RowBox[{"Import", "[", 
                   RowBox[{
                    RowBox[{"FileNameJoin", "[", 
                    RowBox[{"{", 
                    RowBox[{"wd", ",", "\"\<energy.csv\>\""}], "}"}], "]"}], 
                    ",", "\"\<CSV\>\"", ",", 
                    RowBox[{"\"\<HeaderLines\>\"", "\[Rule]", "1"}]}], "]"}], 
                  ",", "First"}], "]"}], ",", "First"}], "]"}]}], "]"}]}], "//",
            "Transpose"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"step", ",", "time"}], "}"}], "=", 
         RowBox[{"Take", "[", 
          RowBox[{"data", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"data", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dB2O2", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"Take", "[", 
           RowBox[{"data", ",", "3"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"data", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dE2O2", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"Take", "[", 
           RowBox[{"data", ",", "3"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"data", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"Take", "[", 
               RowBox[{"#", ",", "3"}], "]"}], "]"}], ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"Drop", "[", 
               RowBox[{"#", ",", "3"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
          RowBox[{"Partition", "[", 
           RowBox[{"data", ",", "stride"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"mv2O2", ",", "m\[Theta]2O2"}], "}"}], "=", 
         RowBox[{"data", "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<step\>\"", "\[Rule]", "step"}], ",", 
          RowBox[{"\"\<time\>\"", "\[Rule]", "time"}], ",", 
          RowBox[{"\"\<dB2O2\>\"", "->", "dB2O2"}], ",", 
          RowBox[{"\"\<dE2O2\>\"", "->", "dE2O2"}], ",", 
          RowBox[{"\"\<mv2O2\>\"", "->", "mv2O2"}], ",", 
          RowBox[{"\"\<m\[Theta]2O2\>\"", "->", "m\[Theta]2O2"}]}], "]"}]}]}],
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellLabel->"In[5]:=",ExpressionUUID->"1ec44cd5-a184-4658-be8c-4fca21fac5bf"],

Cell[BoxData[
 RowBox[{"Dimensions", "/@", "energy"}]], "Input",
 CellLabel->"In[6]:=",ExpressionUUID->"25245137-5cfc-4fd5-8f8b-3b1727393e21"],

Cell[BoxData[
 RowBox[{"dynamic", "=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"energy", "=", "energy"}], ",", 
      RowBox[{"tlim", "=", 
       RowBox[{"Interval", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "Infinity"}], "}"}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"time", ",", "pos", ",", "dB2O2", ",", "dE2O2", ",", "mv2O2"}],
        "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"time", "=", 
        RowBox[{"energy", "[", "\"\<time\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"time", ",", 
          RowBox[{"$_Real", "/;", 
           RowBox[{"IntervalMemberQ", "[", 
            RowBox[{"tlim", ",", "$"}], "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "pos", "]"}], "\[LessEqual]", "1"}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<no time selected\>\"", "]"}], ";", 
            RowBox[{"Abort", "[", "]"}]}], ")"}], ",", 
          RowBox[{"pos", "//", "Extract"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"time", "=", 
        RowBox[{"pos", "[", "time", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dB2O2", "=", 
        RowBox[{
         RowBox[{"energy", "[", "\"\<dB2O2\>\"", "]"}], "//", "pos"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dE2O2", "=", 
        RowBox[{
         RowBox[{"energy", "[", "\"\<dE2O2\>\"", "]"}], "//", "pos"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mv2O2", "=", 
        RowBox[{
         RowBox[{"pos", "/@", 
          RowBox[{"energy", "[", "\"\<mv2O2\>\"", "]"}]}], "//", "Total"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{"#", ",", "\[IndentingNewLine]", 
            RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"AspectRatio", "\[Rule]", 
             RowBox[{"1", "/", "3"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Frame", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
           "]"}], "&"}], "/@", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"dB2O2", "//", "Transpose"}], ",", 
             RowBox[{"DataRange", "\[Rule]", 
              RowBox[{"time", "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", "\"\<dB^2/2\>\""}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"dE2O2", "//", "Transpose"}], ",", 
             RowBox[{"DataRange", "\[Rule]", 
              RowBox[{"time", "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", "\"\<dE^2/2\>\""}]}], "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"mv2O2", "//", "Transpose"}], ",", 
             RowBox[{"DataRange", "\[Rule]", 
              RowBox[{"time", "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", "\"\<mv^2/2\>\""}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#", ",", 
                 RowBox[{"#2", "-", 
                  RowBox[{"First", "[", "#2", "]"}]}], ",", 
                 RowBox[{"#", "+", "#2", "-", 
                  RowBox[{"First", "[", "#2", "]"}]}]}], "}"}], "&"}], "@@", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Plus", "@@@", 
                 RowBox[{"(", 
                  RowBox[{"dB2O2", "+", "dE2O2"}], ")"}]}], ",", 
                RowBox[{"Plus", "@@@", "mv2O2"}]}], "}"}]}], ",", 
             RowBox[{"DataRange", "\[Rule]", 
              RowBox[{"time", "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", "\"\<Total\>\""}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "}"}]}], "//", "Column"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellLabel->"In[7]:=",ExpressionUUID->"165b2a5c-70b2-4a34-9de2-2bc59b9970b5"],

Cell[BoxData[
 RowBox[{"dynamic", "=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"energy", "=", "energy"}], ",", 
      RowBox[{"tlim", "=", 
       RowBox[{"Interval", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "Infinity"}], "}"}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "time", ",", "pos", ",", "mv2O2", ",", "mU2O2", ",", "m\[Theta]2O2", 
        ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"time", "=", 
        RowBox[{"energy", "[", "\"\<time\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"time", ",", 
          RowBox[{"$_Real", "/;", 
           RowBox[{"IntervalMemberQ", "[", 
            RowBox[{"tlim", ",", "$"}], "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "pos", "]"}], "\[LessEqual]", "1"}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<no time selected\>\"", "]"}], ";", 
            RowBox[{"Abort", "[", "]"}]}], ")"}], ",", 
          RowBox[{"pos", "//", "Extract"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"time", "=", 
        RowBox[{"pos", "[", "time", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mv2O2", "=", 
        RowBox[{"pos", "/@", 
         RowBox[{"energy", "[", "\"\<mv2O2\>\"", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"m\[Theta]2O2", "=", 
        RowBox[{"pos", "/@", 
         RowBox[{"energy", "[", "\"\<m\[Theta]2O2\>\"", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mU2O2", "=", 
        RowBox[{"mv2O2", "-", "m\[Theta]2O2"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"plots", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Show", "[", 
            RowBox[{"#", ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "\[Rule]", "Small"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Frame", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
            "]"}], "&"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"ListPlot", "[", 
               RowBox[{
                RowBox[{"#", "//", "Transpose"}], ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"time", "[", 
                  RowBox[{"[", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
                RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "/@",
              "mv2O2"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"ListPlot", "[", 
               RowBox[{
                RowBox[{"#", "//", "Transpose"}], ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"time", "[", 
                  RowBox[{"[", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
                RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "/@",
              "m\[Theta]2O2"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"ListPlot", "[", 
               RowBox[{
                RowBox[{"#", "//", "Transpose"}], ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"time", "[", 
                  RowBox[{"[", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
                RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "/@",
              "mU2O2"}]}], "\[IndentingNewLine]", "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{
          RowBox[{"plots", "//", "Transpose"}], ",", 
          RowBox[{"Text", "/@", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Kinetic\>\"", ",", "\"\<Thermal\>\"", ",", "\"\<Bulk\>\""}], 
            "}"}]}]}], "]"}], "//", "Grid"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->"In[8]:=",ExpressionUUID->"909e924c-4bab-402e-abac-e83db341f28d"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"energy", "=", "energy"}], ",", 
     RowBox[{"tlim", "=", 
      RowBox[{"Interval", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", "Infinity"}], "}"}], "]"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "time", ",", "pos", ",", "mv2O2", ",", "mU2O2", ",", "m\[Theta]2O2", 
       ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"time", "=", 
       RowBox[{"energy", "[", "\"\<time\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"Position", "[", 
        RowBox[{"time", ",", 
         RowBox[{"$_Real", "/;", 
          RowBox[{"IntervalMemberQ", "[", 
           RowBox[{"tlim", ",", "$"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "pos", "]"}], "\[LessEqual]", "1"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<no time selected\>\"", "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}], ")"}], ",", 
         RowBox[{"pos", "//", "Extract"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"time", "=", 
       RowBox[{"pos", "[", "time", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mv2O2", "=", 
       RowBox[{"pos", "/@", 
        RowBox[{"energy", "[", "\"\<mv2O2\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"m\[Theta]2O2", "=", 
       RowBox[{"pos", "/@", 
        RowBox[{"energy", "[", "\"\<m\[Theta]2O2\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mU2O2", "=", 
       RowBox[{"mv2O2", "-", "m\[Theta]2O2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{"#", ",", "\[IndentingNewLine]", 
            RowBox[{"ImageSize", "\[Rule]", "Small"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Frame", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
           "]"}], "&"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"#", "-", 
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"time", "[", 
                 RowBox[{"[", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "/@", 
            
            RowBox[{"Map", "[", 
             RowBox[{"Transpose", ",", "mv2O2"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"#", "-", 
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"time", "[", 
                 RowBox[{"[", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "/@", 
            
            RowBox[{"Map", "[", 
             RowBox[{"Transpose", ",", "m\[Theta]2O2"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"#", "-", 
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"time", "[", 
                 RowBox[{"[", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "/@", 
            
            RowBox[{"Map", "[", 
             RowBox[{"Transpose", ",", "mU2O2"}], "]"}]}]}], 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Prepend", "[", 
        RowBox[{
         RowBox[{"plots", "//", "Transpose"}], ",", 
         RowBox[{"Text", "/@", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Kinetic\>\"", ",", "\"\<Thermal\>\"", ",", "\"\<Bulk\>\""}], 
           "}"}]}]}], "]"}], "//", "Grid"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[9]:=",ExpressionUUID->"b11b8c30-ec3e-4ab2-83d0-d7e26f6f4a7d"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"energy", "=", "energy"}], ",", 
     RowBox[{"tlim", "=", 
      RowBox[{"Interval", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", "Infinity"}], "}"}], "]"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"time", ",", "pos", ",", "m\[Theta]2O2", ",", "T1", ",", "T2"}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"time", "=", 
       RowBox[{"energy", "[", "\"\<time\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"Position", "[", 
        RowBox[{"time", ",", 
         RowBox[{"$_Real", "/;", 
          RowBox[{"IntervalMemberQ", "[", 
           RowBox[{"tlim", ",", "$"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "pos", "]"}], "\[LessEqual]", "1"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<no time selected\>\"", "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}], ")"}], ",", 
         RowBox[{"pos", "//", "Extract"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"time", "=", 
       RowBox[{"pos", "[", "time", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"m\[Theta]2O2", "=", 
       RowBox[{"Map", "[", 
        RowBox[{"pos", ",", 
         RowBox[{"energy", "[", "\"\<m\[Theta]2O2\>\"", "]"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"m\[Theta]2O2", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"First", "[", "#", "]"}], ",", 
            RowBox[{".5", 
             RowBox[{"Plus", "@@", 
              RowBox[{"Rest", "[", "#", "]"}]}]}]}], "}"}], "&"}], ",", 
         "m\[Theta]2O2", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T1", "=", 
       RowBox[{
        RowBox[{"Chop", "[", 
         RowBox[{"m\[Theta]2O2", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "All", ",", "1"}], "]"}], "]"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"0", "\[Rule]", "Indeterminate"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"T2", "=", 
       RowBox[{
        RowBox[{"Chop", "[", 
         RowBox[{"m\[Theta]2O2", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"0", "\[Rule]", "Indeterminate"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{"#", ",", "\[IndentingNewLine]", 
           RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Frame", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
          "]"}], "&"}], "/@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"T1", "/", 
             RowBox[{"T1", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
            RowBox[{"DataRange", "\[Rule]", 
             RowBox[{"time", "[", 
              RowBox[{"[", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{
            "FrameLabel", "\[Rule]", 
             "\"\<\\!\\(\!\(\*SubscriptBox[\(T\), \
\(\[DoubleVerticalBar]\)]\)(t)/\!\(\*SubscriptBox[\(T\), \(\
\[DoubleVerticalBar]\)]\)(0)\\)\>\""}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"T2", "/", 
             RowBox[{"T1", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
            RowBox[{"DataRange", "\[Rule]", 
             RowBox[{"time", "[", 
              RowBox[{"[", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{
            "FrameLabel", "\[Rule]", 
             "\"\<\\!\\(\!\(\*SubscriptBox[\(T\), \
\(\[UpTee]\)]\)(t)/\!\(\*SubscriptBox[\(T\), \
\(\[DoubleVerticalBar]\)]\)(0)\\)\>\""}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
         "\[IndentingNewLine]", "}"}]}], "//", "Column"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[10]:=",ExpressionUUID->"42e0356c-1f39-445c-8c6c-7e391f279571"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Moment", "Subsection",ExpressionUUID->"cd6cf25d-e30d-4dae-8ee1-f32262fc6808"],

Cell[BoxData[
 RowBox[{
  RowBox[{"metadata", "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"files", "=", 
        RowBox[{"FileNames", "[", 
         RowBox[{"\"\<moment-*.h5\>\"", ",", "wd"}], "]"}]}], ",", "attrs", 
       ",", "steps", ",", "times", ",", "pos"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"attrs", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<HDF5\>\"", ",", "\"\<Attributes\>\"", ",", 
             "\"\</moment\>\""}], "}"}]}], "]"}], "&"}], "/@", "files"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{
        RowBox[{"Lookup", "[", "\"\<step\>\"", "]"}], "/@", "attrs"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"times", "=", 
       RowBox[{
        RowBox[{"Lookup", "[", "\"\<time\>\"", "]"}], "/@", "attrs"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"List", "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "times", "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"First", "/@", 
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"pos", ",", "times"}], "}"}], "]"}], ",", "Last"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"steps", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"times", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"times", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"files", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"files", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Association", "[", 
       RowBox[{
        RowBox[{"\"\<attr\>\"", "->", 
         RowBox[{"KeyDrop", "[", 
          RowBox[{
           RowBox[{"First", "[", "attrs", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<step\>\"", ",", "\"\<time\>\""}], "}"}]}], "]"}]}], 
        ",", 
        RowBox[{"\"\<step\>\"", "->", "steps"}], ",", 
        RowBox[{"\"\<time\>\"", "->", "times"}], ",", 
        RowBox[{"\"\<files\>\"", "->", "files"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->"In[11]:=",ExpressionUUID->"6f598aed-c038-4db9-bf47-b3b56562c1e8"],

Cell[CellGroupData[{

Cell["Maxwellian", "Subsubsection",ExpressionUUID->"cb7d9ce6-eb9b-4f7d-9e35-77fe1e582769"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom1", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "1"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom1"}]}], "Input",
 CellLabel->"In[12]:=",ExpressionUUID->"5702dbab-a126-4023-a84b-59e5a35c7564"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom1"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"T2OT1eq", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", 
       "T2OT1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{
        RowBox[{"0", "q1"}], "+", "1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{"T2OT1eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n0"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2OT1", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2OT1", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[14]:=",ExpressionUUID->"924d8ae5-1219-456f-abd8-7e2ac6029643"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bi-Maxwellian", "Subsubsection",ExpressionUUID->"66338852-e001-46f5-8c9c-1b64d8c945c9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom2", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "2"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom2"}]}], "Input",
 CellLabel->"In[15]:=",ExpressionUUID->"c1158f36-932d-4e2f-947e-6f9911a933fb"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom2"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"T2OT1eq", "=", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", 
       "T2OT1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{"T2OT1eq", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "T2OT1eq"}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{"T2OT1eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n0"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2OT1", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2OT1", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[17]:=",ExpressionUUID->"3bdea17f-a210-4f60-bebe-49420255b9df"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Losscone - Maxwellian", "Subsubsection",ExpressionUUID->"7910da06-34ae-4593-bc9e-74a69272b100"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom3", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "3"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom3"}]}], "Input",
 CellLabel->"In[18]:=",ExpressionUUID->"bec4ae69-6202-4538-80b4-e2b9c215efee"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom3"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"T2OT1eq", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", 
       "T2OT1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{
        RowBox[{"0", "q1"}], "+", "1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{"T2OT1eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n0"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2OT1", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2OT1", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[20]:=",ExpressionUUID->"82413c55-b644-430b-99b2-f2f4526dbcc0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Losscone - Bi-Maxwellian", "Subsubsection",ExpressionUUID->"a3f84be9-399c-4419-9094-ed5eda12824f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom4", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "4"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom4"}]}], "Input",
 CellLabel->"In[21]:=",ExpressionUUID->"9d3f1bd2-ce0d-41f3-8537-b2f4ed60425e"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom4"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"T2OT1eq", "=", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", 
       "T2OT1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{"T2OT1eq", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "T2OT1eq"}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{"T2OT1eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n0"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2OT1", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2OT1", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[23]:=",ExpressionUUID->"e333d87b-eff8-4de5-8ff4-d8827bba57ee"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Loss cone - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Beta]", "0"], "=", "0.5"}], TraditionalForm]],
  ExpressionUUID->"ccdb0590-1bd4-4ec8-ba41-3d161d358b69"]
}], "Subsubsection",ExpressionUUID->"4980b484-d4a1-42be-a914-13db437ac77d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom5", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "5"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom5"}]}], "Input",
 CellLabel->"In[24]:=",ExpressionUUID->"6b115070-2d54-49ba-b154-a649826185c9"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom5"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", ".5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "\[Eta]\[Beta]",
        ",", "n0", ",", "\[Beta]", ",", "\[Theta]2O\[Theta]1", ",", "T2OT1"}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n0"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2OT1", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2OT1", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[26]:=",ExpressionUUID->"20f092f7-6abd-4f6b-b097-f0bc08cc06ce"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Loss cone - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Beta]", "0"], "=", "2.5"}], TraditionalForm]],
  ExpressionUUID->"621772c3-7022-4912-8ba2-52b5d131ac20"]
}], "Subsubsection",ExpressionUUID->"e3066ceb-9fb5-40aa-ba34-9cb0fd7abdac"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom6", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "6"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom6"}]}], "Input",
 CellLabel->"In[27]:=",ExpressionUUID->"2eedc04d-fe4a-4f27-8290-838dbd0c8747"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom6"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "2.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "\[Eta]\[Beta]",
        ",", "n0", ",", "\[Beta]", ",", "\[Theta]2O\[Theta]1", ",", "T2OT1"}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n0"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2OT1", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2OT1", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[29]:=",ExpressionUUID->"159758ce-5815-4bad-bdd7-5290ee91102e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Partial shell - Maxwellian", "Subsubsection",ExpressionUUID->"51115539-fd2f-43ec-a01d-08a57471c386"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom7", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "7"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom7"}]}], "Input",
 CellLabel->"In[30]:=",ExpressionUUID->"b5b93d3b-5890-4f43-8098-f48503432848"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom7"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]", "=", "1.5"}], ",", 
     RowBox[{"\[Zeta]", "=", "0"}], ",", 
     RowBox[{"vs", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", "Ab",
        ",", "B\[Zeta]", ",", "T", ",", "T1", ",", "T2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"b", ",", 
          RowBox[{".5", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"b", " ", 
              RowBox[{"Exp", "[", 
               RowBox[{"-", 
                RowBox[{"b", "^", "2"}]}], "]"}]}], "+", 
             RowBox[{
              SqrtBox["\[Pi]"], 
              RowBox[{"(", 
               RowBox[{".5", "+", 
                RowBox[{"b", "^", "2"}]}], ")"}], 
              RowBox[{"Erfc", "[", 
               RowBox[{"-", "b"}], "]"}]}]}], ")"}]}]}], "]"}], "[", 
        RowBox[{"vs", "/", 
         SqrtBox["\[Beta]"]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"B\[Zeta]", "=", 
       RowBox[{
        SqrtBox["\[Pi]"], 
        RowBox[{
         RowBox[{"Gamma", "[", 
          RowBox[{"1", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}], "/", 
         RowBox[{"Gamma", "[", 
          RowBox[{"1.5", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{".5", 
        RowBox[{"\[Beta]", "/", "Ab"}], " ", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"xs", ",", 
           RowBox[{
            RowBox[{"xs", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"5", "/", "2"}], "+", 
               RowBox[{"xs", "^", "2"}]}], ")"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{"xs", "^", "2"}]}], "]"}]}], "+", 
            RowBox[{
             SqrtBox["\[Pi]"], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", "/", "4"}], "+", 
               RowBox[{
                RowBox[{"xs", "^", "2"}], 
                RowBox[{"(", 
                 RowBox[{"3", "+", 
                  RowBox[{"xs", "^", "2"}]}], ")"}]}]}], ")"}], 
             RowBox[{"Erfc", "[", 
              RowBox[{"-", "xs"}], "]"}]}]}]}], "]"}], "[", 
         RowBox[{"vs", "/", 
          SqrtBox["\[Beta]"]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T1", "=", 
       RowBox[{"T", "/", 
        RowBox[{"(", 
         RowBox[{"3", "+", "\[Zeta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2", "=", 
       RowBox[{".5", "T", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "+", "\[Zeta]"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"3", "+", "\[Zeta]"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n0"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T1"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[32]:=",ExpressionUUID->"6e384b7b-cc72-454a-95be-0b3582ad5970"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Isotropic shell", "Subsubsection",ExpressionUUID->"7ec0129c-40d8-4631-bf1b-51fb8eb2c9e3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom8", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "8"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom8"}]}], "Input",
 CellLabel->"In[33]:=",ExpressionUUID->"6cd02a64-3575-4a51-8480-6b28b04b611f"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom8"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "0"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", "Ab",
        ",", "B\[Zeta]", ",", "T", ",", "T1", ",", "T2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"b", ",", 
          RowBox[{".5", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"b", " ", 
              RowBox[{"Exp", "[", 
               RowBox[{"-", 
                RowBox[{"b", "^", "2"}]}], "]"}]}], "+", 
             RowBox[{
              SqrtBox["\[Pi]"], 
              RowBox[{"(", 
               RowBox[{".5", "+", 
                RowBox[{"b", "^", "2"}]}], ")"}], 
              RowBox[{"Erfc", "[", 
               RowBox[{"-", "b"}], "]"}]}]}], ")"}]}]}], "]"}], "[", 
        RowBox[{"vs", "/", 
         SqrtBox["\[Beta]"]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"B\[Zeta]", "=", 
       RowBox[{
        SqrtBox["\[Pi]"], 
        RowBox[{
         RowBox[{"Gamma", "[", 
          RowBox[{"1", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}], "/", 
         RowBox[{"Gamma", "[", 
          RowBox[{"1.5", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{".5", 
        RowBox[{"\[Beta]", "/", "Ab"}], " ", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"xs", ",", 
           RowBox[{
            RowBox[{"xs", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"5", "/", "2"}], "+", 
               RowBox[{"xs", "^", "2"}]}], ")"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{"xs", "^", "2"}]}], "]"}]}], "+", 
            RowBox[{
             SqrtBox["\[Pi]"], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", "/", "4"}], "+", 
               RowBox[{
                RowBox[{"xs", "^", "2"}], 
                RowBox[{"(", 
                 RowBox[{"3", "+", 
                  RowBox[{"xs", "^", "2"}]}], ")"}]}]}], ")"}], 
             RowBox[{"Erfc", "[", 
              RowBox[{"-", "xs"}], "]"}]}]}]}], "]"}], "[", 
         RowBox[{"vs", "/", 
          SqrtBox["\[Beta]"]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T1", "=", 
       RowBox[{"T", "/", 
        RowBox[{"(", 
         RowBox[{"3", "+", "\[Zeta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2", "=", 
       RowBox[{".5", "T", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "+", "\[Zeta]"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"3", "+", "\[Zeta]"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n0"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T1"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[35]:=",ExpressionUUID->"b1edadf5-5bd5-4999-8212-03f4d774ff03"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Partial shell - ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Zeta]", "=", "1"}], TraditionalForm]],ExpressionUUID->
  "dd9f1676-40dd-4042-8cbe-8692107020b5"]
}], "Subsubsection",ExpressionUUID->"22184aa1-da55-4c27-b9ac-23cc971f1ba8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom9", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "9"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom9"}]}], "Input",
 CellLabel->"In[36]:=",ExpressionUUID->"773c508a-4946-441c-b000-2db3a06a75b7"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom9"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "1"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", "Ab",
        ",", "B\[Zeta]", ",", "T", ",", "T1", ",", "T2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"b", ",", 
          RowBox[{".5", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"b", " ", 
              RowBox[{"Exp", "[", 
               RowBox[{"-", 
                RowBox[{"b", "^", "2"}]}], "]"}]}], "+", 
             RowBox[{
              SqrtBox["\[Pi]"], 
              RowBox[{"(", 
               RowBox[{".5", "+", 
                RowBox[{"b", "^", "2"}]}], ")"}], 
              RowBox[{"Erfc", "[", 
               RowBox[{"-", "b"}], "]"}]}]}], ")"}]}]}], "]"}], "[", 
        RowBox[{"vs", "/", 
         SqrtBox["\[Beta]"]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"B\[Zeta]", "=", 
       RowBox[{
        SqrtBox["\[Pi]"], 
        RowBox[{
         RowBox[{"Gamma", "[", 
          RowBox[{"1", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}], "/", 
         RowBox[{"Gamma", "[", 
          RowBox[{"1.5", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{".5", 
        RowBox[{"\[Beta]", "/", "Ab"}], " ", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"xs", ",", 
           RowBox[{
            RowBox[{"xs", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"5", "/", "2"}], "+", 
               RowBox[{"xs", "^", "2"}]}], ")"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{"xs", "^", "2"}]}], "]"}]}], "+", 
            RowBox[{
             SqrtBox["\[Pi]"], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", "/", "4"}], "+", 
               RowBox[{
                RowBox[{"xs", "^", "2"}], 
                RowBox[{"(", 
                 RowBox[{"3", "+", 
                  RowBox[{"xs", "^", "2"}]}], ")"}]}]}], ")"}], 
             RowBox[{"Erfc", "[", 
              RowBox[{"-", "xs"}], "]"}]}]}]}], "]"}], "[", 
         RowBox[{"vs", "/", 
          SqrtBox["\[Beta]"]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T1", "=", 
       RowBox[{"T", "/", 
        RowBox[{"(", 
         RowBox[{"3", "+", "\[Zeta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2", "=", 
       RowBox[{".5", "T", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "+", "\[Zeta]"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"3", "+", "\[Zeta]"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n0"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T1"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[38]:=",ExpressionUUID->"e9ba3453-4dd1-4101-a9d2-b6f662465aaa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Partial shell - ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Zeta]", "=", "5"}], TraditionalForm]],ExpressionUUID->
  "80229383-8135-4a13-ae82-136c4f08f48b"]
}], "Subsubsection",ExpressionUUID->"27bef6b5-a9be-4af2-a6f7-a874de3627cd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom10", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "10"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom10"}]}], "Input",
 CellLabel->"In[39]:=",ExpressionUUID->"632d56b6-0f03-4ede-9a23-16788a182daf"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom10"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "5"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", "Ab",
        ",", "B\[Zeta]", ",", "T", ",", "T1", ",", "T2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"b", ",", 
          RowBox[{".5", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"b", " ", 
              RowBox[{"Exp", "[", 
               RowBox[{"-", 
                RowBox[{"b", "^", "2"}]}], "]"}]}], "+", 
             RowBox[{
              SqrtBox["\[Pi]"], 
              RowBox[{"(", 
               RowBox[{".5", "+", 
                RowBox[{"b", "^", "2"}]}], ")"}], 
              RowBox[{"Erfc", "[", 
               RowBox[{"-", "b"}], "]"}]}]}], ")"}]}]}], "]"}], "[", 
        RowBox[{"vs", "/", 
         SqrtBox["\[Beta]"]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"B\[Zeta]", "=", 
       RowBox[{
        SqrtBox["\[Pi]"], 
        RowBox[{
         RowBox[{"Gamma", "[", 
          RowBox[{"1", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}], "/", 
         RowBox[{"Gamma", "[", 
          RowBox[{"1.5", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{".5", 
        RowBox[{"\[Beta]", "/", "Ab"}], " ", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"xs", ",", 
           RowBox[{
            RowBox[{"xs", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"5", "/", "2"}], "+", 
               RowBox[{"xs", "^", "2"}]}], ")"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{"xs", "^", "2"}]}], "]"}]}], "+", 
            RowBox[{
             SqrtBox["\[Pi]"], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", "/", "4"}], "+", 
               RowBox[{
                RowBox[{"xs", "^", "2"}], 
                RowBox[{"(", 
                 RowBox[{"3", "+", 
                  RowBox[{"xs", "^", "2"}]}], ")"}]}]}], ")"}], 
             RowBox[{"Erfc", "[", 
              RowBox[{"-", "xs"}], "]"}]}]}]}], "]"}], "[", 
         RowBox[{"vs", "/", 
          SqrtBox["\[Beta]"]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T1", "=", 
       RowBox[{"T", "/", 
        RowBox[{"(", 
         RowBox[{"3", "+", "\[Zeta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2", "=", 
       RowBox[{".5", "T", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "+", "\[Zeta]"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"3", "+", "\[Zeta]"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n0"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T1"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[41]:=",ExpressionUUID->"ee0ad69f-bc34-42c3-809f-3080483ea1ca"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Counter beam - Maxwellian", "Subsubsection",ExpressionUUID->"79680e0d-cc42-477e-99d9-ea286e4ea160"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom11", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "11"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom11"}]}], "Input",
 CellLabel->"In[42]:=",ExpressionUUID->"ec3e9f78-fe39-4f2f-949f-684ebb66e230"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom11"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]", "=", "1.5"}], ",", 
     RowBox[{"\[Nu]0", "=", "100000"}], ",", 
     RowBox[{"vs", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", "Ab",
        ",", "T", ",", "\[Nu]", ",", "T1", ",", "T2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"DawsonF", "[", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "/", 
           "\[Nu]0"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]0"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"b", ",", 
          RowBox[{".5", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"b", " ", 
              RowBox[{"Exp", "[", 
               RowBox[{"-", 
                RowBox[{"b", "^", "2"}]}], "]"}]}], "+", 
             RowBox[{
              SqrtBox["\[Pi]"], 
              RowBox[{"(", 
               RowBox[{".5", "+", 
                RowBox[{"b", "^", "2"}]}], ")"}], 
              RowBox[{"Erfc", "[", 
               RowBox[{"-", "b"}], "]"}]}]}], ")"}]}]}], "]"}], "[", 
        RowBox[{"vs", "/", 
         SqrtBox["\[Beta]"]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{".5", 
        RowBox[{"\[Beta]", "/", "Ab"}], " ", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"xs", ",", 
           RowBox[{
            RowBox[{"xs", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"5", "/", "2"}], "+", 
               RowBox[{"xs", "^", "2"}]}], ")"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{"xs", "^", "2"}]}], "]"}]}], "+", 
            RowBox[{
             SqrtBox["\[Pi]"], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", "/", "4"}], "+", 
               RowBox[{
                RowBox[{"xs", "^", "2"}], 
                RowBox[{"(", 
                 RowBox[{"3", "+", 
                  RowBox[{"xs", "^", "2"}]}], ")"}]}]}], ")"}], 
             RowBox[{"Erfc", "[", 
              RowBox[{"-", "xs"}], "]"}]}]}]}], "]"}], "[", 
         RowBox[{"vs", "/", 
          SqrtBox["\[Beta]"]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{
        RowBox[{"Sec", "[", 
         RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "\[Nu]0"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"T1", "=", 
       RowBox[{"T", 
        RowBox[{"(", 
         RowBox[{"\[Nu]", "/", "2"}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"DawsonF", "[", 
            RowBox[{"1", "/", "\[Nu]"}], "]"}]}], "-", "\[Nu]"}], ")"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"T2", "=", 
       RowBox[{".5", 
        RowBox[{"(", 
         RowBox[{"T", "-", "T1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n0"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T1"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[44]:=",ExpressionUUID->"006df907-082a-4f2a-973c-77b7805c1b5f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Counter beam - isotropic shell", "Subsubsection",ExpressionUUID->"eb72f151-d54c-4276-93e7-5901f7789e9b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom12", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "12"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom12"}]}], "Input",
 CellLabel->"In[45]:=",ExpressionUUID->"00d0129a-75a6-497f-8f64-c7528fee83f6"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom12"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Nu]0", "=", "100000"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", "Ab",
        ",", "T", ",", "\[Nu]", ",", "T1", ",", "T2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"DawsonF", "[", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "/", 
           "\[Nu]0"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]0"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"b", ",", 
          RowBox[{".5", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"b", " ", 
              RowBox[{"Exp", "[", 
               RowBox[{"-", 
                RowBox[{"b", "^", "2"}]}], "]"}]}], "+", 
             RowBox[{
              SqrtBox["\[Pi]"], 
              RowBox[{"(", 
               RowBox[{".5", "+", 
                RowBox[{"b", "^", "2"}]}], ")"}], 
              RowBox[{"Erfc", "[", 
               RowBox[{"-", "b"}], "]"}]}]}], ")"}]}]}], "]"}], "[", 
        RowBox[{"vs", "/", 
         SqrtBox["\[Beta]"]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{".5", 
        RowBox[{"\[Beta]", "/", "Ab"}], " ", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"xs", ",", 
           RowBox[{
            RowBox[{"xs", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"5", "/", "2"}], "+", 
               RowBox[{"xs", "^", "2"}]}], ")"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{"xs", "^", "2"}]}], "]"}]}], "+", 
            RowBox[{
             SqrtBox["\[Pi]"], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", "/", "4"}], "+", 
               RowBox[{
                RowBox[{"xs", "^", "2"}], 
                RowBox[{"(", 
                 RowBox[{"3", "+", 
                  RowBox[{"xs", "^", "2"}]}], ")"}]}]}], ")"}], 
             RowBox[{"Erfc", "[", 
              RowBox[{"-", "xs"}], "]"}]}]}]}], "]"}], "[", 
         RowBox[{"vs", "/", 
          SqrtBox["\[Beta]"]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{
        RowBox[{"Sec", "[", 
         RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "\[Nu]0"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"T1", "=", 
       RowBox[{"T", 
        RowBox[{"(", 
         RowBox[{"\[Nu]", "/", "2"}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"DawsonF", "[", 
            RowBox[{"1", "/", "\[Nu]"}], "]"}]}], "-", "\[Nu]"}], ")"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"T2", "=", 
       RowBox[{".5", 
        RowBox[{"(", 
         RowBox[{"T", "-", "T1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n0"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T1"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[47]:=",ExpressionUUID->"efa47aae-6328-4136-8119-e2686f7803c7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Counter beam - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Nu]", "0"], "=", "1"}], TraditionalForm]],ExpressionUUID->
  "2b633c32-8a90-4f9f-8a51-c3b915e19b6d"]
}], "Subsubsection",ExpressionUUID->"4b1e897d-4175-4036-b7bf-6c2d5fed57ad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom13", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "13"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom13"}]}], "Input",
 CellLabel->"In[48]:=",ExpressionUUID->"b9f9386c-6db4-4c7a-9f00-fd19dc97d182"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom13"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Nu]0", "=", "1"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", "Ab",
        ",", "T", ",", "\[Nu]", ",", "T1", ",", "T2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"DawsonF", "[", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "/", 
           "\[Nu]0"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]0"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"b", ",", 
          RowBox[{".5", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"b", " ", 
              RowBox[{"Exp", "[", 
               RowBox[{"-", 
                RowBox[{"b", "^", "2"}]}], "]"}]}], "+", 
             RowBox[{
              SqrtBox["\[Pi]"], 
              RowBox[{"(", 
               RowBox[{".5", "+", 
                RowBox[{"b", "^", "2"}]}], ")"}], 
              RowBox[{"Erfc", "[", 
               RowBox[{"-", "b"}], "]"}]}]}], ")"}]}]}], "]"}], "[", 
        RowBox[{"vs", "/", 
         SqrtBox["\[Beta]"]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{".5", 
        RowBox[{"\[Beta]", "/", "Ab"}], " ", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"xs", ",", 
           RowBox[{
            RowBox[{"xs", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"5", "/", "2"}], "+", 
               RowBox[{"xs", "^", "2"}]}], ")"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{"xs", "^", "2"}]}], "]"}]}], "+", 
            RowBox[{
             SqrtBox["\[Pi]"], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", "/", "4"}], "+", 
               RowBox[{
                RowBox[{"xs", "^", "2"}], 
                RowBox[{"(", 
                 RowBox[{"3", "+", 
                  RowBox[{"xs", "^", "2"}]}], ")"}]}]}], ")"}], 
             RowBox[{"Erfc", "[", 
              RowBox[{"-", "xs"}], "]"}]}]}]}], "]"}], "[", 
         RowBox[{"vs", "/", 
          SqrtBox["\[Beta]"]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{
        RowBox[{"Sec", "[", 
         RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "\[Nu]0"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"T1", "=", 
       RowBox[{"T", 
        RowBox[{"(", 
         RowBox[{"\[Nu]", "/", "2"}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"DawsonF", "[", 
            RowBox[{"1", "/", "\[Nu]"}], "]"}]}], "-", "\[Nu]"}], ")"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"T2", "=", 
       RowBox[{".5", 
        RowBox[{"(", 
         RowBox[{"T", "-", "T1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n0"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T1"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[50]:=",ExpressionUUID->"4ec5de58-bec7-4299-9147-ed817c3cf6e0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Counter beam - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["v", "0"], "=", "0.1"}], TraditionalForm]],ExpressionUUID->
  "984c73e9-2f7c-4ab5-87ca-82167e6ddefa"]
}], "Subsubsection",ExpressionUUID->"d7c47c4b-ef92-45a9-8426-baa3c50ed9c9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom14", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "14"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom14"}]}], "Input",
 CellLabel->"In[51]:=",ExpressionUUID->"a251a9af-37f6-4171-9792-0dc75763611b"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom14"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Nu]0", "=", ".1"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", "Ab",
        ",", "T", ",", "\[Nu]", ",", "T1", ",", "T2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"DawsonF", "[", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "/", 
           "\[Nu]0"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]0"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"b", ",", 
          RowBox[{".5", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"b", " ", 
              RowBox[{"Exp", "[", 
               RowBox[{"-", 
                RowBox[{"b", "^", "2"}]}], "]"}]}], "+", 
             RowBox[{
              SqrtBox["\[Pi]"], 
              RowBox[{"(", 
               RowBox[{".5", "+", 
                RowBox[{"b", "^", "2"}]}], ")"}], 
              RowBox[{"Erfc", "[", 
               RowBox[{"-", "b"}], "]"}]}]}], ")"}]}]}], "]"}], "[", 
        RowBox[{"vs", "/", 
         SqrtBox["\[Beta]"]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{".5", 
        RowBox[{"\[Beta]", "/", "Ab"}], " ", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"xs", ",", 
           RowBox[{
            RowBox[{"xs", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"5", "/", "2"}], "+", 
               RowBox[{"xs", "^", "2"}]}], ")"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{"xs", "^", "2"}]}], "]"}]}], "+", 
            RowBox[{
             SqrtBox["\[Pi]"], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", "/", "4"}], "+", 
               RowBox[{
                RowBox[{"xs", "^", "2"}], 
                RowBox[{"(", 
                 RowBox[{"3", "+", 
                  RowBox[{"xs", "^", "2"}]}], ")"}]}]}], ")"}], 
             RowBox[{"Erfc", "[", 
              RowBox[{"-", "xs"}], "]"}]}]}]}], "]"}], "[", 
         RowBox[{"vs", "/", 
          SqrtBox["\[Beta]"]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{
        RowBox[{"Sec", "[", 
         RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "\[Nu]0"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"T1", "=", 
       RowBox[{"T", 
        RowBox[{"(", 
         RowBox[{"\[Nu]", "/", "2"}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"DawsonF", "[", 
            RowBox[{"1", "/", "\[Nu]"}], "]"}]}], "-", "\[Nu]"}], ")"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"T2", "=", 
       RowBox[{".5", 
        RowBox[{"(", 
         RowBox[{"T", "-", "T1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n0"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T1"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[53]:=",ExpressionUUID->"048e7a89-2bd8-4274-b8d4-2324f3372c2a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cold fluid", "Subsubsection",ExpressionUUID->"1e7aaa3a-a570-4c24-b90e-64b34e4e4847"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom15", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "15"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom15"}]}], "Input",
 CellLabel->"In[54]:=",ExpressionUUID->"8cceee78-63f9-48e9-a0e1-ce69f442f550"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom15"}], ",", 
     RowBox[{"n0", "=", "0.01"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"T1", ",", "T2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"T1", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"GridLinesStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"Opacity", "[", "1", "]"}], ",", 
             RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
             "Dashed"}], "]"}]}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
               "]"}], 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "n0", "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
               "]"}], 
              RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"n0", 
               RowBox[{"{", "T1", "}"}]}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
               "]"}], 
              RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"n0", 
               RowBox[{"{", "T2", "}"}]}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
               "]"}], 
              RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"n0", 
               RowBox[{"{", "T2", "}"}]}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
        "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[56]:=",ExpressionUUID->"8db6a45b-c8e9-49e7-afa5-cdc0f9e8712e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["VHist", "Subsection",ExpressionUUID->"87b5ea90-0db6-483f-8519-834bcf44ddac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"metadata", "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"files", "=", 
        RowBox[{"FileNames", "[", 
         RowBox[{"\"\<vhist2d-*.h5\>\"", ",", "wd"}], "]"}]}], ",", "names", 
       ",", "attrs", ",", "steps", ",", "times", ",", "pos"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"attrs", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<HDF5\>\"", ",", "\"\<Attributes\>\"", ",", 
             "\"\</vhist2d\>\""}], "}"}]}], "]"}], "&"}], "/@", "files"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{
        RowBox[{"Lookup", "[", "\"\<step\>\"", "]"}], "/@", "attrs"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"times", "=", 
       RowBox[{
        RowBox[{"Lookup", "[", "\"\<time\>\"", "]"}], "/@", "attrs"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"List", "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "times", "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"First", "/@", 
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"pos", ",", "times"}], "}"}], "]"}], ",", "Last"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"steps", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"times", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"times", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"files", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"files", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Association", "[", 
       RowBox[{
        RowBox[{"\"\<attr\>\"", "->", 
         RowBox[{"KeyDrop", "[", 
          RowBox[{
           RowBox[{"First", "[", "attrs", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<step\>\"", ",", "\"\<time\>\""}], "}"}]}], "]"}]}], 
        ",", 
        RowBox[{"\"\<step\>\"", "->", "steps"}], ",", 
        RowBox[{"\"\<time\>\"", "->", "times"}], ",", 
        RowBox[{"\"\<files\>\"", "->", "files"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->"In[57]:=",ExpressionUUID->"031100a5-f529-474a-ac83-268d5d7c25ba"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compileBiMaxwellian", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compileBiMaxwellian", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]1_", "?", "Positive"}], ",", 
    RowBox[{"T2OT1_", "?", "Positive"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]1", "=", 
       SqrtBox[
        RowBox[{"N", "[", "\[Beta]1", "]"}]]}], ",", 
      RowBox[{"\[Theta]2", "=", 
       SqrtBox[
        RowBox[{
         RowBox[{"N", "[", "\[Beta]1", "]"}], "T2OT1"}]]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"n", " ", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"v1", "^", "2"}]}], "/", 
            RowBox[{"\[Theta]1", "^", "2"}]}], "-", 
           RowBox[{
            RowBox[{"v2", "^", "2"}], "/", 
            RowBox[{"\[Theta]2", "^", "2"}]}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"Pi", "^", "1.5"}], " ", "\[Theta]1", " ", 
          RowBox[{"\[Theta]2", "^", "2"}]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->"In[58]:=",ExpressionUUID->"23e38fd0-5996-4b1e-8c87-749d77fb67b3"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compileLossCone", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compileLossCone", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]1_", "?", "Positive"}], ",", 
    RowBox[{"T2OT1_", "?", "Positive"}], ",", 
    RowBox[{"\[Beta]_Real", "?", "Positive"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]1", "=", 
       SqrtBox[
        RowBox[{"N", "[", "\[Beta]1", "]"}]]}], ",", 
      RowBox[{"\[Theta]2", "=", 
       SqrtBox[
        RowBox[{
         RowBox[{"N", "[", "\[Beta]1", "]"}], 
         RowBox[{"T2OT1", "/", 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}]]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Beta]"}], ")"}]}], 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"v1", "^", "2"}]}], "/", 
            RowBox[{"\[Theta]1", "^", "2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"v2", "^", "2"}]}], "/", 
              RowBox[{"\[Theta]2", "^", "2"}]}], "]"}], "-", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"v2", "^", "2"}]}], "/", 
               RowBox[{"\[Theta]2", "^", "2"}]}], "/", "\[Beta]"}], "]"}]}], 
           ")"}]}], ",", 
         RowBox[{
          RowBox[{"Pi", "^", "1.5"}], " ", "\[Theta]1", " ", 
          RowBox[{"\[Theta]2", "^", "2"}]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->"In[60]:=",ExpressionUUID->"87d366a1-c8ba-4815-8fc8-6bb45a27781b"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compilePartialShell", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compilePartialShell", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]_", "?", "Positive"}], ",", 
    RowBox[{"\[Zeta]_Integer", "?", "NonNegative"}], ",", 
    RowBox[{"vs_", "?", "NonNegative"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]", "=", 
       RowBox[{"N", "[", 
        SqrtBox["\[Beta]"], "]"}]}], ",", 
      RowBox[{"xs", "=", 
       RowBox[{"N", "[", 
        RowBox[{"vs", "/", 
         SqrtBox["\[Beta]"]}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{".5", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"vs", "/", 
            SqrtBox["\[Beta]"]}], 
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"vs", "/", 
                SqrtBox["\[Beta]"]}], ")"}], "^", "2"}]}], "]"}]}], "+", 
          RowBox[{
           SqrtBox["\[Pi]"], 
           RowBox[{"(", 
            RowBox[{".5", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"vs", "/", 
                SqrtBox["\[Beta]"]}], ")"}], "^", "2"}]}], ")"}], 
           RowBox[{"Erfc", "[", 
            RowBox[{
             RowBox[{"-", "vs"}], "/", 
             SqrtBox["\[Beta]"]}], "]"}]}]}], ")"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"B\[Zeta]", "=", 
       RowBox[{
        SqrtBox["\[Pi]"], 
        RowBox[{
         RowBox[{"Gamma", "[", 
          RowBox[{"1", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}], "/", 
         RowBox[{"Gamma", "[", 
          RowBox[{"1.5", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "x1", ",", "x2", ",", "\[Mu]"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x2", "=", 
          RowBox[{"v2", "/", "\[Theta]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x1", "=", 
          RowBox[{"v1", "/", "\[Theta]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x", "=", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"x1", "^", "2"}], "+", 
            RowBox[{"x2", "^", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Mu]", "=", 
          RowBox[{"x1", "/", "x"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"n", " ", 
          RowBox[{"Divide", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"x", "-", "xs"}], ")"}], "^", "2"}]}], "]"}], 
             RowBox[{"Power", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "\[Mu]"}], ")"}], 
                RowBox[{"(", 
                 RowBox[{"1", "+", "\[Mu]"}], ")"}]}], ",", 
               RowBox[{".5", "\[Zeta]"}]}], "]"}]}], ",", 
            RowBox[{"2", "Pi", " ", 
             RowBox[{"\[Theta]", "^", "3"}], "Ab", " ", "B\[Zeta]"}]}], 
           "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->"In[62]:=",ExpressionUUID->"0c4a0d53-0227-4c1d-9df5-c49fe37333cd"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compileCounterBeam", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compileCounterBeam", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]_", "?", "Positive"}], ",", 
    RowBox[{"vs_", "?", "NonNegative"}], ",", 
    RowBox[{"\[Nu]_", "?", "Positive"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]", "=", 
       RowBox[{"N", "[", 
        SqrtBox["\[Beta]"], "]"}]}], ",", 
      RowBox[{"xs", "=", 
       RowBox[{"N", "[", 
        RowBox[{"vs", "/", 
         SqrtBox["\[Beta]"]}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{".5", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"vs", "/", 
            SqrtBox["\[Beta]"]}], 
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"vs", "/", 
                SqrtBox["\[Beta]"]}], ")"}], "^", "2"}]}], "]"}]}], "+", 
          RowBox[{
           SqrtBox["\[Pi]"], 
           RowBox[{"(", 
            RowBox[{".5", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"vs", "/", 
                SqrtBox["\[Beta]"]}], ")"}], "^", "2"}]}], ")"}], 
           RowBox[{"Erfc", "[", 
            RowBox[{
             RowBox[{"-", "vs"}], "/", 
             SqrtBox["\[Beta]"]}], "]"}]}]}], ")"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"B\[Nu]", "=", 
       RowBox[{"2", "\[Nu]", " ", 
        RowBox[{"DawsonF", "[", 
         RowBox[{"1", "/", "\[Nu]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x1", ",", "x2", ",", "x", ",", "\[Mu]", ",", "f0"}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x2", "=", 
          RowBox[{"v2", "/", "\[Theta]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x1", "=", 
          RowBox[{"v1", "/", "\[Theta]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x", "=", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"x1", "^", "2"}], "+", 
            RowBox[{"x2", "^", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Mu]", "=", 
          RowBox[{"x1", "/", "x"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"n", " ", 
          RowBox[{"Divide", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"x", "-", "xs"}], ")"}], "^", "2"}]}], "]"}], 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "\[Mu]"}], ")"}], 
                  RowBox[{"(", 
                   RowBox[{"1", "+", "\[Mu]"}], ")"}]}], ")"}]}], "/", 
               RowBox[{"\[Nu]", "^", "2"}]}], "]"}]}], ",", 
            RowBox[{"2", "Pi", " ", 
             RowBox[{"\[Theta]", "^", "3"}], "Ab", " ", "B\[Nu]"}]}], 
           "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->"In[64]:=",ExpressionUUID->"d0665cb6-5ec8-4cd5-9cc9-ae20044d7b18"],

Cell[CellGroupData[{

Cell["Maxwellian", "Subsubsection",ExpressionUUID->"fe80e185-5197-42f8-b99f-9cca5f073b7d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist1", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "1"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist1"}]}], "Input",
 CellLabel->"In[66]:=",ExpressionUUID->"f605ebca-de2f-4079-8328-128010bd5dda"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist1"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"T2OT1eq", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "fhist", ",", "ghist", ",", "whist", 
       ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "T2OT1", ",", "vv12", ",", 
       "ff", ",", "gg", ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{"T2OT1eq", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "T2OT1eq"}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{"T2OT1eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileBiMaxwellian", "[", 
          RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1"}], "]"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileBiMaxwellian", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1"}], "]"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[68]:=",ExpressionUUID->"5cdc9089-b8c9-4385-aa1b-7d765c270b48"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bi-Maxwellian", "Subsubsection",ExpressionUUID->"ac9a0ef0-1ed7-4c49-894b-8d040b1265af"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist2", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "2"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist2"}]}], "Input",
 CellLabel->"In[69]:=",ExpressionUUID->"30e29baf-be22-4a23-9455-cfb8d5cc8176"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist2"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"T2OT1eq", "=", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "fhist", ",", "ghist", ",", "whist", 
       ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "T2OT1", ",", "vv12", ",", 
       "ff", ",", "gg", ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{"T2OT1eq", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "T2OT1eq"}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{"T2OT1eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileBiMaxwellian", "[", 
          RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1"}], "]"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileBiMaxwellian", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1"}], "]"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[71]:=",ExpressionUUID->"24babefe-2ca7-45a8-bfe8-ab69c67cf459"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Loss cone - Maxwellian", "Subsubsection",ExpressionUUID->"e301e7dc-eb33-46da-86eb-8f8e6243a88e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist3", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "3"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist3"}]}], "Input",
 CellLabel->"In[72]:=",ExpressionUUID->"354e6873-e1ec-483e-a49a-8830fb2ba2ec"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist3"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["1"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "1.0*^-10"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "fhist", ",", "ghist", ",", "whist", 
       ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "\[Eta]\[Beta]", ",", "n0", ",", 
       "\[Beta]", ",", "\[Theta]2O\[Theta]1", ",", "T2OT1", ",", "vv12", ",", 
       "ff", ",", "gg", ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileLossCone", "[", 
          RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], 
          "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileLossCone", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1", ",", "\[Beta]"}], 
          "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[74]:=",ExpressionUUID->"1b1960bb-dfd3-42da-8f90-2cabf37dc77a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Loss cone - Bi-Maxwellian", "Subsubsection",ExpressionUUID->"f0e7d15b-2c81-4f41-868d-6745ac8e65db"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist4", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "4"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist4"}]}], "Input",
 CellLabel->"In[75]:=",ExpressionUUID->"0772f7b0-48e0-4b2d-8541-a07d79f2ca5d"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist4"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "1.0*^-10"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "fhist", ",", "ghist", ",", "whist", 
       ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "\[Eta]\[Beta]", ",", "n0", ",", 
       "\[Beta]", ",", "\[Theta]2O\[Theta]1", ",", "T2OT1", ",", "vv12", ",", 
       "ff", ",", "gg", ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileLossCone", "[", 
          RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], 
          "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileLossCone", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1", ",", "\[Beta]"}], 
          "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[77]:=",ExpressionUUID->"516ce6ad-b483-4ff9-bf73-83ba5e152724"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Loss cone - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Beta]", "eq"], "=", "0.5"}], TraditionalForm]],
  ExpressionUUID->"2e205f47-9f33-41a7-8fbf-e9a62dc828f2"]
}], "Subsubsection",ExpressionUUID->"09c53460-8f0c-4f01-90b3-594ffa8138dc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist5", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "5"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist5"}]}], "Input",
 CellLabel->"In[78]:=",ExpressionUUID->"d0cfef55-6cad-446f-8c55-c8501fc3af46"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist5"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "0.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "fhist", ",", "ghist", ",", "whist", 
       ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "\[Eta]\[Beta]", ",", "n0", ",", 
       "\[Beta]", ",", "\[Theta]2O\[Theta]1", ",", "T2OT1", ",", "vv12", ",", 
       "ff", ",", "gg", ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileLossCone", "[", 
          RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], 
          "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileLossCone", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1", ",", "\[Beta]"}], 
          "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[80]:=",ExpressionUUID->"184f72e9-532f-4217-a144-e0bc44cc73c3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Loss cone - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Beta]", "eq"], "=", "2.5"}], TraditionalForm]],
  ExpressionUUID->"5150e459-15b5-4b63-8c71-5bfdf0418bb6"]
}], "Subsubsection",ExpressionUUID->"674ebfdd-4362-4560-866b-f9fe043036cf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist6", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "6"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist6"}]}], "Input",
 CellLabel->"In[81]:=",ExpressionUUID->"06c87354-63c2-4a6f-be12-e2fb0478ac00"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist6"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "2.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "fhist", ",", "ghist", ",", "whist", 
       ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "\[Eta]\[Beta]", ",", "n0", ",", 
       "\[Beta]", ",", "\[Theta]2O\[Theta]1", ",", "T2OT1", ",", "vv12", ",", 
       "ff", ",", "gg", ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileLossCone", "[", 
          RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], 
          "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileLossCone", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1", ",", "\[Beta]"}], 
          "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[83]:=",ExpressionUUID->"f735f831-0bc3-40a4-9c52-c27695b114e1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Partial shell - Maxwellian", "Subsubsection",ExpressionUUID->"e264d83a-6c95-4ac5-9721-0f1e04acc04f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist7", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "7"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist7"}]}], "Input",
 CellLabel->"In[84]:=",ExpressionUUID->"489b4e47-5b2e-482d-9fc0-69cf95a5d05f"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist7"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "1.5"}], ",", 
     RowBox[{"\[Zeta]", "=", "0"}], ",", 
     RowBox[{"vs", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "fhist", ",", "ghist", ",", "whist", 
       ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "vv12", ",", "ff", ",", "gg",
        ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compilePartialShell", "[", 
          RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compilePartialShell", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]", " ", "gT"}], ",", "\[Zeta]", ",", "vs"}], "]"}],
          "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[86]:=",ExpressionUUID->"a2b28cda-daca-4adb-8339-21de3d02e7dd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Isotropic shell", "Subsubsection",ExpressionUUID->"6eb3c79b-eff6-4460-8253-47e96d5ee614"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist8", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "8"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist8"}]}], "Input",
 CellLabel->"In[87]:=",ExpressionUUID->"f57bb4e7-f06e-4745-bc6b-63fd2c0beb06"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist8"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "0"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "fhist", ",", "ghist", ",", "whist", 
       ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "vv12", ",", "ff", ",", "gg",
        ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compilePartialShell", "[", 
          RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compilePartialShell", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]", " ", "gT"}], ",", "\[Zeta]", ",", "vs"}], "]"}],
          "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[89]:=",ExpressionUUID->"f0394d30-2067-47b3-8e35-57bbbfb8f7f1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Partial shell - ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Zeta]", "=", "1"}], TraditionalForm]],ExpressionUUID->
  "380dbb2c-602c-4f1e-964c-89fb1ceb2c06"]
}], "Subsubsection",ExpressionUUID->"5dae1cb7-fb06-4091-b03e-968418fa9c75"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist9", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "9"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist9"}]}], "Input",
 CellLabel->"In[90]:=",ExpressionUUID->"f680c9c5-a9a6-49ee-bec0-059f006df748"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist9"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "1"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "fhist", ",", "ghist", ",", "whist", 
       ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "vv12", ",", "ff", ",", "gg",
        ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compilePartialShell", "[", 
          RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compilePartialShell", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]", " ", "gT"}], ",", "\[Zeta]", ",", "vs"}], "]"}],
          "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[92]:=",ExpressionUUID->"5e21fdad-81e8-40e3-8834-d06a327d2dd8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Partial shell - ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Zeta]", "=", "5"}], TraditionalForm]],ExpressionUUID->
  "08a6fdfd-6d84-4369-812f-b9d9fe349ad0"]
}], "Subsubsection",ExpressionUUID->"e115932c-e11d-4697-99f7-effb712dd1d5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist10", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "10"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist10"}]}], "Input",
 CellLabel->"In[93]:=",ExpressionUUID->"e5c1bd5b-d3eb-4d82-9320-2133ba724e35"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist10"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "5"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "fhist", ",", "ghist", ",", "whist", 
       ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "vv12", ",", "ff", ",", "gg",
        ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compilePartialShell", "[", 
          RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compilePartialShell", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]", " ", "gT"}], ",", "\[Zeta]", ",", "vs"}], "]"}],
          "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[95]:=",ExpressionUUID->"d467d30e-a58a-434d-bb04-91e18e536b77"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Counter beam - Maxwellian", "Subsubsection",ExpressionUUID->"dfddec11-3625-4a58-b93f-4eb84373b4d9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist11", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "11"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist11"}]}], "Input",
 CellLabel->"In[96]:=",ExpressionUUID->"300c178f-3b9d-4f74-a0db-61470e36ae1c"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist11"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "1.5"}], ",", 
     RowBox[{"\[Nu]0", "=", "100000"}], ",", 
     RowBox[{"vs", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "fhist", ",", "ghist", ",", "whist", 
       ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "\[Nu]", ",", "vv12", ",", 
       "ff", ",", "gg", ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"DawsonF", "[", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "/", 
           "\[Nu]0"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]0"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{
        RowBox[{"Sec", "[", 
         RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "\[Nu]0"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileCounterBeam", "[", 
          RowBox[{"n0", ",", "\[Beta]", ",", "vs", ",", "\[Nu]"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileCounterBeam", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]", " ", "gT"}], ",", "vs", ",", "\[Nu]"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[100]:=",ExpressionUUID->"2ce31b05-a085-4825-974b-683fa5383177"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Counter beam - isotropic shell", "Subsubsection",ExpressionUUID->"55c407a3-2de6-4846-a716-844f2092e669"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist12", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "12"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist12"}]}], "Input",
 CellLabel->
  "In[101]:=",ExpressionUUID->"30146ccc-1d52-43a3-a629-81703cd3ab6d"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist12"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Nu]0", "=", "100000"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "fhist", ",", "ghist", ",", "whist", 
       ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "\[Nu]", ",", "vv12", ",", 
       "ff", ",", "gg", ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"DawsonF", "[", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "/", 
           "\[Nu]0"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]0"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{
        RowBox[{"Sec", "[", 
         RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "\[Nu]0"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileCounterBeam", "[", 
          RowBox[{"n0", ",", "\[Beta]", ",", "vs", ",", "\[Nu]"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileCounterBeam", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]", " ", "gT"}], ",", "vs", ",", "\[Nu]"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[103]:=",ExpressionUUID->"8081adf9-47ee-4105-aa57-d470dee3c1af"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Counter beam - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Nu]", "0"], "=", "1"}], TraditionalForm]],ExpressionUUID->
  "25e72152-1df5-4d31-b4d5-656b18506b5c"]
}], "Subsubsection",ExpressionUUID->"9c2fdc56-ccd9-4cb5-a1df-53b9c62b8b5a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist13", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "13"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist13"}]}], "Input",
 CellLabel->
  "In[104]:=",ExpressionUUID->"3dccea1a-cf00-4f5d-9585-e23c6b62dea0"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist13"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Nu]0", "=", "1"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "fhist", ",", "ghist", ",", "whist", 
       ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "\[Nu]", ",", "vv12", ",", 
       "ff", ",", "gg", ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"DawsonF", "[", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "/", 
           "\[Nu]0"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]0"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{
        RowBox[{"Sec", "[", 
         RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "\[Nu]0"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileCounterBeam", "[", 
          RowBox[{"n0", ",", "\[Beta]", ",", "vs", ",", "\[Nu]"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileCounterBeam", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]", " ", "gT"}], ",", "vs", ",", "\[Nu]"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[106]:=",ExpressionUUID->"fa6a3b51-a8dd-401b-881f-16e6cd050147"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Counter beam - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["v", "0"], "=", "0.1"}], TraditionalForm]],ExpressionUUID->
  "5bb529f7-4524-40e0-9d65-1aaf8b12adaf"]
}], "Subsubsection",ExpressionUUID->"be15d8da-c8fa-47d3-99fc-d3ef2d7be9bf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist14", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "14"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist14"}]}], "Input",
 CellLabel->
  "In[107]:=",ExpressionUUID->"632eea9a-d53d-44b2-b519-6a9a118ff9c2"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist14"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Nu]0", "=", ".1"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "fhist", ",", "ghist", ",", "whist", 
       ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "\[Nu]", ",", "vv12", ",", 
       "ff", ",", "gg", ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"DawsonF", "[", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "/", 
           "\[Nu]0"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]0"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{
        RowBox[{"Sec", "[", 
         RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "\[Nu]0"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileCounterBeam", "[", 
          RowBox[{"n0", ",", "\[Beta]", ",", "vs", ",", "\[Nu]"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileCounterBeam", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]", " ", "gT"}], ",", "vs", ",", "\[Nu]"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[110]:=",ExpressionUUID->"2e1d00e2-a828-4f6a-b73e-b17b22ae634c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Particle", "Subsection",ExpressionUUID->"5fd3b1be-689f-429f-b7e4-8019920ed1c4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"metadata", "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"files", "=", 
        RowBox[{"FileNames", "[", 
         RowBox[{"\"\<particle-*.h5\>\"", ",", "wd"}], "]"}]}], ",", "names", 
       ",", "attrs", ",", "steps", ",", "times", ",", "pos"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"attrs", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<HDF5\>\"", ",", "\"\<Attributes\>\"", ",", 
             "\"\</particle\>\""}], "}"}]}], "]"}], "&"}], "/@", "files"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{
        RowBox[{"Lookup", "[", "\"\<step\>\"", "]"}], "/@", "attrs"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"times", "=", 
       RowBox[{
        RowBox[{"Lookup", "[", "\"\<time\>\"", "]"}], "/@", "attrs"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"List", "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "times", "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"First", "/@", 
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"pos", ",", "times"}], "}"}], "]"}], ",", "Last"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"steps", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"times", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"times", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"files", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"files", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Association", "[", 
       RowBox[{
        RowBox[{"\"\<attr\>\"", "->", 
         RowBox[{"KeyDrop", "[", 
          RowBox[{
           RowBox[{"First", "[", "attrs", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<step\>\"", ",", "\"\<time\>\""}], "}"}]}], "]"}]}], 
        ",", 
        RowBox[{"\"\<step\>\"", "->", "steps"}], ",", 
        RowBox[{"\"\<time\>\"", "->", "times"}], ",", 
        RowBox[{"\"\<files\>\"", "->", "files"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[111]:=",ExpressionUUID->"893da2a7-7e5d-432e-b173-f8eaf133cea4"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compileBiMaxwellian", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compileBiMaxwellian", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]1_", "?", "Positive"}], ",", 
    RowBox[{"T2OT1_", "?", "Positive"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]1", "=", 
       SqrtBox[
        RowBox[{"N", "[", "\[Beta]1", "]"}]]}], ",", 
      RowBox[{"\[Theta]2", "=", 
       SqrtBox[
        RowBox[{
         RowBox[{"N", "[", "\[Beta]1", "]"}], "T2OT1"}]]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"n", " ", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"v1", "^", "2"}]}], "/", 
            RowBox[{"\[Theta]1", "^", "2"}]}], "-", 
           RowBox[{
            RowBox[{"v2", "^", "2"}], "/", 
            RowBox[{"\[Theta]2", "^", "2"}]}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"Pi", "^", "1.5"}], " ", "\[Theta]1", " ", 
          RowBox[{"\[Theta]2", "^", "2"}]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[112]:=",ExpressionUUID->"cb341572-e53f-4af1-9c6e-ed9448575ba6"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compileLossCone", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compileLossCone", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]1_", "?", "Positive"}], ",", 
    RowBox[{"T2OT1_", "?", "Positive"}], ",", 
    RowBox[{"\[Beta]_Real", "?", "Positive"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]1", "=", 
       SqrtBox[
        RowBox[{"N", "[", "\[Beta]1", "]"}]]}], ",", 
      RowBox[{"\[Theta]2", "=", 
       SqrtBox[
        RowBox[{
         RowBox[{"N", "[", "\[Beta]1", "]"}], 
         RowBox[{"T2OT1", "/", 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}]]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Beta]"}], ")"}]}], 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"v1", "^", "2"}]}], "/", 
            RowBox[{"\[Theta]1", "^", "2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"v2", "^", "2"}]}], "/", 
              RowBox[{"\[Theta]2", "^", "2"}]}], "]"}], "-", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"v2", "^", "2"}]}], "/", 
               RowBox[{"\[Theta]2", "^", "2"}]}], "/", "\[Beta]"}], "]"}]}], 
           ")"}]}], ",", 
         RowBox[{
          RowBox[{"Pi", "^", "1.5"}], " ", "\[Theta]1", " ", 
          RowBox[{"\[Theta]2", "^", "2"}]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[114]:=",ExpressionUUID->"45b8a89b-813c-48e5-adf5-13fd6fe5a6f5"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compilePartialShell", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compilePartialShell", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]_", "?", "Positive"}], ",", 
    RowBox[{"\[Zeta]_Integer", "?", "NonNegative"}], ",", 
    RowBox[{"vs_", "?", "NonNegative"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]", "=", 
       RowBox[{"N", "[", 
        SqrtBox["\[Beta]"], "]"}]}], ",", 
      RowBox[{"xs", "=", 
       RowBox[{"N", "[", 
        RowBox[{"vs", "/", 
         SqrtBox["\[Beta]"]}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{".5", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"vs", "/", 
            SqrtBox["\[Beta]"]}], 
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"vs", "/", 
                SqrtBox["\[Beta]"]}], ")"}], "^", "2"}]}], "]"}]}], "+", 
          RowBox[{
           SqrtBox["\[Pi]"], 
           RowBox[{"(", 
            RowBox[{".5", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"vs", "/", 
                SqrtBox["\[Beta]"]}], ")"}], "^", "2"}]}], ")"}], 
           RowBox[{"Erfc", "[", 
            RowBox[{
             RowBox[{"-", "vs"}], "/", 
             SqrtBox["\[Beta]"]}], "]"}]}]}], ")"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"B\[Zeta]", "=", 
       RowBox[{
        SqrtBox["\[Pi]"], 
        RowBox[{
         RowBox[{"Gamma", "[", 
          RowBox[{"1", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}], "/", 
         RowBox[{"Gamma", "[", 
          RowBox[{"1.5", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "x1", ",", "x2", ",", "\[Mu]"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x2", "=", 
          RowBox[{"v2", "/", "\[Theta]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x1", "=", 
          RowBox[{"v1", "/", "\[Theta]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x", "=", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"x1", "^", "2"}], "+", 
            RowBox[{"x2", "^", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Mu]", "=", 
          RowBox[{"x1", "/", "x"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"n", " ", 
          RowBox[{"Divide", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"x", "-", "xs"}], ")"}], "^", "2"}]}], "]"}], 
             RowBox[{"Power", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "\[Mu]"}], ")"}], 
                RowBox[{"(", 
                 RowBox[{"1", "+", "\[Mu]"}], ")"}]}], ",", 
               RowBox[{".5", "\[Zeta]"}]}], "]"}]}], ",", 
            RowBox[{"2", "Pi", " ", 
             RowBox[{"\[Theta]", "^", "3"}], "Ab", " ", "B\[Zeta]"}]}], 
           "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[116]:=",ExpressionUUID->"a7dddd1d-ebb0-4cac-80db-99d04aa3ebec"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compileCounterBeam", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compileCounterBeam", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]_", "?", "Positive"}], ",", 
    RowBox[{"vs_", "?", "NonNegative"}], ",", 
    RowBox[{"\[Nu]_", "?", "Positive"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]", "=", 
       RowBox[{"N", "[", 
        SqrtBox["\[Beta]"], "]"}]}], ",", 
      RowBox[{"xs", "=", 
       RowBox[{"N", "[", 
        RowBox[{"vs", "/", 
         SqrtBox["\[Beta]"]}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{".5", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"vs", "/", 
            SqrtBox["\[Beta]"]}], 
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"vs", "/", 
                SqrtBox["\[Beta]"]}], ")"}], "^", "2"}]}], "]"}]}], "+", 
          RowBox[{
           SqrtBox["\[Pi]"], 
           RowBox[{"(", 
            RowBox[{".5", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"vs", "/", 
                SqrtBox["\[Beta]"]}], ")"}], "^", "2"}]}], ")"}], 
           RowBox[{"Erfc", "[", 
            RowBox[{
             RowBox[{"-", "vs"}], "/", 
             SqrtBox["\[Beta]"]}], "]"}]}]}], ")"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"B\[Nu]", "=", 
       RowBox[{"2", "\[Nu]", " ", 
        RowBox[{"DawsonF", "[", 
         RowBox[{"1", "/", "\[Nu]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x1", ",", "x2", ",", "x", ",", "\[Mu]", ",", "f0"}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x2", "=", 
          RowBox[{"v2", "/", "\[Theta]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x1", "=", 
          RowBox[{"v1", "/", "\[Theta]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x", "=", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"x1", "^", "2"}], "+", 
            RowBox[{"x2", "^", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Mu]", "=", 
          RowBox[{"x1", "/", "x"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"n", " ", 
          RowBox[{"Divide", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"x", "-", "xs"}], ")"}], "^", "2"}]}], "]"}], 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "\[Mu]"}], ")"}], 
                  RowBox[{"(", 
                   RowBox[{"1", "+", "\[Mu]"}], ")"}]}], ")"}]}], "/", 
               RowBox[{"\[Nu]", "^", "2"}]}], "]"}]}], ",", 
            RowBox[{"2", "Pi", " ", 
             RowBox[{"\[Theta]", "^", "3"}], "Ab", " ", "B\[Nu]"}]}], 
           "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[118]:=",ExpressionUUID->"34e89023-f7cc-411a-a5ac-1210782ac18d"],

Cell[CellGroupData[{

Cell["Maxwellian", "Subsubsection",ExpressionUUID->"36a1f4fc-a9cc-4b45-a98e-bb5e12f6c6e3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl1", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "1"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"v1lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v2lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv2", "=", "51"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "vhist", ",", "q1", ",", "rhist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vhist", "=", 
         RowBox[{"calVelocityHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"v1lim", ",", "Nv1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v2lim", ",", "Nv2"}], "}"}], ",", "q1lim"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nv\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl1"}]}], "Input",
 CellLabel->
  "In[120]:=",ExpressionUUID->"9f097443-e5b5-4b5e-a35b-87e5696bf097"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl1"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"T2OT1eq", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "\[Xi]\[CapitalDelta]1", ",", "q1", 
       ",", "\[Eta]", ",", "n0", ",", "T2OT1", ",", "vv12", ",", "ff", ",", 
       "gg", ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{"T2OT1eq", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "T2OT1eq"}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{"T2OT1eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileBiMaxwellian", "[", 
            RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1"}], "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileBiMaxwellian", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1"}], "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vhist", "[", "\"\<df\>\"", "]"}], "//", "Reverse"}],
                 ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Divide", ",", 
                  RowBox[{"Subtract", "@@@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRangePadding", "->", 
               RowBox[{"Thread", "[", 
                RowBox[{"Scaled", "[", 
                 RowBox[{".02", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[122]:=",ExpressionUUID->"1467e5f1-23c4-4fb5-b056-e0e7cdcb825d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bi-Maxwellian", "Subsubsection",ExpressionUUID->"8adb1f5d-23b5-47fe-9819-00234264bcad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl2", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "2"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"v1lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v2lim", "=", 
        RowBox[{"6.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "vhist", ",", "q1", ",", "rhist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vhist", "=", 
         RowBox[{"calVelocityHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"v1lim", ",", "Nv1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v2lim", ",", "Nv2"}], "}"}], ",", "q1lim"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nv\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl2"}]}], "Input",
 CellLabel->
  "In[123]:=",ExpressionUUID->"fbd90576-d11a-4dd7-99ff-ee2dd90257e7"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl2"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"T2OT1eq", "=", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "\[Xi]\[CapitalDelta]1", ",", "q1", 
       ",", "\[Eta]", ",", "n0", ",", "T2OT1", ",", "vv12", ",", "ff", ",", 
       "gg", ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{"T2OT1eq", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "T2OT1eq"}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{"T2OT1eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileBiMaxwellian", "[", 
            RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1"}], "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileBiMaxwellian", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1"}], "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vhist", "[", "\"\<df\>\"", "]"}], "//", "Reverse"}],
                 ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Divide", ",", 
                  RowBox[{"Subtract", "@@@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRangePadding", "->", 
               RowBox[{"Thread", "[", 
                RowBox[{"Scaled", "[", 
                 RowBox[{".02", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[125]:=",ExpressionUUID->"bdf67aff-9b63-49c3-8a4a-1fbbe0a4de5e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Loss cone - Maxwellian", "Subsubsection",ExpressionUUID->"ff204e1f-d465-4e45-9f15-b73c3c893168"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl3", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "3"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"v1lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v2lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv2", "=", "51"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "vhist", ",", "q1", ",", "rhist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vhist", "=", 
         RowBox[{"calVelocityHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"v1lim", ",", "Nv1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v2lim", ",", "Nv2"}], "}"}], ",", "q1lim"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nv\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl3"}]}], "Input",
 CellLabel->
  "In[126]:=",ExpressionUUID->"96fe0e7f-76ca-4d7d-a9ae-193e995d5e47"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl3"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["1"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "1.0*^-10"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "\[Xi]\[CapitalDelta]1", ",", "q1", 
       ",", "\[Eta]", ",", "\[Eta]\[Beta]", ",", "\[Beta]", ",", "n0", ",", 
       "\[Theta]2O\[Theta]1", ",", "T2OT1", ",", "vv12", ",", "ff", ",", "gg",
        ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileLossCone", "[", 
            RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], 
            "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileLossCone", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1", ",", "\[Beta]"}], 
            "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vhist", "[", "\"\<df\>\"", "]"}], "//", "Reverse"}],
                 ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Divide", ",", 
                  RowBox[{"Subtract", "@@@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRangePadding", "->", 
               RowBox[{"Thread", "[", 
                RowBox[{"Scaled", "[", 
                 RowBox[{".02", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[128]:=",ExpressionUUID->"7b43c61b-d5ad-4fdd-a772-d4d0ed3a5201"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Loss cone - Bi-Maxwellian", "Subsubsection",ExpressionUUID->"07cb930f-0154-42c4-a84b-64000b6a5919"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl4", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "4"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"v1lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v2lim", "=", 
        RowBox[{"6.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "vhist", ",", "q1", ",", "rhist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vhist", "=", 
         RowBox[{"calVelocityHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"v1lim", ",", "Nv1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v2lim", ",", "Nv2"}], "}"}], ",", "q1lim"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nv\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl4"}]}], "Input",
 CellLabel->
  "In[129]:=",ExpressionUUID->"f80e0095-8f0a-4fe4-90c4-7fb3081b8a1b"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl4"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "1.0*^-10"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "\[Xi]\[CapitalDelta]1", ",", "q1", 
       ",", "\[Eta]", ",", "\[Eta]\[Beta]", ",", "\[Beta]", ",", "n0", ",", 
       "\[Theta]2O\[Theta]1", ",", "T2OT1", ",", "vv12", ",", "ff", ",", "gg",
        ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileLossCone", "[", 
            RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], 
            "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileLossCone", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1", ",", "\[Beta]"}], 
            "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vhist", "[", "\"\<df\>\"", "]"}], "//", "Reverse"}],
                 ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Divide", ",", 
                  RowBox[{"Subtract", "@@@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRangePadding", "->", 
               RowBox[{"Thread", "[", 
                RowBox[{"Scaled", "[", 
                 RowBox[{".02", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[131]:=",ExpressionUUID->"51ef39fa-77c6-4a43-9e93-38d99f692bac"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Loss cone - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Beta]", "eq"], "=", "0.5"}], TraditionalForm]],
  ExpressionUUID->"0d219fcd-ec78-4885-b380-67af10638728"]
}], "Subsubsection",ExpressionUUID->"453a29b7-4b7f-4c4e-8b5d-32e8bf4fe9a4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl5", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "5"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"v1lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v2lim", "=", 
        RowBox[{"6.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "vhist", ",", "q1", ",", "rhist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vhist", "=", 
         RowBox[{"calVelocityHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"v1lim", ",", "Nv1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v2lim", ",", "Nv2"}], "}"}], ",", "q1lim"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nv\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl5"}]}], "Input",
 CellLabel->
  "In[132]:=",ExpressionUUID->"0e51ec89-08a0-4054-84d8-3643b3203a1c"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl5"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "0.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "\[Xi]\[CapitalDelta]1", ",", "q1", 
       ",", "\[Eta]", ",", "\[Eta]\[Beta]", ",", "\[Beta]", ",", "n0", ",", 
       "\[Theta]2O\[Theta]1", ",", "T2OT1", ",", "vv12", ",", "ff", ",", "gg",
        ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileLossCone", "[", 
            RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], 
            "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileLossCone", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1", ",", "\[Beta]"}], 
            "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vhist", "[", "\"\<df\>\"", "]"}], "//", "Reverse"}],
                 ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Divide", ",", 
                  RowBox[{"Subtract", "@@@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRangePadding", "->", 
               RowBox[{"Thread", "[", 
                RowBox[{"Scaled", "[", 
                 RowBox[{".02", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[134]:=",ExpressionUUID->"57e2e1ce-cc9a-4e6e-b9b0-5f50e329419d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Loss cone - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Beta]", "eq"], "=", "2.5"}], TraditionalForm]],
  ExpressionUUID->"b870e055-b1c7-449b-902d-f94bf4f76d10"]
}], "Subsubsection",ExpressionUUID->"420d5dbe-eb47-4c9a-b990-17c8bf2c417f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl6", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "6"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"v1lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v2lim", "=", 
        RowBox[{"6.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "vhist", ",", "q1", ",", "rhist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vhist", "=", 
         RowBox[{"calVelocityHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"v1lim", ",", "Nv1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v2lim", ",", "Nv2"}], "}"}], ",", "q1lim"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nv\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl6"}]}], "Input",
 CellLabel->
  "In[135]:=",ExpressionUUID->"4128df59-a0ee-48c9-a3b5-58536eb92fd0"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl6"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "2.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "\[Xi]\[CapitalDelta]1", ",", "q1", 
       ",", "\[Eta]", ",", "\[Eta]\[Beta]", ",", "\[Beta]", ",", "n0", ",", 
       "\[Theta]2O\[Theta]1", ",", "T2OT1", ",", "vv12", ",", "ff", ",", "gg",
        ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileLossCone", "[", 
            RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], 
            "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileLossCone", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1", ",", "\[Beta]"}], 
            "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vhist", "[", "\"\<df\>\"", "]"}], "//", "Reverse"}],
                 ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Divide", ",", 
                  RowBox[{"Subtract", "@@@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRangePadding", "->", 
               RowBox[{"Thread", "[", 
                RowBox[{"Scaled", "[", 
                 RowBox[{".02", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[137]:=",ExpressionUUID->"d183ec4e-ef5d-4e9e-89f7-1752fde91471"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Partial Shell - Maxwellian", "Subsubsection",ExpressionUUID->"4cde35e2-2a6c-42fb-8a21-d536aaf2b1c0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl7", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "7"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"v1lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v2lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv2", "=", "51"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "vhist", ",", "q1", ",", "rhist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vhist", "=", 
         RowBox[{"calVelocityHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"v1lim", ",", "Nv1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v2lim", ",", "Nv2"}], "}"}], ",", "q1lim"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nv\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl7"}]}], "Input",
 CellLabel->
  "In[138]:=",ExpressionUUID->"fdd05f59-c9bf-4ee7-b6e7-1ec4e8adb3e6"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl7"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "1.5"}], ",", 
     RowBox[{"\[Zeta]", "=", "0"}], ",", 
     RowBox[{"vs", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "plots", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "vv12", ",", "ff", ",", 
       "gg"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compilePartialShell", "[", 
            RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], "]"}], 
           ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compilePartialShell", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]", " ", "gT"}], ",", "\[Zeta]", ",", "vs"}], 
            "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vhist", "[", "\"\<df\>\"", "]"}], "//", "Reverse"}],
                 ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Divide", ",", 
                  RowBox[{"Subtract", "@@@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRangePadding", "->", 
               RowBox[{"Thread", "[", 
                RowBox[{"Scaled", "[", 
                 RowBox[{".02", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[140]:=",ExpressionUUID->"3b80149a-2520-4e15-9c72-3095b1089618"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Isotropic shell", "Subsubsection",ExpressionUUID->"9c707734-a002-4b4f-a78f-4088c49d8d3c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl8", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "8"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"v1lim", "=", 
        RowBox[{"2.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v2lim", "=", 
        RowBox[{"3.0", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "vhist", ",", "q1", ",", "rhist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vhist", "=", 
         RowBox[{"calVelocityHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"v1lim", ",", "Nv1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v2lim", ",", "Nv2"}], "}"}], ",", "q1lim"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nv\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl8"}]}], "Input",
 CellLabel->
  "In[141]:=",ExpressionUUID->"398aa1e0-b84f-4764-a659-9a8c5ffcdb98"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl8"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "0"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "plots", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "vv12", ",", "ff", ",", 
       "gg"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compilePartialShell", "[", 
            RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], "]"}], 
           ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compilePartialShell", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]", " ", "gT"}], ",", "\[Zeta]", ",", "vs"}], 
            "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vhist", "[", "\"\<df\>\"", "]"}], "//", "Reverse"}],
                 ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Divide", ",", 
                  RowBox[{"Subtract", "@@@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRangePadding", "->", 
               RowBox[{"Thread", "[", 
                RowBox[{"Scaled", "[", 
                 RowBox[{".02", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[143]:=",ExpressionUUID->"26061cd9-12aa-490f-b1d5-6c11255c1278"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Partial shell - ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Zeta]", "=", "1"}], TraditionalForm]],ExpressionUUID->
  "5dfeb8ae-ab61-4209-b791-0ab3e6edf841"]
}], "Subsubsection",ExpressionUUID->"50d02012-23a3-4fdc-b5f8-faf0710d9674"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl9", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "9"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"v1lim", "=", 
        RowBox[{"2.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v2lim", "=", 
        RowBox[{"3.0", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "vhist", ",", "q1", ",", "rhist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vhist", "=", 
         RowBox[{"calVelocityHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"v1lim", ",", "Nv1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v2lim", ",", "Nv2"}], "}"}], ",", "q1lim"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nv\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl9"}]}], "Input",
 CellLabel->
  "In[144]:=",ExpressionUUID->"9a7809fb-2c2d-4650-8a3f-b5bb9dfe2995"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl9"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "1"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "plots", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "vv12", ",", "ff", ",", 
       "gg"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compilePartialShell", "[", 
            RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], "]"}], 
           ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compilePartialShell", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]", " ", "gT"}], ",", "\[Zeta]", ",", "vs"}], 
            "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vhist", "[", "\"\<df\>\"", "]"}], "//", "Reverse"}],
                 ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Divide", ",", 
                  RowBox[{"Subtract", "@@@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRangePadding", "->", 
               RowBox[{"Thread", "[", 
                RowBox[{"Scaled", "[", 
                 RowBox[{".02", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[146]:=",ExpressionUUID->"89c4593d-3e80-4b8f-bdd1-6fd0449d22c0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Partial shell - ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Zeta]", "=", "5"}], TraditionalForm]],ExpressionUUID->
  "3feba518-3360-48bc-bd4f-19007b6c6f11"]
}], "Subsubsection",ExpressionUUID->"7950b24b-c9da-4d79-9d2d-f2e2a50a72e5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl10", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "10"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"v1lim", "=", 
        RowBox[{"2.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v2lim", "=", 
        RowBox[{"3.0", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "vhist", ",", "q1", ",", "rhist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vhist", "=", 
         RowBox[{"calVelocityHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"v1lim", ",", "Nv1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v2lim", ",", "Nv2"}], "}"}], ",", "q1lim"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nv\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl10"}]}], "Input",
 CellLabel->
  "In[147]:=",ExpressionUUID->"8ec05565-1468-434e-90e1-fa9efc4065ed"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl10"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "5"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "plots", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "vv12", ",", "ff", ",", 
       "gg"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compilePartialShell", "[", 
            RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], "]"}], 
           ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compilePartialShell", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]", " ", "gT"}], ",", "\[Zeta]", ",", "vs"}], 
            "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vhist", "[", "\"\<df\>\"", "]"}], "//", "Reverse"}],
                 ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Divide", ",", 
                  RowBox[{"Subtract", "@@@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRangePadding", "->", 
               RowBox[{"Thread", "[", 
                RowBox[{"Scaled", "[", 
                 RowBox[{".02", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[149]:=",ExpressionUUID->"ed6fdec6-abd6-443c-b685-c3ef58ecb9e8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Counter beam - Maxwellian", "Subsubsection",ExpressionUUID->"a86d3ef8-a37c-4e87-9fe2-6ef470683dbe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl11", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "11"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"v1lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v2lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv2", "=", "51"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "vhist", ",", "q1", ",", "rhist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vhist", "=", 
         RowBox[{"calVelocityHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"v1lim", ",", "Nv1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v2lim", ",", "Nv2"}], "}"}], ",", "q1lim"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nv\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl11"}]}], "Input",
 CellLabel->
  "In[150]:=",ExpressionUUID->"a2eda134-4234-40dd-8cb9-53a0ce5ef4a3"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl11"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "1.5"}], ",", 
     RowBox[{"\[Nu]0", "=", "100000"}], ",", 
     RowBox[{"vs", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "plots", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "\[Nu]", ",", "vv12", ",", 
       "ff", ",", "gg"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"DawsonF", "[", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "/", 
           "\[Nu]0"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]0"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{
        RowBox[{"Sec", "[", 
         RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "\[Nu]0"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileCounterBeam", "[", 
            RowBox[{"n0", ",", "\[Beta]", ",", "vs", ",", "\[Nu]"}], "]"}], 
           ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileCounterBeam", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]", " ", "gT"}], ",", "vs", ",", "\[Nu]"}], "]"}],
            ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vhist", "[", "\"\<df\>\"", "]"}], "//", "Reverse"}],
                 ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Divide", ",", 
                  RowBox[{"Subtract", "@@@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRangePadding", "->", 
               RowBox[{"Thread", "[", 
                RowBox[{"Scaled", "[", 
                 RowBox[{".02", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[153]:=",ExpressionUUID->"8c9fc8ba-ee02-422c-b2a0-8f8aeba8498d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Counter beam - isotropic shell", "Subsubsection",ExpressionUUID->"598bba33-3cb2-4a02-8adc-cf784f1912d4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl12", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "12"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"v1lim", "=", 
        RowBox[{"2.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v2lim", "=", 
        RowBox[{"3.0", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "vhist", ",", "q1", ",", "rhist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vhist", "=", 
         RowBox[{"calVelocityHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"v1lim", ",", "Nv1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v2lim", ",", "Nv2"}], "}"}], ",", "q1lim"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nv\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl12"}]}], "Input",
 CellLabel->
  "In[154]:=",ExpressionUUID->"bc12e428-10d8-4c38-902b-a485497111c1"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl12"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Nu]0", "=", "100000"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "plots", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "\[Nu]", ",", "vv12", ",", 
       "ff", ",", "gg"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"DawsonF", "[", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "/", 
           "\[Nu]0"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]0"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{
        RowBox[{"Sec", "[", 
         RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "\[Nu]0"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileCounterBeam", "[", 
            RowBox[{"n0", ",", "\[Beta]", ",", "vs", ",", "\[Nu]"}], "]"}], 
           ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileCounterBeam", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]", " ", "gT"}], ",", "vs", ",", "\[Nu]"}], "]"}],
            ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vhist", "[", "\"\<df\>\"", "]"}], "//", "Reverse"}],
                 ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Divide", ",", 
                  RowBox[{"Subtract", "@@@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRangePadding", "->", 
               RowBox[{"Thread", "[", 
                RowBox[{"Scaled", "[", 
                 RowBox[{".02", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[157]:=",ExpressionUUID->"582b7cf0-4358-441b-b5d6-692a3026936e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Counter beam - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Nu]", "0"], "=", "1"}], TraditionalForm]],ExpressionUUID->
  "c6f041e5-f86d-416a-b170-d0a7db95afdd"]
}], "Subsubsection",ExpressionUUID->"326ed33a-9bc1-4cb0-8d26-33211d9d1b4e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl13", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "13"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"v1lim", "=", 
        RowBox[{"2.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v2lim", "=", 
        RowBox[{"2.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "vhist", ",", "q1", ",", "rhist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vhist", "=", 
         RowBox[{"calVelocityHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"v1lim", ",", "Nv1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v2lim", ",", "Nv2"}], "}"}], ",", "q1lim"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nv\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl13"}]}], "Input",
 CellLabel->
  "In[158]:=",ExpressionUUID->"363f4125-6a83-44a8-a0a0-f96296862cfe"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl13"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Nu]0", "=", "1"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "plots", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "\[Nu]", ",", "vv12", ",", 
       "ff", ",", "gg"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"DawsonF", "[", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "/", 
           "\[Nu]0"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]0"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{
        RowBox[{"Sec", "[", 
         RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "\[Nu]0"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileCounterBeam", "[", 
            RowBox[{"n0", ",", "\[Beta]", ",", "vs", ",", "\[Nu]"}], "]"}], 
           ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileCounterBeam", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]", " ", "gT"}], ",", "vs", ",", "\[Nu]"}], "]"}],
            ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vhist", "[", "\"\<df\>\"", "]"}], "//", "Reverse"}],
                 ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Divide", ",", 
                  RowBox[{"Subtract", "@@@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRangePadding", "->", 
               RowBox[{"Thread", "[", 
                RowBox[{"Scaled", "[", 
                 RowBox[{".02", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[160]:=",ExpressionUUID->"8d0d14dd-eb5b-4a51-9386-339fbc356c35"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Counter beam - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Nu]", "0"], "=", "0.1"}], TraditionalForm]],
  ExpressionUUID->"590ee0d5-4d16-4cb4-9eb1-a1e1d34c7d9a"]
}], "Subsubsection",ExpressionUUID->"9590f99b-e3a8-4533-9970-2523ff1517ad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl14", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "14"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"v1lim", "=", 
        RowBox[{"2.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v2lim", "=", 
        RowBox[{"0.7", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "vhist", ",", "q1", ",", "rhist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vhist", "=", 
         RowBox[{"calVelocityHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"v1lim", ",", "Nv1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v2lim", ",", "Nv2"}], "}"}], ",", "q1lim"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nv\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl14"}]}], "Input",
 CellLabel->
  "In[161]:=",ExpressionUUID->"6b460388-7429-49d5-926c-fd25afc89bd3"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl14"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Nu]0", "=", ".1"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "plots", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "\[Nu]", ",", "vv12", ",", 
       "ff", ",", "gg"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"DawsonF", "[", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "/", 
           "\[Nu]0"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]0"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{
        RowBox[{"Sec", "[", 
         RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "\[Nu]0"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileCounterBeam", "[", 
            RowBox[{"n0", ",", "\[Beta]", ",", "vs", ",", "\[Nu]"}], "]"}], 
           ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileCounterBeam", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]", " ", "gT"}], ",", "vs", ",", "\[Nu]"}], "]"}],
            ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vhist", "[", "\"\<df\>\"", "]"}], "//", "Reverse"}],
                 ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Divide", ",", 
                  RowBox[{"Subtract", "@@@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRangePadding", "->", 
               RowBox[{"Thread", "[", 
                RowBox[{"Scaled", "[", 
                 RowBox[{".02", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[163]:=",ExpressionUUID->"2f5769a4-2e62-40c9-aac1-e3987605aa8f"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1437, 1578},
WindowMargins->{{Automatic, 0}, {-1.4173228346458018`, Automatic}},
FrontEndVersion->"13.2 for Linux x86 (64-bit) (January 31, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"13c7468d-72b3-4754-a7ae-58931f6d390a"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 271, 5, 51, "Input",ExpressionUUID->"35414358-9cce-404a-b33a-abdb7a6986c5"],
Cell[832, 27, 254, 6, 29, "Input",ExpressionUUID->"98642d0f-5832-45f9-b8ed-04467496a470"],
Cell[1089, 35, 235, 5, 29, "Input",ExpressionUUID->"7640abcc-40a3-4b02-a665-ad3c9af5d4f1"],
Cell[CellGroupData[{
Cell[1349, 44, 97, 0, 68, "Section",ExpressionUUID->"9f12e1c2-203b-454a-a884-7860554e9154"],
Cell[1449, 46, 2221, 75, 140, "Text",ExpressionUUID->"e412d333-35f8-4d7e-9c38-00959af76376"],
Cell[3673, 123, 766, 20, 122, "Input",ExpressionUUID->"a0285dff-a04c-4fa0-9f2b-daf585a3e673"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4476, 148, 80, 0, 68, "Section",ExpressionUUID->"847df2fa-4921-4ad3-8a12-772ae439a795"],
Cell[CellGroupData[{
Cell[4581, 152, 83, 0, 54, "Subsection",ExpressionUUID->"d0695e24-7f9d-4334-8478-e96567942d55"],
Cell[4667, 154, 3487, 84, 298, "Input",ExpressionUUID->"1ec44cd5-a184-4658-be8c-4fca21fac5bf"],
Cell[8157, 240, 142, 2, 29, "Input",ExpressionUUID->"25245137-5cfc-4fd5-8f8b-3b1727393e21"],
Cell[8302, 244, 5533, 133, 473, "Input",ExpressionUUID->"165b2a5c-70b2-4a34-9de2-2bc59b9970b5"],
Cell[13838, 379, 4927, 120, 493, "Input",ExpressionUUID->"909e924c-4bab-402e-abac-e83db341f28d"],
Cell[18768, 501, 5384, 135, 493, "Input",ExpressionUUID->"b11b8c30-ec3e-4ab2-83d0-d7e26f6f4a7d"],
Cell[24155, 638, 4937, 127, 413, "Input",ExpressionUUID->"42e0356c-1f39-445c-8c6c-7e391f279571"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29129, 770, 83, 0, 54, "Subsection",ExpressionUUID->"cd6cf25d-e30d-4dae-8ee1-f32262fc6808"],
Cell[29215, 772, 2530, 66, 236, "Input",ExpressionUUID->"6f598aed-c038-4db9-bf47-b3b56562c1e8"],
Cell[CellGroupData[{
Cell[31770, 842, 90, 0, 45, "Subsubsection",ExpressionUUID->"cb7d9ce6-eb9b-4f7d-9e35-77fe1e582769"],
Cell[31863, 844, 3333, 85, 222, "Input",ExpressionUUID->"5702dbab-a126-4023-a84b-59e5a35c7564"],
Cell[35199, 931, 9782, 235, 660, "Input",ExpressionUUID->"924d8ae5-1219-456f-abd8-7e2ac6029643"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45018, 1171, 93, 0, 45, "Subsubsection",ExpressionUUID->"66338852-e001-46f5-8c9c-1b64d8c945c9"],
Cell[45114, 1173, 3333, 85, 222, "Input",ExpressionUUID->"c1158f36-932d-4e2f-947e-6f9911a933fb"],
Cell[48450, 1260, 10069, 243, 661, "Input",ExpressionUUID->"3bdea17f-a210-4f60-bebe-49420255b9df"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58556, 1508, 101, 0, 45, "Subsubsection",ExpressionUUID->"7910da06-34ae-4593-bc9e-74a69272b100"],
Cell[58660, 1510, 3333, 85, 222, "Input",ExpressionUUID->"bec4ae69-6202-4538-80b4-e2b9c215efee"],
Cell[61996, 1597, 9782, 235, 660, "Input",ExpressionUUID->"82413c55-b644-430b-99b2-f2f4526dbcc0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71815, 1837, 104, 0, 45, "Subsubsection",ExpressionUUID->"a3f84be9-399c-4419-9094-ed5eda12824f"],
Cell[71922, 1839, 3333, 85, 222, "Input",ExpressionUUID->"9d3f1bd2-ce0d-41f3-8537-b2f4ed60425e"],
Cell[75258, 1926, 10069, 243, 661, "Input",ExpressionUUID->"e333d87b-eff8-4de5-8ff4-d8827bba57ee"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85364, 2174, 271, 7, 45, "Subsubsection",ExpressionUUID->"4980b484-d4a1-42be-a914-13db437ac77d"],
Cell[85638, 2183, 3333, 85, 222, "Input",ExpressionUUID->"6b115070-2d54-49ba-b154-a649826185c9"],
Cell[88974, 2270, 11511, 280, 730, "Input",ExpressionUUID->"20f092f7-6abd-4f6b-b097-f0bc08cc06ce"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100522, 2555, 271, 7, 45, "Subsubsection",ExpressionUUID->"e3066ceb-9fb5-40aa-ba34-9cb0fd7abdac"],
Cell[100796, 2564, 3333, 85, 222, "Input",ExpressionUUID->"2eedc04d-fe4a-4f27-8290-838dbd0c8747"],
Cell[104132, 2651, 11512, 280, 730, "Input",ExpressionUUID->"159758ce-5815-4bad-bdd7-5290ee91102e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[115681, 2936, 106, 0, 45, "Subsubsection",ExpressionUUID->"51115539-fd2f-43ec-a01d-08a57471c386"],
Cell[115790, 2938, 3333, 85, 222, "Input",ExpressionUUID->"b5b93d3b-5890-4f43-8098-f48503432848"],
Cell[119126, 3025, 12231, 307, 751, "Input",ExpressionUUID->"6e384b7b-cc72-454a-95be-0b3582ad5970"]
}, Open  ]],
Cell[CellGroupData[{
Cell[131394, 3337, 95, 0, 45, "Subsubsection",ExpressionUUID->"7ec0129c-40d8-4631-bf1b-51fb8eb2c9e3"],
Cell[131492, 3339, 3333, 85, 222, "Input",ExpressionUUID->"6cd02a64-3575-4a51-8480-6b28b04b611f"],
Cell[134828, 3426, 12234, 307, 751, "Input",ExpressionUUID->"b1edadf5-5bd5-4999-8212-03f4d774ff03"]
}, Open  ]],
Cell[CellGroupData[{
Cell[147099, 3738, 249, 6, 45, "Subsubsection",ExpressionUUID->"22184aa1-da55-4c27-b9ac-23cc971f1ba8"],
Cell[147351, 3746, 3333, 85, 222, "Input",ExpressionUUID->"773c508a-4946-441c-b000-2db3a06a75b7"],
Cell[150687, 3833, 12234, 307, 751, "Input",ExpressionUUID->"e9ba3453-4dd1-4101-a9d2-b6f662465aaa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[162958, 4145, 249, 6, 45, "Subsubsection",ExpressionUUID->"27bef6b5-a9be-4af2-a6f7-a874de3627cd"],
Cell[163210, 4153, 3336, 85, 222, "Input",ExpressionUUID->"632d56b6-0f03-4ede-9a23-16788a182daf"],
Cell[166549, 4240, 12235, 307, 751, "Input",ExpressionUUID->"ee0ad69f-bc34-42c3-809f-3080483ea1ca"]
}, Open  ]],
Cell[CellGroupData[{
Cell[178821, 4552, 105, 0, 45, "Subsubsection",ExpressionUUID->"79680e0d-cc42-477e-99d9-ea286e4ea160"],
Cell[178929, 4554, 3336, 85, 222, "Input",ExpressionUUID->"ec3e9f78-fe39-4f2f-949f-684ebb66e230"],
Cell[182268, 4641, 12405, 311, 751, "Input",ExpressionUUID->"006df907-082a-4f2a-973c-77b7805c1b5f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[194710, 4957, 110, 0, 45, "Subsubsection",ExpressionUUID->"eb72f151-d54c-4276-93e7-5901f7789e9b"],
Cell[194823, 4959, 3336, 85, 222, "Input",ExpressionUUID->"00d0129a-75a6-497f-8f64-c7528fee83f6"],
Cell[198162, 5046, 12408, 311, 751, "Input",ExpressionUUID->"efa47aae-6328-4136-8119-e2686f7803c7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[210607, 5362, 270, 7, 45, "Subsubsection",ExpressionUUID->"4b1e897d-4175-4036-b7bf-6c2d5fed57ad"],
Cell[210880, 5371, 3336, 85, 222, "Input",ExpressionUUID->"b9f9386c-6db4-4c7a-9f00-fd19dc97d182"],
Cell[214219, 5458, 12403, 311, 751, "Input",ExpressionUUID->"4ec5de58-bec7-4299-9147-ed817c3cf6e0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[226659, 5774, 268, 7, 45, "Subsubsection",ExpressionUUID->"d7c47c4b-ef92-45a9-8426-baa3c50ed9c9"],
Cell[226930, 5783, 3336, 85, 222, "Input",ExpressionUUID->"a251a9af-37f6-4171-9792-0dc75763611b"],
Cell[230269, 5870, 12404, 311, 751, "Input",ExpressionUUID->"048e7a89-2bd8-4274-b8d4-2324f3372c2a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[242710, 6186, 90, 0, 45, "Subsubsection",ExpressionUUID->"1e7aaa3a-a570-4c24-b90e-64b34e4e4847"],
Cell[242803, 6188, 3336, 85, 222, "Input",ExpressionUUID->"8cceee78-63f9-48e9-a0e1-ce69f442f550"],
Cell[246142, 6275, 6491, 169, 337, "Input",ExpressionUUID->"8db6a45b-c8e9-49e7-afa5-cdc0f9e8712e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[252682, 6450, 82, 0, 54, "Subsection",ExpressionUUID->"87b5ea90-0db6-483f-8519-834bcf44ddac"],
Cell[252767, 6452, 2546, 66, 236, "Input",ExpressionUUID->"031100a5-f529-474a-ac83-268d5d7c25ba"],
Cell[255316, 6520, 1784, 49, 197, "Input",ExpressionUUID->"23e38fd0-5996-4b1e-8c87-749d77fb67b3"],
Cell[257103, 6571, 2391, 67, 197, "Input",ExpressionUUID->"87d366a1-c8ba-4815-8fc8-6bb45a27781b"],
Cell[259497, 6640, 4006, 108, 403, "Input",ExpressionUUID->"0c4a0d53-0227-4c1d-9df5-c49fe37333cd"],
Cell[263506, 6750, 3904, 104, 401, "Input",ExpressionUUID->"d0665cb6-5ec8-4cd5-9cc9-ae20044d7b18"],
Cell[CellGroupData[{
Cell[267435, 6858, 90, 0, 45, "Subsubsection",ExpressionUUID->"fe80e185-5197-42f8-b99f-9cca5f073b7d"],
Cell[267528, 6860, 895, 24, 92, "Input",ExpressionUUID->"f605ebca-de2f-4079-8328-128010bd5dda"],
Cell[268426, 6886, 34168, 782, 2886, "Input",ExpressionUUID->"5cdc9089-b8c9-4385-aa1b-7d765c270b48"]
}, Open  ]],
Cell[CellGroupData[{
Cell[302631, 7673, 93, 0, 45, "Subsubsection",ExpressionUUID->"ac9a0ef0-1ed7-4c49-894b-8d040b1265af"],
Cell[302727, 7675, 895, 24, 92, "Input",ExpressionUUID->"30e29baf-be22-4a23-9455-cfb8d5cc8176"],
Cell[303625, 7701, 34168, 782, 2886, "Input",ExpressionUUID->"24babefe-2ca7-45a8-bfe8-ab69c67cf459"]
}, Open  ]],
Cell[CellGroupData[{
Cell[337830, 8488, 102, 0, 45, "Subsubsection",ExpressionUUID->"e301e7dc-eb33-46da-86eb-8f8e6243a88e"],
Cell[337935, 8490, 895, 24, 92, "Input",ExpressionUUID->"354e6873-e1ec-483e-a49a-8830fb2ba2ec"],
Cell[338833, 8516, 35653, 820, 2955, "Input",ExpressionUUID->"1b1960bb-dfd3-42da-8f90-2cabf37dc77a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[374523, 9341, 105, 0, 45, "Subsubsection",ExpressionUUID->"f0e7d15b-2c81-4f41-868d-6745ac8e65db"],
Cell[374631, 9343, 895, 24, 92, "Input",ExpressionUUID->"0772f7b0-48e0-4b2d-8541-a07d79f2ca5d"],
Cell[375529, 9369, 35653, 820, 2955, "Input",ExpressionUUID->"516ce6ad-b483-4ff9-bf73-83ba5e152724"]
}, Open  ]],
Cell[CellGroupData[{
Cell[411219, 10194, 272, 7, 46, "Subsubsection",ExpressionUUID->"09c53460-8f0c-4f01-90b3-594ffa8138dc"],
Cell[411494, 10203, 895, 24, 92, "Input",ExpressionUUID->"d0cfef55-6cad-446f-8c55-c8501fc3af46"],
Cell[412392, 10229, 35644, 819, 2955, "Input",ExpressionUUID->"184f72e9-532f-4217-a144-e0bc44cc73c3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[448073, 11053, 272, 7, 46, "Subsubsection",ExpressionUUID->"674ebfdd-4362-4560-866b-f9fe043036cf"],
Cell[448348, 11062, 895, 24, 92, "Input",ExpressionUUID->"06c87354-63c2-4a6f-be12-e2fb0478ac00"],
Cell[449246, 11088, 35644, 819, 2955, "Input",ExpressionUUID->"f735f831-0bc3-40a4-9c52-c27695b114e1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[484927, 11912, 106, 0, 45, "Subsubsection",ExpressionUUID->"e264d83a-6c95-4ac5-9721-0f1e04acc04f"],
Cell[485036, 11914, 895, 24, 92, "Input",ExpressionUUID->"489b4e47-5b2e-482d-9fc0-69cf95a5d05f"],
Cell[485934, 11940, 33948, 776, 2865, "Input",ExpressionUUID->"a2b28cda-daca-4adb-8339-21de3d02e7dd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[519919, 12721, 95, 0, 45, "Subsubsection",ExpressionUUID->"6eb3c79b-eff6-4460-8253-47e96d5ee614"],
Cell[520017, 12723, 895, 24, 92, "Input",ExpressionUUID->"f57bb4e7-f06e-4745-bc6b-63fd2c0beb06"],
Cell[520915, 12749, 33951, 776, 2865, "Input",ExpressionUUID->"f0394d30-2067-47b3-8e35-57bbbfb8f7f1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[554903, 13530, 249, 6, 45, "Subsubsection",ExpressionUUID->"5dae1cb7-fb06-4091-b03e-968418fa9c75"],
Cell[555155, 13538, 895, 24, 92, "Input",ExpressionUUID->"f680c9c5-a9a6-49ee-bec0-059f006df748"],
Cell[556053, 13564, 33951, 776, 2865, "Input",ExpressionUUID->"5e21fdad-81e8-40e3-8834-d06a327d2dd8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[590041, 14345, 249, 6, 45, "Subsubsection",ExpressionUUID->"e115932c-e11d-4697-99f7-effb712dd1d5"],
Cell[590293, 14353, 898, 24, 92, "Input",ExpressionUUID->"e5c1bd5b-d3eb-4d82-9320-2133ba724e35"],
Cell[591194, 14379, 33952, 776, 2865, "Input",ExpressionUUID->"d467d30e-a58a-434d-bb04-91e18e536b77"]
}, Open  ]],
Cell[CellGroupData[{
Cell[625183, 15160, 105, 0, 45, "Subsubsection",ExpressionUUID->"dfddec11-3625-4a58-b93f-4eb84373b4d9"],
Cell[625291, 15162, 898, 24, 92, "Input",ExpressionUUID->"300c178f-3b9d-4f74-a0db-61470e36ae1c"],
Cell[626192, 15188, 34431, 790, 2888, "Input",ExpressionUUID->"2ce31b05-a085-4825-974b-683fa5383177"]
}, Open  ]],
Cell[CellGroupData[{
Cell[660660, 15983, 110, 0, 45, "Subsubsection",ExpressionUUID->"55c407a3-2de6-4846-a716-844f2092e669"],
Cell[660773, 15985, 902, 25, 92, "Input",ExpressionUUID->"30146ccc-1d52-43a3-a629-81703cd3ab6d"],
Cell[661678, 16012, 34434, 790, 2888, "Input",ExpressionUUID->"8081adf9-47ee-4105-aa57-d470dee3c1af"]
}, Open  ]],
Cell[CellGroupData[{
Cell[696149, 16807, 270, 7, 45, "Subsubsection",ExpressionUUID->"9c2fdc56-ccd9-4cb5-a1df-53b9c62b8b5a"],
Cell[696422, 16816, 902, 25, 92, "Input",ExpressionUUID->"3dccea1a-cf00-4f5d-9585-e23c6b62dea0"],
Cell[697327, 16843, 34429, 790, 2888, "Input",ExpressionUUID->"fa6a3b51-a8dd-401b-881f-16e6cd050147"]
}, Open  ]],
Cell[CellGroupData[{
Cell[731793, 17638, 268, 7, 45, "Subsubsection",ExpressionUUID->"be15d8da-c8fa-47d3-99fc-d3ef2d7be9bf"],
Cell[732064, 17647, 902, 25, 92, "Input",ExpressionUUID->"632eea9a-d53d-44b2-b519-6a9a118ff9c2"],
Cell[732969, 17674, 34430, 790, 2888, "Input",ExpressionUUID->"2e1d00e2-a828-4f6a-b73e-b17b22ae634c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[767448, 18470, 85, 0, 54, "Subsection",ExpressionUUID->"5fd3b1be-689f-429f-b7e4-8019920ed1c4"],
Cell[767536, 18472, 2552, 67, 236, "Input",ExpressionUUID->"893da2a7-7e5d-432e-b173-f8eaf133cea4"],
Cell[770091, 18541, 1788, 50, 197, "Input",ExpressionUUID->"cb341572-e53f-4af1-9c6e-ed9448575ba6"],
Cell[771882, 18593, 2395, 68, 197, "Input",ExpressionUUID->"45b8a89b-813c-48e5-adf5-13fd6fe5a6f5"],
Cell[774280, 18663, 4010, 109, 403, "Input",ExpressionUUID->"a7dddd1d-ebb0-4cac-80db-99d04aa3ebec"],
Cell[778293, 18774, 3908, 105, 401, "Input",ExpressionUUID->"34e89023-f7cc-411a-a5ac-1210782ac18d"],
Cell[CellGroupData[{
Cell[782226, 18883, 90, 0, 45, "Subsubsection",ExpressionUUID->"36a1f4fc-a9cc-4b45-a98e-bb5e12f6c6e3"],
Cell[782319, 18885, 4654, 115, 368, "Input",ExpressionUUID->"9f097443-e5b5-4b5e-a35b-87e5696bf097"],
Cell[786976, 19002, 18809, 437, 1681, "Input",ExpressionUUID->"1467e5f1-23c4-4fb5-b056-e0e7cdcb825d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[805822, 19444, 93, 0, 45, "Subsubsection",ExpressionUUID->"8adb1f5d-23b5-47fe-9819-00234264bcad"],
Cell[805918, 19446, 4654, 115, 368, "Input",ExpressionUUID->"fbd90576-d11a-4dd7-99ff-ee2dd90257e7"],
Cell[810575, 19563, 18809, 437, 1681, "Input",ExpressionUUID->"bdf67aff-9b63-49c3-8a4a-1fbbe0a4de5e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[829421, 20005, 102, 0, 45, "Subsubsection",ExpressionUUID->"ff204e1f-d465-4e45-9f15-b73c3c893168"],
Cell[829526, 20007, 4654, 115, 368, "Input",ExpressionUUID->"96fe0e7f-76ca-4d7d-a9ae-193e995d5e47"],
Cell[834183, 20124, 20312, 477, 1750, "Input",ExpressionUUID->"7b43c61b-d5ad-4fdd-a772-d4d0ed3a5201"]
}, Open  ]],
Cell[CellGroupData[{
Cell[854532, 20606, 105, 0, 45, "Subsubsection",ExpressionUUID->"07cb930f-0154-42c4-a84b-64000b6a5919"],
Cell[854640, 20608, 4654, 115, 368, "Input",ExpressionUUID->"f80e0095-8f0a-4fe4-90c4-7fb3081b8a1b"],
Cell[859297, 20725, 20312, 477, 1750, "Input",ExpressionUUID->"51ef39fa-77c6-4a43-9e93-38d99f692bac"]
}, Open  ]],
Cell[CellGroupData[{
Cell[879646, 21207, 272, 7, 46, "Subsubsection",ExpressionUUID->"453a29b7-4b7f-4c4e-8b5d-32e8bf4fe9a4"],
Cell[879921, 21216, 4654, 115, 368, "Input",ExpressionUUID->"0e51ec89-08a0-4054-84d8-3643b3203a1c"],
Cell[884578, 21333, 20303, 476, 1750, "Input",ExpressionUUID->"57e2e1ce-cc9a-4e6e-b9b0-5f50e329419d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[904918, 21814, 272, 7, 46, "Subsubsection",ExpressionUUID->"420d5dbe-eb47-4c9a-b990-17c8bf2c417f"],
Cell[905193, 21823, 4654, 115, 368, "Input",ExpressionUUID->"4128df59-a0ee-48c9-a3b5-58536eb92fd0"],
Cell[909850, 21940, 20303, 476, 1750, "Input",ExpressionUUID->"d183ec4e-ef5d-4e9e-89f7-1752fde91471"]
}, Open  ]],
Cell[CellGroupData[{
Cell[930190, 22421, 106, 0, 45, "Subsubsection",ExpressionUUID->"4cde35e2-2a6c-42fb-8a21-d536aaf2b1c0"],
Cell[930299, 22423, 4654, 115, 368, "Input",ExpressionUUID->"fdd05f59-c9bf-4ee7-b6e7-1ec4e8adb3e6"],
Cell[934956, 22540, 18608, 433, 1659, "Input",ExpressionUUID->"3b80149a-2520-4e15-9c72-3095b1089618"]
}, Open  ]],
Cell[CellGroupData[{
Cell[953601, 22978, 95, 0, 45, "Subsubsection",ExpressionUUID->"9c707734-a002-4b4f-a78f-4088c49d8d3c"],
Cell[953699, 22980, 4654, 115, 368, "Input",ExpressionUUID->"398aa1e0-b84f-4764-a659-9a8c5ffcdb98"],
Cell[958356, 23097, 18611, 433, 1659, "Input",ExpressionUUID->"26061cd9-12aa-490f-b1d5-6c11255c1278"]
}, Open  ]],
Cell[CellGroupData[{
Cell[977004, 23535, 249, 6, 45, "Subsubsection",ExpressionUUID->"50d02012-23a3-4fdc-b5f8-faf0710d9674"],
Cell[977256, 23543, 4654, 115, 368, "Input",ExpressionUUID->"9a7809fb-2c2d-4650-8a3f-b5bb9dfe2995"],
Cell[981913, 23660, 18611, 433, 1659, "Input",ExpressionUUID->"89c4593d-3e80-4b8f-bdd1-6fd0449d22c0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1000561, 24098, 249, 6, 45, "Subsubsection",ExpressionUUID->"7950b24b-c9da-4d79-9d2d-f2e2a50a72e5"],
Cell[1000813, 24106, 4657, 115, 368, "Input",ExpressionUUID->"8ec05565-1468-434e-90e1-fa9efc4065ed"],
Cell[1005473, 24223, 18612, 433, 1659, "Input",ExpressionUUID->"ed6fdec6-abd6-443c-b685-c3ef58ecb9e8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1024122, 24661, 105, 0, 45, "Subsubsection",ExpressionUUID->"a86d3ef8-a37c-4e87-9fe2-6ef470683dbe"],
Cell[1024230, 24663, 4657, 115, 368, "Input",ExpressionUUID->"a2eda134-4234-40dd-8cb9-53a0ce5ef4a3"],
Cell[1028890, 24780, 19086, 446, 1682, "Input",ExpressionUUID->"8c9fc8ba-ee02-422c-b2a0-8f8aeba8498d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1048013, 25231, 110, 0, 45, "Subsubsection",ExpressionUUID->"598bba33-3cb2-4a02-8adc-cf784f1912d4"],
Cell[1048126, 25233, 4657, 115, 368, "Input",ExpressionUUID->"bc12e428-10d8-4c38-902b-a485497111c1"],
Cell[1052786, 25350, 19089, 446, 1682, "Input",ExpressionUUID->"582b7cf0-4358-441b-b5d6-692a3026936e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1071912, 25801, 270, 7, 45, "Subsubsection",ExpressionUUID->"326ed33a-9bc1-4cb0-8d26-33211d9d1b4e"],
Cell[1072185, 25810, 4657, 115, 368, "Input",ExpressionUUID->"363f4125-6a83-44a8-a0a0-f96296862cfe"],
Cell[1076845, 25927, 19084, 446, 1682, "Input",ExpressionUUID->"8d0d14dd-eb5b-4a51-9386-339fbc356c35"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1095966, 26378, 272, 7, 45, "Subsubsection",ExpressionUUID->"9590f99b-e3a8-4533-9970-2523ff1517ad"],
Cell[1096241, 26387, 4657, 115, 368, "Input",ExpressionUUID->"6b460388-7429-49d5-926c-fd25afc89bd3"],
Cell[1100901, 26504, 19085, 446, 1682, "Input",ExpressionUUID->"2f5769a4-2e62-40c9-aac1-e3987605aa8f"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

