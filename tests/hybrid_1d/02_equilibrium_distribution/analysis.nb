(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    255178,       6240]
NotebookOptionsPosition[    249782,       6150]
NotebookOutlinePosition[    250180,       6166]
CellTagsIndexPosition[    250137,       6163]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"Clear", "[", "\"\<`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]}], "Input",
 CellLabel->
  "In[493]:=",ExpressionUUID->"35414358-9cce-404a-b33a-abdb7a6986c5"],

Cell[BoxData[
 RowBox[{"Get", "[", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{"\"\<../..\>\"", ",", "\"\<imports.wl\>\""}], "}"}], "]"}], 
  "]"}]], "Input",
 CellLabel->
  "In[495]:=",ExpressionUUID->"98642d0f-5832-45f9-b8ed-04467496a470"],

Cell[BoxData[
 RowBox[{"wd", "=", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{"\"\<.\>\"", ",", "\"\<data\>\""}], "}"}], "]"}]}]], "Input",
 CellLabel->
  "In[496]:=",ExpressionUUID->"7640abcc-40a3-4b02-a665-ad3c9af5d4f1"],

Cell[CellGroupData[{

Cell["Hybrid", "Section",ExpressionUUID->"847df2fa-4921-4ad3-8a12-772ae439a795"],

Cell[CellGroupData[{

Cell["Energy", "Subsection",ExpressionUUID->"d0695e24-7f9d-4334-8478-e96567942d55"],

Cell[BoxData[
 RowBox[{
  RowBox[{"energy", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"stride", "=", "6"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "step", ",", "time", ",", "dB2O2", ",", "dE2O2", ",", "mv2O2", ",", 
         "m\[Theta]2O2", ",", "\[IndentingNewLine]", 
         RowBox[{"data", "=", 
          RowBox[{
           RowBox[{"Chop", "@", 
            RowBox[{"Map", "[", 
             RowBox[{"Last", ",", 
              RowBox[{"SplitBy", "[", 
               RowBox[{
                RowBox[{"SortBy", "[", 
                 RowBox[{
                  RowBox[{"Import", "[", 
                   RowBox[{
                    RowBox[{"FileNameJoin", "[", 
                    RowBox[{"{", 
                    RowBox[{"wd", ",", "\"\<energy.csv\>\""}], "}"}], "]"}], 
                    ",", "\"\<CSV\>\"", ",", 
                    RowBox[{"\"\<HeaderLines\>\"", "\[Rule]", "1"}]}], "]"}], 
                  ",", "First"}], "]"}], ",", "First"}], "]"}]}], "]"}]}], "//",
            "Transpose"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"step", ",", "time"}], "}"}], "=", 
         RowBox[{"Take", "[", 
          RowBox[{"data", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"data", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dB2O2", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"Take", "[", 
           RowBox[{"data", ",", "3"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"data", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dE2O2", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"Take", "[", 
           RowBox[{"data", ",", "3"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"data", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"Take", "[", 
               RowBox[{"#", ",", "3"}], "]"}], "]"}], ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"Drop", "[", 
               RowBox[{"#", ",", "3"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
          RowBox[{"Partition", "[", 
           RowBox[{"data", ",", "stride"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"mv2O2", ",", "m\[Theta]2O2"}], "}"}], "=", 
         RowBox[{"data", "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<step\>\"", "\[Rule]", "step"}], ",", 
          RowBox[{"\"\<time\>\"", "\[Rule]", "time"}], ",", 
          RowBox[{"\"\<dB2O2\>\"", "->", "dB2O2"}], ",", 
          RowBox[{"\"\<dE2O2\>\"", "->", "dE2O2"}], ",", 
          RowBox[{"\"\<mv2O2\>\"", "->", "mv2O2"}], ",", 
          RowBox[{"\"\<m\[Theta]2O2\>\"", "->", "m\[Theta]2O2"}]}], "]"}]}]}],
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[497]:=",ExpressionUUID->"1ec44cd5-a184-4658-be8c-4fca21fac5bf"],

Cell[BoxData[
 RowBox[{"Dimensions", "/@", "energy"}]], "Input",
 CellLabel->
  "In[498]:=",ExpressionUUID->"25245137-5cfc-4fd5-8f8b-3b1727393e21"],

Cell[BoxData[
 RowBox[{"dynamic", "=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"energy", "=", "energy"}], ",", 
      RowBox[{"tlim", "=", 
       RowBox[{"Interval", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "Infinity"}], "}"}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"time", ",", "pos", ",", "dB2O2", ",", "dE2O2", ",", "mv2O2"}],
        "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"time", "=", 
        RowBox[{"energy", "[", "\"\<time\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"time", ",", 
          RowBox[{"$_Real", "/;", 
           RowBox[{"IntervalMemberQ", "[", 
            RowBox[{"tlim", ",", "$"}], "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "pos", "]"}], "\[LessEqual]", "1"}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<no time selected\>\"", "]"}], ";", 
            RowBox[{"Abort", "[", "]"}]}], ")"}], ",", 
          RowBox[{"pos", "//", "Extract"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"time", "=", 
        RowBox[{"pos", "[", "time", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dB2O2", "=", 
        RowBox[{
         RowBox[{"energy", "[", "\"\<dB2O2\>\"", "]"}], "//", "pos"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dE2O2", "=", 
        RowBox[{
         RowBox[{"energy", "[", "\"\<dE2O2\>\"", "]"}], "//", "pos"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mv2O2", "=", 
        RowBox[{
         RowBox[{"pos", "/@", 
          RowBox[{"energy", "[", "\"\<mv2O2\>\"", "]"}]}], "//", "Total"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{"#", ",", "\[IndentingNewLine]", 
            RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"AspectRatio", "\[Rule]", 
             RowBox[{"1", "/", "3"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Frame", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
           "]"}], "&"}], "/@", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"dB2O2", "//", "Transpose"}], ",", 
             RowBox[{"DataRange", "\[Rule]", 
              RowBox[{"time", "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", "\"\<dB^2/2\>\""}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"dE2O2", "//", "Transpose"}], ",", 
             RowBox[{"DataRange", "\[Rule]", 
              RowBox[{"time", "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", "\"\<dE^2/2\>\""}]}], "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"mv2O2", "//", "Transpose"}], ",", 
             RowBox[{"DataRange", "\[Rule]", 
              RowBox[{"time", "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", "\"\<mv^2/2\>\""}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#", ",", 
                 RowBox[{"#2", "-", 
                  RowBox[{"First", "[", "#2", "]"}]}], ",", 
                 RowBox[{"#", "+", "#2", "-", 
                  RowBox[{"First", "[", "#2", "]"}]}]}], "}"}], "&"}], "@@", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Plus", "@@@", 
                 RowBox[{"(", 
                  RowBox[{"dB2O2", "+", "dE2O2"}], ")"}]}], ",", 
                RowBox[{"Plus", "@@@", "mv2O2"}]}], "}"}]}], ",", 
             RowBox[{"DataRange", "\[Rule]", 
              RowBox[{"time", "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", "\"\<Total\>\""}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "}"}]}], "//", "Column"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellLabel->
  "In[499]:=",ExpressionUUID->"165b2a5c-70b2-4a34-9de2-2bc59b9970b5"],

Cell[BoxData[
 RowBox[{"dynamic", "=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"energy", "=", "energy"}], ",", 
      RowBox[{"tlim", "=", 
       RowBox[{"Interval", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "Infinity"}], "}"}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "time", ",", "pos", ",", "mv2O2", ",", "mU2O2", ",", "m\[Theta]2O2", 
        ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"time", "=", 
        RowBox[{"energy", "[", "\"\<time\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"time", ",", 
          RowBox[{"$_Real", "/;", 
           RowBox[{"IntervalMemberQ", "[", 
            RowBox[{"tlim", ",", "$"}], "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "pos", "]"}], "\[LessEqual]", "1"}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<no time selected\>\"", "]"}], ";", 
            RowBox[{"Abort", "[", "]"}]}], ")"}], ",", 
          RowBox[{"pos", "//", "Extract"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"time", "=", 
        RowBox[{"pos", "[", "time", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mv2O2", "=", 
        RowBox[{"pos", "/@", 
         RowBox[{"energy", "[", "\"\<mv2O2\>\"", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"m\[Theta]2O2", "=", 
        RowBox[{"pos", "/@", 
         RowBox[{"energy", "[", "\"\<m\[Theta]2O2\>\"", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mU2O2", "=", 
        RowBox[{"mv2O2", "-", "m\[Theta]2O2"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"plots", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Show", "[", 
            RowBox[{"#", ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "\[Rule]", "Small"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Frame", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
            "]"}], "&"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"ListPlot", "[", 
               RowBox[{
                RowBox[{"#", "//", "Transpose"}], ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"time", "[", 
                  RowBox[{"[", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
                RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "/@",
              "mv2O2"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"ListPlot", "[", 
               RowBox[{
                RowBox[{"#", "//", "Transpose"}], ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"time", "[", 
                  RowBox[{"[", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
                RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "/@",
              "m\[Theta]2O2"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"ListPlot", "[", 
               RowBox[{
                RowBox[{"#", "//", "Transpose"}], ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"time", "[", 
                  RowBox[{"[", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
                RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "/@",
              "mU2O2"}]}], "\[IndentingNewLine]", "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{
          RowBox[{"plots", "//", "Transpose"}], ",", 
          RowBox[{"Text", "/@", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Kinetic\>\"", ",", "\"\<Thermal\>\"", ",", "\"\<Bulk\>\""}], 
            "}"}]}]}], "]"}], "//", "Grid"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[500]:=",ExpressionUUID->"909e924c-4bab-402e-abac-e83db341f28d"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"energy", "=", "energy"}], ",", 
     RowBox[{"tlim", "=", 
      RowBox[{"Interval", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", "Infinity"}], "}"}], "]"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "time", ",", "pos", ",", "mv2O2", ",", "mU2O2", ",", "m\[Theta]2O2", 
       ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"time", "=", 
       RowBox[{"energy", "[", "\"\<time\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"Position", "[", 
        RowBox[{"time", ",", 
         RowBox[{"$_Real", "/;", 
          RowBox[{"IntervalMemberQ", "[", 
           RowBox[{"tlim", ",", "$"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "pos", "]"}], "\[LessEqual]", "1"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<no time selected\>\"", "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}], ")"}], ",", 
         RowBox[{"pos", "//", "Extract"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"time", "=", 
       RowBox[{"pos", "[", "time", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mv2O2", "=", 
       RowBox[{"pos", "/@", 
        RowBox[{"energy", "[", "\"\<mv2O2\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"m\[Theta]2O2", "=", 
       RowBox[{"pos", "/@", 
        RowBox[{"energy", "[", "\"\<m\[Theta]2O2\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mU2O2", "=", 
       RowBox[{"mv2O2", "-", "m\[Theta]2O2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{"#", ",", "\[IndentingNewLine]", 
            RowBox[{"ImageSize", "\[Rule]", "Small"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Frame", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
           "]"}], "&"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"#", "-", 
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"time", "[", 
                 RowBox[{"[", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "/@", 
            
            RowBox[{"Map", "[", 
             RowBox[{"Transpose", ",", "mv2O2"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"#", "-", 
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"time", "[", 
                 RowBox[{"[", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "/@", 
            
            RowBox[{"Map", "[", 
             RowBox[{"Transpose", ",", "m\[Theta]2O2"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"#", "-", 
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"time", "[", 
                 RowBox[{"[", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "/@", 
            
            RowBox[{"Map", "[", 
             RowBox[{"Transpose", ",", "mU2O2"}], "]"}]}]}], 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Prepend", "[", 
        RowBox[{
         RowBox[{"plots", "//", "Transpose"}], ",", 
         RowBox[{"Text", "/@", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Kinetic\>\"", ",", "\"\<Thermal\>\"", ",", "\"\<Bulk\>\""}], 
           "}"}]}]}], "]"}], "//", "Grid"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[501]:=",ExpressionUUID->"b11b8c30-ec3e-4ab2-83d0-d7e26f6f4a7d"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"energy", "=", "energy"}], ",", 
     RowBox[{"tlim", "=", 
      RowBox[{"Interval", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", "Infinity"}], "}"}], "]"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"time", ",", "pos", ",", "m\[Theta]2O2", ",", "T1", ",", "T2"}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"time", "=", 
       RowBox[{"energy", "[", "\"\<time\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"Position", "[", 
        RowBox[{"time", ",", 
         RowBox[{"$_Real", "/;", 
          RowBox[{"IntervalMemberQ", "[", 
           RowBox[{"tlim", ",", "$"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "pos", "]"}], "\[LessEqual]", "1"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<no time selected\>\"", "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}], ")"}], ",", 
         RowBox[{"pos", "//", "Extract"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"time", "=", 
       RowBox[{"pos", "[", "time", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"m\[Theta]2O2", "=", 
       RowBox[{"Map", "[", 
        RowBox[{"pos", ",", 
         RowBox[{"energy", "[", "\"\<m\[Theta]2O2\>\"", "]"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"m\[Theta]2O2", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"First", "[", "#", "]"}], ",", 
            RowBox[{".5", 
             RowBox[{"Plus", "@@", 
              RowBox[{"Rest", "[", "#", "]"}]}]}]}], "}"}], "&"}], ",", 
         "m\[Theta]2O2", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T1", "=", 
       RowBox[{
        RowBox[{"Chop", "[", 
         RowBox[{"m\[Theta]2O2", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "All", ",", "1"}], "]"}], "]"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"0", "\[Rule]", "Indeterminate"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"T2", "=", 
       RowBox[{
        RowBox[{"Chop", "[", 
         RowBox[{"m\[Theta]2O2", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"0", "\[Rule]", "Indeterminate"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{"#", ",", "\[IndentingNewLine]", 
           RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Frame", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
          "]"}], "&"}], "/@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"T1", "/", 
             RowBox[{"T1", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
            RowBox[{"DataRange", "\[Rule]", 
             RowBox[{"time", "[", 
              RowBox[{"[", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{
            "FrameLabel", "\[Rule]", 
             "\"\<\\!\\(\!\(\*SubscriptBox[\(T\), \
\(\[DoubleVerticalBar]\)]\)(t)/\!\(\*SubscriptBox[\(T\), \(\
\[DoubleVerticalBar]\)]\)(0)\\)\>\""}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"T2", "/", 
             RowBox[{"T1", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
            RowBox[{"DataRange", "\[Rule]", 
             RowBox[{"time", "[", 
              RowBox[{"[", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{
            "FrameLabel", "\[Rule]", 
             "\"\<\\!\\(\!\(\*SubscriptBox[\(T\), \
\(\[UpTee]\)]\)(t)/\!\(\*SubscriptBox[\(T\), \
\(\[DoubleVerticalBar]\)]\)(0)\\)\>\""}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
         "\[IndentingNewLine]", "}"}]}], "//", "Column"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[502]:=",ExpressionUUID->"42e0356c-1f39-445c-8c6c-7e391f279571"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Moment", "Subsection",ExpressionUUID->"cd6cf25d-e30d-4dae-8ee1-f32262fc6808"],

Cell[BoxData[
 RowBox[{
  RowBox[{"metadata", "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"files", "=", 
        RowBox[{"FileNames", "[", 
         RowBox[{"\"\<moment-*.h5\>\"", ",", "wd"}], "]"}]}], ",", "attrs", 
       ",", "steps", ",", "times", ",", "pos"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"attrs", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<HDF5\>\"", ",", "\"\<Attributes\>\"", ",", 
             "\"\</moment\>\""}], "}"}]}], "]"}], "&"}], "/@", "files"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{
        RowBox[{"Lookup", "[", "\"\<step\>\"", "]"}], "/@", "attrs"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"times", "=", 
       RowBox[{
        RowBox[{"Lookup", "[", "\"\<time\>\"", "]"}], "/@", "attrs"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"List", "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "times", "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"First", "/@", 
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"pos", ",", "times"}], "}"}], "]"}], ",", "Last"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"steps", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"times", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"times", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"files", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"files", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Association", "[", 
       RowBox[{
        RowBox[{"\"\<attr\>\"", "->", 
         RowBox[{"KeyDrop", "[", 
          RowBox[{
           RowBox[{"First", "[", "attrs", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<step\>\"", ",", "\"\<time\>\""}], "}"}]}], "]"}]}], 
        ",", 
        RowBox[{"\"\<step\>\"", "->", "steps"}], ",", 
        RowBox[{"\"\<time\>\"", "->", "times"}], ",", 
        RowBox[{"\"\<files\>\"", "->", "files"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[503]:=",ExpressionUUID->"6f598aed-c038-4db9-bf47-b3b56562c1e8"],

Cell[CellGroupData[{

Cell["Bi-Max", "Subsubsection",ExpressionUUID->"a9d4fe23-b6f9-426a-8a85-405a1da3a2c0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom1", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "1"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom1"}]}], "Input",
 CellLabel->
  "In[504]:=",ExpressionUUID->"f961c9f3-018f-4125-96fb-28e168ed7e1f"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom1"}], ",", 
     RowBox[{"n0", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"T2OT1", "=", "2"}], ",", 
     RowBox[{"V1", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Show", "[", 
        RowBox[{"#", ",", 
         RowBox[{"ImageSize", "->", "Medium"}], ",", 
         RowBox[{"GridLinesStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"Opacity", "[", "1", "]"}], ",", 
            RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
            "Dashed"}], "]"}]}]}], "]"}], "&"}], "/@", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}], 
             "]"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
             "moment", "[", "\"\<energy_density_conversion_factor\>\"", "]"}], 
             RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
          RowBox[{"GridLines", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "}"}], ",", 
             RowBox[{"{", "n0", "}"}]}], "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}], 
             "]"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
             RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
          RowBox[{"GridLines", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "}"}], ",", 
             RowBox[{"{", "V1", "}"}]}], "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}], 
             "]"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
             RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}], 
             "]"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
             RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}], 
             "]"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
             "moment", "[", "\"\<energy_density_conversion_factor\>\"", "]"}], 
             RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
          RowBox[{"GridLines", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "}"}], ",", 
             RowBox[{"n0", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\[Beta]1", "/", "2"}], "+", 
                RowBox[{"V1", "^", "2"}]}], "}"}]}]}], "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}], 
             "]"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
             "moment", "[", "\"\<energy_density_conversion_factor\>\"", "]"}], 
             RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
          RowBox[{"GridLines", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "}"}], ",", 
             RowBox[{"n0", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\[Beta]1", "/", "2"}], "T2OT1"}], "}"}]}]}], "}"}]}],
           ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}], 
             "]"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
             "moment", "[", "\"\<energy_density_conversion_factor\>\"", "]"}], 
             RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
          RowBox[{"GridLines", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "}"}], ",", 
             RowBox[{"n0", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\[Beta]1", "/", "2"}], "T2OT1"}], "}"}]}]}], "}"}]}],
           ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
       "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[506]:=",ExpressionUUID->"6e5ebecb-1a74-4d90-95a6-c00f8b7f1423"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Loss cone", "Subsubsection",ExpressionUUID->"4980b484-d4a1-42be-a914-13db437ac77d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom2", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "2"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom2"}]}], "Input",
 CellLabel->
  "In[507]:=",ExpressionUUID->"6b115070-2d54-49ba-b154-a649826185c9"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom2"}], ",", 
     RowBox[{"n0", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"V1", "=", "0"}], ",", 
     RowBox[{"\[CapitalDelta]\[Beta]", "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", ".5"}], "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[CapitalDelta]\[Beta]", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
           RowBox[{"\[CapitalDelta]\[Beta]", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Show", "[", 
        RowBox[{"#", ",", 
         RowBox[{"ImageSize", "->", "Medium"}], ",", 
         RowBox[{"GridLinesStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"Opacity", "[", "1", "]"}], ",", 
            RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
            "Dashed"}], "]"}]}]}], "]"}], "&"}], "/@", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}], 
             "]"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
             "moment", "[", "\"\<energy_density_conversion_factor\>\"", "]"}], 
             RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
          RowBox[{"GridLines", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "}"}], ",", 
             RowBox[{"{", "n0", "}"}]}], "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}], 
             "]"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
             RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
          RowBox[{"GridLines", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "}"}], ",", 
             RowBox[{"{", "V1", "}"}]}], "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}], 
             "]"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
             RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}], 
             "]"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
             RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}], 
             "]"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
             "moment", "[", "\"\<energy_density_conversion_factor\>\"", "]"}], 
             RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
          RowBox[{"GridLines", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "}"}], ",", 
             RowBox[{"n0", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\[Beta]1", "/", "2"}], "+", 
                RowBox[{"V1", "^", "2"}]}], "}"}]}]}], "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}], 
             "]"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
             "moment", "[", "\"\<energy_density_conversion_factor\>\"", "]"}], 
             RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
          RowBox[{"GridLines", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "}"}], ",", 
             RowBox[{"n0", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\[Beta]1", "/", "2"}], "T2OT1"}], "}"}]}]}], "}"}]}],
           ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}], 
             "]"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
             "moment", "[", "\"\<energy_density_conversion_factor\>\"", "]"}], 
             RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
          RowBox[{"GridLines", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "}"}], ",", 
             RowBox[{"n0", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\[Beta]1", "/", "2"}], "T2OT1"}], "}"}]}]}], "}"}]}],
           ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
       "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[509]:=",ExpressionUUID->"d9d069a8-740d-49cc-b1dd-688e9000a0e4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Partial shell", "Subsubsection",ExpressionUUID->"907e757e-d7ef-4bf4-a970-1841e2d135ec"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom3", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "3"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom3"}]}], "Input",
 CellLabel->
  "In[510]:=",ExpressionUUID->"99ce8c1b-a4b8-45c9-af47-60201ac4218c"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom3"}], ",", 
     RowBox[{"n0", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]", "=", ".25"}], ",", 
     RowBox[{"\[Zeta]", "=", "1"}], ",", 
     RowBox[{"vs", "=", "1.5"}], ",", 
     RowBox[{"V1", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Ab", ",", "B\[Zeta]", ",", "T", ",", "T1", ",", "T2"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Ab", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"b", ",", 
          RowBox[{".5", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"b", " ", 
              RowBox[{"Exp", "[", 
               RowBox[{"-", 
                RowBox[{"b", "^", "2"}]}], "]"}]}], "+", 
             RowBox[{
              SqrtBox["\[Pi]"], 
              RowBox[{"(", 
               RowBox[{".5", "+", 
                RowBox[{"b", "^", "2"}]}], ")"}], 
              RowBox[{"Erfc", "[", 
               RowBox[{"-", "b"}], "]"}]}]}], ")"}]}]}], "]"}], "[", 
        RowBox[{"vs", "/", 
         SqrtBox["\[Beta]"]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"B\[Zeta]", "=", 
       RowBox[{
        SqrtBox["\[Pi]"], 
        RowBox[{
         RowBox[{"Gamma", "[", 
          RowBox[{"1", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}], "/", 
         RowBox[{"Gamma", "[", 
          RowBox[{"1.5", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{".5", 
        RowBox[{"\[Beta]", "/", "Ab"}], " ", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"xs", ",", 
           RowBox[{
            RowBox[{"xs", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"5", "/", "2"}], "+", 
               RowBox[{"xs", "^", "2"}]}], ")"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{"xs", "^", "2"}]}], "]"}]}], "+", 
            RowBox[{
             SqrtBox["\[Pi]"], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", "/", "4"}], "+", 
               RowBox[{
                RowBox[{"xs", "^", "2"}], 
                RowBox[{"(", 
                 RowBox[{"3", "+", 
                  RowBox[{"xs", "^", "2"}]}], ")"}]}]}], ")"}], 
             RowBox[{"Erfc", "[", 
              RowBox[{"-", "xs"}], "]"}]}]}]}], "]"}], "[", 
         RowBox[{"vs", "/", 
          SqrtBox["\[Beta]"]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T1", "=", 
       RowBox[{"T", "/", 
        RowBox[{"(", 
         RowBox[{"3", "+", "\[Zeta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2", "=", 
       RowBox[{".5", "T", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "+", "\[Zeta]"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"3", "+", "\[Zeta]"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"GridLinesStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"Opacity", "[", "1", "]"}], ",", 
             RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
             "Dashed"}], "]"}]}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
               "]"}], 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "n0", "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "V1", "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
               "]"}], 
              RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"n0", 
               RowBox[{"{", 
                RowBox[{"T1", "+", 
                 RowBox[{"V1", "^", "2"}]}], "}"}]}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
               "]"}], 
              RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"n0", 
               RowBox[{"{", "T2", "}"}]}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
               "]"}], 
              RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"n0", 
               RowBox[{"{", "T2", "}"}]}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
        "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[512]:=",ExpressionUUID->"ca9f04a6-241a-4a65-b1d5-503577126a2b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cold fluid", "Subsubsection",ExpressionUUID->"1e7aaa3a-a570-4c24-b90e-64b34e4e4847"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom4", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "4"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom4"}]}], "Input",
 CellLabel->
  "In[513]:=",ExpressionUUID->"8cceee78-63f9-48e9-a0e1-ce69f442f550"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom4"}], ",", 
     RowBox[{"n0", "=", "0.01"}], ",", 
     RowBox[{"V1", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"T1", ",", "T2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"T1", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"GridLinesStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"Opacity", "[", "1", "]"}], ",", 
             RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
             "Dashed"}], "]"}]}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
               "]"}], 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "n0", "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "V1", "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
               "]"}], 
              RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"n0", 
               RowBox[{"{", 
                RowBox[{"T1", "+", 
                 RowBox[{"V1", "^", "2"}]}], "}"}]}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
               "]"}], 
              RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"n0", 
               RowBox[{"{", "T2", "}"}]}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
               "]"}], 
              RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"n0", 
               RowBox[{"{", "T2", "}"}]}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
        "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[515]:=",ExpressionUUID->"8db6a45b-c8e9-49e7-afa5-cdc0f9e8712e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["VHist", "Subsection",ExpressionUUID->"87b5ea90-0db6-483f-8519-834bcf44ddac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"metadata", "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"files", "=", 
        RowBox[{"FileNames", "[", 
         RowBox[{"\"\<vhist2d-*.h5\>\"", ",", "wd"}], "]"}]}], ",", "names", 
       ",", "attrs", ",", "steps", ",", "times", ",", "pos"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"attrs", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<HDF5\>\"", ",", "\"\<Attributes\>\"", ",", 
             "\"\</vhist2d\>\""}], "}"}]}], "]"}], "&"}], "/@", "files"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{
        RowBox[{"Lookup", "[", "\"\<step\>\"", "]"}], "/@", "attrs"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"times", "=", 
       RowBox[{
        RowBox[{"Lookup", "[", "\"\<time\>\"", "]"}], "/@", "attrs"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"List", "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "times", "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"First", "/@", 
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"pos", ",", "times"}], "}"}], "]"}], ",", "Last"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"steps", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"times", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"times", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"files", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"files", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Association", "[", 
       RowBox[{
        RowBox[{"\"\<attr\>\"", "->", 
         RowBox[{"KeyDrop", "[", 
          RowBox[{
           RowBox[{"First", "[", "attrs", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<step\>\"", ",", "\"\<time\>\""}], "}"}]}], "]"}]}], 
        ",", 
        RowBox[{"\"\<step\>\"", "->", "steps"}], ",", 
        RowBox[{"\"\<time\>\"", "->", "times"}], ",", 
        RowBox[{"\"\<files\>\"", "->", "files"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[516]:=",ExpressionUUID->"031100a5-f529-474a-ac83-268d5d7c25ba"],

Cell[CellGroupData[{

Cell["Bi-Max", "Subsubsection",ExpressionUUID->"ac9a0ef0-1ed7-4c49-894b-8d040b1265af"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist1", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"spid", "=", "1"}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist1"}]}], "Input",
 CellLabel->
  "In[517]:=",ExpressionUUID->"30e29baf-be22-4a23-9455-cfb8d5cc8176"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"T2OT1", "=", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "fhist", ",", "ghist", ",", "whist", 
       ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", "plots"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"Divide", "[", 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"x", "^", "2"}]}], "/", "\[Beta]1"}], "]"}], ",", 
                 
                 SqrtBox[
                  RowBox[{"\[Pi]", " ", "\[Beta]1"}]]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"v1", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"v1", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"Divide", "[", 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"x", "^", "2"}]}], "/", 
                   RowBox[{"(", 
                    RowBox[{"\[Beta]1", " ", "gT"}], ")"}]}], "]"}], ",", 
                 SqrtBox[
                  RowBox[{"\[Pi]", " ", "\[Beta]1", " ", "gT"}]]}], "]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"v1", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"v1", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"2", "Pi", " ", "x", " ", 
                RowBox[{"Divide", "[", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"x", "^", "2"}]}], "/", "\[Beta]1"}], "/", 
                    "T2OT1"}], "]"}], ",", 
                  RowBox[{"\[Pi]", " ", "\[Beta]1", " ", "T2OT1"}]}], "]"}]}],
                ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "0", ",", 
                 RowBox[{"v2", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"2", "Pi", " ", "x", " ", 
                RowBox[{"Divide", "[", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"x", "^", "2"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"\[Beta]1", " ", "T2OT1", " ", "gT"}], ")"}]}], 
                   "]"}], ",", 
                  RowBox[{
                  "\[Pi]", " ", "\[Beta]1", " ", "T2OT1", " ", "gT"}]}], 
                 "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "0", ",", 
                 RowBox[{"v2", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"Divide", "[", 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"x", "^", "2"}]}], "/", "\[Beta]1"}], "]"}], ",", 
                 
                 SqrtBox[
                  RowBox[{"\[Pi]", " ", "\[Beta]1"}]]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"v1", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"v1", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"Divide", "[", 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"x", "^", "2"}]}], "/", "\[Beta]1"}], "/", "gT"}],
                   "]"}], ",", 
                 SqrtBox[
                  RowBox[{"\[Pi]", " ", "\[Beta]1", " ", "gT"}]]}], "]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"v1", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"v1", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"2", "\[Pi]", " ", 
                RowBox[{"Divide", "[", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"x", "^", "2"}]}], "/", "\[Beta]1"}], "/", 
                    "T2OT1"}], "]"}], ",", 
                  RowBox[{"\[Pi]", " ", "\[Beta]1", " ", "T2OT1"}]}], "]"}]}],
                ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "0", ",", 
                 RowBox[{"v2", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"2", "\[Pi]", " ", 
                RowBox[{"Divide", "[", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"x", "^", "2"}]}], "/", "\[Beta]1"}], "/", 
                    "T2OT1"}], "/", "gT"}], "]"}], ",", 
                  RowBox[{
                  "\[Pi]", " ", "\[Beta]1", " ", "T2OT1", " ", "gT"}]}], 
                 "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "0", ",", 
                 RowBox[{"v2", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[519]:=",ExpressionUUID->"25218406-ccb4-45af-a2d5-02cb676a97b5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Loss cone", "Subsubsection",ExpressionUUID->"c67eb6bf-2612-4875-8c2b-a6b3296b9e6c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist2", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"spid", "=", "2"}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist2"}]}], "Input",
 CellLabel->
  "In[520]:=",ExpressionUUID->"f918bfad-b1b9-4a76-aebb-dbb59e0eb539"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist2"}], ",", 
     RowBox[{"\[Theta]1", "=", 
      SqrtBox["1.5"]}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1", "=", 
      SqrtBox["2.0"]}], ",", 
     RowBox[{"\[CapitalDelta]", "=", "0"}], ",", 
     RowBox[{"\[Beta]", "=", "0.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Theta]2", "=", 
        RowBox[{"\[Theta]1", " ", "\[Theta]2O\[Theta]1"}]}], ",", "gT", ",", 
       "v1", ",", "v2", ",", "fhist", ",", "ghist", ",", "whist", ",", "fpsd",
        ",", "gpsd", ",", "wpsd", ",", "plots"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"Divide", "[", 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"x", "^", "2"}]}], "/", 
                   RowBox[{"\[Theta]1", "^", "2"}]}], "]"}], ",", 
                 RowBox[{
                  SqrtBox["\[Pi]"], "\[Theta]1"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"v1", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"v1", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"Divide", "[", 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"x", "^", "2"}]}], "/", 
                    RowBox[{"\[Theta]1", "^", "2"}]}], "/", "gT"}], "]"}], 
                 ",", 
                 RowBox[{
                  SqrtBox[
                   RowBox[{"\[Pi]", " ", "gT"}]], "\[Theta]1"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"v1", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"v1", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"2", "Pi", " ", "x", " ", 
                RowBox[{"Divide", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"\[CapitalDelta]", " ", "\[Beta]"}]}], ")"}], 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"x", "^", "2"}]}], "/", 
                    RowBox[{"\[Theta]2", "^", "2"}]}], "]"}]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "\[CapitalDelta]"}], ")"}], 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"x", "^", "2"}]}], "/", 
                    RowBox[{"\[Theta]2", "^", "2"}]}], "/", "\[Beta]"}], 
                    "]"}]}]}], ",", 
                  RowBox[{"\[Pi]", " ", 
                   RowBox[{"\[Theta]2", "^", "2"}], 
                   RowBox[{"(", 
                    RowBox[{"1", "-", "\[Beta]"}], ")"}]}]}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "0", ",", 
                 RowBox[{"v2", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"2", "Pi", " ", "x", " ", 
                RowBox[{"Divide", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"\[CapitalDelta]", " ", "\[Beta]"}]}], ")"}], 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"x", "^", "2"}]}], "/", 
                    RowBox[{"\[Theta]2", "^", "2"}]}], "/", "gT"}], "]"}]}], 
                   "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "\[CapitalDelta]"}], ")"}], 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"x", "^", "2"}]}], "/", 
                    RowBox[{"\[Theta]2", "^", "2"}]}], "/", "\[Beta]"}], "/", 
                    "gT"}], "]"}]}]}], ",", 
                  RowBox[{"\[Pi]", " ", 
                   RowBox[{"\[Theta]2", "^", "2"}], "gT", 
                   RowBox[{"(", 
                    RowBox[{"1", "-", "\[Beta]"}], ")"}]}]}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "0", ",", 
                 RowBox[{"v2", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"Divide", "[", 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"x", "^", "2"}]}], "/", 
                   RowBox[{"\[Theta]1", "^", "2"}]}], "]"}], ",", 
                 RowBox[{
                  SqrtBox["\[Pi]"], "\[Theta]1"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"v1", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"v1", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"Divide", "[", 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"x", "^", "2"}]}], "/", 
                    RowBox[{"\[Theta]1", "^", "2"}]}], "/", "gT"}], "]"}], 
                 ",", 
                 RowBox[{
                  SqrtBox[
                   RowBox[{"\[Pi]", " ", "gT"}]], "\[Theta]1"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"v1", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"v1", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"2", "Pi", " ", 
                RowBox[{"Divide", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"\[CapitalDelta]", " ", "\[Beta]"}]}], ")"}], 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"x", "^", "2"}]}], "/", 
                    RowBox[{"\[Theta]2", "^", "2"}]}], "]"}]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "\[CapitalDelta]"}], ")"}], 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"x", "^", "2"}]}], "/", 
                    RowBox[{"\[Theta]2", "^", "2"}]}], "/", "\[Beta]"}], 
                    "]"}]}]}], ",", 
                  RowBox[{"\[Pi]", " ", 
                   RowBox[{"\[Theta]2", "^", "2"}], 
                   RowBox[{"(", 
                    RowBox[{"1", "-", "\[Beta]"}], ")"}]}]}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "0", ",", 
                 RowBox[{"v2", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"2", "Pi", " ", 
                RowBox[{"Divide", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"\[CapitalDelta]", " ", "\[Beta]"}]}], ")"}], 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"x", "^", "2"}]}], "/", 
                    RowBox[{"\[Theta]2", "^", "2"}]}], "/", "gT"}], "]"}]}], 
                   "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "\[CapitalDelta]"}], ")"}], 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"x", "^", "2"}]}], "/", 
                    RowBox[{"\[Theta]2", "^", "2"}]}], "/", "\[Beta]"}], "/", 
                    "gT"}], "]"}]}]}], ",", 
                  RowBox[{"\[Pi]", " ", 
                   RowBox[{"\[Theta]2", "^", "2"}], "gT", 
                   RowBox[{"(", 
                    RowBox[{"1", "-", "\[Beta]"}], ")"}]}]}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "0", ",", 
                 RowBox[{"v2", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[522]:=",ExpressionUUID->"665f40f2-60d1-4a6a-999c-73665ff22b60"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Partial shell", "Subsubsection",ExpressionUUID->"5dae1cb7-fb06-4091-b03e-968418fa9c75"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist3", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"spid", "=", "3"}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist3"}]}], "Input",
 CellLabel->
  "In[523]:=",ExpressionUUID->"f680c9c5-a9a6-49ee-bec0-059f006df748"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist3"}], ",", 
     RowBox[{"\[Theta]", "=", 
      SqrtBox["0.25"]}], ",", 
     RowBox[{"\[Zeta]", "=", "1"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "fhist", ",", "ghist", ",", "whist", 
       ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", "plots", ",", "Ab", ",", 
       "B\[Zeta]", ",", "fexact", ",", "gAb", ",", "gexact"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"b", "=", 
           RowBox[{"vs", "/", "\[Theta]"}]}], "}"}], ",", 
         RowBox[{".5", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"b", " ", 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{"b", "^", "2"}]}], "]"}]}], "+", 
            RowBox[{
             SqrtBox["\[Pi]"], 
             RowBox[{"(", 
              RowBox[{".5", "+", 
               RowBox[{"b", "^", "2"}]}], ")"}], 
             RowBox[{"Erfc", "[", 
              RowBox[{"-", "b"}], "]"}]}]}], ")"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gAb", "=", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"b", "=", 
           RowBox[{
            RowBox[{"vs", "/", "\[Theta]"}], "/", 
            SqrtBox["gT"]}]}], "}"}], ",", 
         RowBox[{".5", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"b", " ", 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{"b", "^", "2"}]}], "]"}]}], "+", 
            RowBox[{
             SqrtBox["\[Pi]"], 
             RowBox[{"(", 
              RowBox[{".5", "+", 
               RowBox[{"b", "^", "2"}]}], ")"}], 
             RowBox[{"Erfc", "[", 
              RowBox[{"-", "b"}], "]"}]}]}], ")"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"B\[Zeta]", "=", 
       RowBox[{
        SqrtBox["\[Pi]"], 
        RowBox[{
         RowBox[{"Gamma", "[", 
          RowBox[{"1", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}], "/", 
         RowBox[{"Gamma", "[", 
          RowBox[{"1.5", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fexact", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"v1", ",", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"v", "=", 
              SqrtBox[
               RowBox[{
                RowBox[{"v1", "^", "2"}], "+", 
                RowBox[{"v2", "^", "2"}]}]]}], "}"}], ",", 
            RowBox[{"Divide", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"v", "-", "vs"}], ")"}], "^", "2"}]}], "/", 
                 RowBox[{"\[Theta]", "^", "2"}]}], "]"}], 
               RowBox[{"Power", "[", 
                RowBox[{
                 RowBox[{"v2", "/", "v"}], ",", "\[Zeta]"}], "]"}]}], ",", 
              RowBox[{"2", "\[Pi]", " ", 
               RowBox[{"\[Theta]", "^", "3"}], " ", "Ab", " ", "B\[Zeta]"}]}],
              "]"}]}], "]"}], ",", 
          RowBox[{"{", "Listable", "}"}]}], "]"}], "[", "v1", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gexact", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"v1", ",", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"v", "=", 
              SqrtBox[
               RowBox[{
                RowBox[{"v1", "^", "2"}], "+", 
                RowBox[{"v2", "^", "2"}]}]]}], "}"}], ",", 
            RowBox[{"Divide", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"v", "-", "vs"}], ")"}], "^", "2"}]}], "/", 
                  RowBox[{"\[Theta]", "^", "2"}]}], "/", "gT"}], "]"}], 
               RowBox[{"Power", "[", 
                RowBox[{
                 RowBox[{"v2", "/", "v"}], ",", "\[Zeta]"}], "]"}]}], ",", 
              RowBox[{"2", "\[Pi]", " ", 
               RowBox[{"\[Theta]", "^", "3"}], " ", 
               RowBox[{"gT", "^", "1.5"}], "gAb", " ", "B\[Zeta]"}]}], 
             "]"}]}], "]"}], ",", 
          RowBox[{"{", "Listable", "}"}]}], "]"}], "[", "v1", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fexact"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gexact"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fexact", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gexact", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fexact"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gexact"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fexact", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gexact", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[525]:=",ExpressionUUID->"5e21fdad-81e8-40e3-8834-d06a327d2dd8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Particle", "Subsection",ExpressionUUID->"5fd3b1be-689f-429f-b7e4-8019920ed1c4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"metadata", "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"files", "=", 
        RowBox[{"FileNames", "[", 
         RowBox[{"\"\<particle-*.h5\>\"", ",", "wd"}], "]"}]}], ",", "names", 
       ",", "attrs", ",", "steps", ",", "times", ",", "pos"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"attrs", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<HDF5\>\"", ",", "\"\<Attributes\>\"", ",", 
             "\"\</particle\>\""}], "}"}]}], "]"}], "&"}], "/@", "files"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{
        RowBox[{"Lookup", "[", "\"\<step\>\"", "]"}], "/@", "attrs"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"times", "=", 
       RowBox[{
        RowBox[{"Lookup", "[", "\"\<time\>\"", "]"}], "/@", "attrs"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"List", "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "times", "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"First", "/@", 
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"pos", ",", "times"}], "}"}], "]"}], ",", "Last"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"steps", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"times", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"times", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"files", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"files", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Association", "[", 
       RowBox[{
        RowBox[{"\"\<attr\>\"", "->", 
         RowBox[{"KeyDrop", "[", 
          RowBox[{
           RowBox[{"First", "[", "attrs", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<step\>\"", ",", "\"\<time\>\""}], "}"}]}], "]"}]}], 
        ",", 
        RowBox[{"\"\<step\>\"", "->", "steps"}], ",", 
        RowBox[{"\"\<time\>\"", "->", "times"}], ",", 
        RowBox[{"\"\<files\>\"", "->", "files"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[526]:=",ExpressionUUID->"893da2a7-7e5d-432e-b173-f8eaf133cea4"],

Cell[CellGroupData[{

Cell["Bi-Max", "Subsubsection",ExpressionUUID->"8adb1f5d-23b5-47fe-9819-00234264bcad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl1", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       RowBox[{"spid", "=", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v1lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v2lim", "=", 
        RowBox[{"6.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv2", "=", "70"}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "vhist", ",", "q1", ",", "rhist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vhist", "=", 
         RowBox[{"calVelocityHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"v1lim", ",", "Nv1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v2lim", ",", "Nv2"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nv\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl1"}]}], "Input",
 CellLabel->
  "In[527]:=",ExpressionUUID->"fbd90576-d11a-4dd7-99ff-ee2dd90257e7"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"T2OT1", "=", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"gT", ",", "v1", ",", "v2", ",", "plots"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vhist", "[", "\"\<df\>\"", "]"}], "//", "Reverse"}],
                 ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Divide", ",", 
                  RowBox[{"Subtract", "@@@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRangePadding", "->", 
               RowBox[{"Thread", "[", 
                RowBox[{"Scaled", "[", 
                 RowBox[{".02", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"Divide", "[", 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"x", "^", "2"}]}], "/", "\[Beta]1"}], "]"}], ",", 
                 
                 SqrtBox[
                  RowBox[{"\[Pi]", " ", "\[Beta]1"}]]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"v1", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"v1", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"Divide", "[", 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"x", "^", "2"}]}], "/", "\[Beta]1"}], "/", "gT"}],
                   "]"}], ",", 
                 SqrtBox[
                  RowBox[{"\[Pi]", " ", "\[Beta]1", " ", "gT"}]]}], "]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"v1", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"v1", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"Divide", "[", 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"x", "^", "2"}]}], "/", "\[Beta]1"}], "/", 
                   "T2OT1"}], "]"}], ",", 
                 RowBox[{"\[Pi]", " ", "\[Beta]1", " ", "T2OT1"}]}], "]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "0", ",", 
                 RowBox[{"v2", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"Divide", "[", 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"x", "^", "2"}]}], "/", "\[Beta]1"}], "/", 
                    "T2OT1"}], "/", "gT"}], "]"}], ",", 
                 RowBox[{
                 "\[Pi]", " ", "\[Beta]1", " ", "T2OT1", " ", "gT"}]}], "]"}],
                ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "0", ",", 
                 RowBox[{"v2", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[529]:=",ExpressionUUID->"bdf67aff-9b63-49c3-8a4a-1fbbe0a4de5e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Loss cone", "Subsubsection",ExpressionUUID->"f8cbf2e7-d198-4763-a291-ecb6bc01d604"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl2", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       RowBox[{"spid", "=", "2"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v1lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v2lim", "=", 
        RowBox[{"6.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv2", "=", "70"}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "vhist", ",", "q1", ",", "rhist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vhist", "=", 
         RowBox[{"calVelocityHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"v1lim", ",", "Nv1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v2lim", ",", "Nv2"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nv\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl2"}]}], "Input",
 CellLabel->
  "In[530]:=",ExpressionUUID->"4a6587e1-7687-47c4-99f5-11ad7d6cf5c4"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl2"}], ",", 
     RowBox[{"\[Theta]1", "=", 
      SqrtBox["1.5"]}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1", "=", 
      SqrtBox["2.0"]}], ",", 
     RowBox[{"\[CapitalDelta]", "=", "0."}], ",", 
     RowBox[{"\[Beta]", "=", "0.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Theta]2", "=", 
        RowBox[{"\[Theta]1", " ", "\[Theta]2O\[Theta]1"}]}], ",", "gT", ",", 
       "v1", ",", "v2", ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vhist", "[", "\"\<df\>\"", "]"}], "//", "Reverse"}],
                 ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Divide", ",", 
                  RowBox[{"Subtract", "@@@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRangePadding", "->", 
               RowBox[{"Thread", "[", 
                RowBox[{"Scaled", "[", 
                 RowBox[{".02", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"Divide", "[", 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"x", "^", "2"}]}], "/", 
                   RowBox[{"\[Theta]1", "^", "2"}]}], "]"}], ",", 
                 RowBox[{
                  SqrtBox["\[Pi]"], "\[Theta]1"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"v1", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"v1", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"Divide", "[", 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"x", "^", "2"}]}], "/", 
                    RowBox[{"\[Theta]1", "^", "2"}]}], "/", "gT"}], "]"}], 
                 ",", 
                 RowBox[{
                  SqrtBox[
                   RowBox[{"\[Pi]", " ", "gT"}]], "\[Theta]1"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"v1", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"v1", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"Divide", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"\[CapitalDelta]", " ", "\[Beta]"}]}], ")"}], 
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"x", "^", "2"}]}], "/", 
                    RowBox[{"\[Theta]2", "^", "2"}]}], "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "\[CapitalDelta]"}], ")"}], 
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"x", "^", "2"}]}], "/", 
                    RowBox[{"\[Theta]2", "^", "2"}]}], "/", "\[Beta]"}], 
                    "]"}]}]}], ",", 
                 RowBox[{"\[Pi]", " ", 
                  RowBox[{"\[Theta]2", "^", "2"}], 
                  RowBox[{"(", 
                   RowBox[{"1", "-", "\[Beta]"}], ")"}]}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "0", ",", 
                 RowBox[{"v2", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Plot", "[", 
              RowBox[{
               RowBox[{"Divide", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"\[CapitalDelta]", " ", "\[Beta]"}]}], ")"}], 
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"x", "^", "2"}]}], "/", 
                    RowBox[{"\[Theta]2", "^", "2"}]}], "/", "gT"}], "]"}]}], 
                  "-", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "\[CapitalDelta]"}], ")"}], 
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"x", "^", "2"}]}], "/", 
                    RowBox[{"\[Theta]2", "^", "2"}]}], "/", "\[Beta]"}], "/", 
                    "gT"}], "]"}]}]}], ",", 
                 RowBox[{"\[Pi]", " ", 
                  RowBox[{"\[Theta]2", "^", "2"}], "gT", 
                  RowBox[{"(", 
                   RowBox[{"1", "-", "\[Beta]"}], ")"}]}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "0", ",", 
                 RowBox[{"v2", "[", 
                  RowBox[{"[", 
                   RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[532]:=",ExpressionUUID->"cefcf908-c80d-4dd7-9dd4-2745118e26d2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Partial shell", "Subsubsection",ExpressionUUID->"7950b24b-c9da-4d79-9d2d-f2e2a50a72e5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl3", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       RowBox[{"spid", "=", "3"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v1lim", "=", 
        RowBox[{"2.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v2lim", "=", 
        RowBox[{"3.0", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv2", "=", "70"}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "vhist", ",", "q1", ",", "rhist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vhist", "=", 
         RowBox[{"calVelocityHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"v1lim", ",", "Nv1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v2lim", ",", "Nv2"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nv\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl3"}]}], "Input",
 CellLabel->
  "In[533]:=",ExpressionUUID->"8ec05565-1468-434e-90e1-fa9efc4065ed"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl3"}], ",", 
     RowBox[{"\[Theta]", "=", 
      SqrtBox["0.25"]}], ",", 
     RowBox[{"\[Zeta]", "=", "1"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "plots", ",", "Ab", ",", "gAb", ",", 
       "B\[Zeta]", ",", "fexact", ",", "gexact"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"b", "=", 
           RowBox[{"vs", "/", "\[Theta]"}]}], "}"}], ",", 
         RowBox[{".5", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"b", " ", 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{"b", "^", "2"}]}], "]"}]}], "+", 
            RowBox[{
             SqrtBox["\[Pi]"], 
             RowBox[{"(", 
              RowBox[{".5", "+", 
               RowBox[{"b", "^", "2"}]}], ")"}], 
             RowBox[{"Erfc", "[", 
              RowBox[{"-", "b"}], "]"}]}]}], ")"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gAb", "=", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"b", "=", 
           RowBox[{
            RowBox[{"vs", "/", "\[Theta]"}], "/", 
            SqrtBox["gT"]}]}], "}"}], ",", 
         RowBox[{".5", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"b", " ", 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{"b", "^", "2"}]}], "]"}]}], "+", 
            RowBox[{
             SqrtBox["\[Pi]"], 
             RowBox[{"(", 
              RowBox[{".5", "+", 
               RowBox[{"b", "^", "2"}]}], ")"}], 
             RowBox[{"Erfc", "[", 
              RowBox[{"-", "b"}], "]"}]}]}], ")"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"B\[Zeta]", "=", 
       RowBox[{
        SqrtBox["\[Pi]"], 
        RowBox[{
         RowBox[{"Gamma", "[", 
          RowBox[{"1", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}], "/", 
         RowBox[{"Gamma", "[", 
          RowBox[{"1.5", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fexact", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"v1", ",", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"v", "=", 
              SqrtBox[
               RowBox[{
                RowBox[{"v1", "^", "2"}], "+", 
                RowBox[{"v2", "^", "2"}]}]]}], "}"}], ",", 
            RowBox[{"Divide", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"v", "-", "vs"}], ")"}], "^", "2"}]}], "/", 
                 RowBox[{"\[Theta]", "^", "2"}]}], "]"}], 
               RowBox[{"Power", "[", 
                RowBox[{
                 RowBox[{"v2", "/", "v"}], ",", "\[Zeta]"}], "]"}]}], ",", 
              RowBox[{"2", "\[Pi]", " ", 
               RowBox[{"\[Theta]", "^", "3"}], " ", "Ab", " ", "B\[Zeta]"}]}],
              "]"}]}], "]"}], ",", 
          RowBox[{"{", "Listable", "}"}]}], "]"}], "[", "v1", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gexact", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"v1", ",", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"v", "=", 
              SqrtBox[
               RowBox[{
                RowBox[{"v1", "^", "2"}], "+", 
                RowBox[{"v2", "^", "2"}]}]]}], "}"}], ",", 
            RowBox[{"Divide", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"v", "-", "vs"}], ")"}], "^", "2"}]}], "/", 
                  RowBox[{"\[Theta]", "^", "2"}]}], "/", "gT"}], "]"}], 
               RowBox[{"Power", "[", 
                RowBox[{
                 RowBox[{"v2", "/", "v"}], ",", "\[Zeta]"}], "]"}]}], ",", 
              RowBox[{"2", "\[Pi]", " ", 
               RowBox[{"\[Theta]", "^", "3"}], " ", 
               RowBox[{"gT", "^", "1.5"}], "gAb", " ", "B\[Zeta]"}]}], 
             "]"}]}], "]"}], ",", 
          RowBox[{"{", "Listable", "}"}]}], "]"}], "[", "v1", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vhist", "[", "\"\<df\>\"", "]"}], "//", "Reverse"}],
                 ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Divide", ",", 
                  RowBox[{"Subtract", "@@@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRangePadding", "->", 
               RowBox[{"Thread", "[", 
                RowBox[{"Scaled", "[", 
                 RowBox[{".02", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fexact"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gexact"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fexact", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gexact", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[535]:=",ExpressionUUID->"ed6fdec6-abd6-443c-b685-c3ef58ecb9e8"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1468, 1047},
WindowMargins->{{69, Automatic}, {Automatic, 97}},
FrontEndVersion->"13.0 for Mac OS X x86 (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"13c7468d-72b3-4754-a7ae-58931f6d390a"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 276, 6, 52, "Input",ExpressionUUID->"35414358-9cce-404a-b33a-abdb7a6986c5"],
Cell[837, 28, 259, 7, 30, "Input",ExpressionUUID->"98642d0f-5832-45f9-b8ed-04467496a470"],
Cell[1099, 37, 240, 6, 30, "Input",ExpressionUUID->"7640abcc-40a3-4b02-a665-ad3c9af5d4f1"],
Cell[CellGroupData[{
Cell[1364, 47, 80, 0, 67, "Section",ExpressionUUID->"847df2fa-4921-4ad3-8a12-772ae439a795"],
Cell[CellGroupData[{
Cell[1469, 51, 83, 0, 54, "Subsection",ExpressionUUID->"d0695e24-7f9d-4334-8478-e96567942d55"],
Cell[1555, 53, 3492, 85, 304, "Input",ExpressionUUID->"1ec44cd5-a184-4658-be8c-4fca21fac5bf"],
Cell[5050, 140, 147, 3, 30, "Input",ExpressionUUID->"25245137-5cfc-4fd5-8f8b-3b1727393e21"],
Cell[5200, 145, 5538, 134, 472, "Input",ExpressionUUID->"165b2a5c-70b2-4a34-9de2-2bc59b9970b5"],
Cell[10741, 281, 4932, 121, 493, "Input",ExpressionUUID->"909e924c-4bab-402e-abac-e83db341f28d"],
Cell[15676, 404, 5389, 136, 493, "Input",ExpressionUUID->"b11b8c30-ec3e-4ab2-83d0-d7e26f6f4a7d"],
Cell[21068, 542, 4941, 128, 409, "Input",ExpressionUUID->"42e0356c-1f39-445c-8c6c-7e391f279571"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26046, 675, 83, 0, 54, "Subsection",ExpressionUUID->"cd6cf25d-e30d-4dae-8ee1-f32262fc6808"],
Cell[26132, 677, 2534, 67, 241, "Input",ExpressionUUID->"6f598aed-c038-4db9-bf47-b3b56562c1e8"],
Cell[CellGroupData[{
Cell[28691, 748, 86, 0, 45, "Subsubsection",ExpressionUUID->"a9d4fe23-b6f9-426a-8a85-405a1da3a2c0"],
Cell[28780, 750, 3337, 86, 220, "Input",ExpressionUUID->"f961c9f3-018f-4125-96fb-28e168ed7e1f"],
Cell[32120, 838, 6526, 174, 283, "Input",ExpressionUUID->"6e5ebecb-1a74-4d90-95a6-c00f8b7f1423"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38683, 1017, 89, 0, 45, "Subsubsection",ExpressionUUID->"4980b484-d4a1-42be-a914-13db437ac77d"],
Cell[38775, 1019, 3337, 86, 220, "Input",ExpressionUUID->"6b115070-2d54-49ba-b154-a649826185c9"],
Cell[42115, 1107, 7117, 191, 297, "Input",ExpressionUUID->"d9d069a8-740d-49cc-b1dd-688e9000a0e4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49269, 1303, 93, 0, 45, "Subsubsection",ExpressionUUID->"907e757e-d7ef-4bf4-a970-1841e2d135ec"],
Cell[49365, 1305, 3337, 86, 220, "Input",ExpressionUUID->"99ce8c1b-a4b8-45c9-af47-60201ac4218c"],
Cell[52705, 1393, 9161, 247, 431, "Input",ExpressionUUID->"ca9f04a6-241a-4a65-b1d5-503577126a2b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61903, 1645, 90, 0, 45, "Subsubsection",ExpressionUUID->"1e7aaa3a-a570-4c24-b90e-64b34e4e4847"],
Cell[61996, 1647, 3337, 86, 220, "Input",ExpressionUUID->"8cceee78-63f9-48e9-a0e1-ce69f442f550"],
Cell[65336, 1735, 6608, 173, 325, "Input",ExpressionUUID->"8db6a45b-c8e9-49e7-afa5-cdc0f9e8712e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[71993, 1914, 82, 0, 54, "Subsection",ExpressionUUID->"87b5ea90-0db6-483f-8519-834bcf44ddac"],
Cell[72078, 1916, 2550, 67, 241, "Input",ExpressionUUID->"031100a5-f529-474a-ac83-268d5d7c25ba"],
Cell[CellGroupData[{
Cell[74653, 1987, 86, 0, 45, "Subsubsection",ExpressionUUID->"ac9a0ef0-1ed7-4c49-894b-8d040b1265af"],
Cell[74742, 1989, 899, 25, 94, "Input",ExpressionUUID->"30e29baf-be22-4a23-9455-cfb8d5cc8176"],
Cell[75644, 2016, 31492, 729, 2179, "Input",ExpressionUUID->"25218406-ccb4-45af-a2d5-02cb676a97b5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[107173, 2750, 89, 0, 45, "Subsubsection",ExpressionUUID->"c67eb6bf-2612-4875-8c2b-a6b3296b9e6c"],
Cell[107265, 2752, 899, 25, 94, "Input",ExpressionUUID->"f918bfad-b1b9-4a76-aebb-dbb59e0eb539"],
Cell[108167, 2779, 34187, 790, 2180, "Input",ExpressionUUID->"665f40f2-60d1-4a6a-999c-73665ff22b60"]
}, Open  ]],
Cell[CellGroupData[{
Cell[142391, 3574, 93, 0, 45, "Subsubsection",ExpressionUUID->"5dae1cb7-fb06-4091-b03e-968418fa9c75"],
Cell[142487, 3576, 899, 25, 94, "Input",ExpressionUUID->"f680c9c5-a9a6-49ee-bec0-059f006df748"],
Cell[143389, 3603, 35033, 819, 2652, "Input",ExpressionUUID->"5e21fdad-81e8-40e3-8834-d06a327d2dd8"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[178471, 4428, 85, 0, 54, "Subsection",ExpressionUUID->"5fd3b1be-689f-429f-b7e4-8019920ed1c4"],
Cell[178559, 4430, 2552, 67, 241, "Input",ExpressionUUID->"893da2a7-7e5d-432e-b173-f8eaf133cea4"],
Cell[CellGroupData[{
Cell[181136, 4501, 86, 0, 45, "Subsubsection",ExpressionUUID->"8adb1f5d-23b5-47fe-9819-00234264bcad"],
Cell[181225, 4503, 4373, 107, 346, "Input",ExpressionUUID->"fbd90576-d11a-4dd7-99ff-ee2dd90257e7"],
Cell[185601, 4612, 16468, 385, 1268, "Input",ExpressionUUID->"bdf67aff-9b63-49c3-8a4a-1fbbe0a4de5e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[202106, 5002, 89, 0, 45, "Subsubsection",ExpressionUUID->"f8cbf2e7-d198-4763-a291-ecb6bc01d604"],
Cell[202198, 5004, 4373, 107, 346, "Input",ExpressionUUID->"4a6587e1-7687-47c4-99f5-11ad7d6cf5c4"],
Cell[206574, 5113, 18236, 425, 1269, "Input",ExpressionUUID->"cefcf908-c80d-4dd7-9dd4-2745118e26d2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[224847, 5543, 93, 0, 45, "Subsubsection",ExpressionUUID->"7950b24b-c9da-4d79-9d2d-f2e2a50a72e5"],
Cell[224943, 5545, 4373, 107, 346, "Input",ExpressionUUID->"8ec05565-1468-434e-90e1-fa9efc4065ed"],
Cell[229319, 5654, 20423, 491, 1570, "Input",ExpressionUUID->"ed6fdec6-abd6-443c-b685-c3ef58ecb9e8"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

