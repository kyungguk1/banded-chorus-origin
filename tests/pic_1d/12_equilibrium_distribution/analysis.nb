(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[   2337700,      55405]
NotebookOptionsPosition[   2302395,      54886]
NotebookOutlinePosition[   2302794,      54902]
CellTagsIndexPosition[   2302751,      54899]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"Clear", "[", "\"\<`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]}], "Input",
 CellLabel->
  "In[745]:=",ExpressionUUID->"35414358-9cce-404a-b33a-abdb7a6986c5"],

Cell[BoxData[
 RowBox[{"Get", "[", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{"\"\<../..\>\"", ",", "\"\<imports.wl\>\""}], "}"}], "]"}], 
  "]"}]], "Input",
 CellLabel->
  "In[747]:=",ExpressionUUID->"98642d0f-5832-45f9-b8ed-04467496a470"],

Cell[BoxData[
 RowBox[{"wd", "=", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{"\"\<.\>\"", ",", "\"\<data\>\""}], "}"}], "]"}]}]], "Input",
 CellLabel->
  "In[748]:=",ExpressionUUID->"7640abcc-40a3-4b02-a665-ad3c9af5d4f1"],

Cell[CellGroupData[{

Cell["Inhomogeneous Parameter", "Section",ExpressionUUID->"9f12e1c2-203b-454a-a884-7860554e9154"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["B", "x"]},
       {
        SubscriptBox["B", "y"]},
       {
        SubscriptBox["B", "z"]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["B", "0"], "(", GridBox[{
        {
         RowBox[{"1", "+", 
          RowBox[{
           SuperscriptBox["\[Xi]", "2"], 
           SuperscriptBox["x", "2"]}]}]},
        {
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["\[Xi]", "2"]}], "x", " ", "y"}]},
        {
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["\[Xi]", "2"]}], "x", " ", "z"}]}
       }], ")"}], "=", 
     RowBox[{
      SubscriptBox["B", "0"], "(", GridBox[{
        {
         RowBox[{
          SuperscriptBox["sec", "2"], 
          RowBox[{"(", 
           RowBox[{"\[Xi]", " ", 
            SubscriptBox["\[CapitalDelta]", "1"], 
            SuperscriptBox["q", "1"]}], ")"}]}]},
        {
         RowBox[{
          RowBox[{"-", "\[Xi]"}], " ", 
          SubscriptBox["\[CapitalDelta]", "2"], 
          SuperscriptBox["q", "2"], 
          RowBox[{"sin", "(", 
           RowBox[{"\[Xi]", " ", 
            SubscriptBox["\[CapitalDelta]", "1"], 
            SuperscriptBox["q", "1"]}], ")"}]}]},
        {
         RowBox[{
          RowBox[{"-", "\[Xi]"}], " ", 
          SubscriptBox["\[CapitalDelta]", "3"], 
          SuperscriptBox["q", "3"], 
          RowBox[{"sin", "(", 
           RowBox[{"\[Xi]", " ", 
            SubscriptBox["\[CapitalDelta]", "1"], 
            SuperscriptBox["q", "1"]}], ")"}]}]}
       }], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "8f13adcc-c76f-4d27-8999-3fa68c042baf"],
 ".\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Xi]", " ", 
     SubscriptBox["\[CapitalDelta]", "1"], 
     SuperscriptBox["q", "1"]}], "=", 
    RowBox[{
     SuperscriptBox["cos", 
      RowBox[{"-", "1"}]], 
     SqrtBox[
      FractionBox["1", 
       RowBox[{
        SubscriptBox["B", "x"], "/", 
        SubscriptBox["B", "0"]}]]]}]}], TraditionalForm]],ExpressionUUID->
  "74594919-e3b9-4832-8b0d-55788a5a9d30"],
 "."
}], "Text",ExpressionUUID->"e412d333-35f8-4d7e-9c38-00959af76376"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"BOB0", "=", "2.1"}], ",", 
     RowBox[{"\[CapitalDelta]1", "=", ".5"}], ",", 
     RowBox[{"q1max", "=", "60"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[Xi]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Xi]", "=", 
      RowBox[{"Divide", "[", 
       RowBox[{
        RowBox[{"ArcCos", "[", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"1", "/", "BOB0"}], "]"}], "]"}], ",", 
        RowBox[{"\[CapitalDelta]1", " ", "q1max"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[470]:=",ExpressionUUID->"a0285dff-a04c-4fa0-9f2b-daf585a3e673"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Non-relativistic", "Section",ExpressionUUID->"847df2fa-4921-4ad3-8a12-772ae439a795"],

Cell[CellGroupData[{

Cell["Energy", "Subsection",ExpressionUUID->"d0695e24-7f9d-4334-8478-e96567942d55"],

Cell[BoxData[
 RowBox[{
  RowBox[{"energy", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"stride", "=", "6"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "step", ",", "time", ",", "dB2O2", ",", "dE2O2", ",", "mv2O2", ",", 
         "m\[Theta]2O2", ",", "\[IndentingNewLine]", 
         RowBox[{"data", "=", 
          RowBox[{
           RowBox[{"Chop", "@", 
            RowBox[{"Map", "[", 
             RowBox[{"Last", ",", 
              RowBox[{"SplitBy", "[", 
               RowBox[{
                RowBox[{"SortBy", "[", 
                 RowBox[{
                  RowBox[{"Import", "[", 
                   RowBox[{
                    RowBox[{"FileNameJoin", "[", 
                    RowBox[{"{", 
                    RowBox[{"wd", ",", "\"\<energy.csv\>\""}], "}"}], "]"}], 
                    ",", "\"\<CSV\>\"", ",", 
                    RowBox[{"\"\<HeaderLines\>\"", "\[Rule]", "1"}]}], "]"}], 
                  ",", "First"}], "]"}], ",", "First"}], "]"}]}], "]"}]}], "//",
            "Transpose"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"step", ",", "time"}], "}"}], "=", 
         RowBox[{"Take", "[", 
          RowBox[{"data", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"data", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dB2O2", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"Take", "[", 
           RowBox[{"data", ",", "3"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"data", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dE2O2", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"Take", "[", 
           RowBox[{"data", ",", "3"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"data", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"Take", "[", 
               RowBox[{"#", ",", "3"}], "]"}], "]"}], ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"Drop", "[", 
               RowBox[{"#", ",", "3"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
          RowBox[{"Partition", "[", 
           RowBox[{"data", ",", "stride"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"mv2O2", ",", "m\[Theta]2O2"}], "}"}], "=", 
         RowBox[{"data", "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<step\>\"", "\[Rule]", "step"}], ",", 
          RowBox[{"\"\<time\>\"", "\[Rule]", "time"}], ",", 
          RowBox[{"\"\<dB2O2\>\"", "->", "dB2O2"}], ",", 
          RowBox[{"\"\<dE2O2\>\"", "->", "dE2O2"}], ",", 
          RowBox[{"\"\<mv2O2\>\"", "->", "mv2O2"}], ",", 
          RowBox[{"\"\<m\[Theta]2O2\>\"", "->", "m\[Theta]2O2"}]}], "]"}]}]}],
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[584]:=",ExpressionUUID->"1ec44cd5-a184-4658-be8c-4fca21fac5bf"],

Cell[BoxData[
 RowBox[{"Dimensions", "/@", "energy"}]], "Input",
 CellLabel->
  "In[585]:=",ExpressionUUID->"25245137-5cfc-4fd5-8f8b-3b1727393e21"],

Cell[BoxData[
 RowBox[{"dynamic", "=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"energy", "=", "energy"}], ",", 
      RowBox[{"tlim", "=", 
       RowBox[{"Interval", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "Infinity"}], "}"}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"time", ",", "pos", ",", "dB2O2", ",", "dE2O2", ",", "mv2O2"}],
        "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"time", "=", 
        RowBox[{"energy", "[", "\"\<time\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"time", ",", 
          RowBox[{"$_Real", "/;", 
           RowBox[{"IntervalMemberQ", "[", 
            RowBox[{"tlim", ",", "$"}], "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "pos", "]"}], "\[LessEqual]", "1"}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<no time selected\>\"", "]"}], ";", 
            RowBox[{"Abort", "[", "]"}]}], ")"}], ",", 
          RowBox[{"pos", "//", "Extract"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"time", "=", 
        RowBox[{"pos", "[", "time", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dB2O2", "=", 
        RowBox[{
         RowBox[{"energy", "[", "\"\<dB2O2\>\"", "]"}], "//", "pos"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dE2O2", "=", 
        RowBox[{
         RowBox[{"energy", "[", "\"\<dE2O2\>\"", "]"}], "//", "pos"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mv2O2", "=", 
        RowBox[{
         RowBox[{"pos", "/@", 
          RowBox[{"energy", "[", "\"\<mv2O2\>\"", "]"}]}], "//", "Total"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{"#", ",", "\[IndentingNewLine]", 
            RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"AspectRatio", "\[Rule]", 
             RowBox[{"1", "/", "3"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Frame", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
           "]"}], "&"}], "/@", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"dB2O2", "//", "Transpose"}], ",", 
             RowBox[{"DataRange", "\[Rule]", 
              RowBox[{"time", "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", "\"\<dB^2/2\>\""}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"dE2O2", "//", "Transpose"}], ",", 
             RowBox[{"DataRange", "\[Rule]", 
              RowBox[{"time", "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", "\"\<dE^2/2\>\""}]}], "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"mv2O2", "//", "Transpose"}], ",", 
             RowBox[{"DataRange", "\[Rule]", 
              RowBox[{"time", "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", "\"\<mv^2/2\>\""}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#", ",", 
                 RowBox[{"#2", "-", 
                  RowBox[{"First", "[", "#2", "]"}]}], ",", 
                 RowBox[{"#", "+", "#2", "-", 
                  RowBox[{"First", "[", "#2", "]"}]}]}], "}"}], "&"}], "@@", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Plus", "@@@", 
                 RowBox[{"(", 
                  RowBox[{"dB2O2", "+", "dE2O2"}], ")"}]}], ",", 
                RowBox[{"Plus", "@@@", "mv2O2"}]}], "}"}]}], ",", 
             RowBox[{"DataRange", "\[Rule]", 
              RowBox[{"time", "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", "\"\<Total\>\""}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "}"}]}], "//", "Column"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellLabel->
  "In[586]:=",ExpressionUUID->"165b2a5c-70b2-4a34-9de2-2bc59b9970b5"],

Cell[BoxData[
 RowBox[{"dynamic", "=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"energy", "=", "energy"}], ",", 
      RowBox[{"tlim", "=", 
       RowBox[{"Interval", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "Infinity"}], "}"}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "time", ",", "pos", ",", "mv2O2", ",", "mU2O2", ",", "m\[Theta]2O2", 
        ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"time", "=", 
        RowBox[{"energy", "[", "\"\<time\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"time", ",", 
          RowBox[{"$_Real", "/;", 
           RowBox[{"IntervalMemberQ", "[", 
            RowBox[{"tlim", ",", "$"}], "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "pos", "]"}], "\[LessEqual]", "1"}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<no time selected\>\"", "]"}], ";", 
            RowBox[{"Abort", "[", "]"}]}], ")"}], ",", 
          RowBox[{"pos", "//", "Extract"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"time", "=", 
        RowBox[{"pos", "[", "time", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mv2O2", "=", 
        RowBox[{"pos", "/@", 
         RowBox[{"energy", "[", "\"\<mv2O2\>\"", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"m\[Theta]2O2", "=", 
        RowBox[{"pos", "/@", 
         RowBox[{"energy", "[", "\"\<m\[Theta]2O2\>\"", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mU2O2", "=", 
        RowBox[{"mv2O2", "-", "m\[Theta]2O2"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"plots", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Show", "[", 
            RowBox[{"#", ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "\[Rule]", "Small"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Frame", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
            "]"}], "&"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"ListPlot", "[", 
               RowBox[{
                RowBox[{"#", "//", "Transpose"}], ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"time", "[", 
                  RowBox[{"[", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
                RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "/@",
              "mv2O2"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"ListPlot", "[", 
               RowBox[{
                RowBox[{"#", "//", "Transpose"}], ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"time", "[", 
                  RowBox[{"[", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
                RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "/@",
              "m\[Theta]2O2"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"ListPlot", "[", 
               RowBox[{
                RowBox[{"#", "//", "Transpose"}], ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"time", "[", 
                  RowBox[{"[", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
                RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "/@",
              "mU2O2"}]}], "\[IndentingNewLine]", "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{
          RowBox[{"plots", "//", "Transpose"}], ",", 
          RowBox[{"Text", "/@", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Kinetic\>\"", ",", "\"\<Thermal\>\"", ",", "\"\<Bulk\>\""}], 
            "}"}]}]}], "]"}], "//", "Grid"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[587]:=",ExpressionUUID->"909e924c-4bab-402e-abac-e83db341f28d"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"energy", "=", "energy"}], ",", 
     RowBox[{"tlim", "=", 
      RowBox[{"Interval", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", "Infinity"}], "}"}], "]"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "time", ",", "pos", ",", "mv2O2", ",", "mU2O2", ",", "m\[Theta]2O2", 
       ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"time", "=", 
       RowBox[{"energy", "[", "\"\<time\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"Position", "[", 
        RowBox[{"time", ",", 
         RowBox[{"$_Real", "/;", 
          RowBox[{"IntervalMemberQ", "[", 
           RowBox[{"tlim", ",", "$"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "pos", "]"}], "\[LessEqual]", "1"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<no time selected\>\"", "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}], ")"}], ",", 
         RowBox[{"pos", "//", "Extract"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"time", "=", 
       RowBox[{"pos", "[", "time", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mv2O2", "=", 
       RowBox[{"pos", "/@", 
        RowBox[{"energy", "[", "\"\<mv2O2\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"m\[Theta]2O2", "=", 
       RowBox[{"pos", "/@", 
        RowBox[{"energy", "[", "\"\<m\[Theta]2O2\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mU2O2", "=", 
       RowBox[{"mv2O2", "-", "m\[Theta]2O2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{"#", ",", "\[IndentingNewLine]", 
            RowBox[{"ImageSize", "\[Rule]", "Small"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Frame", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
           "]"}], "&"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"#", "-", 
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"time", "[", 
                 RowBox[{"[", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "/@", 
            
            RowBox[{"Map", "[", 
             RowBox[{"Transpose", ",", "mv2O2"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"#", "-", 
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"time", "[", 
                 RowBox[{"[", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "/@", 
            
            RowBox[{"Map", "[", 
             RowBox[{"Transpose", ",", "m\[Theta]2O2"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"#", "-", 
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"time", "[", 
                 RowBox[{"[", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "/@", 
            
            RowBox[{"Map", "[", 
             RowBox[{"Transpose", ",", "mU2O2"}], "]"}]}]}], 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Prepend", "[", 
        RowBox[{
         RowBox[{"plots", "//", "Transpose"}], ",", 
         RowBox[{"Text", "/@", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Kinetic\>\"", ",", "\"\<Thermal\>\"", ",", "\"\<Bulk\>\""}], 
           "}"}]}]}], "]"}], "//", "Grid"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[588]:=",ExpressionUUID->"b11b8c30-ec3e-4ab2-83d0-d7e26f6f4a7d"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"energy", "=", "energy"}], ",", 
     RowBox[{"tlim", "=", 
      RowBox[{"Interval", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", "Infinity"}], "}"}], "]"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"time", ",", "pos", ",", "m\[Theta]2O2", ",", "T1", ",", "T2"}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"time", "=", 
       RowBox[{"energy", "[", "\"\<time\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"Position", "[", 
        RowBox[{"time", ",", 
         RowBox[{"$_Real", "/;", 
          RowBox[{"IntervalMemberQ", "[", 
           RowBox[{"tlim", ",", "$"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "pos", "]"}], "\[LessEqual]", "1"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<no time selected\>\"", "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}], ")"}], ",", 
         RowBox[{"pos", "//", "Extract"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"time", "=", 
       RowBox[{"pos", "[", "time", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"m\[Theta]2O2", "=", 
       RowBox[{"Map", "[", 
        RowBox[{"pos", ",", 
         RowBox[{"energy", "[", "\"\<m\[Theta]2O2\>\"", "]"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"m\[Theta]2O2", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"First", "[", "#", "]"}], ",", 
            RowBox[{".5", 
             RowBox[{"Plus", "@@", 
              RowBox[{"Rest", "[", "#", "]"}]}]}]}], "}"}], "&"}], ",", 
         "m\[Theta]2O2", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T1", "=", 
       RowBox[{
        RowBox[{"Chop", "[", 
         RowBox[{"m\[Theta]2O2", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "All", ",", "1"}], "]"}], "]"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"0", "\[Rule]", "Indeterminate"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"T2", "=", 
       RowBox[{
        RowBox[{"Chop", "[", 
         RowBox[{"m\[Theta]2O2", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"0", "\[Rule]", "Indeterminate"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{"#", ",", "\[IndentingNewLine]", 
           RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Frame", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
          "]"}], "&"}], "/@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"T1", "/", 
             RowBox[{"T1", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
            RowBox[{"DataRange", "\[Rule]", 
             RowBox[{"time", "[", 
              RowBox[{"[", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{
            "FrameLabel", "\[Rule]", 
             "\"\<\\!\\(\!\(\*SubscriptBox[\(T\), \
\(\[DoubleVerticalBar]\)]\)(t)/\!\(\*SubscriptBox[\(T\), \(\
\[DoubleVerticalBar]\)]\)(0)\\)\>\""}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"T2", "/", 
             RowBox[{"T1", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
            RowBox[{"DataRange", "\[Rule]", 
             RowBox[{"time", "[", 
              RowBox[{"[", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{
            "FrameLabel", "\[Rule]", 
             "\"\<\\!\\(\!\(\*SubscriptBox[\(T\), \
\(\[UpTee]\)]\)(t)/\!\(\*SubscriptBox[\(T\), \
\(\[DoubleVerticalBar]\)]\)(0)\\)\>\""}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
         "\[IndentingNewLine]", "}"}]}], "//", "Column"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[589]:=",ExpressionUUID->"42e0356c-1f39-445c-8c6c-7e391f279571"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Moment", "Subsection",ExpressionUUID->"cd6cf25d-e30d-4dae-8ee1-f32262fc6808"],

Cell[BoxData[
 RowBox[{
  RowBox[{"metadata", "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"files", "=", 
        RowBox[{"FileNames", "[", 
         RowBox[{"\"\<moment-*.h5\>\"", ",", "wd"}], "]"}]}], ",", "attrs", 
       ",", "steps", ",", "times", ",", "pos"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"attrs", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<HDF5\>\"", ",", "\"\<Attributes\>\"", ",", 
             "\"\</moment\>\""}], "}"}]}], "]"}], "&"}], "/@", "files"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{
        RowBox[{"Lookup", "[", "\"\<step\>\"", "]"}], "/@", "attrs"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"times", "=", 
       RowBox[{
        RowBox[{"Lookup", "[", "\"\<time\>\"", "]"}], "/@", "attrs"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"List", "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "times", "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"First", "/@", 
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"pos", ",", "times"}], "}"}], "]"}], ",", "Last"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"steps", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"times", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"times", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"files", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"files", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Association", "[", 
       RowBox[{
        RowBox[{"\"\<attr\>\"", "->", 
         RowBox[{"KeyDrop", "[", 
          RowBox[{
           RowBox[{"First", "[", "attrs", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<step\>\"", ",", "\"\<time\>\""}], "}"}]}], "]"}]}], 
        ",", 
        RowBox[{"\"\<step\>\"", "->", "steps"}], ",", 
        RowBox[{"\"\<time\>\"", "->", "times"}], ",", 
        RowBox[{"\"\<files\>\"", "->", "files"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[590]:=",ExpressionUUID->"6f598aed-c038-4db9-bf47-b3b56562c1e8"],

Cell[CellGroupData[{

Cell["Maxwellian", "Subsubsection",ExpressionUUID->"cb7d9ce6-eb9b-4f7d-9e35-77fe1e582769"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom1", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "1"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom1"}]}], "Input",
 CellLabel->
  "In[591]:=",ExpressionUUID->"5702dbab-a126-4023-a84b-59e5a35c7564"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom1"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"T2OT1eq", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", 
       "T2OT1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{
        RowBox[{"0", "q1"}], "+", "1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{"T2OT1eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n0"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2OT1", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2OT1", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[593]:=",ExpressionUUID->"924d8ae5-1219-456f-abd8-7e2ac6029643"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bi-Maxwellian", "Subsubsection",ExpressionUUID->"66338852-e001-46f5-8c9c-1b64d8c945c9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom2", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "2"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom2"}]}], "Input",
 CellLabel->
  "In[594]:=",ExpressionUUID->"c1158f36-932d-4e2f-947e-6f9911a933fb"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom2"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"T2OT1eq", "=", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", 
       "T2OT1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{"T2OT1eq", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "T2OT1eq"}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{"T2OT1eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n0"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2OT1", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2OT1", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[596]:=",ExpressionUUID->"3bdea17f-a210-4f60-bebe-49420255b9df"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Losscone - Maxwellian", "Subsubsection",ExpressionUUID->"7910da06-34ae-4593-bc9e-74a69272b100"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom3", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "3"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom3"}]}], "Input",
 CellLabel->
  "In[597]:=",ExpressionUUID->"bec4ae69-6202-4538-80b4-e2b9c215efee"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom3"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"T2OT1eq", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", 
       "T2OT1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{
        RowBox[{"0", "q1"}], "+", "1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{"T2OT1eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n0"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2OT1", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2OT1", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[599]:=",ExpressionUUID->"82413c55-b644-430b-99b2-f2f4526dbcc0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Losscone - Bi-Maxwellian", "Subsubsection",ExpressionUUID->"a3f84be9-399c-4419-9094-ed5eda12824f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom4", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "4"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom4"}]}], "Input",
 CellLabel->
  "In[600]:=",ExpressionUUID->"9d3f1bd2-ce0d-41f3-8537-b2f4ed60425e"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom4"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"T2OT1eq", "=", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", 
       "T2OT1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{"T2OT1eq", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "T2OT1eq"}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{"T2OT1eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n0"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2OT1", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2OT1", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[602]:=",ExpressionUUID->"e333d87b-eff8-4de5-8ff4-d8827bba57ee"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Loss cone - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Beta]", "0"], "=", "0.5"}], TraditionalForm]],
  ExpressionUUID->"ccdb0590-1bd4-4ec8-ba41-3d161d358b69"]
}], "Subsubsection",ExpressionUUID->"4980b484-d4a1-42be-a914-13db437ac77d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom5", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "5"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom5"}]}], "Input",
 CellLabel->
  "In[603]:=",ExpressionUUID->"6b115070-2d54-49ba-b154-a649826185c9"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom5"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", ".5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "\[Eta]\[Beta]",
        ",", "n0", ",", "\[Beta]", ",", "\[Theta]2O\[Theta]1", ",", "T2OT1"}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n0"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2OT1", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2OT1", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[605]:=",ExpressionUUID->"20f092f7-6abd-4f6b-b097-f0bc08cc06ce"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Loss cone - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Beta]", "0"], "=", "2.5"}], TraditionalForm]],
  ExpressionUUID->"621772c3-7022-4912-8ba2-52b5d131ac20"]
}], "Subsubsection",ExpressionUUID->"e3066ceb-9fb5-40aa-ba34-9cb0fd7abdac"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom6", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "6"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom6"}]}], "Input",
 CellLabel->
  "In[606]:=",ExpressionUUID->"2eedc04d-fe4a-4f27-8290-838dbd0c8747"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom6"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "2.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "\[Eta]\[Beta]",
        ",", "n0", ",", "\[Beta]", ",", "\[Theta]2O\[Theta]1", ",", "T2OT1"}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n0"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2OT1", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2OT1", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[608]:=",ExpressionUUID->"159758ce-5815-4bad-bdd7-5290ee91102e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Partial shell - Maxwellian", "Subsubsection",ExpressionUUID->"51115539-fd2f-43ec-a01d-08a57471c386"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom7", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "7"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom7"}]}], "Input",
 CellLabel->
  "In[609]:=",ExpressionUUID->"b5b93d3b-5890-4f43-8098-f48503432848"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom7"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]", "=", "1.5"}], ",", 
     RowBox[{"\[Zeta]", "=", "0"}], ",", 
     RowBox[{"vs", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", "Ab",
        ",", "B\[Zeta]", ",", "T", ",", "T1", ",", "T2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"b", ",", 
          RowBox[{".5", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"b", " ", 
              RowBox[{"Exp", "[", 
               RowBox[{"-", 
                RowBox[{"b", "^", "2"}]}], "]"}]}], "+", 
             RowBox[{
              SqrtBox["\[Pi]"], 
              RowBox[{"(", 
               RowBox[{".5", "+", 
                RowBox[{"b", "^", "2"}]}], ")"}], 
              RowBox[{"Erfc", "[", 
               RowBox[{"-", "b"}], "]"}]}]}], ")"}]}]}], "]"}], "[", 
        RowBox[{"vs", "/", 
         SqrtBox["\[Beta]"]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"B\[Zeta]", "=", 
       RowBox[{
        SqrtBox["\[Pi]"], 
        RowBox[{
         RowBox[{"Gamma", "[", 
          RowBox[{"1", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}], "/", 
         RowBox[{"Gamma", "[", 
          RowBox[{"1.5", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{".5", 
        RowBox[{"\[Beta]", "/", "Ab"}], " ", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"xs", ",", 
           RowBox[{
            RowBox[{"xs", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"5", "/", "2"}], "+", 
               RowBox[{"xs", "^", "2"}]}], ")"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{"xs", "^", "2"}]}], "]"}]}], "+", 
            RowBox[{
             SqrtBox["\[Pi]"], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", "/", "4"}], "+", 
               RowBox[{
                RowBox[{"xs", "^", "2"}], 
                RowBox[{"(", 
                 RowBox[{"3", "+", 
                  RowBox[{"xs", "^", "2"}]}], ")"}]}]}], ")"}], 
             RowBox[{"Erfc", "[", 
              RowBox[{"-", "xs"}], "]"}]}]}]}], "]"}], "[", 
         RowBox[{"vs", "/", 
          SqrtBox["\[Beta]"]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T1", "=", 
       RowBox[{"T", "/", 
        RowBox[{"(", 
         RowBox[{"3", "+", "\[Zeta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2", "=", 
       RowBox[{".5", "T", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "+", "\[Zeta]"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"3", "+", "\[Zeta]"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n0"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T1"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[611]:=",ExpressionUUID->"6e384b7b-cc72-454a-95be-0b3582ad5970"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Isotropic shell", "Subsubsection",ExpressionUUID->"7ec0129c-40d8-4631-bf1b-51fb8eb2c9e3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom8", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "8"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom8"}]}], "Input",
 CellLabel->
  "In[612]:=",ExpressionUUID->"6cd02a64-3575-4a51-8480-6b28b04b611f"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom8"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "0"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", "Ab",
        ",", "B\[Zeta]", ",", "T", ",", "T1", ",", "T2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"b", ",", 
          RowBox[{".5", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"b", " ", 
              RowBox[{"Exp", "[", 
               RowBox[{"-", 
                RowBox[{"b", "^", "2"}]}], "]"}]}], "+", 
             RowBox[{
              SqrtBox["\[Pi]"], 
              RowBox[{"(", 
               RowBox[{".5", "+", 
                RowBox[{"b", "^", "2"}]}], ")"}], 
              RowBox[{"Erfc", "[", 
               RowBox[{"-", "b"}], "]"}]}]}], ")"}]}]}], "]"}], "[", 
        RowBox[{"vs", "/", 
         SqrtBox["\[Beta]"]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"B\[Zeta]", "=", 
       RowBox[{
        SqrtBox["\[Pi]"], 
        RowBox[{
         RowBox[{"Gamma", "[", 
          RowBox[{"1", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}], "/", 
         RowBox[{"Gamma", "[", 
          RowBox[{"1.5", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{".5", 
        RowBox[{"\[Beta]", "/", "Ab"}], " ", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"xs", ",", 
           RowBox[{
            RowBox[{"xs", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"5", "/", "2"}], "+", 
               RowBox[{"xs", "^", "2"}]}], ")"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{"xs", "^", "2"}]}], "]"}]}], "+", 
            RowBox[{
             SqrtBox["\[Pi]"], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", "/", "4"}], "+", 
               RowBox[{
                RowBox[{"xs", "^", "2"}], 
                RowBox[{"(", 
                 RowBox[{"3", "+", 
                  RowBox[{"xs", "^", "2"}]}], ")"}]}]}], ")"}], 
             RowBox[{"Erfc", "[", 
              RowBox[{"-", "xs"}], "]"}]}]}]}], "]"}], "[", 
         RowBox[{"vs", "/", 
          SqrtBox["\[Beta]"]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T1", "=", 
       RowBox[{"T", "/", 
        RowBox[{"(", 
         RowBox[{"3", "+", "\[Zeta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2", "=", 
       RowBox[{".5", "T", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "+", "\[Zeta]"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"3", "+", "\[Zeta]"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n0"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T1"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[614]:=",ExpressionUUID->"b1edadf5-5bd5-4999-8212-03f4d774ff03"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Partial shell - ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Zeta]", "=", "1"}], TraditionalForm]],ExpressionUUID->
  "dd9f1676-40dd-4042-8cbe-8692107020b5"]
}], "Subsubsection",ExpressionUUID->"22184aa1-da55-4c27-b9ac-23cc971f1ba8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom9", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "9"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom9"}]}], "Input",
 CellLabel->
  "In[615]:=",ExpressionUUID->"773c508a-4946-441c-b000-2db3a06a75b7"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom9"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "1"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", "Ab",
        ",", "B\[Zeta]", ",", "T", ",", "T1", ",", "T2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"b", ",", 
          RowBox[{".5", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"b", " ", 
              RowBox[{"Exp", "[", 
               RowBox[{"-", 
                RowBox[{"b", "^", "2"}]}], "]"}]}], "+", 
             RowBox[{
              SqrtBox["\[Pi]"], 
              RowBox[{"(", 
               RowBox[{".5", "+", 
                RowBox[{"b", "^", "2"}]}], ")"}], 
              RowBox[{"Erfc", "[", 
               RowBox[{"-", "b"}], "]"}]}]}], ")"}]}]}], "]"}], "[", 
        RowBox[{"vs", "/", 
         SqrtBox["\[Beta]"]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"B\[Zeta]", "=", 
       RowBox[{
        SqrtBox["\[Pi]"], 
        RowBox[{
         RowBox[{"Gamma", "[", 
          RowBox[{"1", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}], "/", 
         RowBox[{"Gamma", "[", 
          RowBox[{"1.5", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{".5", 
        RowBox[{"\[Beta]", "/", "Ab"}], " ", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"xs", ",", 
           RowBox[{
            RowBox[{"xs", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"5", "/", "2"}], "+", 
               RowBox[{"xs", "^", "2"}]}], ")"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{"xs", "^", "2"}]}], "]"}]}], "+", 
            RowBox[{
             SqrtBox["\[Pi]"], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", "/", "4"}], "+", 
               RowBox[{
                RowBox[{"xs", "^", "2"}], 
                RowBox[{"(", 
                 RowBox[{"3", "+", 
                  RowBox[{"xs", "^", "2"}]}], ")"}]}]}], ")"}], 
             RowBox[{"Erfc", "[", 
              RowBox[{"-", "xs"}], "]"}]}]}]}], "]"}], "[", 
         RowBox[{"vs", "/", 
          SqrtBox["\[Beta]"]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T1", "=", 
       RowBox[{"T", "/", 
        RowBox[{"(", 
         RowBox[{"3", "+", "\[Zeta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2", "=", 
       RowBox[{".5", "T", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "+", "\[Zeta]"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"3", "+", "\[Zeta]"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n0"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T1"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[617]:=",ExpressionUUID->"e9ba3453-4dd1-4101-a9d2-b6f662465aaa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Partial shell - ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Zeta]", "=", "5"}], TraditionalForm]],ExpressionUUID->
  "80229383-8135-4a13-ae82-136c4f08f48b"]
}], "Subsubsection",ExpressionUUID->"27bef6b5-a9be-4af2-a6f7-a874de3627cd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom10", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "10"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom10"}]}], "Input",
 CellLabel->
  "In[618]:=",ExpressionUUID->"632d56b6-0f03-4ede-9a23-16788a182daf"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom10"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "5"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", "Ab",
        ",", "B\[Zeta]", ",", "T", ",", "T1", ",", "T2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"b", ",", 
          RowBox[{".5", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"b", " ", 
              RowBox[{"Exp", "[", 
               RowBox[{"-", 
                RowBox[{"b", "^", "2"}]}], "]"}]}], "+", 
             RowBox[{
              SqrtBox["\[Pi]"], 
              RowBox[{"(", 
               RowBox[{".5", "+", 
                RowBox[{"b", "^", "2"}]}], ")"}], 
              RowBox[{"Erfc", "[", 
               RowBox[{"-", "b"}], "]"}]}]}], ")"}]}]}], "]"}], "[", 
        RowBox[{"vs", "/", 
         SqrtBox["\[Beta]"]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"B\[Zeta]", "=", 
       RowBox[{
        SqrtBox["\[Pi]"], 
        RowBox[{
         RowBox[{"Gamma", "[", 
          RowBox[{"1", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}], "/", 
         RowBox[{"Gamma", "[", 
          RowBox[{"1.5", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{".5", 
        RowBox[{"\[Beta]", "/", "Ab"}], " ", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"xs", ",", 
           RowBox[{
            RowBox[{"xs", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"5", "/", "2"}], "+", 
               RowBox[{"xs", "^", "2"}]}], ")"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{"xs", "^", "2"}]}], "]"}]}], "+", 
            RowBox[{
             SqrtBox["\[Pi]"], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", "/", "4"}], "+", 
               RowBox[{
                RowBox[{"xs", "^", "2"}], 
                RowBox[{"(", 
                 RowBox[{"3", "+", 
                  RowBox[{"xs", "^", "2"}]}], ")"}]}]}], ")"}], 
             RowBox[{"Erfc", "[", 
              RowBox[{"-", "xs"}], "]"}]}]}]}], "]"}], "[", 
         RowBox[{"vs", "/", 
          SqrtBox["\[Beta]"]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T1", "=", 
       RowBox[{"T", "/", 
        RowBox[{"(", 
         RowBox[{"3", "+", "\[Zeta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2", "=", 
       RowBox[{".5", "T", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "+", "\[Zeta]"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"3", "+", "\[Zeta]"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n0"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T1"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[620]:=",ExpressionUUID->"ee0ad69f-bc34-42c3-809f-3080483ea1ca"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Counter beam - Maxwellian", "Subsubsection",ExpressionUUID->"4b6ddeb1-71dc-4805-87f7-aa2cf3e33c88"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom11", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "11"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom11"}]}], "Input",
 CellLabel->
  "In[621]:=",ExpressionUUID->"989f0d09-f8ea-448f-a52e-99f74b59faf5"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom11"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]", "=", "1.5"}], ",", 
     RowBox[{"\[Nu]0", "=", "100000"}], ",", 
     RowBox[{"vs", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", "Ab",
        ",", "T", ",", "\[Nu]", ",", "T1", ",", "T2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"DawsonF", "[", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "/", 
           "\[Nu]0"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]0"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"b", ",", 
          RowBox[{".5", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"b", " ", 
              RowBox[{"Exp", "[", 
               RowBox[{"-", 
                RowBox[{"b", "^", "2"}]}], "]"}]}], "+", 
             RowBox[{
              SqrtBox["\[Pi]"], 
              RowBox[{"(", 
               RowBox[{".5", "+", 
                RowBox[{"b", "^", "2"}]}], ")"}], 
              RowBox[{"Erfc", "[", 
               RowBox[{"-", "b"}], "]"}]}]}], ")"}]}]}], "]"}], "[", 
        RowBox[{"vs", "/", 
         SqrtBox["\[Beta]"]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{".5", 
        RowBox[{"\[Beta]", "/", "Ab"}], " ", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"xs", ",", 
           RowBox[{
            RowBox[{"xs", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"5", "/", "2"}], "+", 
               RowBox[{"xs", "^", "2"}]}], ")"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{"xs", "^", "2"}]}], "]"}]}], "+", 
            RowBox[{
             SqrtBox["\[Pi]"], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", "/", "4"}], "+", 
               RowBox[{
                RowBox[{"xs", "^", "2"}], 
                RowBox[{"(", 
                 RowBox[{"3", "+", 
                  RowBox[{"xs", "^", "2"}]}], ")"}]}]}], ")"}], 
             RowBox[{"Erfc", "[", 
              RowBox[{"-", "xs"}], "]"}]}]}]}], "]"}], "[", 
         RowBox[{"vs", "/", 
          SqrtBox["\[Beta]"]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{
        RowBox[{"Sec", "[", 
         RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "\[Nu]0"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"T1", "=", 
       RowBox[{"T", 
        RowBox[{"(", 
         RowBox[{"\[Nu]", "/", "2"}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"DawsonF", "[", 
            RowBox[{"1", "/", "\[Nu]"}], "]"}]}], "-", "\[Nu]"}], ")"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"T2", "=", 
       RowBox[{".5", 
        RowBox[{"(", 
         RowBox[{"T", "-", "T1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n0"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T1"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[626]:=",ExpressionUUID->"69f9e8c0-303a-4de9-a322-42d966c42544"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Counter beam - isotropic shell", "Subsubsection",ExpressionUUID->"11ef4dfa-6fd5-458a-ae5d-bd394c6824ed"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom12", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "12"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom12"}]}], "Input",
 CellLabel->
  "In[627]:=",ExpressionUUID->"02c86870-3109-44f6-8d4e-384dc117b535"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom12"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Nu]0", "=", "100000"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", "Ab",
        ",", "T", ",", "\[Nu]", ",", "T1", ",", "T2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"DawsonF", "[", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "/", 
           "\[Nu]0"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]0"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"b", ",", 
          RowBox[{".5", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"b", " ", 
              RowBox[{"Exp", "[", 
               RowBox[{"-", 
                RowBox[{"b", "^", "2"}]}], "]"}]}], "+", 
             RowBox[{
              SqrtBox["\[Pi]"], 
              RowBox[{"(", 
               RowBox[{".5", "+", 
                RowBox[{"b", "^", "2"}]}], ")"}], 
              RowBox[{"Erfc", "[", 
               RowBox[{"-", "b"}], "]"}]}]}], ")"}]}]}], "]"}], "[", 
        RowBox[{"vs", "/", 
         SqrtBox["\[Beta]"]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{".5", 
        RowBox[{"\[Beta]", "/", "Ab"}], " ", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"xs", ",", 
           RowBox[{
            RowBox[{"xs", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"5", "/", "2"}], "+", 
               RowBox[{"xs", "^", "2"}]}], ")"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{"xs", "^", "2"}]}], "]"}]}], "+", 
            RowBox[{
             SqrtBox["\[Pi]"], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", "/", "4"}], "+", 
               RowBox[{
                RowBox[{"xs", "^", "2"}], 
                RowBox[{"(", 
                 RowBox[{"3", "+", 
                  RowBox[{"xs", "^", "2"}]}], ")"}]}]}], ")"}], 
             RowBox[{"Erfc", "[", 
              RowBox[{"-", "xs"}], "]"}]}]}]}], "]"}], "[", 
         RowBox[{"vs", "/", 
          SqrtBox["\[Beta]"]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{
        RowBox[{"Sec", "[", 
         RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "\[Nu]0"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"T1", "=", 
       RowBox[{"T", 
        RowBox[{"(", 
         RowBox[{"\[Nu]", "/", "2"}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"DawsonF", "[", 
            RowBox[{"1", "/", "\[Nu]"}], "]"}]}], "-", "\[Nu]"}], ")"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"T2", "=", 
       RowBox[{".5", 
        RowBox[{"(", 
         RowBox[{"T", "-", "T1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n0"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T1"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[629]:=",ExpressionUUID->"ab41ef5a-c557-4806-a7b7-d69630b2567c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Counter beam - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Nu]", "0"], "=", "1"}], TraditionalForm]],ExpressionUUID->
  "033e5b8a-c1d6-43ec-84c3-a86b93466849"]
}], "Subsubsection",ExpressionUUID->"a31a5214-7f7b-4ce5-99b4-b89ffccf4aff"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom13", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "13"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom13"}]}], "Input",
 CellLabel->
  "In[630]:=",ExpressionUUID->"fafd59f3-ab9d-4cf3-a449-afc25397f122"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom13"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Nu]0", "=", "1"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", "Ab",
        ",", "T", ",", "\[Nu]", ",", "T1", ",", "T2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"DawsonF", "[", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "/", 
           "\[Nu]0"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]0"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"b", ",", 
          RowBox[{".5", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"b", " ", 
              RowBox[{"Exp", "[", 
               RowBox[{"-", 
                RowBox[{"b", "^", "2"}]}], "]"}]}], "+", 
             RowBox[{
              SqrtBox["\[Pi]"], 
              RowBox[{"(", 
               RowBox[{".5", "+", 
                RowBox[{"b", "^", "2"}]}], ")"}], 
              RowBox[{"Erfc", "[", 
               RowBox[{"-", "b"}], "]"}]}]}], ")"}]}]}], "]"}], "[", 
        RowBox[{"vs", "/", 
         SqrtBox["\[Beta]"]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{".5", 
        RowBox[{"\[Beta]", "/", "Ab"}], " ", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"xs", ",", 
           RowBox[{
            RowBox[{"xs", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"5", "/", "2"}], "+", 
               RowBox[{"xs", "^", "2"}]}], ")"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{"xs", "^", "2"}]}], "]"}]}], "+", 
            RowBox[{
             SqrtBox["\[Pi]"], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", "/", "4"}], "+", 
               RowBox[{
                RowBox[{"xs", "^", "2"}], 
                RowBox[{"(", 
                 RowBox[{"3", "+", 
                  RowBox[{"xs", "^", "2"}]}], ")"}]}]}], ")"}], 
             RowBox[{"Erfc", "[", 
              RowBox[{"-", "xs"}], "]"}]}]}]}], "]"}], "[", 
         RowBox[{"vs", "/", 
          SqrtBox["\[Beta]"]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{
        RowBox[{"Sec", "[", 
         RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "\[Nu]0"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"T1", "=", 
       RowBox[{"T", 
        RowBox[{"(", 
         RowBox[{"\[Nu]", "/", "2"}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"DawsonF", "[", 
            RowBox[{"1", "/", "\[Nu]"}], "]"}]}], "-", "\[Nu]"}], ")"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"T2", "=", 
       RowBox[{".5", 
        RowBox[{"(", 
         RowBox[{"T", "-", "T1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n0"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T1"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[632]:=",ExpressionUUID->"60fc5a44-c59a-49b7-8c47-09f58a3be01c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Counter beam - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["v", "0"], "=", "0.1"}], TraditionalForm]],ExpressionUUID->
  "b1fc2a99-fe5c-4d33-abec-7000b3d6895d"]
}], "Subsubsection",ExpressionUUID->"59cda4ac-6ee8-49bc-922e-64c2e773968e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom14", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "14"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom14"}]}], "Input",
 CellLabel->
  "In[633]:=",ExpressionUUID->"dbb84057-814d-4668-81da-6ff40f7e23b6"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom14"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Nu]0", "=", ".1"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", "Ab",
        ",", "T", ",", "\[Nu]", ",", "T1", ",", "T2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"DawsonF", "[", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "/", 
           "\[Nu]0"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]0"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"b", ",", 
          RowBox[{".5", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"b", " ", 
              RowBox[{"Exp", "[", 
               RowBox[{"-", 
                RowBox[{"b", "^", "2"}]}], "]"}]}], "+", 
             RowBox[{
              SqrtBox["\[Pi]"], 
              RowBox[{"(", 
               RowBox[{".5", "+", 
                RowBox[{"b", "^", "2"}]}], ")"}], 
              RowBox[{"Erfc", "[", 
               RowBox[{"-", "b"}], "]"}]}]}], ")"}]}]}], "]"}], "[", 
        RowBox[{"vs", "/", 
         SqrtBox["\[Beta]"]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{".5", 
        RowBox[{"\[Beta]", "/", "Ab"}], " ", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"xs", ",", 
           RowBox[{
            RowBox[{"xs", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"5", "/", "2"}], "+", 
               RowBox[{"xs", "^", "2"}]}], ")"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{"xs", "^", "2"}]}], "]"}]}], "+", 
            RowBox[{
             SqrtBox["\[Pi]"], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", "/", "4"}], "+", 
               RowBox[{
                RowBox[{"xs", "^", "2"}], 
                RowBox[{"(", 
                 RowBox[{"3", "+", 
                  RowBox[{"xs", "^", "2"}]}], ")"}]}]}], ")"}], 
             RowBox[{"Erfc", "[", 
              RowBox[{"-", "xs"}], "]"}]}]}]}], "]"}], "[", 
         RowBox[{"vs", "/", 
          SqrtBox["\[Beta]"]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{
        RowBox[{"Sec", "[", 
         RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "\[Nu]0"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"T1", "=", 
       RowBox[{"T", 
        RowBox[{"(", 
         RowBox[{"\[Nu]", "/", "2"}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"DawsonF", "[", 
            RowBox[{"1", "/", "\[Nu]"}], "]"}]}], "-", "\[Nu]"}], ")"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"T2", "=", 
       RowBox[{".5", 
        RowBox[{"(", 
         RowBox[{"T", "-", "T1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n0"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T1"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[635]:=",ExpressionUUID->"e31ac146-0052-42ad-8d17-258db71cdef5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cold fluid", "Subsubsection",ExpressionUUID->"1e7aaa3a-a570-4c24-b90e-64b34e4e4847"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom15", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "15"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom15"}]}], "Input",
 CellLabel->
  "In[636]:=",ExpressionUUID->"8cceee78-63f9-48e9-a0e1-ce69f442f550"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom15"}], ",", 
     RowBox[{"n0", "=", "0.01"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"T1", ",", "T2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"T1", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"GridLinesStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"Opacity", "[", "1", "]"}], ",", 
             RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
             "Dashed"}], "]"}]}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
               "]"}], 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "n0", "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
               "]"}], 
              RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"n0", 
               RowBox[{"{", "T1", "}"}]}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
               "]"}], 
              RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"n0", 
               RowBox[{"{", "T2", "}"}]}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
               "]"}], 
              RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"n0", 
               RowBox[{"{", "T2", "}"}]}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
        "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[638]:=",ExpressionUUID->"8db6a45b-c8e9-49e7-afa5-cdc0f9e8712e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["VHist", "Subsection",ExpressionUUID->"87b5ea90-0db6-483f-8519-834bcf44ddac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"metadata", "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"files", "=", 
        RowBox[{"FileNames", "[", 
         RowBox[{"\"\<vhist2d-*.h5\>\"", ",", "wd"}], "]"}]}], ",", "names", 
       ",", "attrs", ",", "steps", ",", "times", ",", "pos"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"attrs", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<HDF5\>\"", ",", "\"\<Attributes\>\"", ",", 
             "\"\</vhist2d\>\""}], "}"}]}], "]"}], "&"}], "/@", "files"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{
        RowBox[{"Lookup", "[", "\"\<step\>\"", "]"}], "/@", "attrs"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"times", "=", 
       RowBox[{
        RowBox[{"Lookup", "[", "\"\<time\>\"", "]"}], "/@", "attrs"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"List", "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "times", "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"First", "/@", 
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"pos", ",", "times"}], "}"}], "]"}], ",", "Last"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"steps", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"times", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"times", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"files", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"files", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Association", "[", 
       RowBox[{
        RowBox[{"\"\<attr\>\"", "->", 
         RowBox[{"KeyDrop", "[", 
          RowBox[{
           RowBox[{"First", "[", "attrs", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<step\>\"", ",", "\"\<time\>\""}], "}"}]}], "]"}]}], 
        ",", 
        RowBox[{"\"\<step\>\"", "->", "steps"}], ",", 
        RowBox[{"\"\<time\>\"", "->", "times"}], ",", 
        RowBox[{"\"\<files\>\"", "->", "files"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[639]:=",ExpressionUUID->"031100a5-f529-474a-ac83-268d5d7c25ba"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compileBiMaxwellian", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compileBiMaxwellian", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]1_", "?", "Positive"}], ",", 
    RowBox[{"T2OT1_", "?", "Positive"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]1", "=", 
       SqrtBox[
        RowBox[{"N", "[", "\[Beta]1", "]"}]]}], ",", 
      RowBox[{"\[Theta]2", "=", 
       SqrtBox[
        RowBox[{
         RowBox[{"N", "[", "\[Beta]1", "]"}], "T2OT1"}]]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"n", " ", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"v1", "^", "2"}]}], "/", 
            RowBox[{"\[Theta]1", "^", "2"}]}], "-", 
           RowBox[{
            RowBox[{"v2", "^", "2"}], "/", 
            RowBox[{"\[Theta]2", "^", "2"}]}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"Pi", "^", "1.5"}], " ", "\[Theta]1", " ", 
          RowBox[{"\[Theta]2", "^", "2"}]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[640]:=",ExpressionUUID->"23e38fd0-5996-4b1e-8c87-749d77fb67b3"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compileLossCone", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compileLossCone", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]1_", "?", "Positive"}], ",", 
    RowBox[{"T2OT1_", "?", "Positive"}], ",", 
    RowBox[{"\[Beta]_Real", "?", "Positive"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]1", "=", 
       SqrtBox[
        RowBox[{"N", "[", "\[Beta]1", "]"}]]}], ",", 
      RowBox[{"\[Theta]2", "=", 
       SqrtBox[
        RowBox[{
         RowBox[{"N", "[", "\[Beta]1", "]"}], 
         RowBox[{"T2OT1", "/", 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}]]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Beta]"}], ")"}]}], 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"v1", "^", "2"}]}], "/", 
            RowBox[{"\[Theta]1", "^", "2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"v2", "^", "2"}]}], "/", 
              RowBox[{"\[Theta]2", "^", "2"}]}], "]"}], "-", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"v2", "^", "2"}]}], "/", 
               RowBox[{"\[Theta]2", "^", "2"}]}], "/", "\[Beta]"}], "]"}]}], 
           ")"}]}], ",", 
         RowBox[{
          RowBox[{"Pi", "^", "1.5"}], " ", "\[Theta]1", " ", 
          RowBox[{"\[Theta]2", "^", "2"}]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[642]:=",ExpressionUUID->"87d366a1-c8ba-4815-8fc8-6bb45a27781b"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compilePartialShell", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compilePartialShell", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]_", "?", "Positive"}], ",", 
    RowBox[{"\[Zeta]_Integer", "?", "NonNegative"}], ",", 
    RowBox[{"vs_", "?", "NonNegative"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]", "=", 
       RowBox[{"N", "[", 
        SqrtBox["\[Beta]"], "]"}]}], ",", 
      RowBox[{"xs", "=", 
       RowBox[{"N", "[", 
        RowBox[{"vs", "/", 
         SqrtBox["\[Beta]"]}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{".5", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"vs", "/", 
            SqrtBox["\[Beta]"]}], 
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"vs", "/", 
                SqrtBox["\[Beta]"]}], ")"}], "^", "2"}]}], "]"}]}], "+", 
          RowBox[{
           SqrtBox["\[Pi]"], 
           RowBox[{"(", 
            RowBox[{".5", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"vs", "/", 
                SqrtBox["\[Beta]"]}], ")"}], "^", "2"}]}], ")"}], 
           RowBox[{"Erfc", "[", 
            RowBox[{
             RowBox[{"-", "vs"}], "/", 
             SqrtBox["\[Beta]"]}], "]"}]}]}], ")"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"B\[Zeta]", "=", 
       RowBox[{
        SqrtBox["\[Pi]"], 
        RowBox[{
         RowBox[{"Gamma", "[", 
          RowBox[{"1", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}], "/", 
         RowBox[{"Gamma", "[", 
          RowBox[{"1.5", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "x1", ",", "x2", ",", "\[Mu]"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x2", "=", 
          RowBox[{"v2", "/", "\[Theta]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x1", "=", 
          RowBox[{"v1", "/", "\[Theta]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x", "=", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"x1", "^", "2"}], "+", 
            RowBox[{"x2", "^", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Mu]", "=", 
          RowBox[{"x1", "/", "x"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"n", " ", 
          RowBox[{"Divide", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"x", "-", "xs"}], ")"}], "^", "2"}]}], "]"}], 
             RowBox[{"Power", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "\[Mu]"}], ")"}], 
                RowBox[{"(", 
                 RowBox[{"1", "+", "\[Mu]"}], ")"}]}], ",", 
               RowBox[{".5", "\[Zeta]"}]}], "]"}]}], ",", 
            RowBox[{"2", "Pi", " ", 
             RowBox[{"\[Theta]", "^", "3"}], "Ab", " ", "B\[Zeta]"}]}], 
           "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[644]:=",ExpressionUUID->"0c4a0d53-0227-4c1d-9df5-c49fe37333cd"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compileCounterBeam", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compileCounterBeam", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]_", "?", "Positive"}], ",", 
    RowBox[{"vs_", "?", "NonNegative"}], ",", 
    RowBox[{"\[Nu]_", "?", "Positive"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]", "=", 
       RowBox[{"N", "[", 
        SqrtBox["\[Beta]"], "]"}]}], ",", 
      RowBox[{"xs", "=", 
       RowBox[{"N", "[", 
        RowBox[{"vs", "/", 
         SqrtBox["\[Beta]"]}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{".5", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"vs", "/", 
            SqrtBox["\[Beta]"]}], 
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"vs", "/", 
                SqrtBox["\[Beta]"]}], ")"}], "^", "2"}]}], "]"}]}], "+", 
          RowBox[{
           SqrtBox["\[Pi]"], 
           RowBox[{"(", 
            RowBox[{".5", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"vs", "/", 
                SqrtBox["\[Beta]"]}], ")"}], "^", "2"}]}], ")"}], 
           RowBox[{"Erfc", "[", 
            RowBox[{
             RowBox[{"-", "vs"}], "/", 
             SqrtBox["\[Beta]"]}], "]"}]}]}], ")"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"B\[Nu]", "=", 
       RowBox[{"2", "\[Nu]", " ", 
        RowBox[{"DawsonF", "[", 
         RowBox[{"1", "/", "\[Nu]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x1", ",", "x2", ",", "x", ",", "\[Mu]", ",", "f0"}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x2", "=", 
          RowBox[{"v2", "/", "\[Theta]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x1", "=", 
          RowBox[{"v1", "/", "\[Theta]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x", "=", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"x1", "^", "2"}], "+", 
            RowBox[{"x2", "^", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Mu]", "=", 
          RowBox[{"x1", "/", "x"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"n", " ", 
          RowBox[{"Divide", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"x", "-", "xs"}], ")"}], "^", "2"}]}], "]"}], 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "\[Mu]"}], ")"}], 
                  RowBox[{"(", 
                   RowBox[{"1", "+", "\[Mu]"}], ")"}]}], ")"}]}], "/", 
               RowBox[{"\[Nu]", "^", "2"}]}], "]"}]}], ",", 
            RowBox[{"2", "Pi", " ", 
             RowBox[{"\[Theta]", "^", "3"}], "Ab", " ", "B\[Nu]"}]}], 
           "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[646]:=",ExpressionUUID->"0d5aa188-ba6a-4cbc-8225-b6d0055eda98"],

Cell[CellGroupData[{

Cell["Maxwellian", "Subsubsection",ExpressionUUID->"fe80e185-5197-42f8-b99f-9cca5f073b7d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist1", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "1"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist1"}]}], "Input",
 CellLabel->
  "In[648]:=",ExpressionUUID->"f605ebca-de2f-4079-8328-128010bd5dda"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist1"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"T2OT1eq", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "fhist", ",", "ghist", ",", "whist", 
       ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "T2OT1", ",", "vv12", ",", 
       "ff", ",", "gg", ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{"T2OT1eq", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "T2OT1eq"}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{"T2OT1eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileBiMaxwellian", "[", 
          RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1"}], "]"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileBiMaxwellian", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1"}], "]"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[650]:=",ExpressionUUID->"5cdc9089-b8c9-4385-aa1b-7d765c270b48"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bi-Maxwellian", "Subsubsection",ExpressionUUID->"ac9a0ef0-1ed7-4c49-894b-8d040b1265af"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist2", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "2"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist2"}]}], "Input",
 CellLabel->
  "In[651]:=",ExpressionUUID->"30e29baf-be22-4a23-9455-cfb8d5cc8176"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist2"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"T2OT1eq", "=", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "fhist", ",", "ghist", ",", "whist", 
       ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "T2OT1", ",", "vv12", ",", 
       "ff", ",", "gg", ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{"T2OT1eq", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "T2OT1eq"}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{"T2OT1eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileBiMaxwellian", "[", 
          RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1"}], "]"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileBiMaxwellian", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1"}], "]"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[653]:=",ExpressionUUID->"24babefe-2ca7-45a8-bfe8-ab69c67cf459"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Loss cone - Maxwellian", "Subsubsection",ExpressionUUID->"e301e7dc-eb33-46da-86eb-8f8e6243a88e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist3", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "3"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist3"}]}], "Input",
 CellLabel->
  "In[654]:=",ExpressionUUID->"354e6873-e1ec-483e-a49a-8830fb2ba2ec"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist3"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["1"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "1.0*^-10"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "fhist", ",", "ghist", ",", "whist", 
       ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "\[Eta]\[Beta]", ",", "n0", ",", 
       "\[Beta]", ",", "\[Theta]2O\[Theta]1", ",", "T2OT1", ",", "vv12", ",", 
       "ff", ",", "gg", ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileLossCone", "[", 
          RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], 
          "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileLossCone", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1", ",", "\[Beta]"}], 
          "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[656]:=",ExpressionUUID->"1b1960bb-dfd3-42da-8f90-2cabf37dc77a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Loss cone - Bi-Maxwellian", "Subsubsection",ExpressionUUID->"f0e7d15b-2c81-4f41-868d-6745ac8e65db"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist4", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "4"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist4"}]}], "Input",
 CellLabel->
  "In[657]:=",ExpressionUUID->"0772f7b0-48e0-4b2d-8541-a07d79f2ca5d"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist4"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "1.0*^-10"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "fhist", ",", "ghist", ",", "whist", 
       ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "\[Eta]\[Beta]", ",", "n0", ",", 
       "\[Beta]", ",", "\[Theta]2O\[Theta]1", ",", "T2OT1", ",", "vv12", ",", 
       "ff", ",", "gg", ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileLossCone", "[", 
          RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], 
          "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileLossCone", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1", ",", "\[Beta]"}], 
          "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[659]:=",ExpressionUUID->"516ce6ad-b483-4ff9-bf73-83ba5e152724"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Loss cone - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Beta]", "eq"], "=", "0.5"}], TraditionalForm]],
  ExpressionUUID->"2e205f47-9f33-41a7-8fbf-e9a62dc828f2"]
}], "Subsubsection",ExpressionUUID->"09c53460-8f0c-4f01-90b3-594ffa8138dc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist5", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "5"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist5"}]}], "Input",
 CellLabel->
  "In[660]:=",ExpressionUUID->"d0cfef55-6cad-446f-8c55-c8501fc3af46"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist5"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "0.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "fhist", ",", "ghist", ",", "whist", 
       ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "\[Eta]\[Beta]", ",", "n0", ",", 
       "\[Beta]", ",", "\[Theta]2O\[Theta]1", ",", "T2OT1", ",", "vv12", ",", 
       "ff", ",", "gg", ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileLossCone", "[", 
          RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], 
          "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileLossCone", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1", ",", "\[Beta]"}], 
          "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[662]:=",ExpressionUUID->"184f72e9-532f-4217-a144-e0bc44cc73c3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Loss cone - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Beta]", "eq"], "=", "2.5"}], TraditionalForm]],
  ExpressionUUID->"5150e459-15b5-4b63-8c71-5bfdf0418bb6"]
}], "Subsubsection",ExpressionUUID->"674ebfdd-4362-4560-866b-f9fe043036cf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist6", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "6"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist6"}]}], "Input",
 CellLabel->
  "In[663]:=",ExpressionUUID->"06c87354-63c2-4a6f-be12-e2fb0478ac00"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist6"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "2.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "fhist", ",", "ghist", ",", "whist", 
       ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "\[Eta]\[Beta]", ",", "n0", ",", 
       "\[Beta]", ",", "\[Theta]2O\[Theta]1", ",", "T2OT1", ",", "vv12", ",", 
       "ff", ",", "gg", ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileLossCone", "[", 
          RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], 
          "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileLossCone", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1", ",", "\[Beta]"}], 
          "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[665]:=",ExpressionUUID->"f735f831-0bc3-40a4-9c52-c27695b114e1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Partial shell - Maxwellian", "Subsubsection",ExpressionUUID->"e264d83a-6c95-4ac5-9721-0f1e04acc04f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist7", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "7"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist7"}]}], "Input",
 CellLabel->
  "In[666]:=",ExpressionUUID->"489b4e47-5b2e-482d-9fc0-69cf95a5d05f"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist7"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "1.5"}], ",", 
     RowBox[{"\[Zeta]", "=", "0"}], ",", 
     RowBox[{"vs", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "fhist", ",", "ghist", ",", "whist", 
       ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "vv12", ",", "ff", ",", "gg",
        ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compilePartialShell", "[", 
          RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compilePartialShell", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]", " ", "gT"}], ",", "\[Zeta]", ",", "vs"}], "]"}],
          "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[668]:=",ExpressionUUID->"a2b28cda-daca-4adb-8339-21de3d02e7dd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Isotropic shell", "Subsubsection",ExpressionUUID->"6eb3c79b-eff6-4460-8253-47e96d5ee614"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist8", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "8"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist8"}]}], "Input",
 CellLabel->
  "In[669]:=",ExpressionUUID->"f57bb4e7-f06e-4745-bc6b-63fd2c0beb06"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist8"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "0"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "fhist", ",", "ghist", ",", "whist", 
       ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "vv12", ",", "ff", ",", "gg",
        ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compilePartialShell", "[", 
          RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compilePartialShell", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]", " ", "gT"}], ",", "\[Zeta]", ",", "vs"}], "]"}],
          "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[671]:=",ExpressionUUID->"f0394d30-2067-47b3-8e35-57bbbfb8f7f1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Partial shell - ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Zeta]", "=", "1"}], TraditionalForm]],ExpressionUUID->
  "380dbb2c-602c-4f1e-964c-89fb1ceb2c06"]
}], "Subsubsection",ExpressionUUID->"5dae1cb7-fb06-4091-b03e-968418fa9c75"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist9", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "9"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist9"}]}], "Input",
 CellLabel->
  "In[672]:=",ExpressionUUID->"f680c9c5-a9a6-49ee-bec0-059f006df748"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist9"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "1"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "fhist", ",", "ghist", ",", "whist", 
       ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "vv12", ",", "ff", ",", "gg",
        ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compilePartialShell", "[", 
          RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compilePartialShell", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]", " ", "gT"}], ",", "\[Zeta]", ",", "vs"}], "]"}],
          "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[674]:=",ExpressionUUID->"5e21fdad-81e8-40e3-8834-d06a327d2dd8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Partial shell - ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Zeta]", "=", "5"}], TraditionalForm]],ExpressionUUID->
  "08a6fdfd-6d84-4369-812f-b9d9fe349ad0"]
}], "Subsubsection",ExpressionUUID->"e115932c-e11d-4697-99f7-effb712dd1d5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist10", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "10"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist10"}]}], "Input",
 CellLabel->
  "In[675]:=",ExpressionUUID->"e5c1bd5b-d3eb-4d82-9320-2133ba724e35"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist10"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "5"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "fhist", ",", "ghist", ",", "whist", 
       ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "vv12", ",", "ff", ",", "gg",
        ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compilePartialShell", "[", 
          RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compilePartialShell", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]", " ", "gT"}], ",", "\[Zeta]", ",", "vs"}], "]"}],
          "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[677]:=",ExpressionUUID->"d467d30e-a58a-434d-bb04-91e18e536b77"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Counter beam - Maxwellian", "Subsubsection",ExpressionUUID->"88577145-53b2-45f2-befa-c6328576974c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist11", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "11"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist11"}]}], "Input",
 CellLabel->
  "In[678]:=",ExpressionUUID->"27dce91b-13b3-4814-8ce6-7ae13050d04d"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist11"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "1.5"}], ",", 
     RowBox[{"\[Nu]0", "=", "100000"}], ",", 
     RowBox[{"vs", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "fhist", ",", "ghist", ",", "whist", 
       ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "\[Nu]", ",", "vv12", ",", 
       "ff", ",", "gg", ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"DawsonF", "[", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "/", 
           "\[Nu]0"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]0"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{
        RowBox[{"Sec", "[", 
         RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "\[Nu]0"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileCounterBeam", "[", 
          RowBox[{"n0", ",", "\[Beta]", ",", "vs", ",", "\[Nu]"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileCounterBeam", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]", " ", "gT"}], ",", "vs", ",", "\[Nu]"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[680]:=",ExpressionUUID->"2eb96b85-47b8-4480-ad8a-e96c34742f20"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Counter beam - isotropic shell", "Subsubsection",ExpressionUUID->"a796a14f-e636-4854-9cf6-3b4263b58f82"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist12", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "12"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist12"}]}], "Input",
 CellLabel->
  "In[681]:=",ExpressionUUID->"762414c1-c427-4a2a-8924-be887f04946e"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist12"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Nu]0", "=", "100000"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "fhist", ",", "ghist", ",", "whist", 
       ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "\[Nu]", ",", "vv12", ",", 
       "ff", ",", "gg", ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"DawsonF", "[", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "/", 
           "\[Nu]0"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]0"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{
        RowBox[{"Sec", "[", 
         RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "\[Nu]0"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileCounterBeam", "[", 
          RowBox[{"n0", ",", "\[Beta]", ",", "vs", ",", "\[Nu]"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileCounterBeam", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]", " ", "gT"}], ",", "vs", ",", "\[Nu]"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[683]:=",ExpressionUUID->"501f2c08-e5ac-452c-863d-19b1afa616af"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Counter beam - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Nu]", "0"], "=", "1"}], TraditionalForm]],ExpressionUUID->
  "a1af443d-5e10-446f-bd9c-95e6123508b5"]
}], "Subsubsection",ExpressionUUID->"70285619-b808-4ccf-a159-53e96984bebc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist13", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "13"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist13"}]}], "Input",
 CellLabel->
  "In[684]:=",ExpressionUUID->"cd68cb77-d141-4727-9149-f0a16b904b97"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist13"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Nu]0", "=", "1"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "fhist", ",", "ghist", ",", "whist", 
       ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "\[Nu]", ",", "vv12", ",", 
       "ff", ",", "gg", ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"DawsonF", "[", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "/", 
           "\[Nu]0"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]0"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{
        RowBox[{"Sec", "[", 
         RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "\[Nu]0"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileCounterBeam", "[", 
          RowBox[{"n0", ",", "\[Beta]", ",", "vs", ",", "\[Nu]"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileCounterBeam", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]", " ", "gT"}], ",", "vs", ",", "\[Nu]"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[686]:=",ExpressionUUID->"f08b5895-f9e4-4037-a990-fe6fba0f7fb1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Counter beam - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Nu]", "0"], "=", "0.1"}], TraditionalForm]],
  ExpressionUUID->"cec4c5e7-0868-45be-ada9-e7f7dd19ba19"]
}], "Subsubsection",ExpressionUUID->"c308e20b-faa5-4985-aea4-e6e226905b9c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist14", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "14"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist14"}]}], "Input",
 CellLabel->
  "In[687]:=",ExpressionUUID->"03de21da-e94b-4ac2-84b3-8bd4a62a2813"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist14"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Nu]0", "=", ".1"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "fhist", ",", "ghist", ",", "whist", 
       ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "\[Nu]", ",", "vv12", ",", 
       "ff", ",", "gg", ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"DawsonF", "[", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "/", 
           "\[Nu]0"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]0"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{
        RowBox[{"Sec", "[", 
         RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "\[Nu]0"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileCounterBeam", "[", 
          RowBox[{"n0", ",", "\[Beta]", ",", "vs", ",", "\[Nu]"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileCounterBeam", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]", " ", "gT"}], ",", "vs", ",", "\[Nu]"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[689]:=",ExpressionUUID->"6dd9eaac-b76a-4c19-9e1e-f0b0e7a222bb"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Particle", "Subsection",ExpressionUUID->"5fd3b1be-689f-429f-b7e4-8019920ed1c4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"metadata", "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"files", "=", 
        RowBox[{"FileNames", "[", 
         RowBox[{"\"\<particle-*.h5\>\"", ",", "wd"}], "]"}]}], ",", "names", 
       ",", "attrs", ",", "steps", ",", "times", ",", "pos"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"attrs", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<HDF5\>\"", ",", "\"\<Attributes\>\"", ",", 
             "\"\</particle\>\""}], "}"}]}], "]"}], "&"}], "/@", "files"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{
        RowBox[{"Lookup", "[", "\"\<step\>\"", "]"}], "/@", "attrs"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"times", "=", 
       RowBox[{
        RowBox[{"Lookup", "[", "\"\<time\>\"", "]"}], "/@", "attrs"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"List", "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "times", "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"First", "/@", 
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"pos", ",", "times"}], "}"}], "]"}], ",", "Last"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"steps", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"times", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"times", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"files", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"files", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Association", "[", 
       RowBox[{
        RowBox[{"\"\<attr\>\"", "->", 
         RowBox[{"KeyDrop", "[", 
          RowBox[{
           RowBox[{"First", "[", "attrs", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<step\>\"", ",", "\"\<time\>\""}], "}"}]}], "]"}]}], 
        ",", 
        RowBox[{"\"\<step\>\"", "->", "steps"}], ",", 
        RowBox[{"\"\<time\>\"", "->", "times"}], ",", 
        RowBox[{"\"\<files\>\"", "->", "files"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[690]:=",ExpressionUUID->"893da2a7-7e5d-432e-b173-f8eaf133cea4"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compileBiMaxwellian", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compileBiMaxwellian", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]1_", "?", "Positive"}], ",", 
    RowBox[{"T2OT1_", "?", "Positive"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]1", "=", 
       SqrtBox[
        RowBox[{"N", "[", "\[Beta]1", "]"}]]}], ",", 
      RowBox[{"\[Theta]2", "=", 
       SqrtBox[
        RowBox[{
         RowBox[{"N", "[", "\[Beta]1", "]"}], "T2OT1"}]]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"n", " ", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"v1", "^", "2"}]}], "/", 
            RowBox[{"\[Theta]1", "^", "2"}]}], "-", 
           RowBox[{
            RowBox[{"v2", "^", "2"}], "/", 
            RowBox[{"\[Theta]2", "^", "2"}]}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"Pi", "^", "1.5"}], " ", "\[Theta]1", " ", 
          RowBox[{"\[Theta]2", "^", "2"}]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[691]:=",ExpressionUUID->"cb341572-e53f-4af1-9c6e-ed9448575ba6"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compileLossCone", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compileLossCone", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]1_", "?", "Positive"}], ",", 
    RowBox[{"T2OT1_", "?", "Positive"}], ",", 
    RowBox[{"\[Beta]_Real", "?", "Positive"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]1", "=", 
       SqrtBox[
        RowBox[{"N", "[", "\[Beta]1", "]"}]]}], ",", 
      RowBox[{"\[Theta]2", "=", 
       SqrtBox[
        RowBox[{
         RowBox[{"N", "[", "\[Beta]1", "]"}], 
         RowBox[{"T2OT1", "/", 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}]]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Beta]"}], ")"}]}], 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"v1", "^", "2"}]}], "/", 
            RowBox[{"\[Theta]1", "^", "2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"v2", "^", "2"}]}], "/", 
              RowBox[{"\[Theta]2", "^", "2"}]}], "]"}], "-", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"v2", "^", "2"}]}], "/", 
               RowBox[{"\[Theta]2", "^", "2"}]}], "/", "\[Beta]"}], "]"}]}], 
           ")"}]}], ",", 
         RowBox[{
          RowBox[{"Pi", "^", "1.5"}], " ", "\[Theta]1", " ", 
          RowBox[{"\[Theta]2", "^", "2"}]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[693]:=",ExpressionUUID->"45b8a89b-813c-48e5-adf5-13fd6fe5a6f5"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compilePartialShell", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compilePartialShell", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]_", "?", "Positive"}], ",", 
    RowBox[{"\[Zeta]_Integer", "?", "NonNegative"}], ",", 
    RowBox[{"vs_", "?", "NonNegative"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]", "=", 
       RowBox[{"N", "[", 
        SqrtBox["\[Beta]"], "]"}]}], ",", 
      RowBox[{"xs", "=", 
       RowBox[{"N", "[", 
        RowBox[{"vs", "/", 
         SqrtBox["\[Beta]"]}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{".5", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"vs", "/", 
            SqrtBox["\[Beta]"]}], 
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"vs", "/", 
                SqrtBox["\[Beta]"]}], ")"}], "^", "2"}]}], "]"}]}], "+", 
          RowBox[{
           SqrtBox["\[Pi]"], 
           RowBox[{"(", 
            RowBox[{".5", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"vs", "/", 
                SqrtBox["\[Beta]"]}], ")"}], "^", "2"}]}], ")"}], 
           RowBox[{"Erfc", "[", 
            RowBox[{
             RowBox[{"-", "vs"}], "/", 
             SqrtBox["\[Beta]"]}], "]"}]}]}], ")"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"B\[Zeta]", "=", 
       RowBox[{
        SqrtBox["\[Pi]"], 
        RowBox[{
         RowBox[{"Gamma", "[", 
          RowBox[{"1", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}], "/", 
         RowBox[{"Gamma", "[", 
          RowBox[{"1.5", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "x1", ",", "x2", ",", "\[Mu]"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x2", "=", 
          RowBox[{"v2", "/", "\[Theta]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x1", "=", 
          RowBox[{"v1", "/", "\[Theta]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x", "=", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"x1", "^", "2"}], "+", 
            RowBox[{"x2", "^", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Mu]", "=", 
          RowBox[{"x1", "/", "x"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"n", " ", 
          RowBox[{"Divide", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"x", "-", "xs"}], ")"}], "^", "2"}]}], "]"}], 
             RowBox[{"Power", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "\[Mu]"}], ")"}], 
                RowBox[{"(", 
                 RowBox[{"1", "+", "\[Mu]"}], ")"}]}], ",", 
               RowBox[{".5", "\[Zeta]"}]}], "]"}]}], ",", 
            RowBox[{"2", "Pi", " ", 
             RowBox[{"\[Theta]", "^", "3"}], "Ab", " ", "B\[Zeta]"}]}], 
           "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[695]:=",ExpressionUUID->"a7dddd1d-ebb0-4cac-80db-99d04aa3ebec"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compileCounterBeam", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compileCounterBeam", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]_", "?", "Positive"}], ",", 
    RowBox[{"vs_", "?", "NonNegative"}], ",", 
    RowBox[{"\[Nu]_", "?", "Positive"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]", "=", 
       RowBox[{"N", "[", 
        SqrtBox["\[Beta]"], "]"}]}], ",", 
      RowBox[{"xs", "=", 
       RowBox[{"N", "[", 
        RowBox[{"vs", "/", 
         SqrtBox["\[Beta]"]}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{".5", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"vs", "/", 
            SqrtBox["\[Beta]"]}], 
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"vs", "/", 
                SqrtBox["\[Beta]"]}], ")"}], "^", "2"}]}], "]"}]}], "+", 
          RowBox[{
           SqrtBox["\[Pi]"], 
           RowBox[{"(", 
            RowBox[{".5", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"vs", "/", 
                SqrtBox["\[Beta]"]}], ")"}], "^", "2"}]}], ")"}], 
           RowBox[{"Erfc", "[", 
            RowBox[{
             RowBox[{"-", "vs"}], "/", 
             SqrtBox["\[Beta]"]}], "]"}]}]}], ")"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"B\[Nu]", "=", 
       RowBox[{"2", "\[Nu]", " ", 
        RowBox[{"DawsonF", "[", 
         RowBox[{"1", "/", "\[Nu]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x1", ",", "x2", ",", "x", ",", "\[Mu]", ",", "f0"}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x2", "=", 
          RowBox[{"v2", "/", "\[Theta]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x1", "=", 
          RowBox[{"v1", "/", "\[Theta]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x", "=", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"x1", "^", "2"}], "+", 
            RowBox[{"x2", "^", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Mu]", "=", 
          RowBox[{"x1", "/", "x"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"n", " ", 
          RowBox[{"Divide", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"x", "-", "xs"}], ")"}], "^", "2"}]}], "]"}], 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "\[Mu]"}], ")"}], 
                  RowBox[{"(", 
                   RowBox[{"1", "+", "\[Mu]"}], ")"}]}], ")"}]}], "/", 
               RowBox[{"\[Nu]", "^", "2"}]}], "]"}]}], ",", 
            RowBox[{"2", "Pi", " ", 
             RowBox[{"\[Theta]", "^", "3"}], "Ab", " ", "B\[Nu]"}]}], 
           "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[697]:=",ExpressionUUID->"b5cd3f93-f0d4-4ff7-9ec0-63cb690624b2"],

Cell[CellGroupData[{

Cell["Maxwellian", "Subsubsection",ExpressionUUID->"36a1f4fc-a9cc-4b45-a98e-bb5e12f6c6e3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl1", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "1"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"v1lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v2lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv2", "=", "51"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "vhist", ",", "q1", ",", "rhist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vhist", "=", 
         RowBox[{"calVelocityHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"v1lim", ",", "Nv1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v2lim", ",", "Nv2"}], "}"}], ",", "q1lim"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nv\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl1"}]}], "Input",
 CellLabel->
  "In[699]:=",ExpressionUUID->"9f097443-e5b5-4b5e-a35b-87e5696bf097"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl1"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"T2OT1eq", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "\[Xi]\[CapitalDelta]1", ",", "q1", 
       ",", "\[Eta]", ",", "n0", ",", "T2OT1", ",", "vv12", ",", "ff", ",", 
       "gg", ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{"T2OT1eq", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "T2OT1eq"}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{"T2OT1eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileBiMaxwellian", "[", 
            RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1"}], "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileBiMaxwellian", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1"}], "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vhist", "[", "\"\<df\>\"", "]"}], "//", "Reverse"}],
                 ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Divide", ",", 
                  RowBox[{"Subtract", "@@@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRangePadding", "->", 
               RowBox[{"Thread", "[", 
                RowBox[{"Scaled", "[", 
                 RowBox[{".02", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[701]:=",ExpressionUUID->"1467e5f1-23c4-4fb5-b056-e0e7cdcb825d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bi-Maxwellian", "Subsubsection",ExpressionUUID->"8adb1f5d-23b5-47fe-9819-00234264bcad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl2", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "2"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"v1lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v2lim", "=", 
        RowBox[{"6.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "vhist", ",", "q1", ",", "rhist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vhist", "=", 
         RowBox[{"calVelocityHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"v1lim", ",", "Nv1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v2lim", ",", "Nv2"}], "}"}], ",", "q1lim"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nv\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl2"}]}], "Input",
 CellLabel->
  "In[702]:=",ExpressionUUID->"fbd90576-d11a-4dd7-99ff-ee2dd90257e7"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl2"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"T2OT1eq", "=", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "\[Xi]\[CapitalDelta]1", ",", "q1", 
       ",", "\[Eta]", ",", "n0", ",", "T2OT1", ",", "vv12", ",", "ff", ",", 
       "gg", ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{"T2OT1eq", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "T2OT1eq"}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{"T2OT1eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileBiMaxwellian", "[", 
            RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1"}], "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileBiMaxwellian", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1"}], "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vhist", "[", "\"\<df\>\"", "]"}], "//", "Reverse"}],
                 ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Divide", ",", 
                  RowBox[{"Subtract", "@@@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRangePadding", "->", 
               RowBox[{"Thread", "[", 
                RowBox[{"Scaled", "[", 
                 RowBox[{".02", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[704]:=",ExpressionUUID->"bdf67aff-9b63-49c3-8a4a-1fbbe0a4de5e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Loss cone - Maxwellian", "Subsubsection",ExpressionUUID->"ff204e1f-d465-4e45-9f15-b73c3c893168"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl3", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "3"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"v1lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v2lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv2", "=", "51"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "vhist", ",", "q1", ",", "rhist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vhist", "=", 
         RowBox[{"calVelocityHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"v1lim", ",", "Nv1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v2lim", ",", "Nv2"}], "}"}], ",", "q1lim"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nv\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl3"}]}], "Input",
 CellLabel->
  "In[705]:=",ExpressionUUID->"96fe0e7f-76ca-4d7d-a9ae-193e995d5e47"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl3"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["1"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "1.0*^-10"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "\[Xi]\[CapitalDelta]1", ",", "q1", 
       ",", "\[Eta]", ",", "\[Eta]\[Beta]", ",", "\[Beta]", ",", "n0", ",", 
       "\[Theta]2O\[Theta]1", ",", "T2OT1", ",", "vv12", ",", "ff", ",", "gg",
        ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileLossCone", "[", 
            RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], 
            "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileLossCone", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1", ",", "\[Beta]"}], 
            "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vhist", "[", "\"\<df\>\"", "]"}], "//", "Reverse"}],
                 ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Divide", ",", 
                  RowBox[{"Subtract", "@@@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRangePadding", "->", 
               RowBox[{"Thread", "[", 
                RowBox[{"Scaled", "[", 
                 RowBox[{".02", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[707]:=",ExpressionUUID->"7b43c61b-d5ad-4fdd-a772-d4d0ed3a5201"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Loss cone - Bi-Maxwellian", "Subsubsection",ExpressionUUID->"07cb930f-0154-42c4-a84b-64000b6a5919"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl4", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "4"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"v1lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v2lim", "=", 
        RowBox[{"6.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "vhist", ",", "q1", ",", "rhist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vhist", "=", 
         RowBox[{"calVelocityHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"v1lim", ",", "Nv1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v2lim", ",", "Nv2"}], "}"}], ",", "q1lim"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nv\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl4"}]}], "Input",
 CellLabel->
  "In[708]:=",ExpressionUUID->"f80e0095-8f0a-4fe4-90c4-7fb3081b8a1b"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl4"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "1.0*^-10"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "\[Xi]\[CapitalDelta]1", ",", "q1", 
       ",", "\[Eta]", ",", "\[Eta]\[Beta]", ",", "\[Beta]", ",", "n0", ",", 
       "\[Theta]2O\[Theta]1", ",", "T2OT1", ",", "vv12", ",", "ff", ",", "gg",
        ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileLossCone", "[", 
            RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], 
            "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileLossCone", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1", ",", "\[Beta]"}], 
            "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vhist", "[", "\"\<df\>\"", "]"}], "//", "Reverse"}],
                 ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Divide", ",", 
                  RowBox[{"Subtract", "@@@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRangePadding", "->", 
               RowBox[{"Thread", "[", 
                RowBox[{"Scaled", "[", 
                 RowBox[{".02", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[710]:=",ExpressionUUID->"51ef39fa-77c6-4a43-9e93-38d99f692bac"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Loss cone - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Beta]", "eq"], "=", "0.5"}], TraditionalForm]],
  ExpressionUUID->"0d219fcd-ec78-4885-b380-67af10638728"]
}], "Subsubsection",ExpressionUUID->"453a29b7-4b7f-4c4e-8b5d-32e8bf4fe9a4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl5", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "5"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"v1lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v2lim", "=", 
        RowBox[{"6.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "vhist", ",", "q1", ",", "rhist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vhist", "=", 
         RowBox[{"calVelocityHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"v1lim", ",", "Nv1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v2lim", ",", "Nv2"}], "}"}], ",", "q1lim"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nv\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl5"}]}], "Input",
 CellLabel->
  "In[711]:=",ExpressionUUID->"0e51ec89-08a0-4054-84d8-3643b3203a1c"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl5"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "0.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "\[Xi]\[CapitalDelta]1", ",", "q1", 
       ",", "\[Eta]", ",", "\[Eta]\[Beta]", ",", "\[Beta]", ",", "n0", ",", 
       "\[Theta]2O\[Theta]1", ",", "T2OT1", ",", "vv12", ",", "ff", ",", "gg",
        ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileLossCone", "[", 
            RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], 
            "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileLossCone", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1", ",", "\[Beta]"}], 
            "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vhist", "[", "\"\<df\>\"", "]"}], "//", "Reverse"}],
                 ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Divide", ",", 
                  RowBox[{"Subtract", "@@@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRangePadding", "->", 
               RowBox[{"Thread", "[", 
                RowBox[{"Scaled", "[", 
                 RowBox[{".02", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[713]:=",ExpressionUUID->"57e2e1ce-cc9a-4e6e-b9b0-5f50e329419d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Loss cone - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Beta]", "eq"], "=", "2.5"}], TraditionalForm]],
  ExpressionUUID->"b870e055-b1c7-449b-902d-f94bf4f76d10"]
}], "Subsubsection",ExpressionUUID->"420d5dbe-eb47-4c9a-b990-17c8bf2c417f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl6", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "6"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"v1lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v2lim", "=", 
        RowBox[{"6.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "vhist", ",", "q1", ",", "rhist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vhist", "=", 
         RowBox[{"calVelocityHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"v1lim", ",", "Nv1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v2lim", ",", "Nv2"}], "}"}], ",", "q1lim"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nv\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl6"}]}], "Input",
 CellLabel->
  "In[714]:=",ExpressionUUID->"4128df59-a0ee-48c9-a3b5-58536eb92fd0"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl6"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "2.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "\[Xi]\[CapitalDelta]1", ",", "q1", 
       ",", "\[Eta]", ",", "\[Eta]\[Beta]", ",", "\[Beta]", ",", "n0", ",", 
       "\[Theta]2O\[Theta]1", ",", "T2OT1", ",", "vv12", ",", "ff", ",", "gg",
        ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileLossCone", "[", 
            RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], 
            "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileLossCone", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1", ",", "\[Beta]"}], 
            "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vhist", "[", "\"\<df\>\"", "]"}], "//", "Reverse"}],
                 ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Divide", ",", 
                  RowBox[{"Subtract", "@@@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRangePadding", "->", 
               RowBox[{"Thread", "[", 
                RowBox[{"Scaled", "[", 
                 RowBox[{".02", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[716]:=",ExpressionUUID->"d183ec4e-ef5d-4e9e-89f7-1752fde91471"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Partial Shell - Maxwellian", "Subsubsection",ExpressionUUID->"4cde35e2-2a6c-42fb-8a21-d536aaf2b1c0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl7", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "7"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"v1lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v2lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv2", "=", "51"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "vhist", ",", "q1", ",", "rhist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vhist", "=", 
         RowBox[{"calVelocityHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"v1lim", ",", "Nv1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v2lim", ",", "Nv2"}], "}"}], ",", "q1lim"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nv\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl7"}]}], "Input",
 CellLabel->
  "In[717]:=",ExpressionUUID->"fdd05f59-c9bf-4ee7-b6e7-1ec4e8adb3e6"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl7"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "1.5"}], ",", 
     RowBox[{"\[Zeta]", "=", "0"}], ",", 
     RowBox[{"vs", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "plots", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "vv12", ",", "ff", ",", 
       "gg"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compilePartialShell", "[", 
            RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], "]"}], 
           ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compilePartialShell", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]", " ", "gT"}], ",", "\[Zeta]", ",", "vs"}], 
            "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vhist", "[", "\"\<df\>\"", "]"}], "//", "Reverse"}],
                 ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Divide", ",", 
                  RowBox[{"Subtract", "@@@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRangePadding", "->", 
               RowBox[{"Thread", "[", 
                RowBox[{"Scaled", "[", 
                 RowBox[{".02", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[719]:=",ExpressionUUID->"3b80149a-2520-4e15-9c72-3095b1089618"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Isotropic shell", "Subsubsection",ExpressionUUID->"9c707734-a002-4b4f-a78f-4088c49d8d3c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl8", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "8"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"v1lim", "=", 
        RowBox[{"2.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v2lim", "=", 
        RowBox[{"3.0", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "vhist", ",", "q1", ",", "rhist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vhist", "=", 
         RowBox[{"calVelocityHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"v1lim", ",", "Nv1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v2lim", ",", "Nv2"}], "}"}], ",", "q1lim"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nv\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl8"}]}], "Input",
 CellLabel->
  "In[720]:=",ExpressionUUID->"398aa1e0-b84f-4764-a659-9a8c5ffcdb98"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl8"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "0"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "plots", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "vv12", ",", "ff", ",", 
       "gg"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compilePartialShell", "[", 
            RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], "]"}], 
           ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compilePartialShell", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]", " ", "gT"}], ",", "\[Zeta]", ",", "vs"}], 
            "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vhist", "[", "\"\<df\>\"", "]"}], "//", "Reverse"}],
                 ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Divide", ",", 
                  RowBox[{"Subtract", "@@@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRangePadding", "->", 
               RowBox[{"Thread", "[", 
                RowBox[{"Scaled", "[", 
                 RowBox[{".02", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[722]:=",ExpressionUUID->"26061cd9-12aa-490f-b1d5-6c11255c1278"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Partial shell - ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Zeta]", "=", "1"}], TraditionalForm]],ExpressionUUID->
  "5dfeb8ae-ab61-4209-b791-0ab3e6edf841"]
}], "Subsubsection",ExpressionUUID->"50d02012-23a3-4fdc-b5f8-faf0710d9674"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl9", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "9"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"v1lim", "=", 
        RowBox[{"2.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v2lim", "=", 
        RowBox[{"3.0", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "vhist", ",", "q1", ",", "rhist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vhist", "=", 
         RowBox[{"calVelocityHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"v1lim", ",", "Nv1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v2lim", ",", "Nv2"}], "}"}], ",", "q1lim"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nv\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl9"}]}], "Input",
 CellLabel->
  "In[723]:=",ExpressionUUID->"9a7809fb-2c2d-4650-8a3f-b5bb9dfe2995"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl9"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "1"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "plots", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "vv12", ",", "ff", ",", 
       "gg"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compilePartialShell", "[", 
            RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], "]"}], 
           ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compilePartialShell", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]", " ", "gT"}], ",", "\[Zeta]", ",", "vs"}], 
            "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vhist", "[", "\"\<df\>\"", "]"}], "//", "Reverse"}],
                 ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Divide", ",", 
                  RowBox[{"Subtract", "@@@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRangePadding", "->", 
               RowBox[{"Thread", "[", 
                RowBox[{"Scaled", "[", 
                 RowBox[{".02", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[725]:=",ExpressionUUID->"89c4593d-3e80-4b8f-bdd1-6fd0449d22c0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Partial shell - ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Zeta]", "=", "5"}], TraditionalForm]],ExpressionUUID->
  "3feba518-3360-48bc-bd4f-19007b6c6f11"]
}], "Subsubsection",ExpressionUUID->"7950b24b-c9da-4d79-9d2d-f2e2a50a72e5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl10", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "10"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"v1lim", "=", 
        RowBox[{"2.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v2lim", "=", 
        RowBox[{"3.0", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "vhist", ",", "q1", ",", "rhist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vhist", "=", 
         RowBox[{"calVelocityHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"v1lim", ",", "Nv1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v2lim", ",", "Nv2"}], "}"}], ",", "q1lim"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nv\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl10"}]}], "Input",
 CellLabel->
  "In[726]:=",ExpressionUUID->"8ec05565-1468-434e-90e1-fa9efc4065ed"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl10"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "5"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "plots", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "vv12", ",", "ff", ",", 
       "gg"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compilePartialShell", "[", 
            RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], "]"}], 
           ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compilePartialShell", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]", " ", "gT"}], ",", "\[Zeta]", ",", "vs"}], 
            "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vhist", "[", "\"\<df\>\"", "]"}], "//", "Reverse"}],
                 ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Divide", ",", 
                  RowBox[{"Subtract", "@@@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRangePadding", "->", 
               RowBox[{"Thread", "[", 
                RowBox[{"Scaled", "[", 
                 RowBox[{".02", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[728]:=",ExpressionUUID->"ed6fdec6-abd6-443c-b685-c3ef58ecb9e8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Counter beam - Maxwellian", "Subsubsection",ExpressionUUID->"4cec448c-3d7a-4fd7-9c0a-e1836675128f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl11", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "11"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"v1lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v2lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv2", "=", "51"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "vhist", ",", "q1", ",", "rhist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vhist", "=", 
         RowBox[{"calVelocityHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"v1lim", ",", "Nv1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v2lim", ",", "Nv2"}], "}"}], ",", "q1lim"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nv\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl11"}]}], "Input",
 CellLabel->
  "In[729]:=",ExpressionUUID->"e3f0d1a5-770d-47f9-9e5c-1b5acc92301f"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl11"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "1.5"}], ",", 
     RowBox[{"\[Nu]0", "=", "100000"}], ",", 
     RowBox[{"vs", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "plots", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "\[Nu]", ",", "vv12", ",", 
       "ff", ",", "gg"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"DawsonF", "[", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "/", 
           "\[Nu]0"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]0"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{
        RowBox[{"Sec", "[", 
         RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "\[Nu]0"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileCounterBeam", "[", 
            RowBox[{"n0", ",", "\[Beta]", ",", "vs", ",", "\[Nu]"}], "]"}], 
           ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileCounterBeam", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]", " ", "gT"}], ",", "vs", ",", "\[Nu]"}], "]"}],
            ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vhist", "[", "\"\<df\>\"", "]"}], "//", "Reverse"}],
                 ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Divide", ",", 
                  RowBox[{"Subtract", "@@@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRangePadding", "->", 
               RowBox[{"Thread", "[", 
                RowBox[{"Scaled", "[", 
                 RowBox[{".02", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[731]:=",ExpressionUUID->"58814c80-a843-43cb-81e2-6f7b9a64138e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Counter beam - isotropic shell", "Subsubsection",ExpressionUUID->"b2787023-e854-4d97-bdb2-555e1e255c32"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl12", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "12"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"v1lim", "=", 
        RowBox[{"2.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v2lim", "=", 
        RowBox[{"3.0", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "vhist", ",", "q1", ",", "rhist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vhist", "=", 
         RowBox[{"calVelocityHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"v1lim", ",", "Nv1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v2lim", ",", "Nv2"}], "}"}], ",", "q1lim"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nv\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl12"}]}], "Input",
 CellLabel->
  "In[732]:=",ExpressionUUID->"03e006c2-6f13-41fa-a52c-2268281afb64"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl12"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Nu]0", "=", "100000"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "plots", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "\[Nu]", ",", "vv12", ",", 
       "ff", ",", "gg"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"DawsonF", "[", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "/", 
           "\[Nu]0"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]0"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{
        RowBox[{"Sec", "[", 
         RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "\[Nu]0"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileCounterBeam", "[", 
            RowBox[{"n0", ",", "\[Beta]", ",", "vs", ",", "\[Nu]"}], "]"}], 
           ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileCounterBeam", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]", " ", "gT"}], ",", "vs", ",", "\[Nu]"}], "]"}],
            ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vhist", "[", "\"\<df\>\"", "]"}], "//", "Reverse"}],
                 ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Divide", ",", 
                  RowBox[{"Subtract", "@@@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRangePadding", "->", 
               RowBox[{"Thread", "[", 
                RowBox[{"Scaled", "[", 
                 RowBox[{".02", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[734]:=",ExpressionUUID->"2ae1959d-ae38-4ff3-94a2-215a15b4a6e6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Counter beam - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Nu]", "0"], "=", "1"}], TraditionalForm]],ExpressionUUID->
  "e4026eed-fd2b-47a0-8b18-6518e2fd7a59"]
}], "Subsubsection",ExpressionUUID->"425c0b4d-707b-4e30-9d81-0bacf5478281"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl13", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "13"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"v1lim", "=", 
        RowBox[{"2.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v2lim", "=", 
        RowBox[{"2.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "vhist", ",", "q1", ",", "rhist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vhist", "=", 
         RowBox[{"calVelocityHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"v1lim", ",", "Nv1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v2lim", ",", "Nv2"}], "}"}], ",", "q1lim"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nv\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl13"}]}], "Input",
 CellLabel->
  "In[735]:=",ExpressionUUID->"7ede2f19-f009-4a5c-8a46-7b26e09fcfb4"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl13"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Nu]0", "=", "1"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "plots", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "\[Nu]", ",", "vv12", ",", 
       "ff", ",", "gg"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"DawsonF", "[", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "/", 
           "\[Nu]0"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]0"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{
        RowBox[{"Sec", "[", 
         RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "\[Nu]0"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileCounterBeam", "[", 
            RowBox[{"n0", ",", "\[Beta]", ",", "vs", ",", "\[Nu]"}], "]"}], 
           ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileCounterBeam", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]", " ", "gT"}], ",", "vs", ",", "\[Nu]"}], "]"}],
            ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vhist", "[", "\"\<df\>\"", "]"}], "//", "Reverse"}],
                 ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Divide", ",", 
                  RowBox[{"Subtract", "@@@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRangePadding", "->", 
               RowBox[{"Thread", "[", 
                RowBox[{"Scaled", "[", 
                 RowBox[{".02", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[737]:=",ExpressionUUID->"9150111a-7c50-4ba0-9fee-8a357fc77a15"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Counter beam - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["v", "0"], "=", "0.1"}], TraditionalForm]],ExpressionUUID->
  "16a9cdee-7af5-439c-bd7f-01b404a774cd"]
}], "Subsubsection",ExpressionUUID->"e60b2247-50ac-4405-bbdb-493619026322"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl14", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "14"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"v1lim", "=", 
        RowBox[{"2.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v2lim", "=", 
        RowBox[{"0.7", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "vhist", ",", "q1", ",", "rhist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vhist", "=", 
         RowBox[{"calVelocityHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"v1lim", ",", "Nv1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v2lim", ",", "Nv2"}], "}"}], ",", "q1lim"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nv\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl14"}]}], "Input",
 CellLabel->
  "In[738]:=",ExpressionUUID->"922fdd4b-1f2c-464d-b78f-98eed0571d1a"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl14"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Nu]0", "=", ".1"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "plots", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "\[Nu]", ",", "vv12", ",", 
       "ff", ",", "gg"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"DawsonF", "[", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "/", 
           "\[Nu]0"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]0"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{
        RowBox[{"Sec", "[", 
         RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "\[Nu]0"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileCounterBeam", "[", 
            RowBox[{"n0", ",", "\[Beta]", ",", "vs", ",", "\[Nu]"}], "]"}], 
           ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileCounterBeam", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]", " ", "gT"}], ",", "vs", ",", "\[Nu]"}], "]"}],
            ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vhist", "[", "\"\<df\>\"", "]"}], "//", "Reverse"}],
                 ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Divide", ",", 
                  RowBox[{"Subtract", "@@@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRangePadding", "->", 
               RowBox[{"Thread", "[", 
                RowBox[{"Scaled", "[", 
                 RowBox[{".02", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[740]:=",ExpressionUUID->"d6f70ad5-fa18-4fe0-84df-eff5abcac98b"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Relativistic", "Section",ExpressionUUID->"049bdef6-6ff3-441e-9834-854918644d50"],

Cell[CellGroupData[{

Cell["Energy", "Subsection",ExpressionUUID->"d6bbe9ce-e81c-4417-8a75-9db60646a1a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"energy", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"stride", "=", "8"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "step", ",", "time", ",", "dB2O2", ",", "dE2O2", ",", "mv2O2", ",", 
         "m\[Theta]2O2", ",", "\[IndentingNewLine]", 
         RowBox[{"data", "=", 
          RowBox[{
           RowBox[{"Chop", "@", 
            RowBox[{"Map", "[", 
             RowBox[{"Last", ",", 
              RowBox[{"SplitBy", "[", 
               RowBox[{
                RowBox[{"SortBy", "[", 
                 RowBox[{
                  RowBox[{"Import", "[", 
                   RowBox[{
                    RowBox[{"FileNameJoin", "[", 
                    RowBox[{"{", 
                    RowBox[{"wd", ",", "\"\<energy.csv\>\""}], "}"}], "]"}], 
                    ",", "\"\<CSV\>\"", ",", 
                    RowBox[{"\"\<HeaderLines\>\"", "\[Rule]", "1"}]}], "]"}], 
                  ",", "First"}], "]"}], ",", "First"}], "]"}]}], "]"}]}], "//",
            "Transpose"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"step", ",", "time"}], "}"}], "=", 
         RowBox[{"Take", "[", 
          RowBox[{"data", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"data", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dB2O2", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"Take", "[", 
           RowBox[{"data", ",", "3"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"data", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dE2O2", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"Take", "[", 
           RowBox[{"data", ",", "3"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"data", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"Take", "[", 
               RowBox[{"#", ",", "4"}], "]"}], "]"}], ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"Drop", "[", 
               RowBox[{"#", ",", "4"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
          RowBox[{"Partition", "[", 
           RowBox[{"data", ",", "stride"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"mv2O2", ",", "m\[Theta]2O2"}], "}"}], "=", 
         RowBox[{"data", "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<step\>\"", "\[Rule]", "step"}], ",", 
          RowBox[{"\"\<time\>\"", "\[Rule]", "time"}], ",", 
          RowBox[{"\"\<dB2O2\>\"", "->", "dB2O2"}], ",", 
          RowBox[{"\"\<dE2O2\>\"", "->", "dE2O2"}], ",", 
          RowBox[{"\"\<mv2O2\>\"", "->", "mv2O2"}], ",", 
          RowBox[{"\"\<m\[Theta]2O2\>\"", "->", "m\[Theta]2O2"}]}], "]"}]}]}],
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[749]:=",ExpressionUUID->"5af87966-7ad5-4915-b423-a530c1b88ade"],

Cell[BoxData[
 RowBox[{"Dimensions", "/@", "energy"}]], "Input",
 CellLabel->
  "In[750]:=",ExpressionUUID->"01777970-3e72-4129-8b96-05a4ad95277a"],

Cell[BoxData[
 RowBox[{"dynamic", "=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"energy", "=", "energy"}], ",", 
      RowBox[{"tlim", "=", 
       RowBox[{"Interval", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "Infinity"}], "}"}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"time", ",", "pos", ",", "dB2O2", ",", "dE2O2", ",", "mv2O2"}],
        "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"time", "=", 
        RowBox[{"energy", "[", "\"\<time\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"time", ",", 
          RowBox[{"$_Real", "/;", 
           RowBox[{"IntervalMemberQ", "[", 
            RowBox[{"tlim", ",", "$"}], "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "pos", "]"}], "\[LessEqual]", "1"}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<no time selected\>\"", "]"}], ";", 
            RowBox[{"Abort", "[", "]"}]}], ")"}], ",", 
          RowBox[{"pos", "//", "Extract"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"time", "=", 
        RowBox[{"pos", "[", "time", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dB2O2", "=", 
        RowBox[{
         RowBox[{"energy", "[", "\"\<dB2O2\>\"", "]"}], "//", "pos"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dE2O2", "=", 
        RowBox[{
         RowBox[{"energy", "[", "\"\<dE2O2\>\"", "]"}], "//", "pos"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mv2O2", "=", 
        RowBox[{
         RowBox[{"pos", "/@", 
          RowBox[{"energy", "[", "\"\<mv2O2\>\"", "]"}]}], "//", "Total"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{"#", ",", "\[IndentingNewLine]", 
            RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"AspectRatio", "\[Rule]", 
             RowBox[{"1", "/", "3"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Frame", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
           "]"}], "&"}], "/@", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"dB2O2", "//", "Transpose"}], ",", 
             RowBox[{"DataRange", "\[Rule]", 
              RowBox[{"time", "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", "\"\<dB^2/2\>\""}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"dE2O2", "//", "Transpose"}], ",", 
             RowBox[{"DataRange", "\[Rule]", 
              RowBox[{"time", "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", "\"\<dE^2/2\>\""}]}], "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Rest", "/@", "mv2O2"}], "//", "Transpose"}], ",", 
             RowBox[{"DataRange", "\[Rule]", 
              RowBox[{"time", "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", "\"\<mv^2/2\>\""}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#", ",", 
                 RowBox[{"#2", "-", 
                  RowBox[{"First", "[", "#2", "]"}]}], ",", 
                 RowBox[{"#", "+", "#2", "-", 
                  RowBox[{"First", "[", "#2", "]"}]}]}], "}"}], "&"}], "@@", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Plus", "@@@", 
                 RowBox[{"(", 
                  RowBox[{"dB2O2", "+", "dE2O2"}], ")"}]}], ",", 
                RowBox[{"First", "/@", "mv2O2"}]}], "}"}]}], ",", 
             RowBox[{"DataRange", "\[Rule]", 
              RowBox[{"time", "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", "\"\<Total\>\""}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "}"}]}], "//", "Column"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellLabel->
  "In[751]:=",ExpressionUUID->"7328c186-3089-40c8-b97d-7a65c857185d"],

Cell[BoxData[
 RowBox[{"dynamic", "=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"energy", "=", "energy"}], ",", 
      RowBox[{"tlim", "=", 
       RowBox[{"Interval", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "Infinity"}], "}"}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "time", ",", "pos", ",", "mv2O2", ",", "mU2O2", ",", "m\[Theta]2O2", 
        ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"time", "=", 
        RowBox[{"energy", "[", "\"\<time\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"time", ",", 
          RowBox[{"$_Real", "/;", 
           RowBox[{"IntervalMemberQ", "[", 
            RowBox[{"tlim", ",", "$"}], "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "pos", "]"}], "\[LessEqual]", "1"}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<no time selected\>\"", "]"}], ";", 
            RowBox[{"Abort", "[", "]"}]}], ")"}], ",", 
          RowBox[{"pos", "//", "Extract"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"time", "=", 
        RowBox[{"pos", "[", "time", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mv2O2", "=", 
        RowBox[{"pos", "/@", 
         RowBox[{"energy", "[", "\"\<mv2O2\>\"", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"m\[Theta]2O2", "=", 
        RowBox[{"pos", "/@", 
         RowBox[{"energy", "[", "\"\<m\[Theta]2O2\>\"", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mU2O2", "=", 
        RowBox[{"mv2O2", "-", "m\[Theta]2O2"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"plots", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Show", "[", 
            RowBox[{"#", ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "\[Rule]", "Small"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Frame", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
            "]"}], "&"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"ListPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"RotateLeft", "/@", "#"}], "//", "Transpose"}], ",", 
                
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"time", "[", 
                  RowBox[{"[", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
                RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "/@",
              "mv2O2"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"ListPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"RotateLeft", "/@", "#"}], "//", "Transpose"}], ",", 
                
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"time", "[", 
                  RowBox[{"[", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
                RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "/@",
              "m\[Theta]2O2"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"ListPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"RotateLeft", "/@", "#"}], "//", "Transpose"}], ",", 
                
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"time", "[", 
                  RowBox[{"[", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
                RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "/@",
              "mU2O2"}]}], "\[IndentingNewLine]", "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{
          RowBox[{"plots", "//", "Transpose"}], ",", 
          RowBox[{"Text", "/@", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Kinetic\>\"", ",", "\"\<Thermal\>\"", ",", "\"\<Bulk\>\""}], 
            "}"}]}]}], "]"}], "//", "Grid"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[752]:=",ExpressionUUID->"fcab10d7-7b6d-4ee9-b2d1-81e593575264"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"energy", "=", "energy"}], ",", 
     RowBox[{"tlim", "=", 
      RowBox[{"Interval", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", "Infinity"}], "}"}], "]"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "time", ",", "pos", ",", "mv2O2", ",", "mU2O2", ",", "m\[Theta]2O2", 
       ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"time", "=", 
       RowBox[{"energy", "[", "\"\<time\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"Position", "[", 
        RowBox[{"time", ",", 
         RowBox[{"$_Real", "/;", 
          RowBox[{"IntervalMemberQ", "[", 
           RowBox[{"tlim", ",", "$"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "pos", "]"}], "\[LessEqual]", "1"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<no time selected\>\"", "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}], ")"}], ",", 
         RowBox[{"pos", "//", "Extract"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"time", "=", 
       RowBox[{"pos", "[", "time", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mv2O2", "=", 
       RowBox[{"pos", "/@", 
        RowBox[{"energy", "[", "\"\<mv2O2\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"m\[Theta]2O2", "=", 
       RowBox[{"pos", "/@", 
        RowBox[{"energy", "[", "\"\<m\[Theta]2O2\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mU2O2", "=", 
       RowBox[{"mv2O2", "-", "m\[Theta]2O2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{"#", ",", "\[IndentingNewLine]", 
            RowBox[{"ImageSize", "\[Rule]", "Small"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Frame", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
           "]"}], "&"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"RotateLeft", "[", 
                RowBox[{"#", "-", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"time", "[", 
                 RowBox[{"[", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "/@", 
            
            RowBox[{"Map", "[", 
             RowBox[{"Transpose", ",", "mv2O2"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"RotateLeft", "[", 
                RowBox[{"#", "-", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"time", "[", 
                 RowBox[{"[", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "/@", 
            
            RowBox[{"Map", "[", 
             RowBox[{"Transpose", ",", "m\[Theta]2O2"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"RotateLeft", "[", 
                RowBox[{"#", "-", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"time", "[", 
                 RowBox[{"[", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "/@", 
            
            RowBox[{"Map", "[", 
             RowBox[{"Transpose", ",", "mU2O2"}], "]"}]}]}], 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Prepend", "[", 
        RowBox[{
         RowBox[{"plots", "//", "Transpose"}], ",", 
         RowBox[{"Text", "/@", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Kinetic\>\"", ",", "\"\<Thermal\>\"", ",", "\"\<Bulk\>\""}], 
           "}"}]}]}], "]"}], "//", "Grid"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[753]:=",ExpressionUUID->"9fdae9ed-6252-4ec2-b7e6-89d9ab850e3d"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"energy", "=", "energy"}], ",", 
     RowBox[{"tlim", "=", 
      RowBox[{"Interval", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", "Infinity"}], "}"}], "]"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"time", ",", "pos", ",", "m\[Theta]2O2", ",", "T1", ",", "T2"}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"time", "=", 
       RowBox[{"energy", "[", "\"\<time\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"Position", "[", 
        RowBox[{"time", ",", 
         RowBox[{"$_Real", "/;", 
          RowBox[{"IntervalMemberQ", "[", 
           RowBox[{"tlim", ",", "$"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "pos", "]"}], "\[LessEqual]", "1"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<no time selected\>\"", "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}], ")"}], ",", 
         RowBox[{"pos", "//", "Extract"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"time", "=", 
       RowBox[{"pos", "[", "time", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"m\[Theta]2O2", "=", 
       RowBox[{"Map", "[", 
        RowBox[{"pos", ",", 
         RowBox[{"energy", "[", "\"\<m\[Theta]2O2\>\"", "]"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"m\[Theta]2O2", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{"#", ",", "2"}], "]"}], ",", 
            RowBox[{".5", 
             RowBox[{"Plus", "@@", 
              RowBox[{"Drop", "[", 
               RowBox[{"#", ",", "2"}], "]"}]}]}]}], "}"}], "&"}], ",", 
         "m\[Theta]2O2", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T1", "=", 
       RowBox[{
        RowBox[{"Chop", "[", 
         RowBox[{"m\[Theta]2O2", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "All", ",", "1"}], "]"}], "]"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"0", "\[Rule]", "Indeterminate"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"T2", "=", 
       RowBox[{
        RowBox[{"Chop", "[", 
         RowBox[{"m\[Theta]2O2", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"0", "\[Rule]", "Indeterminate"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{"#", ",", "\[IndentingNewLine]", 
           RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Frame", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
          "]"}], "&"}], "/@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"T1", "/", 
             RowBox[{"T1", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
            RowBox[{"DataRange", "\[Rule]", 
             RowBox[{"time", "[", 
              RowBox[{"[", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{
            "FrameLabel", "\[Rule]", 
             "\"\<\\!\\(\!\(\*SubscriptBox[\(T\), \
\(\[DoubleVerticalBar]\)]\)(t)/\!\(\*SubscriptBox[\(T\), \(\
\[DoubleVerticalBar]\)]\)(0)\\)\>\""}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"T2", "/", 
             RowBox[{"T1", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
            RowBox[{"DataRange", "\[Rule]", 
             RowBox[{"time", "[", 
              RowBox[{"[", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{
            "FrameLabel", "\[Rule]", 
             "\"\<\\!\\(\!\(\*SubscriptBox[\(T\), \
\(\[UpTee]\)]\)(t)/\!\(\*SubscriptBox[\(T\), \
\(\[DoubleVerticalBar]\)]\)(0)\\)\>\""}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
         "\[IndentingNewLine]", "}"}]}], "//", "Column"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[754]:=",ExpressionUUID->"b3a0de19-ea50-4af9-b6fb-aec6c87ba033"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Moment", "Subsection",ExpressionUUID->"8bab2c33-d95c-41f6-a9df-a55c1f8da90f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"metadata", "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"files", "=", 
        RowBox[{"FileNames", "[", 
         RowBox[{"\"\<moment-*.h5\>\"", ",", "wd"}], "]"}]}], ",", "attrs", 
       ",", "steps", ",", "times", ",", "pos"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"attrs", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<HDF5\>\"", ",", "\"\<Attributes\>\"", ",", 
             "\"\</moment\>\""}], "}"}]}], "]"}], "&"}], "/@", "files"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{
        RowBox[{"Lookup", "[", "\"\<step\>\"", "]"}], "/@", "attrs"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"times", "=", 
       RowBox[{
        RowBox[{"Lookup", "[", "\"\<time\>\"", "]"}], "/@", "attrs"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"List", "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "times", "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"First", "/@", 
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"pos", ",", "times"}], "}"}], "]"}], ",", "Last"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"steps", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"times", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"times", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"files", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"files", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Association", "[", 
       RowBox[{
        RowBox[{"\"\<attr\>\"", "->", 
         RowBox[{"KeyDrop", "[", 
          RowBox[{
           RowBox[{"First", "[", "attrs", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<step\>\"", ",", "\"\<time\>\""}], "}"}]}], "]"}]}], 
        ",", 
        RowBox[{"\"\<step\>\"", "->", "steps"}], ",", 
        RowBox[{"\"\<time\>\"", "->", "times"}], ",", 
        RowBox[{"\"\<files\>\"", "->", "files"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[755]:=",ExpressionUUID->"7fe74a65-87d2-41fd-9f7e-6086933d5ee9"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compileBiMaxwellian", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compileBiMaxwellian", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]1_", "?", "Positive"}], ",", 
    RowBox[{"T2OT1_", "?", "Positive"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]1", "=", 
       SqrtBox[
        RowBox[{"N", "[", "\[Beta]1", "]"}]]}], ",", 
      RowBox[{"\[Theta]2", "=", 
       SqrtBox[
        RowBox[{
         RowBox[{"N", "[", "\[Beta]1", "]"}], "T2OT1"}]]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"n", " ", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"v1", "^", "2"}]}], "/", 
            RowBox[{"\[Theta]1", "^", "2"}]}], "-", 
           RowBox[{
            RowBox[{"v2", "^", "2"}], "/", 
            RowBox[{"\[Theta]2", "^", "2"}]}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"Pi", "^", "1.5"}], " ", "\[Theta]1", " ", 
          RowBox[{"\[Theta]2", "^", "2"}]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[756]:=",ExpressionUUID->"3510a4dc-20bc-4764-8fcd-94131ca416fe"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compileLossCone", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compileLossCone", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]1_", "?", "Positive"}], ",", 
    RowBox[{"T2OT1_", "?", "Positive"}], ",", 
    RowBox[{"\[Beta]_Real", "?", "Positive"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]1", "=", 
       SqrtBox[
        RowBox[{"N", "[", "\[Beta]1", "]"}]]}], ",", 
      RowBox[{"\[Theta]2", "=", 
       SqrtBox[
        RowBox[{
         RowBox[{"N", "[", "\[Beta]1", "]"}], 
         RowBox[{"T2OT1", "/", 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}]]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Beta]"}], ")"}]}], 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"v1", "^", "2"}]}], "/", 
            RowBox[{"\[Theta]1", "^", "2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"v2", "^", "2"}]}], "/", 
              RowBox[{"\[Theta]2", "^", "2"}]}], "]"}], "-", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"v2", "^", "2"}]}], "/", 
               RowBox[{"\[Theta]2", "^", "2"}]}], "/", "\[Beta]"}], "]"}]}], 
           ")"}]}], ",", 
         RowBox[{
          RowBox[{"Pi", "^", "1.5"}], " ", "\[Theta]1", " ", 
          RowBox[{"\[Theta]2", "^", "2"}]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[758]:=",ExpressionUUID->"298398bb-8b8b-4a10-8c21-2ff961485459"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compilePartialShell", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compilePartialShell", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]_", "?", "Positive"}], ",", 
    RowBox[{"\[Zeta]_Integer", "?", "NonNegative"}], ",", 
    RowBox[{"vs_", "?", "NonNegative"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]", "=", 
       RowBox[{"N", "[", 
        SqrtBox["\[Beta]"], "]"}]}], ",", 
      RowBox[{"xs", "=", 
       RowBox[{"N", "[", 
        RowBox[{"vs", "/", 
         SqrtBox["\[Beta]"]}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{".5", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"vs", "/", 
            SqrtBox["\[Beta]"]}], 
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"vs", "/", 
                SqrtBox["\[Beta]"]}], ")"}], "^", "2"}]}], "]"}]}], "+", 
          RowBox[{
           SqrtBox["\[Pi]"], 
           RowBox[{"(", 
            RowBox[{".5", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"vs", "/", 
                SqrtBox["\[Beta]"]}], ")"}], "^", "2"}]}], ")"}], 
           RowBox[{"Erfc", "[", 
            RowBox[{
             RowBox[{"-", "vs"}], "/", 
             SqrtBox["\[Beta]"]}], "]"}]}]}], ")"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"B\[Zeta]", "=", 
       RowBox[{
        SqrtBox["\[Pi]"], 
        RowBox[{
         RowBox[{"Gamma", "[", 
          RowBox[{"1", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}], "/", 
         RowBox[{"Gamma", "[", 
          RowBox[{"1.5", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "x1", ",", "x2", ",", "\[Mu]"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x2", "=", 
          RowBox[{"v2", "/", "\[Theta]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x1", "=", 
          RowBox[{"v1", "/", "\[Theta]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x", "=", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"x1", "^", "2"}], "+", 
            RowBox[{"x2", "^", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Mu]", "=", 
          RowBox[{"x1", "/", "x"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"n", " ", 
          RowBox[{"Divide", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"x", "-", "xs"}], ")"}], "^", "2"}]}], "]"}], 
             RowBox[{"Power", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "\[Mu]"}], ")"}], 
                RowBox[{"(", 
                 RowBox[{"1", "+", "\[Mu]"}], ")"}]}], ",", 
               RowBox[{".5", "\[Zeta]"}]}], "]"}]}], ",", 
            RowBox[{"2", "Pi", " ", 
             RowBox[{"\[Theta]", "^", "3"}], "Ab", " ", "B\[Zeta]"}]}], 
           "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[760]:=",ExpressionUUID->"e40fce72-be50-45ca-a8e6-1b607548d481"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compileCounterBeam", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compileCounterBeam", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]_", "?", "Positive"}], ",", 
    RowBox[{"vs_", "?", "NonNegative"}], ",", 
    RowBox[{"\[Nu]_", "?", "Positive"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]", "=", 
       RowBox[{"N", "[", 
        SqrtBox["\[Beta]"], "]"}]}], ",", 
      RowBox[{"xs", "=", 
       RowBox[{"N", "[", 
        RowBox[{"vs", "/", 
         SqrtBox["\[Beta]"]}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{".5", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"vs", "/", 
            SqrtBox["\[Beta]"]}], 
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"vs", "/", 
                SqrtBox["\[Beta]"]}], ")"}], "^", "2"}]}], "]"}]}], "+", 
          RowBox[{
           SqrtBox["\[Pi]"], 
           RowBox[{"(", 
            RowBox[{".5", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"vs", "/", 
                SqrtBox["\[Beta]"]}], ")"}], "^", "2"}]}], ")"}], 
           RowBox[{"Erfc", "[", 
            RowBox[{
             RowBox[{"-", "vs"}], "/", 
             SqrtBox["\[Beta]"]}], "]"}]}]}], ")"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"B\[Nu]", "=", 
       RowBox[{"2", "\[Nu]", " ", 
        RowBox[{"DawsonF", "[", 
         RowBox[{"1", "/", "\[Nu]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"u1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"u2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x1", ",", "x2", ",", "x", ",", "\[Mu]", ",", "f0"}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x2", "=", 
          RowBox[{"u2", "/", "\[Theta]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x1", "=", 
          RowBox[{"u1", "/", "\[Theta]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x", "=", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"x1", "^", "2"}], "+", 
            RowBox[{"x2", "^", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Mu]", "=", 
          RowBox[{"x1", "/", "x"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"n", " ", 
          RowBox[{"Divide", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"x", "-", "xs"}], ")"}], "^", "2"}]}], "]"}], 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "\[Mu]"}], ")"}], 
                  RowBox[{"(", 
                   RowBox[{"1", "+", "\[Mu]"}], ")"}]}], ")"}]}], "/", 
               RowBox[{"\[Nu]", "^", "2"}]}], "]"}]}], ",", 
            RowBox[{"2", "Pi", " ", 
             RowBox[{"\[Theta]", "^", "3"}], "Ab", " ", "B\[Nu]"}]}], 
           "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[762]:=",ExpressionUUID->"937a4f23-f60b-45c0-9c8f-3cde34fc2c75"],

Cell[CellGroupData[{

Cell["Maxwellian", "Subsubsection",ExpressionUUID->"ddc277b0-c34c-48ad-a79c-e36819923521"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom1", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "1"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<n\>\"", ",", "\"\<time\>\"", ",", "\"\<n\[Gamma]cc\>\""}], 
           "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<c\>\""}], "}"}], "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importRelativisticMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom1"}]}], "Input",
 CellLabel->
  "In[764]:=",ExpressionUUID->"7a555eae-a0a9-4fed-82b9-c337510fe03c"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom1"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"T2OT1eq", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "q1", ",", "\[Xi]\[CapitalDelta]1", ",", "\[Eta]", ",", "n0", ",", 
       "T2OT1", ",", "n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", 
       "n\[Gamma]v2v2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{"T2OT1eq", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "T2OT1eq"}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{"T2OT1eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}],
         "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"n0", ",", "T2OT1"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\[Theta]1", ",", "\[Theta]2", ",", "\[Gamma]v1", ",", 
               "\[Gamma]v2", ",", "dV", ",", "\[Gamma]vv1", ",", 
               "\[Gamma]vv2", ",", "\[Gamma]\[Gamma]", ",", "ff"}], "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\[Theta]1", "=", 
               SqrtBox["\[Beta]1"]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Theta]2", "=", 
               SqrtBox[
                RowBox[{"\[Beta]1", " ", "T2OT1"}]]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v1", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "501", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "4", 
                    "\[Theta]1"}]}], "]"}], ",", "2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v2", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "251", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], "4", "\[Theta]2"}]}], 
                  "]"}], ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"dV", "=", 
               RowBox[{"2", "\[Pi]", " ", "\[Gamma]vv2", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "}"}], "=", 
               RowBox[{"Transpose", "[", 
                RowBox[{"Tuples", "[", 
                 RowBox[{"{", 
                  RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]\[Gamma]", "=", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"1", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[Gamma]vv1", "^", "2"}], "+", 
                    RowBox[{"\[Gamma]vv2", "^", "2"}]}], ")"}], "/", 
                  RowBox[{
                   RowBox[{"moment", "[", "\"\<c\>\"", "]"}], "^", "2"}]}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"ff", "=", 
               RowBox[{
                RowBox[{"compileBiMaxwellian", "[", 
                 RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1"}], "]"}], "[", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n", "=", 
               RowBox[{"Total", "[", 
                RowBox[{"ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"nV1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{"\[Gamma]vv1", "/", "\[Gamma]\[Gamma]"}], "*", "ff", 
                 "*", "dV"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v1v1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Gamma]vv1", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v2v2", "=", 
               RowBox[{"Total", "[", 
                RowBox[{".5", 
                 RowBox[{
                  RowBox[{"\[Gamma]vv2", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}], 
               "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", "Listable", "}"}]}], "\[IndentingNewLine]", "]"}], 
         "[", 
         RowBox[{"n0", ",", "T2OT1"}], "]"}], "\[Transpose]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"GridLinesStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "nV1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v1v1\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v1v1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v2v2\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v3v3\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[766]:=",ExpressionUUID->"16d8e1ea-6c16-43c7-bdb1-9cb8ada304dc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bi-Maxwellian", "Subsubsection",ExpressionUUID->"cfb74493-f898-425d-8e91-4d90c50a2157"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom2", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "2"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<n\>\"", ",", "\"\<time\>\"", ",", "\"\<n\[Gamma]cc\>\""}], 
           "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<c\>\""}], "}"}], "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importRelativisticMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom2"}]}], "Input",
 CellLabel->
  "In[767]:=",ExpressionUUID->"6aca6b0c-7305-4db1-a30d-6e095dece959"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom2"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"T2OT1eq", "=", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "q1", ",", "\[Xi]\[CapitalDelta]1", ",", "\[Eta]", ",", "n0", ",", 
       "T2OT1", ",", "n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", 
       "n\[Gamma]v2v2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{"T2OT1eq", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "T2OT1eq"}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{"T2OT1eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}],
         "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"n0", ",", "T2OT1"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\[Theta]1", ",", "\[Theta]2", ",", "\[Gamma]v1", ",", 
               "\[Gamma]v2", ",", "dV", ",", "\[Gamma]vv1", ",", 
               "\[Gamma]vv2", ",", "\[Gamma]\[Gamma]", ",", "ff"}], "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\[Theta]1", "=", 
               SqrtBox["\[Beta]1"]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Theta]2", "=", 
               SqrtBox[
                RowBox[{"\[Beta]1", " ", "T2OT1"}]]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v1", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "501", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "4", 
                    "\[Theta]1"}]}], "]"}], ",", "2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v2", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "251", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], "4", "\[Theta]2"}]}], 
                  "]"}], ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"dV", "=", 
               RowBox[{"2", "\[Pi]", " ", "\[Gamma]vv2", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "}"}], "=", 
               RowBox[{"Transpose", "[", 
                RowBox[{"Tuples", "[", 
                 RowBox[{"{", 
                  RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]\[Gamma]", "=", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"1", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[Gamma]vv1", "^", "2"}], "+", 
                    RowBox[{"\[Gamma]vv2", "^", "2"}]}], ")"}], "/", 
                  RowBox[{
                   RowBox[{"moment", "[", "\"\<c\>\"", "]"}], "^", "2"}]}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"ff", "=", 
               RowBox[{
                RowBox[{"compileBiMaxwellian", "[", 
                 RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1"}], "]"}], "[", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n", "=", 
               RowBox[{"Total", "[", 
                RowBox[{"ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"nV1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{"\[Gamma]vv1", "/", "\[Gamma]\[Gamma]"}], "*", "ff", 
                 "*", "dV"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v1v1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Gamma]vv1", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v2v2", "=", 
               RowBox[{"Total", "[", 
                RowBox[{".5", 
                 RowBox[{
                  RowBox[{"\[Gamma]vv2", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}], 
               "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", "Listable", "}"}]}], "\[IndentingNewLine]", "]"}], 
         "[", 
         RowBox[{"n0", ",", "T2OT1"}], "]"}], "\[Transpose]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"GridLinesStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "nV1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v1v1\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v1v1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v2v2\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v3v3\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[769]:=",ExpressionUUID->"b09322f1-58bf-4f3d-8718-bec806aa24f0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Losscone - Maxwellian", "Subsubsection",ExpressionUUID->"9d1ccb1f-8b24-4f8f-ba47-7fded7019e4e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom3", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "3"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<n\>\"", ",", "\"\<time\>\"", ",", "\"\<n\[Gamma]cc\>\""}], 
           "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<c\>\""}], "}"}], "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importRelativisticMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom3"}]}], "Input",
 CellLabel->
  "In[770]:=",ExpressionUUID->"41c9806f-94b8-4d02-ae04-ef94c4e9e016"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom3"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["1"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "1.0*^-10"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "q1", ",", "\[Xi]\[CapitalDelta]1", ",", "\[Eta]", ",", "\[Eta]\[Beta]",
        ",", "n0", ",", "\[Beta]", ",", "\[Theta]2O\[Theta]1", ",", "n", ",", 
       "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}],
         "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"n0", ",", "\[Theta]2O\[Theta]1", ",", "\[Beta]"}], "}"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "T2OT1", ",", "\[Theta]1", ",", "\[Theta]2", ",", "\[Gamma]v1", 
               ",", "\[Gamma]v2", ",", "dV", ",", "\[Gamma]vv1", ",", 
               "\[Gamma]vv2", ",", "\[Gamma]\[Gamma]", ",", "ff"}], "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"T2OT1", "=", 
               RowBox[{
                RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
                RowBox[{"(", 
                 RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"\[Theta]1", "=", 
               SqrtBox["\[Beta]1"]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Theta]2", "=", 
               RowBox[{
                SqrtBox["\[Beta]1"], "\[Theta]2O\[Theta]1"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v1", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "501", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "5", 
                    "\[Theta]1"}]}], "]"}], ",", "2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v2", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "251", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], "5", "\[Theta]2"}]}], 
                  "]"}], ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"dV", "=", 
               RowBox[{"2", "\[Pi]", " ", "\[Gamma]vv2", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "}"}], "=", 
               RowBox[{"Transpose", "[", 
                RowBox[{"Tuples", "[", 
                 RowBox[{"{", 
                  RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]\[Gamma]", "=", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"1", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[Gamma]vv1", "^", "2"}], "+", 
                    RowBox[{"\[Gamma]vv2", "^", "2"}]}], ")"}], "/", 
                  RowBox[{
                   RowBox[{"moment", "[", "\"\<c\>\"", "]"}], "^", "2"}]}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"ff", "=", 
               RowBox[{
                RowBox[{"compileLossCone", "[", 
                 RowBox[{
                 "n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], "]"}],
                 "[", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n", "=", 
               RowBox[{"Total", "[", 
                RowBox[{"ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"nV1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{"\[Gamma]vv1", "/", "\[Gamma]\[Gamma]"}], "*", "ff", 
                 "*", "dV"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v1v1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Gamma]vv1", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v2v2", "=", 
               RowBox[{"Total", "[", 
                RowBox[{".5", 
                 RowBox[{
                  RowBox[{"\[Gamma]vv2", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}], 
               "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", "Listable", "}"}]}], "\[IndentingNewLine]", "]"}], 
         "[", 
         RowBox[{"n0", ",", "\[Theta]2O\[Theta]1", ",", "\[Beta]"}], "]"}], 
        "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"GridLinesStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "nV1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v1v1\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v1v1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v2v2\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v3v3\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[772]:=",ExpressionUUID->"5974ab6e-13db-4e00-9c87-b9006dc9260a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Losscone - Bi-Maxwellian", "Subsubsection",ExpressionUUID->"47a11008-a6c4-4886-a479-09376b05a9bd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom4", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "4"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<n\>\"", ",", "\"\<time\>\"", ",", "\"\<n\[Gamma]cc\>\""}], 
           "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<c\>\""}], "}"}], "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importRelativisticMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom4"}]}], "Input",
 CellLabel->
  "In[773]:=",ExpressionUUID->"237d1028-5bf3-4148-89a6-ff43d9df1091"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom4"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "1.0*^-10"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "q1", ",", "\[Xi]\[CapitalDelta]1", ",", "\[Eta]", ",", "\[Eta]\[Beta]",
        ",", "n0", ",", "\[Beta]", ",", "\[Theta]2O\[Theta]1", ",", "n", ",", 
       "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}],
         "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"n0", ",", "\[Theta]2O\[Theta]1", ",", "\[Beta]"}], "}"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "T2OT1", ",", "\[Theta]1", ",", "\[Theta]2", ",", "\[Gamma]v1", 
               ",", "\[Gamma]v2", ",", "dV", ",", "\[Gamma]vv1", ",", 
               "\[Gamma]vv2", ",", "\[Gamma]\[Gamma]", ",", "ff"}], "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"T2OT1", "=", 
               RowBox[{
                RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
                RowBox[{"(", 
                 RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"\[Theta]1", "=", 
               SqrtBox["\[Beta]1"]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Theta]2", "=", 
               RowBox[{
                SqrtBox["\[Beta]1"], "\[Theta]2O\[Theta]1"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v1", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "501", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "5", 
                    "\[Theta]1"}]}], "]"}], ",", "2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v2", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "251", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], "5", "\[Theta]2"}]}], 
                  "]"}], ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"dV", "=", 
               RowBox[{"2", "\[Pi]", " ", "\[Gamma]vv2", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "}"}], "=", 
               RowBox[{"Transpose", "[", 
                RowBox[{"Tuples", "[", 
                 RowBox[{"{", 
                  RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]\[Gamma]", "=", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"1", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[Gamma]vv1", "^", "2"}], "+", 
                    RowBox[{"\[Gamma]vv2", "^", "2"}]}], ")"}], "/", 
                  RowBox[{
                   RowBox[{"moment", "[", "\"\<c\>\"", "]"}], "^", "2"}]}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"ff", "=", 
               RowBox[{
                RowBox[{"compileLossCone", "[", 
                 RowBox[{
                 "n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], "]"}],
                 "[", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n", "=", 
               RowBox[{"Total", "[", 
                RowBox[{"ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"nV1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{"\[Gamma]vv1", "/", "\[Gamma]\[Gamma]"}], "*", "ff", 
                 "*", "dV"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v1v1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Gamma]vv1", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v2v2", "=", 
               RowBox[{"Total", "[", 
                RowBox[{".5", 
                 RowBox[{
                  RowBox[{"\[Gamma]vv2", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}], 
               "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", "Listable", "}"}]}], "\[IndentingNewLine]", "]"}], 
         "[", 
         RowBox[{"n0", ",", "\[Theta]2O\[Theta]1", ",", "\[Beta]"}], "]"}], 
        "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"GridLinesStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "nV1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v1v1\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v1v1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v2v2\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v3v3\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[775]:=",ExpressionUUID->"038e52a0-33c0-409e-bec9-540fa4082ead"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Loss cone - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Beta]", "0"], "=", "0.5"}], TraditionalForm]],
  ExpressionUUID->"0ef200c0-a194-4e4f-a500-597529bcd010"]
}], "Subsubsection",ExpressionUUID->"ad1ee675-19c9-4bb5-87f7-6f5c23dc87fe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom5", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "5"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<n\>\"", ",", "\"\<time\>\"", ",", "\"\<n\[Gamma]cc\>\""}], 
           "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<c\>\""}], "}"}], "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importRelativisticMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom5"}]}], "Input",
 CellLabel->
  "In[776]:=",ExpressionUUID->"41f2eafb-7911-420f-8c46-2daaf4790f80"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom5"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", ".5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "q1", ",", "\[Xi]\[CapitalDelta]1", ",", "\[Eta]", ",", "\[Eta]\[Beta]",
        ",", "n0", ",", "\[Beta]", ",", "\[Theta]2O\[Theta]1", ",", "n", ",", 
       "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}],
         "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"n0", ",", "\[Theta]2O\[Theta]1", ",", "\[Beta]"}], "}"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "T2OT1", ",", "\[Theta]1", ",", "\[Theta]2", ",", "\[Gamma]v1", 
               ",", "\[Gamma]v2", ",", "dV", ",", "\[Gamma]vv1", ",", 
               "\[Gamma]vv2", ",", "\[Gamma]\[Gamma]", ",", "ff"}], "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"T2OT1", "=", 
               RowBox[{
                RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
                RowBox[{"(", 
                 RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"\[Theta]1", "=", 
               SqrtBox["\[Beta]1"]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Theta]2", "=", 
               RowBox[{
                SqrtBox["\[Beta]1"], "\[Theta]2O\[Theta]1"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v1", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "501", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "5", 
                    "\[Theta]1"}]}], "]"}], ",", "2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v2", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "251", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], "5", "\[Theta]2"}]}], 
                  "]"}], ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"dV", "=", 
               RowBox[{"2", "\[Pi]", " ", "\[Gamma]vv2", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "}"}], "=", 
               RowBox[{"Transpose", "[", 
                RowBox[{"Tuples", "[", 
                 RowBox[{"{", 
                  RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]\[Gamma]", "=", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"1", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[Gamma]vv1", "^", "2"}], "+", 
                    RowBox[{"\[Gamma]vv2", "^", "2"}]}], ")"}], "/", 
                  RowBox[{
                   RowBox[{"moment", "[", "\"\<c\>\"", "]"}], "^", "2"}]}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"ff", "=", 
               RowBox[{
                RowBox[{"compileLossCone", "[", 
                 RowBox[{
                 "n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], "]"}],
                 "[", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n", "=", 
               RowBox[{"Total", "[", 
                RowBox[{"ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"nV1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{"\[Gamma]vv1", "/", "\[Gamma]\[Gamma]"}], "*", "ff", 
                 "*", "dV"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v1v1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Gamma]vv1", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v2v2", "=", 
               RowBox[{"Total", "[", 
                RowBox[{".5", 
                 RowBox[{
                  RowBox[{"\[Gamma]vv2", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}], 
               "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", "Listable", "}"}]}], "\[IndentingNewLine]", "]"}], 
         "[", 
         RowBox[{"n0", ",", "\[Theta]2O\[Theta]1", ",", "\[Beta]"}], "]"}], 
        "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"GridLinesStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "nV1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v1v1\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v1v1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v2v2\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v3v3\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[778]:=",ExpressionUUID->"14b10031-8666-4e0a-b81f-415a3bbaec35"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Loss cone - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Beta]", "0"], "=", "2.5"}], TraditionalForm]],
  ExpressionUUID->"33e39057-5c44-4293-918f-ba709e4a7fbd"]
}], "Subsubsection",ExpressionUUID->"7cd87267-c2be-498e-ba25-40560d948519"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom6", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "6"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<n\>\"", ",", "\"\<time\>\"", ",", "\"\<n\[Gamma]cc\>\""}], 
           "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<c\>\""}], "}"}], "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importRelativisticMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom6"}]}], "Input",
 CellLabel->
  "In[779]:=",ExpressionUUID->"2d1e5b20-f65e-4c54-bf3c-9f45d6712df2"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom6"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "2.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "q1", ",", "\[Xi]\[CapitalDelta]1", ",", "\[Eta]", ",", "\[Eta]\[Beta]",
        ",", "n0", ",", "\[Beta]", ",", "\[Theta]2O\[Theta]1", ",", "n", ",", 
       "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}],
         "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"n0", ",", "\[Theta]2O\[Theta]1", ",", "\[Beta]"}], "}"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "T2OT1", ",", "\[Theta]1", ",", "\[Theta]2", ",", "\[Gamma]v1", 
               ",", "\[Gamma]v2", ",", "dV", ",", "\[Gamma]vv1", ",", 
               "\[Gamma]vv2", ",", "\[Gamma]\[Gamma]", ",", "ff"}], "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"T2OT1", "=", 
               RowBox[{
                RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
                RowBox[{"(", 
                 RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"\[Theta]1", "=", 
               SqrtBox["\[Beta]1"]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Theta]2", "=", 
               RowBox[{
                SqrtBox["\[Beta]1"], "\[Theta]2O\[Theta]1"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v1", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "501", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "5", 
                    "\[Theta]1"}]}], "]"}], ",", "2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v2", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "251", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], "5", "\[Theta]2"}]}], 
                  "]"}], ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"dV", "=", 
               RowBox[{"2", "\[Pi]", " ", "\[Gamma]vv2", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "}"}], "=", 
               RowBox[{"Transpose", "[", 
                RowBox[{"Tuples", "[", 
                 RowBox[{"{", 
                  RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]\[Gamma]", "=", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"1", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[Gamma]vv1", "^", "2"}], "+", 
                    RowBox[{"\[Gamma]vv2", "^", "2"}]}], ")"}], "/", 
                  RowBox[{
                   RowBox[{"moment", "[", "\"\<c\>\"", "]"}], "^", "2"}]}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"ff", "=", 
               RowBox[{
                RowBox[{"compileLossCone", "[", 
                 RowBox[{
                 "n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], "]"}],
                 "[", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n", "=", 
               RowBox[{"Total", "[", 
                RowBox[{"ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"nV1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{"\[Gamma]vv1", "/", "\[Gamma]\[Gamma]"}], "*", "ff", 
                 "*", "dV"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v1v1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Gamma]vv1", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v2v2", "=", 
               RowBox[{"Total", "[", 
                RowBox[{".5", 
                 RowBox[{
                  RowBox[{"\[Gamma]vv2", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}], 
               "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", "Listable", "}"}]}], "\[IndentingNewLine]", "]"}], 
         "[", 
         RowBox[{"n0", ",", "\[Theta]2O\[Theta]1", ",", "\[Beta]"}], "]"}], 
        "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"GridLinesStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "nV1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v1v1\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v1v1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v2v2\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v3v3\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[781]:=",ExpressionUUID->"1ccfe769-e751-49bc-8e9f-d98fcd25736c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Partial shell - Maxwellian", "Subsubsection",ExpressionUUID->"cdd4ca52-a017-4c36-baf5-a99f5ad778e9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom7", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "7"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<n\>\"", ",", "\"\<time\>\"", ",", "\"\<n\[Gamma]cc\>\""}], 
           "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<c\>\""}], "}"}], "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importRelativisticMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom7"}]}], "Input",
 CellLabel->
  "In[782]:=",ExpressionUUID->"de35aae0-eafc-400a-b227-8ce129d0917a"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom7"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]", "=", "1.5"}], ",", 
     RowBox[{"\[Zeta]", "=", "0"}], ",", 
     RowBox[{"vs", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "q1", ",", "\[Xi]\[CapitalDelta]1", ",", "\[Eta]", ",", "n0", ",", "n", 
       ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}],
         "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", "n0", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\[Theta]", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "dV", 
               ",", "\[Gamma]vv1", ",", "\[Gamma]vv2", ",", 
               "\[Gamma]\[Gamma]", ",", "ff"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\[Theta]", "=", 
               SqrtBox["\[Beta]"]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v1", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "501", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", "\[Theta]"}], "+", "vs"}], ")"}]}]}], "]"}], 
                 ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v2", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "251", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", "\[Theta]"}], "+", "vs"}], ")"}]}]}], "]"}], 
                 ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"dV", "=", 
               RowBox[{"2", "\[Pi]", " ", "\[Gamma]vv2", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "}"}], "=", 
               RowBox[{"Transpose", "[", 
                RowBox[{"Tuples", "[", 
                 RowBox[{"{", 
                  RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]\[Gamma]", "=", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"1", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[Gamma]vv1", "^", "2"}], "+", 
                    RowBox[{"\[Gamma]vv2", "^", "2"}]}], ")"}], "/", 
                  RowBox[{
                   RowBox[{"moment", "[", "\"\<c\>\"", "]"}], "^", "2"}]}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"ff", "=", 
               RowBox[{
                RowBox[{"compilePartialShell", "[", 
                 RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], 
                 "]"}], "[", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n", "=", 
               RowBox[{"Total", "[", 
                RowBox[{"ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"nV1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{"\[Gamma]vv1", "/", "\[Gamma]\[Gamma]"}], "*", "ff", 
                 "*", "dV"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v1v1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Gamma]vv1", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v2v2", "=", 
               RowBox[{"Total", "[", 
                RowBox[{".5", 
                 RowBox[{
                  RowBox[{"\[Gamma]vv2", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}], 
               "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", "Listable", "}"}]}], "\[IndentingNewLine]", "]"}], 
         "[", "n0", "]"}], "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"GridLinesStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "nV1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v1v1\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v1v1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v2v2\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v3v3\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[784]:=",ExpressionUUID->"27492e21-50be-40ed-bf2b-11a024f3cacc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Isotropic shell", "Subsubsection",ExpressionUUID->"f3408f53-1470-4fbc-a420-68ab9b513b5d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom8", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "8"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<n\>\"", ",", "\"\<time\>\"", ",", "\"\<n\[Gamma]cc\>\""}], 
           "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<c\>\""}], "}"}], "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importRelativisticMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom8"}]}], "Input",
 CellLabel->
  "In[785]:=",ExpressionUUID->"71fc302a-b01c-45b9-93e2-2a89905e0be5"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom8"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "0"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "q1", ",", "\[Xi]\[CapitalDelta]1", ",", "\[Eta]", ",", "n0", ",", "n", 
       ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}],
         "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", "n0", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\[Theta]", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "dV", 
               ",", "\[Gamma]vv1", ",", "\[Gamma]vv2", ",", 
               "\[Gamma]\[Gamma]", ",", "ff"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\[Theta]", "=", 
               SqrtBox["\[Beta]"]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v1", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "501", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", "\[Theta]"}], "+", "vs"}], ")"}]}]}], "]"}], 
                 ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v2", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "251", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", "\[Theta]"}], "+", "vs"}], ")"}]}]}], "]"}], 
                 ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"dV", "=", 
               RowBox[{"2", "\[Pi]", " ", "\[Gamma]vv2", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "}"}], "=", 
               RowBox[{"Transpose", "[", 
                RowBox[{"Tuples", "[", 
                 RowBox[{"{", 
                  RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]\[Gamma]", "=", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"1", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[Gamma]vv1", "^", "2"}], "+", 
                    RowBox[{"\[Gamma]vv2", "^", "2"}]}], ")"}], "/", 
                  RowBox[{
                   RowBox[{"moment", "[", "\"\<c\>\"", "]"}], "^", "2"}]}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"ff", "=", 
               RowBox[{
                RowBox[{"compilePartialShell", "[", 
                 RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], 
                 "]"}], "[", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n", "=", 
               RowBox[{"Total", "[", 
                RowBox[{"ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"nV1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{"\[Gamma]vv1", "/", "\[Gamma]\[Gamma]"}], "*", "ff", 
                 "*", "dV"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v1v1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Gamma]vv1", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v2v2", "=", 
               RowBox[{"Total", "[", 
                RowBox[{".5", 
                 RowBox[{
                  RowBox[{"\[Gamma]vv2", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}], 
               "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", "Listable", "}"}]}], "\[IndentingNewLine]", "]"}], 
         "[", "n0", "]"}], "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"GridLinesStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "nV1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v1v1\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v1v1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v2v2\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v3v3\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[787]:=",ExpressionUUID->"59d5142a-c332-4c58-b59f-5208172f2c85"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Partial shell - ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Zeta]", "=", "1"}], TraditionalForm]],ExpressionUUID->
  "563f15d3-6ca1-4e67-bab9-cf62c270509d"]
}], "Subsubsection",ExpressionUUID->"87b5b180-6800-464c-8cf9-86e78965ba97"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom9", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "9"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<n\>\"", ",", "\"\<time\>\"", ",", "\"\<n\[Gamma]cc\>\""}], 
           "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<c\>\""}], "}"}], "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importRelativisticMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom9"}]}], "Input",
 CellLabel->
  "In[788]:=",ExpressionUUID->"0651bc90-a8fe-4302-9e6b-b8c5fb92bc8b"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom9"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "1"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "q1", ",", "\[Xi]\[CapitalDelta]1", ",", "\[Eta]", ",", "n0", ",", "n", 
       ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}],
         "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", "n0", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\[Theta]", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "dV", 
               ",", "\[Gamma]vv1", ",", "\[Gamma]vv2", ",", 
               "\[Gamma]\[Gamma]", ",", "ff"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\[Theta]", "=", 
               SqrtBox["\[Beta]"]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v1", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "501", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", "\[Theta]"}], "+", "vs"}], ")"}]}]}], "]"}], 
                 ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v2", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "251", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", "\[Theta]"}], "+", "vs"}], ")"}]}]}], "]"}], 
                 ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"dV", "=", 
               RowBox[{"2", "\[Pi]", " ", "\[Gamma]vv2", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "}"}], "=", 
               RowBox[{"Transpose", "[", 
                RowBox[{"Tuples", "[", 
                 RowBox[{"{", 
                  RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]\[Gamma]", "=", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"1", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[Gamma]vv1", "^", "2"}], "+", 
                    RowBox[{"\[Gamma]vv2", "^", "2"}]}], ")"}], "/", 
                  RowBox[{
                   RowBox[{"moment", "[", "\"\<c\>\"", "]"}], "^", "2"}]}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"ff", "=", 
               RowBox[{
                RowBox[{"compilePartialShell", "[", 
                 RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], 
                 "]"}], "[", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n", "=", 
               RowBox[{"Total", "[", 
                RowBox[{"ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"nV1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{"\[Gamma]vv1", "/", "\[Gamma]\[Gamma]"}], "*", "ff", 
                 "*", "dV"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v1v1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Gamma]vv1", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v2v2", "=", 
               RowBox[{"Total", "[", 
                RowBox[{".5", 
                 RowBox[{
                  RowBox[{"\[Gamma]vv2", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}], 
               "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", "Listable", "}"}]}], "\[IndentingNewLine]", "]"}], 
         "[", "n0", "]"}], "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"GridLinesStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "nV1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v1v1\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v1v1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v2v2\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v3v3\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[790]:=",ExpressionUUID->"d5c8ecb4-20ff-4027-adf6-3fad8e47a77d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Partial shell - ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Zeta]", "=", "5"}], TraditionalForm]],ExpressionUUID->
  "774ef169-0ebb-4aac-a979-e4ad8d8a2120"]
}], "Subsubsection",ExpressionUUID->"1fea2f03-a1cd-4796-bf70-0006266d721b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom10", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "10"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<n\>\"", ",", "\"\<time\>\"", ",", "\"\<n\[Gamma]cc\>\""}], 
           "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<c\>\""}], "}"}], "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importRelativisticMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom10"}]}], "Input",
 CellLabel->
  "In[791]:=",ExpressionUUID->"9cb50e31-8afc-41da-bfe8-4e823fae8b12"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom10"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "5"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "q1", ",", "\[Xi]\[CapitalDelta]1", ",", "\[Eta]", ",", "n0", ",", "n", 
       ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}],
         "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", "n0", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\[Theta]", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "dV", 
               ",", "\[Gamma]vv1", ",", "\[Gamma]vv2", ",", 
               "\[Gamma]\[Gamma]", ",", "ff"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\[Theta]", "=", 
               SqrtBox["\[Beta]"]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v1", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "501", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", "\[Theta]"}], "+", "vs"}], ")"}]}]}], "]"}], 
                 ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v2", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "251", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", "\[Theta]"}], "+", "vs"}], ")"}]}]}], "]"}], 
                 ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"dV", "=", 
               RowBox[{"2", "\[Pi]", " ", "\[Gamma]vv2", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "}"}], "=", 
               RowBox[{"Transpose", "[", 
                RowBox[{"Tuples", "[", 
                 RowBox[{"{", 
                  RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]\[Gamma]", "=", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"1", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[Gamma]vv1", "^", "2"}], "+", 
                    RowBox[{"\[Gamma]vv2", "^", "2"}]}], ")"}], "/", 
                  RowBox[{
                   RowBox[{"moment", "[", "\"\<c\>\"", "]"}], "^", "2"}]}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"ff", "=", 
               RowBox[{
                RowBox[{"compilePartialShell", "[", 
                 RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], 
                 "]"}], "[", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n", "=", 
               RowBox[{"Total", "[", 
                RowBox[{"ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"nV1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{"\[Gamma]vv1", "/", "\[Gamma]\[Gamma]"}], "*", "ff", 
                 "*", "dV"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v1v1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Gamma]vv1", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v2v2", "=", 
               RowBox[{"Total", "[", 
                RowBox[{".5", 
                 RowBox[{
                  RowBox[{"\[Gamma]vv2", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}], 
               "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", "Listable", "}"}]}], "\[IndentingNewLine]", "]"}], 
         "[", "n0", "]"}], "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"GridLinesStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "nV1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v1v1\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v1v1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v2v2\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v3v3\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[793]:=",ExpressionUUID->"d72e11f1-2040-4412-b40c-c71a6461c58a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Counter beam - Maxwellian", "Subsubsection",ExpressionUUID->"512a1dc4-163c-4a4a-a637-95d70a5bd3b6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom11", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "11"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<n\>\"", ",", "\"\<time\>\"", ",", "\"\<n\[Gamma]cc\>\""}], 
           "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<c\>\""}], "}"}], "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importRelativisticMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom11"}]}], "Input",
 CellLabel->
  "In[794]:=",ExpressionUUID->"7c2d7bea-b693-482c-8378-3c913d58d2f2"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom11"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]", "=", "1.5"}], ",", 
     RowBox[{"\[Nu]0", "=", "100000"}], ",", 
     RowBox[{"vs", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "q1", ",", "\[Xi]\[CapitalDelta]1", ",", "\[Nu]s", ",", "\[Eta]", ",", 
       "n0", ",", "n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", 
       "n\[Gamma]v2v2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Nu]s", "=", 
       RowBox[{
        RowBox[{"Sec", "[", 
         RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "\[Nu]0"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"\[Nu]s", " ", 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]s"}], "]"}]}], ",", 
         RowBox[{"\[Nu]0", " ", 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]0"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}],
         "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"n0", ",", "\[Nu]"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\[Theta]", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "dV", 
               ",", "\[Gamma]vv1", ",", "\[Gamma]vv2", ",", 
               "\[Gamma]\[Gamma]", ",", "ff"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\[Theta]", "=", 
               SqrtBox["\[Beta]"]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v1", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "501", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", "\[Theta]"}], "+", "vs"}], ")"}]}]}], "]"}], 
                 ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v2", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "251", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", "\[Theta]"}], "+", "vs"}], ")"}], 
                    RowBox[{"Min", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"4", "\[Nu]0"}]}], "]"}]}]}], "]"}], ",", "2"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"dV", "=", 
               RowBox[{"2", "\[Pi]", " ", "\[Gamma]vv2", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "}"}], "=", 
               RowBox[{"Transpose", "[", 
                RowBox[{"Tuples", "[", 
                 RowBox[{"{", 
                  RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]\[Gamma]", "=", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"1", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[Gamma]vv1", "^", "2"}], "+", 
                    RowBox[{"\[Gamma]vv2", "^", "2"}]}], ")"}], "/", 
                  RowBox[{
                   RowBox[{"moment", "[", "\"\<c\>\"", "]"}], "^", "2"}]}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"ff", "=", 
               RowBox[{
                RowBox[{"compileCounterBeam", "[", 
                 RowBox[{"n0", ",", "\[Beta]", ",", "vs", ",", "\[Nu]"}], 
                 "]"}], "[", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n", "=", 
               RowBox[{"Total", "[", 
                RowBox[{"ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"nV1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{"\[Gamma]vv1", "/", "\[Gamma]\[Gamma]"}], "*", "ff", 
                 "*", "dV"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v1v1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Gamma]vv1", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v2v2", "=", 
               RowBox[{"Total", "[", 
                RowBox[{".5", 
                 RowBox[{
                  RowBox[{"\[Gamma]vv2", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}], 
               "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", "Listable", "}"}]}], "\[IndentingNewLine]", "]"}], 
         "[", 
         RowBox[{"n0", ",", "\[Nu]s"}], "]"}], "\[Transpose]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"GridLinesStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "nV1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v1v1\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v1v1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v2v2\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v3v3\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[796]:=",ExpressionUUID->"0d50e98f-4d6c-4cfa-a38c-e1bf70097c1a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Counter beam - isotropic shell", "Subsubsection",ExpressionUUID->"e53922b5-9590-4b75-bfb7-b7142ad5bdda"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom12", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "12"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<n\>\"", ",", "\"\<time\>\"", ",", "\"\<n\[Gamma]cc\>\""}], 
           "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<c\>\""}], "}"}], "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importRelativisticMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom12"}]}], "Input",
 CellLabel->
  "In[798]:=",ExpressionUUID->"3c45466c-5b60-4357-a172-2334f1d164a9"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom12"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Nu]0", "=", "100000"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "q1", ",", "\[Xi]\[CapitalDelta]1", ",", "\[Nu]s", ",", "\[Eta]", ",", 
       "n0", ",", "n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", 
       "n\[Gamma]v2v2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Nu]s", "=", 
       RowBox[{
        RowBox[{"Sec", "[", 
         RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "\[Nu]0"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"\[Nu]s", " ", 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]s"}], "]"}]}], ",", 
         RowBox[{"\[Nu]0", " ", 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]0"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}],
         "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"n0", ",", "\[Nu]"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\[Theta]", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "dV", 
               ",", "\[Gamma]vv1", ",", "\[Gamma]vv2", ",", 
               "\[Gamma]\[Gamma]", ",", "ff"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\[Theta]", "=", 
               SqrtBox["\[Beta]"]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v1", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "501", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", "\[Theta]"}], "+", "vs"}], ")"}]}]}], "]"}], 
                 ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v2", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "251", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", "\[Theta]"}], "+", "vs"}], ")"}], 
                    RowBox[{"Min", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"4", "\[Nu]0"}]}], "]"}]}]}], "]"}], ",", "2"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"dV", "=", 
               RowBox[{"2", "\[Pi]", " ", "\[Gamma]vv2", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "}"}], "=", 
               RowBox[{"Transpose", "[", 
                RowBox[{"Tuples", "[", 
                 RowBox[{"{", 
                  RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]\[Gamma]", "=", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"1", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[Gamma]vv1", "^", "2"}], "+", 
                    RowBox[{"\[Gamma]vv2", "^", "2"}]}], ")"}], "/", 
                  RowBox[{
                   RowBox[{"moment", "[", "\"\<c\>\"", "]"}], "^", "2"}]}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"ff", "=", 
               RowBox[{
                RowBox[{"compileCounterBeam", "[", 
                 RowBox[{"n0", ",", "\[Beta]", ",", "vs", ",", "\[Nu]"}], 
                 "]"}], "[", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n", "=", 
               RowBox[{"Total", "[", 
                RowBox[{"ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"nV1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{"\[Gamma]vv1", "/", "\[Gamma]\[Gamma]"}], "*", "ff", 
                 "*", "dV"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v1v1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Gamma]vv1", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v2v2", "=", 
               RowBox[{"Total", "[", 
                RowBox[{".5", 
                 RowBox[{
                  RowBox[{"\[Gamma]vv2", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}], 
               "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", "Listable", "}"}]}], "\[IndentingNewLine]", "]"}], 
         "[", 
         RowBox[{"n0", ",", "\[Nu]s"}], "]"}], "\[Transpose]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"GridLinesStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "nV1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v1v1\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v1v1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v2v2\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v3v3\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[800]:=",ExpressionUUID->"537ca204-0c06-421e-8fa6-e5364b7c81b2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Counter beam - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Nu]", "0"], "=", "1"}], TraditionalForm]],ExpressionUUID->
  "28a4a690-1a96-4480-9a87-db08f8ce465f"]
}], "Subsubsection",ExpressionUUID->"7889ea8e-503f-477b-8723-60e8c50ed71b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom13", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "13"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<n\>\"", ",", "\"\<time\>\"", ",", "\"\<n\[Gamma]cc\>\""}], 
           "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<c\>\""}], "}"}], "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importRelativisticMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom13"}]}], "Input",
 CellLabel->
  "In[801]:=",ExpressionUUID->"d7127765-01e6-489a-b31b-ffc332ea7276"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom13"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Nu]0", "=", "1"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "q1", ",", "\[Xi]\[CapitalDelta]1", ",", "\[Nu]s", ",", "\[Eta]", ",", 
       "n0", ",", "n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", 
       "n\[Gamma]v2v2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Nu]s", "=", 
       RowBox[{
        RowBox[{"Sec", "[", 
         RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "\[Nu]0"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"\[Nu]s", " ", 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]s"}], "]"}]}], ",", 
         RowBox[{"\[Nu]0", " ", 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]0"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}],
         "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"n0", ",", "\[Nu]"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\[Theta]", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "dV", 
               ",", "\[Gamma]vv1", ",", "\[Gamma]vv2", ",", 
               "\[Gamma]\[Gamma]", ",", "ff"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\[Theta]", "=", 
               SqrtBox["\[Beta]"]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v1", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "501", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", "\[Theta]"}], "+", "vs"}], ")"}]}]}], "]"}], 
                 ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v2", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "251", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", "\[Theta]"}], "+", "vs"}], ")"}], 
                    RowBox[{"Min", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"4", "\[Nu]0"}]}], "]"}]}]}], "]"}], ",", "2"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"dV", "=", 
               RowBox[{"2", "\[Pi]", " ", "\[Gamma]vv2", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "}"}], "=", 
               RowBox[{"Transpose", "[", 
                RowBox[{"Tuples", "[", 
                 RowBox[{"{", 
                  RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]\[Gamma]", "=", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"1", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[Gamma]vv1", "^", "2"}], "+", 
                    RowBox[{"\[Gamma]vv2", "^", "2"}]}], ")"}], "/", 
                  RowBox[{
                   RowBox[{"moment", "[", "\"\<c\>\"", "]"}], "^", "2"}]}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"ff", "=", 
               RowBox[{
                RowBox[{"compileCounterBeam", "[", 
                 RowBox[{"n0", ",", "\[Beta]", ",", "vs", ",", "\[Nu]"}], 
                 "]"}], "[", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n", "=", 
               RowBox[{"Total", "[", 
                RowBox[{"ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"nV1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{"\[Gamma]vv1", "/", "\[Gamma]\[Gamma]"}], "*", "ff", 
                 "*", "dV"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v1v1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Gamma]vv1", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v2v2", "=", 
               RowBox[{"Total", "[", 
                RowBox[{".5", 
                 RowBox[{
                  RowBox[{"\[Gamma]vv2", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}], 
               "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", "Listable", "}"}]}], "\[IndentingNewLine]", "]"}], 
         "[", 
         RowBox[{"n0", ",", "\[Nu]s"}], "]"}], "\[Transpose]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"GridLinesStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "nV1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v1v1\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v1v1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v2v2\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v3v3\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[803]:=",ExpressionUUID->"c3ee5bd8-23bf-421c-84f4-53fe38705507"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Counter beam - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["v", "0"], "=", "0.1"}], TraditionalForm]],ExpressionUUID->
  "8150d211-8c89-4d87-84f7-d9aa402ef434"]
}], "Subsubsection",ExpressionUUID->"efc17c99-6c04-47ce-a4de-28171fe10af6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom14", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "14"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<n\>\"", ",", "\"\<time\>\"", ",", "\"\<n\[Gamma]cc\>\""}], 
           "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<c\>\""}], "}"}], "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importRelativisticMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom14"}]}], "Input",
 CellLabel->
  "In[804]:=",ExpressionUUID->"ed131f29-0dc6-4e46-9fbf-b30d0f643bf4"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom14"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Nu]0", "=", ".1"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "q1", ",", "\[Xi]\[CapitalDelta]1", ",", "\[Nu]s", ",", "\[Eta]", ",", 
       "n0", ",", "n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", 
       "n\[Gamma]v2v2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Nu]s", "=", 
       RowBox[{
        RowBox[{"Sec", "[", 
         RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "\[Nu]0"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"\[Nu]s", " ", 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]s"}], "]"}]}], ",", 
         RowBox[{"\[Nu]0", " ", 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]0"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}],
         "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"n0", ",", "\[Nu]"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\[Theta]", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "dV", 
               ",", "\[Gamma]vv1", ",", "\[Gamma]vv2", ",", 
               "\[Gamma]\[Gamma]", ",", "ff"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\[Theta]", "=", 
               SqrtBox["\[Beta]"]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v1", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "501", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", "\[Theta]"}], "+", "vs"}], ")"}]}]}], "]"}], 
                 ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v2", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "251", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", "\[Theta]"}], "+", "vs"}], ")"}], 
                    RowBox[{"Min", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"4", "\[Nu]0"}]}], "]"}]}]}], "]"}], ",", "2"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"dV", "=", 
               RowBox[{"2", "\[Pi]", " ", "\[Gamma]vv2", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "}"}], "=", 
               RowBox[{"Transpose", "[", 
                RowBox[{"Tuples", "[", 
                 RowBox[{"{", 
                  RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]\[Gamma]", "=", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"1", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[Gamma]vv1", "^", "2"}], "+", 
                    RowBox[{"\[Gamma]vv2", "^", "2"}]}], ")"}], "/", 
                  RowBox[{
                   RowBox[{"moment", "[", "\"\<c\>\"", "]"}], "^", "2"}]}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"ff", "=", 
               RowBox[{
                RowBox[{"compileCounterBeam", "[", 
                 RowBox[{"n0", ",", "\[Beta]", ",", "vs", ",", "\[Nu]"}], 
                 "]"}], "[", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n", "=", 
               RowBox[{"Total", "[", 
                RowBox[{"ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"nV1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{"\[Gamma]vv1", "/", "\[Gamma]\[Gamma]"}], "*", "ff", 
                 "*", "dV"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v1v1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Gamma]vv1", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v2v2", "=", 
               RowBox[{"Total", "[", 
                RowBox[{".5", 
                 RowBox[{
                  RowBox[{"\[Gamma]vv2", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}], 
               "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", "Listable", "}"}]}], "\[IndentingNewLine]", "]"}], 
         "[", 
         RowBox[{"n0", ",", "\[Nu]s"}], "]"}], "\[Transpose]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"GridLinesStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "nV1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v1v1\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v1v1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v2v2\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v3v3\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[806]:=",ExpressionUUID->"12be4993-8a2c-41f6-acf1-2980bff3c131"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cold fluid", "Subsubsection",ExpressionUUID->"4edb9e72-6721-4b18-870b-ec377a2f788e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom15", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "15"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<n\>\"", ",", "\"\<time\>\"", ",", "\"\<n\[Gamma]cc\>\""}], 
           "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<c\>\""}], "}"}], "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importRelativisticMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom15"}]}], "Input",
 CellLabel->
  "In[807]:=",ExpressionUUID->"7c8ef4d8-98c9-4077-8302-179b47115928"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom15"}], ",", 
     RowBox[{"n0", "=", "0.01"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"T1", ",", "T2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"T1", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"GridLinesStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"Opacity", "[", "1", "]"}], ",", 
             RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
             "Dashed"}], "]"}]}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
               "]"}], 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "n0", "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
               "]"}], 
              RowBox[{"moment", "[", "\"\<n\[Gamma]v1v1\>\"", "]"}]}], 
             ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"n0", 
               RowBox[{"{", "T1", "}"}]}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
               "]"}], 
              RowBox[{"moment", "[", "\"\<n\[Gamma]v2v2\>\"", "]"}]}], 
             ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"n0", 
               RowBox[{"{", "T2", "}"}]}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
               "]"}], 
              RowBox[{"moment", "[", "\"\<n\[Gamma]v3v3\>\"", "]"}]}], 
             ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"n0", 
               RowBox[{"{", "T2", "}"}]}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
        "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[809]:=",ExpressionUUID->"90c718fe-3a88-4069-a272-25467d8b4830"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["VHist", "Subsection",ExpressionUUID->"997996cf-89a4-4991-8ffc-c230229c881f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"metadata", "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"files", "=", 
        RowBox[{"FileNames", "[", 
         RowBox[{"\"\<gvhist2d-*.h5\>\"", ",", "wd"}], "]"}]}], ",", "names", 
       ",", "attrs", ",", "steps", ",", "times", ",", "pos"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"attrs", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<HDF5\>\"", ",", "\"\<Attributes\>\"", ",", 
             "\"\</gvhist2d\>\""}], "}"}]}], "]"}], "&"}], "/@", "files"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{
        RowBox[{"Lookup", "[", "\"\<step\>\"", "]"}], "/@", "attrs"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"times", "=", 
       RowBox[{
        RowBox[{"Lookup", "[", "\"\<time\>\"", "]"}], "/@", "attrs"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"List", "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "times", "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"First", "/@", 
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"pos", ",", "times"}], "}"}], "]"}], ",", "Last"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"steps", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"times", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"times", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"files", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"files", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Association", "[", 
       RowBox[{
        RowBox[{"\"\<attr\>\"", "->", 
         RowBox[{"KeyDrop", "[", 
          RowBox[{
           RowBox[{"First", "[", "attrs", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<step\>\"", ",", "\"\<time\>\""}], "}"}]}], "]"}]}], 
        ",", 
        RowBox[{"\"\<step\>\"", "->", "steps"}], ",", 
        RowBox[{"\"\<time\>\"", "->", "times"}], ",", 
        RowBox[{"\"\<files\>\"", "->", "files"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[817]:=",ExpressionUUID->"e117c764-e5f8-418c-a297-5adadaec257b"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compileBiMaxwellian", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compileBiMaxwellian", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]1_", "?", "Positive"}], ",", 
    RowBox[{"T2OT1_", "?", "Positive"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]1", "=", 
       SqrtBox[
        RowBox[{"N", "[", "\[Beta]1", "]"}]]}], ",", 
      RowBox[{"\[Theta]2", "=", 
       SqrtBox[
        RowBox[{
         RowBox[{"N", "[", "\[Beta]1", "]"}], "T2OT1"}]]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"n", " ", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"v1", "^", "2"}]}], "/", 
            RowBox[{"\[Theta]1", "^", "2"}]}], "-", 
           RowBox[{
            RowBox[{"v2", "^", "2"}], "/", 
            RowBox[{"\[Theta]2", "^", "2"}]}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"Pi", "^", "1.5"}], " ", "\[Theta]1", " ", 
          RowBox[{"\[Theta]2", "^", "2"}]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[818]:=",ExpressionUUID->"5909326c-1855-4206-8845-a65d02876914"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compileLossCone", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compileLossCone", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]1_", "?", "Positive"}], ",", 
    RowBox[{"T2OT1_", "?", "Positive"}], ",", 
    RowBox[{"\[Beta]_Real", "?", "Positive"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]1", "=", 
       SqrtBox[
        RowBox[{"N", "[", "\[Beta]1", "]"}]]}], ",", 
      RowBox[{"\[Theta]2", "=", 
       SqrtBox[
        RowBox[{
         RowBox[{"N", "[", "\[Beta]1", "]"}], 
         RowBox[{"T2OT1", "/", 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}]]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Beta]"}], ")"}]}], 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"v1", "^", "2"}]}], "/", 
            RowBox[{"\[Theta]1", "^", "2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"v2", "^", "2"}]}], "/", 
              RowBox[{"\[Theta]2", "^", "2"}]}], "]"}], "-", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"v2", "^", "2"}]}], "/", 
               RowBox[{"\[Theta]2", "^", "2"}]}], "/", "\[Beta]"}], "]"}]}], 
           ")"}]}], ",", 
         RowBox[{
          RowBox[{"Pi", "^", "1.5"}], " ", "\[Theta]1", " ", 
          RowBox[{"\[Theta]2", "^", "2"}]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[820]:=",ExpressionUUID->"4db05d20-a675-4dc3-9bda-2ee9c09c5366"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compilePartialShell", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compilePartialShell", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]_", "?", "Positive"}], ",", 
    RowBox[{"\[Zeta]_Integer", "?", "NonNegative"}], ",", 
    RowBox[{"vs_", "?", "NonNegative"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]", "=", 
       RowBox[{"N", "[", 
        SqrtBox["\[Beta]"], "]"}]}], ",", 
      RowBox[{"xs", "=", 
       RowBox[{"N", "[", 
        RowBox[{"vs", "/", 
         SqrtBox["\[Beta]"]}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{".5", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"vs", "/", 
            SqrtBox["\[Beta]"]}], 
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"vs", "/", 
                SqrtBox["\[Beta]"]}], ")"}], "^", "2"}]}], "]"}]}], "+", 
          RowBox[{
           SqrtBox["\[Pi]"], 
           RowBox[{"(", 
            RowBox[{".5", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"vs", "/", 
                SqrtBox["\[Beta]"]}], ")"}], "^", "2"}]}], ")"}], 
           RowBox[{"Erfc", "[", 
            RowBox[{
             RowBox[{"-", "vs"}], "/", 
             SqrtBox["\[Beta]"]}], "]"}]}]}], ")"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"B\[Zeta]", "=", 
       RowBox[{
        SqrtBox["\[Pi]"], 
        RowBox[{
         RowBox[{"Gamma", "[", 
          RowBox[{"1", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}], "/", 
         RowBox[{"Gamma", "[", 
          RowBox[{"1.5", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "x1", ",", "x2", ",", "\[Mu]"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x2", "=", 
          RowBox[{"v2", "/", "\[Theta]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x1", "=", 
          RowBox[{"v1", "/", "\[Theta]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x", "=", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"x1", "^", "2"}], "+", 
            RowBox[{"x2", "^", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Mu]", "=", 
          RowBox[{"x1", "/", "x"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"n", " ", 
          RowBox[{"Divide", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"x", "-", "xs"}], ")"}], "^", "2"}]}], "]"}], 
             RowBox[{"Power", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "\[Mu]"}], ")"}], 
                RowBox[{"(", 
                 RowBox[{"1", "+", "\[Mu]"}], ")"}]}], ",", 
               RowBox[{".5", "\[Zeta]"}]}], "]"}]}], ",", 
            RowBox[{"2", "Pi", " ", 
             RowBox[{"\[Theta]", "^", "3"}], "Ab", " ", "B\[Zeta]"}]}], 
           "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[822]:=",ExpressionUUID->"a7859a12-107c-4fbe-a4d6-d12004caf481"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compileCounterBeam", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compileCounterBeam", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]_", "?", "Positive"}], ",", 
    RowBox[{"vs_", "?", "NonNegative"}], ",", 
    RowBox[{"\[Nu]_", "?", "Positive"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]", "=", 
       RowBox[{"N", "[", 
        SqrtBox["\[Beta]"], "]"}]}], ",", 
      RowBox[{"xs", "=", 
       RowBox[{"N", "[", 
        RowBox[{"vs", "/", 
         SqrtBox["\[Beta]"]}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{".5", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"vs", "/", 
            SqrtBox["\[Beta]"]}], 
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"vs", "/", 
                SqrtBox["\[Beta]"]}], ")"}], "^", "2"}]}], "]"}]}], "+", 
          RowBox[{
           SqrtBox["\[Pi]"], 
           RowBox[{"(", 
            RowBox[{".5", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"vs", "/", 
                SqrtBox["\[Beta]"]}], ")"}], "^", "2"}]}], ")"}], 
           RowBox[{"Erfc", "[", 
            RowBox[{
             RowBox[{"-", "vs"}], "/", 
             SqrtBox["\[Beta]"]}], "]"}]}]}], ")"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"B\[Nu]", "=", 
       RowBox[{"2", "\[Nu]", " ", 
        RowBox[{"DawsonF", "[", 
         RowBox[{"1", "/", "\[Nu]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"u1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"u2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x1", ",", "x2", ",", "x", ",", "\[Mu]", ",", "f0"}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x2", "=", 
          RowBox[{"u2", "/", "\[Theta]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x1", "=", 
          RowBox[{"u1", "/", "\[Theta]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x", "=", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"x1", "^", "2"}], "+", 
            RowBox[{"x2", "^", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Mu]", "=", 
          RowBox[{"x1", "/", "x"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"n", " ", 
          RowBox[{"Divide", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"x", "-", "xs"}], ")"}], "^", "2"}]}], "]"}], 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "\[Mu]"}], ")"}], 
                  RowBox[{"(", 
                   RowBox[{"1", "+", "\[Mu]"}], ")"}]}], ")"}]}], "/", 
               RowBox[{"\[Nu]", "^", "2"}]}], "]"}]}], ",", 
            RowBox[{"2", "Pi", " ", 
             RowBox[{"\[Theta]", "^", "3"}], "Ab", " ", "B\[Nu]"}]}], 
           "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[824]:=",ExpressionUUID->"153676d8-00eb-4307-9671-861e492d0c54"],

Cell[CellGroupData[{

Cell["Maxwellian", "Subsubsection",ExpressionUUID->"d10d8033-a66b-4393-a8cb-670cd72e5548"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist1", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "1"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importRelativisticVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist1"}]}], "Input",
 CellLabel->
  "In[826]:=",ExpressionUUID->"da645338-f2a4-446c-be72-74ca60f5b244"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist1"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"T2OT1eq", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "fhist", ",", "ghist", 
       ",", "whist", ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", 
       "T2OT1", ",", "\[Gamma]vv12", ",", "ff", ",", "gg", ",", "plots"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{"T2OT1eq", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "T2OT1eq"}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{"T2OT1eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileBiMaxwellian", "[", 
          RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1"}], "]"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "\[Eta]", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileBiMaxwellian", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1"}], "]"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "\[Eta]", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[828]:=",ExpressionUUID->"606d39b8-87cc-4bd9-bf59-67236fd16194"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bi-Maxwellian", "Subsubsection",ExpressionUUID->"13a4823e-ac7d-411a-bfa7-214b68eed661"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist2", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "2"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importRelativisticVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist2"}]}], "Input",
 CellLabel->
  "In[829]:=",ExpressionUUID->"358286e0-1852-4590-bd31-ee0d264e6157"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist2"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"T2OT1eq", "=", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "fhist", ",", "ghist", 
       ",", "whist", ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", 
       "T2OT1", ",", "\[Gamma]vv12", ",", "ff", ",", "gg", ",", "plots"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{"T2OT1eq", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "T2OT1eq"}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{"T2OT1eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileBiMaxwellian", "[", 
          RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1"}], "]"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "\[Eta]", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileBiMaxwellian", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1"}], "]"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "\[Eta]", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[831]:=",ExpressionUUID->"97722b2b-dd5e-4845-8646-8dea8c604bff"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Loss cone - Maxwellian", "Subsubsection",ExpressionUUID->"8b5a1d8f-2e7e-4610-8804-00cc69919962"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist3", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "3"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importRelativisticVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist3"}]}], "Input",
 CellLabel->
  "In[832]:=",ExpressionUUID->"059c1c8d-d9c0-4514-804f-f6e54b939747"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist3"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["1"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "1.0*^-10"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "fhist", ",", "ghist", 
       ",", "whist", ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", 
       "\[Eta]\[Beta]", ",", "n0", ",", "\[Beta]", ",", "\[Theta]2O\[Theta]1",
        ",", "T2OT1", ",", "\[Gamma]vv12", ",", "ff", ",", "gg", ",", 
       "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileLossCone", "[", 
          RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], 
          "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileLossCone", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1", ",", "\[Beta]"}], 
          "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[834]:=",ExpressionUUID->"e34fa43a-618f-455f-abf5-fcaadfe905ac"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Loss cone - Bi-Maxwellian", "Subsubsection",ExpressionUUID->"f3a0152c-b4bf-4104-9df7-9825b312236c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist4", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "4"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importRelativisticVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist4"}]}], "Input",
 CellLabel->
  "In[835]:=",ExpressionUUID->"0cdaf02d-030b-47ff-abd9-b2d8e5aaf998"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist4"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "1.0*^-10"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "fhist", ",", "ghist", 
       ",", "whist", ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", 
       "\[Eta]\[Beta]", ",", "n0", ",", "\[Beta]", ",", "\[Theta]2O\[Theta]1",
        ",", "T2OT1", ",", "\[Gamma]vv12", ",", "ff", ",", "gg", ",", 
       "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileLossCone", "[", 
          RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], 
          "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileLossCone", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1", ",", "\[Beta]"}], 
          "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[837]:=",ExpressionUUID->"242c22bf-a27a-41e0-a95b-faf19f90b67e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Loss cone - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Beta]", "eq"], "=", "0.5"}], TraditionalForm]],
  ExpressionUUID->"2a856998-27f3-4145-a59f-d33452dffbb5"]
}], "Subsubsection",ExpressionUUID->"2d584d4e-aca4-40ea-abb1-5febd213865b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist5", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "5"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importRelativisticVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist5"}]}], "Input",
 CellLabel->
  "In[838]:=",ExpressionUUID->"f1930530-5934-4184-9bec-ac38bded1c6c"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist5"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "0.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "fhist", ",", "ghist", 
       ",", "whist", ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", 
       "\[Eta]\[Beta]", ",", "n0", ",", "\[Beta]", ",", "\[Theta]2O\[Theta]1",
        ",", "T2OT1", ",", "\[Gamma]vv12", ",", "ff", ",", "gg", ",", 
       "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileLossCone", "[", 
          RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], 
          "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileLossCone", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1", ",", "\[Beta]"}], 
          "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[840]:=",ExpressionUUID->"419f4ebb-de08-4a93-b9a7-0272ae5b2cb8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Loss cone - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Beta]", "eq"], "=", "2.5"}], TraditionalForm]],
  ExpressionUUID->"0ee8da94-321d-4e20-bbd3-b50b98ad3695"]
}], "Subsubsection",ExpressionUUID->"85c5e31b-54d9-48e7-af2e-c40d4f1a2cc6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist6", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "6"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importRelativisticVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist6"}]}], "Input",
 CellLabel->
  "In[841]:=",ExpressionUUID->"e82cfc9c-d286-4a5c-955d-f0bd54ee0e6c"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist6"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "2.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "fhist", ",", "ghist", 
       ",", "whist", ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", 
       "\[Eta]\[Beta]", ",", "n0", ",", "\[Beta]", ",", "\[Theta]2O\[Theta]1",
        ",", "T2OT1", ",", "\[Gamma]vv12", ",", "ff", ",", "gg", ",", 
       "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileLossCone", "[", 
          RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], 
          "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileLossCone", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1", ",", "\[Beta]"}], 
          "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[843]:=",ExpressionUUID->"6db91dd7-71ec-4fd0-9c0d-ba5b3012ab76"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Partial shell - Maxwellian", "Subsubsection",ExpressionUUID->"013a1f16-e084-4c3e-ac42-d68210c8e57a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist7", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "7"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importRelativisticVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist7"}]}], "Input",
 CellLabel->
  "In[844]:=",ExpressionUUID->"2b8c8682-69fd-4f94-b209-1831d67f21a1"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist7"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "1.5"}], ",", 
     RowBox[{"\[Zeta]", "=", "0"}], ",", 
     RowBox[{"vs", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "fhist", ",", "ghist", 
       ",", "whist", ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", 
       "\[Gamma]vv12", ",", "ff", ",", "gg", ",", "plots"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compilePartialShell", "[", 
          RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compilePartialShell", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]", " ", "gT"}], ",", "\[Zeta]", ",", "vs"}], "]"}],
          "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[846]:=",ExpressionUUID->"7f4489aa-8ade-4596-8d9c-4d0058bff819"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Isotropic shell", "Subsubsection",ExpressionUUID->"87264bae-dad2-40bc-9bd6-4728ef9f88c4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist8", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "8"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importRelativisticVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist8"}]}], "Input",
 CellLabel->
  "In[847]:=",ExpressionUUID->"252b1fc0-447a-4871-a3db-3122b47c9d02"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist8"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "0"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "fhist", ",", "ghist", 
       ",", "whist", ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", 
       "\[Gamma]vv12", ",", "ff", ",", "gg", ",", "plots"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compilePartialShell", "[", 
          RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compilePartialShell", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]", " ", "gT"}], ",", "\[Zeta]", ",", "vs"}], "]"}],
          "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[849]:=",ExpressionUUID->"b19411bf-c796-49d0-b788-065d98d88ebb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Partial shell - ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Zeta]", "=", "1"}], TraditionalForm]],ExpressionUUID->
  "3a7997b3-d3dc-4e4b-b522-622110e6a3d2"]
}], "Subsubsection",ExpressionUUID->"bf57786b-be3a-4b32-b539-b4ebb0366f3d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist9", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "9"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importRelativisticVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist9"}]}], "Input",
 CellLabel->
  "In[850]:=",ExpressionUUID->"35cf0d2d-ef01-4ee4-afad-a6ac1acbabb9"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist9"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "1"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "fhist", ",", "ghist", 
       ",", "whist", ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", 
       "\[Gamma]vv12", ",", "ff", ",", "gg", ",", "plots"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compilePartialShell", "[", 
          RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compilePartialShell", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]", " ", "gT"}], ",", "\[Zeta]", ",", "vs"}], "]"}],
          "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[852]:=",ExpressionUUID->"be0a0374-2f78-40af-852a-464d3ea2cd98"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Partial shell - ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Zeta]", "=", "5"}], TraditionalForm]],ExpressionUUID->
  "6d9b073b-4fa6-426e-ad6c-6908631dfe60"]
}], "Subsubsection",ExpressionUUID->"691309da-dc5e-453b-b371-b7d84af6b73c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist10", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "10"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importRelativisticVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist10"}]}], "Input",
 CellLabel->
  "In[853]:=",ExpressionUUID->"9587ba05-32d4-4d37-a75c-ba7c5bfe1872"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist10"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "5"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "fhist", ",", "ghist", 
       ",", "whist", ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", 
       "\[Gamma]vv12", ",", "ff", ",", "gg", ",", "plots"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compilePartialShell", "[", 
          RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compilePartialShell", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]", " ", "gT"}], ",", "\[Zeta]", ",", "vs"}], "]"}],
          "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[855]:=",ExpressionUUID->"c81072ea-4274-4e6d-8d0d-ec69e8bbfab8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Counter beam - Maxwellian", "Subsubsection",ExpressionUUID->"f49b195c-5d26-49a0-843e-75ca1b38127d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist11", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "11"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importRelativisticVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist11"}]}], "Input",
 CellLabel->
  "In[856]:=",ExpressionUUID->"2a01d1a6-615b-431b-a8dc-37d1919328dc"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist11"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "1.5"}], ",", 
     RowBox[{"\[Nu]0", "=", "100000"}], ",", 
     RowBox[{"vs", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "fhist", ",", "ghist", 
       ",", "whist", ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Nu]", ",", "\[Eta]", ",", 
       "n0", ",", "\[Gamma]vv12", ",", "ff", ",", "gg", ",", "plots"}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{
        RowBox[{"Sec", "[", 
         RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "\[Nu]0"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"\[Nu]", " ", 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]"}], "]"}]}], ",", 
         RowBox[{"\[Nu]0", " ", 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]0"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileCounterBeam", "[", 
          RowBox[{"n0", ",", "\[Beta]", ",", "vs", ",", "\[Nu]"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileCounterBeam", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]", " ", "gT"}], ",", "vs", ",", "\[Nu]"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[858]:=",ExpressionUUID->"3ceed081-7fd1-4671-b4ec-f309e4b9acbf"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Counter beam - isotropic shell", "Subsubsection",ExpressionUUID->"8d5a1747-d016-43f6-9efe-36dc54347844"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist12", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "12"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importRelativisticVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist12"}]}], "Input",
 CellLabel->
  "In[859]:=",ExpressionUUID->"2fb43abd-be6f-4d9c-b4e3-9a7c1d0d16a7"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist12"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Nu]0", "=", "100000"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "fhist", ",", "ghist", 
       ",", "whist", ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Nu]", ",", "\[Eta]", ",", 
       "n0", ",", "\[Gamma]vv12", ",", "ff", ",", "gg", ",", "plots"}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{
        RowBox[{"Sec", "[", 
         RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "\[Nu]0"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"\[Nu]", " ", 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]"}], "]"}]}], ",", 
         RowBox[{"\[Nu]0", " ", 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]0"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileCounterBeam", "[", 
          RowBox[{"n0", ",", "\[Beta]", ",", "vs", ",", "\[Nu]"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileCounterBeam", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]", " ", "gT"}], ",", "vs", ",", "\[Nu]"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[861]:=",ExpressionUUID->"e9ca8279-b0ad-4ba8-b4ba-60f8853c76ce"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Counter beam - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Nu]", "0"], "=", "1"}], TraditionalForm]],ExpressionUUID->
  "3b07dd32-e2ac-4dcb-b5f7-62f9ae8a262f"]
}], "Subsubsection",ExpressionUUID->"f7b2e3cf-ac3e-4058-820a-353f3bad2af3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist13", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "13"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importRelativisticVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist13"}]}], "Input",
 CellLabel->
  "In[862]:=",ExpressionUUID->"3dfedf8f-9eeb-4632-afe5-6210b8c45cb6"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist13"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Nu]0", "=", "1"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "fhist", ",", "ghist", 
       ",", "whist", ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Nu]", ",", "\[Eta]", ",", 
       "n0", ",", "\[Gamma]vv12", ",", "ff", ",", "gg", ",", "plots"}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{
        RowBox[{"Sec", "[", 
         RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "\[Nu]0"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"\[Nu]", " ", 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]"}], "]"}]}], ",", 
         RowBox[{"\[Nu]0", " ", 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]0"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileCounterBeam", "[", 
          RowBox[{"n0", ",", "\[Beta]", ",", "vs", ",", "\[Nu]"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileCounterBeam", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]", " ", "gT"}], ",", "vs", ",", "\[Nu]"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[864]:=",ExpressionUUID->"f4c49113-2adf-4ae3-abe4-b884acfef679"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Counter beam - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Nu]", "0"], "=", "0.1"}], TraditionalForm]],
  ExpressionUUID->"8941141d-45c5-4b13-aa0d-205edf46c09a"]
}], "Subsubsection",ExpressionUUID->"0e1319e5-d33d-42be-92d6-84267ce260cf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist14", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "14"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importRelativisticVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist14"}]}], "Input",
 CellLabel->
  "In[865]:=",ExpressionUUID->"5e282e21-2474-43aa-ba16-d7caef70bbc1"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist14"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Nu]0", "=", ".1"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "fhist", ",", "ghist", 
       ",", "whist", ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Nu]", ",", "\[Eta]", ",", 
       "n0", ",", "\[Gamma]vv12", ",", "ff", ",", "gg", ",", "plots"}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{
        RowBox[{"Sec", "[", 
         RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "\[Nu]0"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"\[Nu]", " ", 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]"}], "]"}]}], ",", 
         RowBox[{"\[Nu]0", " ", 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]0"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileCounterBeam", "[", 
          RowBox[{"n0", ",", "\[Beta]", ",", "vs", ",", "\[Nu]"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileCounterBeam", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]", " ", "gT"}], ",", "vs", ",", "\[Nu]"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[867]:=",ExpressionUUID->"55bcee7f-b914-438b-911a-d91f78918edb"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Particle", "Subsection",ExpressionUUID->"023b24a9-16b6-4fb7-b2e9-c6cf3a306a33"],

Cell[BoxData[
 RowBox[{
  RowBox[{"metadata", "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"files", "=", 
        RowBox[{"FileNames", "[", 
         RowBox[{"\"\<particle-*.h5\>\"", ",", "wd"}], "]"}]}], ",", "names", 
       ",", "attrs", ",", "steps", ",", "times", ",", "pos"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"attrs", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<HDF5\>\"", ",", "\"\<Attributes\>\"", ",", 
             "\"\</particle\>\""}], "}"}]}], "]"}], "&"}], "/@", "files"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{
        RowBox[{"Lookup", "[", "\"\<step\>\"", "]"}], "/@", "attrs"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"times", "=", 
       RowBox[{
        RowBox[{"Lookup", "[", "\"\<time\>\"", "]"}], "/@", "attrs"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"List", "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "times", "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"First", "/@", 
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"pos", ",", "times"}], "}"}], "]"}], ",", "Last"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"steps", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"times", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"times", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"files", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"files", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Association", "[", 
       RowBox[{
        RowBox[{"\"\<attr\>\"", "->", 
         RowBox[{"KeyDrop", "[", 
          RowBox[{
           RowBox[{"First", "[", "attrs", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<step\>\"", ",", "\"\<time\>\""}], "}"}]}], "]"}]}], 
        ",", 
        RowBox[{"\"\<step\>\"", "->", "steps"}], ",", 
        RowBox[{"\"\<time\>\"", "->", "times"}], ",", 
        RowBox[{"\"\<files\>\"", "->", "files"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[868]:=",ExpressionUUID->"468f27fd-8a91-44f3-9254-2d6c5d26f5ce"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compileBiMaxwellian", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compileBiMaxwellian", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]1_", "?", "Positive"}], ",", 
    RowBox[{"T2OT1_", "?", "Positive"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]1", "=", 
       SqrtBox[
        RowBox[{"N", "[", "\[Beta]1", "]"}]]}], ",", 
      RowBox[{"\[Theta]2", "=", 
       SqrtBox[
        RowBox[{
         RowBox[{"N", "[", "\[Beta]1", "]"}], "T2OT1"}]]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"n", " ", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"v1", "^", "2"}]}], "/", 
            RowBox[{"\[Theta]1", "^", "2"}]}], "-", 
           RowBox[{
            RowBox[{"v2", "^", "2"}], "/", 
            RowBox[{"\[Theta]2", "^", "2"}]}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"Pi", "^", "1.5"}], " ", "\[Theta]1", " ", 
          RowBox[{"\[Theta]2", "^", "2"}]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[869]:=",ExpressionUUID->"b110facb-79d2-47de-8a1f-dc5092cfec2b"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compileLossCone", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compileLossCone", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]1_", "?", "Positive"}], ",", 
    RowBox[{"T2OT1_", "?", "Positive"}], ",", 
    RowBox[{"\[Beta]_Real", "?", "Positive"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]1", "=", 
       SqrtBox[
        RowBox[{"N", "[", "\[Beta]1", "]"}]]}], ",", 
      RowBox[{"\[Theta]2", "=", 
       SqrtBox[
        RowBox[{
         RowBox[{"N", "[", "\[Beta]1", "]"}], 
         RowBox[{"T2OT1", "/", 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}]]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Beta]"}], ")"}]}], 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"v1", "^", "2"}]}], "/", 
            RowBox[{"\[Theta]1", "^", "2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"v2", "^", "2"}]}], "/", 
              RowBox[{"\[Theta]2", "^", "2"}]}], "]"}], "-", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"v2", "^", "2"}]}], "/", 
               RowBox[{"\[Theta]2", "^", "2"}]}], "/", "\[Beta]"}], "]"}]}], 
           ")"}]}], ",", 
         RowBox[{
          RowBox[{"Pi", "^", "1.5"}], " ", "\[Theta]1", " ", 
          RowBox[{"\[Theta]2", "^", "2"}]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[871]:=",ExpressionUUID->"7ca9c11b-346c-4d01-8ead-6ea875f5a953"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compilePartialShell", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compilePartialShell", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]_", "?", "Positive"}], ",", 
    RowBox[{"\[Zeta]_Integer", "?", "NonNegative"}], ",", 
    RowBox[{"vs_", "?", "NonNegative"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]", "=", 
       RowBox[{"N", "[", 
        SqrtBox["\[Beta]"], "]"}]}], ",", 
      RowBox[{"xs", "=", 
       RowBox[{"N", "[", 
        RowBox[{"vs", "/", 
         SqrtBox["\[Beta]"]}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{".5", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"vs", "/", 
            SqrtBox["\[Beta]"]}], 
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"vs", "/", 
                SqrtBox["\[Beta]"]}], ")"}], "^", "2"}]}], "]"}]}], "+", 
          RowBox[{
           SqrtBox["\[Pi]"], 
           RowBox[{"(", 
            RowBox[{".5", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"vs", "/", 
                SqrtBox["\[Beta]"]}], ")"}], "^", "2"}]}], ")"}], 
           RowBox[{"Erfc", "[", 
            RowBox[{
             RowBox[{"-", "vs"}], "/", 
             SqrtBox["\[Beta]"]}], "]"}]}]}], ")"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"B\[Zeta]", "=", 
       RowBox[{
        SqrtBox["\[Pi]"], 
        RowBox[{
         RowBox[{"Gamma", "[", 
          RowBox[{"1", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}], "/", 
         RowBox[{"Gamma", "[", 
          RowBox[{"1.5", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "x1", ",", "x2", ",", "\[Mu]"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x2", "=", 
          RowBox[{"v2", "/", "\[Theta]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x1", "=", 
          RowBox[{"v1", "/", "\[Theta]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x", "=", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"x1", "^", "2"}], "+", 
            RowBox[{"x2", "^", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Mu]", "=", 
          RowBox[{"x1", "/", "x"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"n", " ", 
          RowBox[{"Divide", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"x", "-", "xs"}], ")"}], "^", "2"}]}], "]"}], 
             RowBox[{"Power", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "\[Mu]"}], ")"}], 
                RowBox[{"(", 
                 RowBox[{"1", "+", "\[Mu]"}], ")"}]}], ",", 
               RowBox[{".5", "\[Zeta]"}]}], "]"}]}], ",", 
            RowBox[{"2", "Pi", " ", 
             RowBox[{"\[Theta]", "^", "3"}], "Ab", " ", "B\[Zeta]"}]}], 
           "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[873]:=",ExpressionUUID->"087b0d9f-e776-40d6-a246-3234f96b3215"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compileCounterBeam", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compileCounterBeam", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]_", "?", "Positive"}], ",", 
    RowBox[{"vs_", "?", "NonNegative"}], ",", 
    RowBox[{"\[Nu]_", "?", "Positive"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]", "=", 
       RowBox[{"N", "[", 
        SqrtBox["\[Beta]"], "]"}]}], ",", 
      RowBox[{"xs", "=", 
       RowBox[{"N", "[", 
        RowBox[{"vs", "/", 
         SqrtBox["\[Beta]"]}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{".5", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"vs", "/", 
            SqrtBox["\[Beta]"]}], 
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"vs", "/", 
                SqrtBox["\[Beta]"]}], ")"}], "^", "2"}]}], "]"}]}], "+", 
          RowBox[{
           SqrtBox["\[Pi]"], 
           RowBox[{"(", 
            RowBox[{".5", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"vs", "/", 
                SqrtBox["\[Beta]"]}], ")"}], "^", "2"}]}], ")"}], 
           RowBox[{"Erfc", "[", 
            RowBox[{
             RowBox[{"-", "vs"}], "/", 
             SqrtBox["\[Beta]"]}], "]"}]}]}], ")"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"B\[Nu]", "=", 
       RowBox[{"2", "\[Nu]", " ", 
        RowBox[{"DawsonF", "[", 
         RowBox[{"1", "/", "\[Nu]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"u1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"u2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x1", ",", "x2", ",", "x", ",", "\[Mu]", ",", "f0"}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x2", "=", 
          RowBox[{"u2", "/", "\[Theta]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x1", "=", 
          RowBox[{"u1", "/", "\[Theta]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x", "=", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"x1", "^", "2"}], "+", 
            RowBox[{"x2", "^", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Mu]", "=", 
          RowBox[{"x1", "/", "x"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"n", " ", 
          RowBox[{"Divide", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"x", "-", "xs"}], ")"}], "^", "2"}]}], "]"}], 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "\[Mu]"}], ")"}], 
                  RowBox[{"(", 
                   RowBox[{"1", "+", "\[Mu]"}], ")"}]}], ")"}]}], "/", 
               RowBox[{"\[Nu]", "^", "2"}]}], "]"}]}], ",", 
            RowBox[{"2", "Pi", " ", 
             RowBox[{"\[Theta]", "^", "3"}], "Ab", " ", "B\[Nu]"}]}], 
           "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[875]:=",ExpressionUUID->"f80d1f0a-25e1-4203-8d8d-4cac8d707808"],

Cell[CellGroupData[{

Cell["Maxwellian", "Subsubsection",ExpressionUUID->"479e96aa-b6c4-4c6e-a00b-44d7e9a04ac0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl1", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "1"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v1lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v2lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v2", "=", "51"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "\[Gamma]vhist", ",", "q1", ",", "rhist"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importRelativisticParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Gamma]vhist", "=", 
         RowBox[{"calMomentumHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v1lim", ",", "N\[Gamma]v1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v2lim", ",", "N\[Gamma]v2"}], "}"}], ",", 
           "q1lim"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<n\[Gamma]cc\>\"", 
                   ",", "\"\<\[Gamma]c\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<c\>\""}], "}"}], "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "\[Gamma]vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl1"}]}], "Input",
 CellLabel->
  "In[877]:=",ExpressionUUID->"6f0c0881-47e1-49d1-9273-dda0b8b971bc"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl1"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"T2OT1eq", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", 
       "T2OT1", ",", "\[Gamma]vv12", ",", "ff", ",", "gg", ",", "plots"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{"T2OT1eq", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "T2OT1eq"}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{"T2OT1eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileBiMaxwellian", "[", 
            RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1"}], "]"}], ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileBiMaxwellian", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1"}], "]"}], ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[879]:=",ExpressionUUID->"4d3cf1f4-020b-426a-af0d-ea7e77c05cee"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bi-Maxwellian", "Subsubsection",ExpressionUUID->"2e74fbbb-c808-4225-be09-4cdaf4d7a33d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl2", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "2"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v1lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v2lim", "=", 
        RowBox[{"6.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "\[Gamma]vhist", ",", "q1", ",", "rhist"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importRelativisticParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Gamma]vhist", "=", 
         RowBox[{"calMomentumHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v1lim", ",", "N\[Gamma]v1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v2lim", ",", "N\[Gamma]v2"}], "}"}], ",", 
           "q1lim"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<n\[Gamma]cc\>\"", 
                   ",", "\"\<\[Gamma]c\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<c\>\""}], "}"}], "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "\[Gamma]vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl2"}]}], "Input",
 CellLabel->
  "In[880]:=",ExpressionUUID->"7d0333b0-bbb2-45d3-bb64-e540f9b0e48d"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl2"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"T2OT1eq", "=", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", 
       "T2OT1", ",", "\[Gamma]vv12", ",", "ff", ",", "gg", ",", "plots"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{"T2OT1eq", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "T2OT1eq"}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{"T2OT1eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileBiMaxwellian", "[", 
            RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1"}], "]"}], ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileBiMaxwellian", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1"}], "]"}], ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[882]:=",ExpressionUUID->"03540508-00cf-42bf-ac8f-6184de1717d9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Loss cone - Maxwellian", "Subsubsection",ExpressionUUID->"c77d42dd-e2e9-4afd-908d-a66540d6bb87"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl3", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "3"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v1lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v2lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v2", "=", "51"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "\[Gamma]vhist", ",", "q1", ",", "rhist"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importRelativisticParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Gamma]vhist", "=", 
         RowBox[{"calMomentumHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v1lim", ",", "N\[Gamma]v1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v2lim", ",", "N\[Gamma]v2"}], "}"}], ",", 
           "q1lim"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<n\[Gamma]cc\>\"", 
                   ",", "\"\<\[Gamma]c\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<c\>\""}], "}"}], "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "\[Gamma]vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl3"}]}], "Input",
 CellLabel->
  "In[883]:=",ExpressionUUID->"e9e1d5cf-7953-4cbc-be87-449979859ee9"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl3"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["1"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "1.0*^-10"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", 
       "\[Eta]\[Beta]", ",", "\[Beta]", ",", "n0", ",", "\[Theta]2O\[Theta]1",
        ",", "T2OT1", ",", "\[Gamma]vv12", ",", "ff", ",", "gg", ",", 
       "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileLossCone", "[", 
            RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], 
            "]"}], ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileLossCone", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1", ",", "\[Beta]"}], 
            "]"}], ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[885]:=",ExpressionUUID->"08ea6c9f-7a77-4fe8-8b19-23bf1b666bb9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Loss cone - Bi-Maxwellian", "Subsubsection",ExpressionUUID->"0b5175d8-72de-44cb-b539-9edad7abdd35"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl4", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "4"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v1lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v2lim", "=", 
        RowBox[{"6.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "\[Gamma]vhist", ",", "q1", ",", "rhist"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importRelativisticParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Gamma]vhist", "=", 
         RowBox[{"calMomentumHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v1lim", ",", "N\[Gamma]v1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v2lim", ",", "N\[Gamma]v2"}], "}"}], ",", 
           "q1lim"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<n\[Gamma]cc\>\"", 
                   ",", "\"\<\[Gamma]c\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<c\>\""}], "}"}], "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "\[Gamma]vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl4"}]}], "Input",
 CellLabel->
  "In[886]:=",ExpressionUUID->"b4ca3669-b891-4814-a52f-2652d9727f9d"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl4"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "1.0*^-10"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", 
       "\[Eta]\[Beta]", ",", "\[Beta]", ",", "n0", ",", "\[Theta]2O\[Theta]1",
        ",", "T2OT1", ",", "\[Gamma]vv12", ",", "ff", ",", "gg", ",", 
       "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileLossCone", "[", 
            RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], 
            "]"}], ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileLossCone", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1", ",", "\[Beta]"}], 
            "]"}], ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[888]:=",ExpressionUUID->"3becc930-f168-4e52-9efb-482064c4c8d7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Loss cone - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Beta]", "eq"], "=", "0.5"}], TraditionalForm]],
  ExpressionUUID->"c7951850-3148-4644-804f-5d1863a30421"]
}], "Subsubsection",ExpressionUUID->"99b8a46f-6c71-4123-9546-859235d4f8c5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl5", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "5"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v1lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v2lim", "=", 
        RowBox[{"6.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "\[Gamma]vhist", ",", "q1", ",", "rhist"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importRelativisticParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Gamma]vhist", "=", 
         RowBox[{"calMomentumHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v1lim", ",", "N\[Gamma]v1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v2lim", ",", "N\[Gamma]v2"}], "}"}], ",", 
           "q1lim"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<n\[Gamma]cc\>\"", 
                   ",", "\"\<\[Gamma]c\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<c\>\""}], "}"}], "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "\[Gamma]vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl5"}]}], "Input",
 CellLabel->
  "In[889]:=",ExpressionUUID->"3d1b38a5-30d9-4707-a77a-3827704aca13"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl5"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "0.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", 
       "\[Eta]\[Beta]", ",", "\[Beta]", ",", "n0", ",", "\[Theta]2O\[Theta]1",
        ",", "T2OT1", ",", "\[Gamma]vv12", ",", "ff", ",", "gg", ",", 
       "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileLossCone", "[", 
            RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], 
            "]"}], ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileLossCone", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1", ",", "\[Beta]"}], 
            "]"}], ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[891]:=",ExpressionUUID->"fee4b97f-8959-4ebf-82be-e2e327482bc3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Loss cone - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Beta]", "eq"], "=", "2.5"}], TraditionalForm]],
  ExpressionUUID->"3f06920e-d864-4751-a794-72d4ee46e99f"]
}], "Subsubsection",ExpressionUUID->"dfb9196d-59ad-4d1a-bedd-3726a86c664e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl6", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "6"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v1lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v2lim", "=", 
        RowBox[{"6.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "\[Gamma]vhist", ",", "q1", ",", "rhist"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importRelativisticParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Gamma]vhist", "=", 
         RowBox[{"calMomentumHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v1lim", ",", "N\[Gamma]v1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v2lim", ",", "N\[Gamma]v2"}], "}"}], ",", 
           "q1lim"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<n\[Gamma]cc\>\"", 
                   ",", "\"\<\[Gamma]c\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<c\>\""}], "}"}], "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "\[Gamma]vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl6"}]}], "Input",
 CellLabel->
  "In[892]:=",ExpressionUUID->"7679c66c-f6c3-406a-8ee8-50b8f6cd852b"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl6"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "2.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", 
       "\[Eta]\[Beta]", ",", "\[Beta]", ",", "n0", ",", "\[Theta]2O\[Theta]1",
        ",", "T2OT1", ",", "\[Gamma]vv12", ",", "ff", ",", "gg", ",", 
       "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileLossCone", "[", 
            RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], 
            "]"}], ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileLossCone", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1", ",", "\[Beta]"}], 
            "]"}], ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[894]:=",ExpressionUUID->"4da1be35-1b66-4c82-b7a5-b692e65e1317"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Partial Shell - Maxwellian", "Subsubsection",ExpressionUUID->"1b1cc39a-eb3b-419b-896c-2ff3a1f6ed48"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl7", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "7"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v1lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v2lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v2", "=", "51"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "\[Gamma]vhist", ",", "q1", ",", "rhist"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importRelativisticParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Gamma]vhist", "=", 
         RowBox[{"calMomentumHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v1lim", ",", "N\[Gamma]v1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v2lim", ",", "N\[Gamma]v2"}], "}"}], ",", 
           "q1lim"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<n\[Gamma]cc\>\"", 
                   ",", "\"\<\[Gamma]c\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<c\>\""}], "}"}], "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "\[Gamma]vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl7"}]}], "Input",
 CellLabel->
  "In[895]:=",ExpressionUUID->"35465c77-e521-4104-8a14-80dc40ff44f2"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl7"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "1.5"}], ",", 
     RowBox[{"\[Zeta]", "=", "0"}], ",", 
     RowBox[{"vs", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "plots", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", 
       "\[Gamma]vv12", ",", "ff", ",", "gg"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compilePartialShell", "[", 
            RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], "]"}], 
           ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compilePartialShell", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]", " ", "gT"}], ",", "\[Zeta]", ",", "vs"}], 
            "]"}], ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[897]:=",ExpressionUUID->"53b114e5-c4bb-4f2c-a09d-4189b3900904"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Isotropic shell", "Subsubsection",ExpressionUUID->"6324afde-8eb2-445f-9caa-3e86cfb79deb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl8", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "8"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v1lim", "=", 
        RowBox[{"2.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v2lim", "=", 
        RowBox[{"3.0", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "\[Gamma]vhist", ",", "q1", ",", "rhist"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importRelativisticParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Gamma]vhist", "=", 
         RowBox[{"calMomentumHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v1lim", ",", "N\[Gamma]v1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v2lim", ",", "N\[Gamma]v2"}], "}"}], ",", 
           "q1lim"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<n\[Gamma]cc\>\"", 
                   ",", "\"\<\[Gamma]c\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<c\>\""}], "}"}], "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "\[Gamma]vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl8"}]}], "Input",
 CellLabel->
  "In[898]:=",ExpressionUUID->"c4a1f921-0343-4134-a2cd-2627f19a9726"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl8"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "0"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "plots", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", 
       "\[Gamma]vv12", ",", "ff", ",", "gg"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compilePartialShell", "[", 
            RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], "]"}], 
           ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compilePartialShell", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]", " ", "gT"}], ",", "\[Zeta]", ",", "vs"}], 
            "]"}], ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[900]:=",ExpressionUUID->"885b5041-ccce-421d-8c68-d81323cdd220"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Partial shell - ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Zeta]", "=", "1"}], TraditionalForm]],ExpressionUUID->
  "bf39d3d2-75e5-4ee1-a635-b7bb4badd820"]
}], "Subsubsection",ExpressionUUID->"57cd3b51-98b4-46e5-8f98-842d155a92d3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl9", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "9"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v1lim", "=", 
        RowBox[{"2.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v2lim", "=", 
        RowBox[{"3.0", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "\[Gamma]vhist", ",", "q1", ",", "rhist"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importRelativisticParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Gamma]vhist", "=", 
         RowBox[{"calMomentumHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v1lim", ",", "N\[Gamma]v1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v2lim", ",", "N\[Gamma]v2"}], "}"}], ",", 
           "q1lim"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<n\[Gamma]cc\>\"", 
                   ",", "\"\<\[Gamma]c\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<c\>\""}], "}"}], "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "\[Gamma]vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl9"}]}], "Input",
 CellLabel->
  "In[901]:=",ExpressionUUID->"1416d2ec-7d3f-42a7-9315-c6f5c16197d2"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl9"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "1"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "plots", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", 
       "\[Gamma]vv12", ",", "ff", ",", "gg"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compilePartialShell", "[", 
            RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], "]"}], 
           ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compilePartialShell", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]", " ", "gT"}], ",", "\[Zeta]", ",", "vs"}], 
            "]"}], ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[903]:=",ExpressionUUID->"db6add99-68f6-4732-8796-031c7be4bbfa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Partial shell - ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Zeta]", "=", "5"}], TraditionalForm]],ExpressionUUID->
  "9ddf4c3b-4526-443e-a28e-7030060b35a7"]
}], "Subsubsection",ExpressionUUID->"2a7e28b7-349b-4ff2-942b-db1023561f34"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl10", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "10"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v1lim", "=", 
        RowBox[{"2.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v2lim", "=", 
        RowBox[{"3.0", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "\[Gamma]vhist", ",", "q1", ",", "rhist"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importRelativisticParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Gamma]vhist", "=", 
         RowBox[{"calMomentumHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v1lim", ",", "N\[Gamma]v1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v2lim", ",", "N\[Gamma]v2"}], "}"}], ",", 
           "q1lim"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<n\[Gamma]cc\>\"", 
                   ",", "\"\<\[Gamma]c\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<c\>\""}], "}"}], "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "\[Gamma]vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl10"}]}], "Input",
 CellLabel->
  "In[904]:=",ExpressionUUID->"e88fbd2d-5216-460f-ac0f-384b9da418f5"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl10"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "5"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "plots", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", 
       "\[Gamma]vv12", ",", "ff", ",", "gg"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compilePartialShell", "[", 
            RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], "]"}], 
           ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compilePartialShell", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]", " ", "gT"}], ",", "\[Zeta]", ",", "vs"}], 
            "]"}], ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[906]:=",ExpressionUUID->"5090fcf7-34fb-40cb-9182-b4269ea09712"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Counter beam - Maxwellian", "Subsubsection",ExpressionUUID->"11c0e461-3c7a-422f-9ac4-030b6e6805a0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl11", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "11"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v1lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v2lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v2", "=", "51"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "\[Gamma]vhist", ",", "q1", ",", "rhist"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importRelativisticParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Gamma]vhist", "=", 
         RowBox[{"calMomentumHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v1lim", ",", "N\[Gamma]v1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v2lim", ",", "N\[Gamma]v2"}], "}"}], ",", 
           "q1lim"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<n\[Gamma]cc\>\"", 
                   ",", "\"\<\[Gamma]c\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<c\>\""}], "}"}], "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "\[Gamma]vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl11"}]}], "Input",
 CellLabel->
  "In[907]:=",ExpressionUUID->"b1f5fecc-cfe8-464a-bc5c-eb46b08bf923"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl11"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "1.5"}], ",", 
     RowBox[{"\[Nu]0", "=", "100000"}], ",", 
     RowBox[{"vs", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "plots", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Nu]", ",", "\[Eta]", ",", 
       "n0", ",", "\[Gamma]vv12", ",", "ff", ",", "gg"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{
        RowBox[{"Sec", "[", 
         RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "\[Nu]0"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"\[Nu]", " ", 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]"}], "]"}]}], ",", 
         RowBox[{"\[Nu]0", " ", 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]0"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileCounterBeam", "[", 
            RowBox[{"n0", ",", "\[Beta]", ",", "vs", ",", "\[Nu]"}], "]"}], 
           ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileCounterBeam", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]", " ", "gT"}], ",", "vs", ",", "\[Nu]"}], "]"}],
            ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[910]:=",ExpressionUUID->"57140b2c-50fd-41c2-96d0-217691ff39f7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Counter beam - isotropic shell", "Subsubsection",ExpressionUUID->"1f8d168b-e560-4003-a128-5c26722161f1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl12", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "12"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v1lim", "=", 
        RowBox[{"2.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v2lim", "=", 
        RowBox[{"3.0", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "\[Gamma]vhist", ",", "q1", ",", "rhist"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importRelativisticParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Gamma]vhist", "=", 
         RowBox[{"calMomentumHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v1lim", ",", "N\[Gamma]v1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v2lim", ",", "N\[Gamma]v2"}], "}"}], ",", 
           "q1lim"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<n\[Gamma]cc\>\"", 
                   ",", "\"\<\[Gamma]c\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<c\>\""}], "}"}], "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "\[Gamma]vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl12"}]}], "Input",
 CellLabel->
  "In[911]:=",ExpressionUUID->"35f58b2e-0d67-4505-9a0c-fac49dbfeda0"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl12"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Nu]0", "=", "100000"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "plots", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Nu]", ",", "\[Eta]", ",", 
       "n0", ",", "\[Gamma]vv12", ",", "ff", ",", "gg"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{
        RowBox[{"Sec", "[", 
         RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "\[Nu]0"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"\[Nu]", " ", 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]"}], "]"}]}], ",", 
         RowBox[{"\[Nu]0", " ", 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]0"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileCounterBeam", "[", 
            RowBox[{"n0", ",", "\[Beta]", ",", "vs", ",", "\[Nu]"}], "]"}], 
           ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileCounterBeam", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]", " ", "gT"}], ",", "vs", ",", "\[Nu]"}], "]"}],
            ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[913]:=",ExpressionUUID->"fe1c0584-c84f-4c8f-90c5-5d57c10907ab"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Counter beam - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Nu]", "0"], "=", "1"}], TraditionalForm]],ExpressionUUID->
  "f7ffd5de-038a-4ae4-a16d-e89dc497efaf"]
}], "Subsubsection",ExpressionUUID->"1e54032e-3813-48c3-895c-5122319741ca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl13", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "13"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v1lim", "=", 
        RowBox[{"2.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v2lim", "=", 
        RowBox[{"2.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "\[Gamma]vhist", ",", "q1", ",", "rhist"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importRelativisticParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Gamma]vhist", "=", 
         RowBox[{"calMomentumHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v1lim", ",", "N\[Gamma]v1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v2lim", ",", "N\[Gamma]v2"}], "}"}], ",", 
           "q1lim"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<n\[Gamma]cc\>\"", 
                   ",", "\"\<\[Gamma]c\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<c\>\""}], "}"}], "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "\[Gamma]vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl13"}]}], "Input",
 CellLabel->
  "In[914]:=",ExpressionUUID->"2fe8d16d-1ca0-4433-8507-8bf6f1b567d7"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl13"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Nu]0", "=", "1"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "plots", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Nu]", ",", "\[Eta]", ",", 
       "n0", ",", "\[Gamma]vv12", ",", "ff", ",", "gg"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{
        RowBox[{"Sec", "[", 
         RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "\[Nu]0"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"\[Nu]", " ", 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]"}], "]"}]}], ",", 
         RowBox[{"\[Nu]0", " ", 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]0"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileCounterBeam", "[", 
            RowBox[{"n0", ",", "\[Beta]", ",", "vs", ",", "\[Nu]"}], "]"}], 
           ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileCounterBeam", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]", " ", "gT"}], ",", "vs", ",", "\[Nu]"}], "]"}],
            ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[916]:=",ExpressionUUID->"1b15904d-23af-4c41-968b-a8ffc158a3a3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Counter beam - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Nu]", "0"], "=", "0.1"}], TraditionalForm]],
  ExpressionUUID->"bdf4c4a5-9ea5-4180-b5b0-6ff60eb09799"]
}], "Subsubsection",ExpressionUUID->"9372b067-e2dd-42da-bf4c-edb2d7f275bb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl14", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "14"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v1lim", "=", 
        RowBox[{"2.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v2lim", "=", 
        RowBox[{"0.7", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "\[Gamma]vhist", ",", "q1", ",", "rhist"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importRelativisticParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Gamma]vhist", "=", 
         RowBox[{"calMomentumHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v1lim", ",", "N\[Gamma]v1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v2lim", ",", "N\[Gamma]v2"}], "}"}], ",", 
           "q1lim"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<n\[Gamma]cc\>\"", 
                   ",", "\"\<\[Gamma]c\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<c\>\""}], "}"}], "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "\[Gamma]vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl14"}]}], "Input",
 CellLabel->
  "In[917]:=",ExpressionUUID->"40c1afe9-cc1b-44c8-9acf-85ddfac431e1"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl14"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Nu]0", "=", ".1"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "plots", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Nu]", ",", "\[Eta]", ",", 
       "n0", ",", "\[Gamma]vv12", ",", "ff", ",", "gg"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Nu]", "=", 
       RowBox[{
        RowBox[{"Sec", "[", 
         RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "\[Nu]0"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"\[Nu]", " ", 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]"}], "]"}]}], ",", 
         RowBox[{"\[Nu]0", " ", 
          RowBox[{"DawsonF", "[", 
           RowBox[{"1", "/", "\[Nu]0"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileCounterBeam", "[", 
            RowBox[{"n0", ",", "\[Beta]", ",", "vs", ",", "\[Nu]"}], "]"}], 
           ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileCounterBeam", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]", " ", "gT"}], ",", "vs", ",", "\[Nu]"}], "]"}],
            ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[919]:=",ExpressionUUID->"4389c99a-957d-41d4-945b-89b6c49dd480"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1468, 1142},
WindowMargins->{{115, Automatic}, {Automatic, 74}},
FrontEndVersion->"13.2 for Mac OS X x86 (64-bit) (January 30, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"13c7468d-72b3-4754-a7ae-58931f6d390a"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 276, 6, 52, "Input",ExpressionUUID->"35414358-9cce-404a-b33a-abdb7a6986c5"],
Cell[837, 28, 259, 7, 30, "Input",ExpressionUUID->"98642d0f-5832-45f9-b8ed-04467496a470"],
Cell[1099, 37, 240, 6, 30, "Input",ExpressionUUID->"7640abcc-40a3-4b02-a665-ad3c9af5d4f1"],
Cell[CellGroupData[{
Cell[1364, 47, 97, 0, 67, "Section",ExpressionUUID->"9f12e1c2-203b-454a-a884-7860554e9154"],
Cell[1464, 49, 2221, 75, 125, "Text",ExpressionUUID->"e412d333-35f8-4d7e-9c38-00959af76376"],
Cell[3688, 126, 766, 20, 115, "Input",ExpressionUUID->"a0285dff-a04c-4fa0-9f2b-daf585a3e673"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4491, 151, 90, 0, 67, "Section",ExpressionUUID->"847df2fa-4921-4ad3-8a12-772ae439a795"],
Cell[CellGroupData[{
Cell[4606, 155, 83, 0, 54, "Subsection",ExpressionUUID->"d0695e24-7f9d-4334-8478-e96567942d55"],
Cell[4692, 157, 3492, 85, 304, "Input",ExpressionUUID->"1ec44cd5-a184-4658-be8c-4fca21fac5bf"],
Cell[8187, 244, 147, 3, 30, "Input",ExpressionUUID->"25245137-5cfc-4fd5-8f8b-3b1727393e21"],
Cell[8337, 249, 5538, 134, 472, "Input",ExpressionUUID->"165b2a5c-70b2-4a34-9de2-2bc59b9970b5"],
Cell[13878, 385, 4932, 121, 493, "Input",ExpressionUUID->"909e924c-4bab-402e-abac-e83db341f28d"],
Cell[18813, 508, 5389, 136, 493, "Input",ExpressionUUID->"b11b8c30-ec3e-4ab2-83d0-d7e26f6f4a7d"],
Cell[24205, 646, 4941, 128, 409, "Input",ExpressionUUID->"42e0356c-1f39-445c-8c6c-7e391f279571"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29183, 779, 83, 0, 54, "Subsection",ExpressionUUID->"cd6cf25d-e30d-4dae-8ee1-f32262fc6808"],
Cell[29269, 781, 2534, 67, 241, "Input",ExpressionUUID->"6f598aed-c038-4db9-bf47-b3b56562c1e8"],
Cell[CellGroupData[{
Cell[31828, 852, 90, 0, 45, "Subsubsection",ExpressionUUID->"cb7d9ce6-eb9b-4f7d-9e35-77fe1e582769"],
Cell[31921, 854, 3337, 86, 220, "Input",ExpressionUUID->"5702dbab-a126-4023-a84b-59e5a35c7564"],
Cell[35261, 942, 9786, 236, 640, "Input",ExpressionUUID->"924d8ae5-1219-456f-abd8-7e2ac6029643"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45084, 1183, 93, 0, 45, "Subsubsection",ExpressionUUID->"66338852-e001-46f5-8c9c-1b64d8c945c9"],
Cell[45180, 1185, 3337, 86, 220, "Input",ExpressionUUID->"c1158f36-932d-4e2f-947e-6f9911a933fb"],
Cell[48520, 1273, 10073, 244, 640, "Input",ExpressionUUID->"3bdea17f-a210-4f60-bebe-49420255b9df"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58630, 1522, 101, 0, 45, "Subsubsection",ExpressionUUID->"7910da06-34ae-4593-bc9e-74a69272b100"],
Cell[58734, 1524, 3337, 86, 220, "Input",ExpressionUUID->"bec4ae69-6202-4538-80b4-e2b9c215efee"],
Cell[62074, 1612, 9786, 236, 640, "Input",ExpressionUUID->"82413c55-b644-430b-99b2-f2f4526dbcc0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71897, 1853, 104, 0, 45, "Subsubsection",ExpressionUUID->"a3f84be9-399c-4419-9094-ed5eda12824f"],
Cell[72004, 1855, 3337, 86, 220, "Input",ExpressionUUID->"9d3f1bd2-ce0d-41f3-8537-b2f4ed60425e"],
Cell[75344, 1943, 10073, 244, 640, "Input",ExpressionUUID->"e333d87b-eff8-4de5-8ff4-d8827bba57ee"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85454, 2192, 271, 7, 45, "Subsubsection",ExpressionUUID->"4980b484-d4a1-42be-a914-13db437ac77d"],
Cell[85728, 2201, 3337, 86, 220, "Input",ExpressionUUID->"6b115070-2d54-49ba-b154-a649826185c9"],
Cell[89068, 2289, 11515, 281, 733, "Input",ExpressionUUID->"20f092f7-6abd-4f6b-b097-f0bc08cc06ce"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100620, 2575, 271, 7, 45, "Subsubsection",ExpressionUUID->"e3066ceb-9fb5-40aa-ba34-9cb0fd7abdac"],
Cell[100894, 2584, 3337, 86, 220, "Input",ExpressionUUID->"2eedc04d-fe4a-4f27-8290-838dbd0c8747"],
Cell[104234, 2672, 11516, 281, 733, "Input",ExpressionUUID->"159758ce-5815-4bad-bdd7-5290ee91102e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[115787, 2958, 106, 0, 45, "Subsubsection",ExpressionUUID->"51115539-fd2f-43ec-a01d-08a57471c386"],
Cell[115896, 2960, 3337, 86, 220, "Input",ExpressionUUID->"b5b93d3b-5890-4f43-8098-f48503432848"],
Cell[119236, 3048, 12235, 308, 767, "Input",ExpressionUUID->"6e384b7b-cc72-454a-95be-0b3582ad5970"]
}, Open  ]],
Cell[CellGroupData[{
Cell[131508, 3361, 95, 0, 45, "Subsubsection",ExpressionUUID->"7ec0129c-40d8-4631-bf1b-51fb8eb2c9e3"],
Cell[131606, 3363, 3337, 86, 220, "Input",ExpressionUUID->"6cd02a64-3575-4a51-8480-6b28b04b611f"],
Cell[134946, 3451, 12238, 308, 767, "Input",ExpressionUUID->"b1edadf5-5bd5-4999-8212-03f4d774ff03"]
}, Open  ]],
Cell[CellGroupData[{
Cell[147221, 3764, 249, 6, 45, "Subsubsection",ExpressionUUID->"22184aa1-da55-4c27-b9ac-23cc971f1ba8"],
Cell[147473, 3772, 3337, 86, 220, "Input",ExpressionUUID->"773c508a-4946-441c-b000-2db3a06a75b7"],
Cell[150813, 3860, 12238, 308, 767, "Input",ExpressionUUID->"e9ba3453-4dd1-4101-a9d2-b6f662465aaa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[163088, 4173, 249, 6, 45, "Subsubsection",ExpressionUUID->"27bef6b5-a9be-4af2-a6f7-a874de3627cd"],
Cell[163340, 4181, 3340, 86, 220, "Input",ExpressionUUID->"632d56b6-0f03-4ede-9a23-16788a182daf"],
Cell[166683, 4269, 12239, 308, 767, "Input",ExpressionUUID->"ee0ad69f-bc34-42c3-809f-3080483ea1ca"]
}, Open  ]],
Cell[CellGroupData[{
Cell[178959, 4582, 105, 0, 45, "Subsubsection",ExpressionUUID->"4b6ddeb1-71dc-4805-87f7-aa2cf3e33c88"],
Cell[179067, 4584, 3340, 86, 220, "Input",ExpressionUUID->"989f0d09-f8ea-448f-a52e-99f74b59faf5"],
Cell[182410, 4672, 12409, 312, 766, "Input",ExpressionUUID->"69f9e8c0-303a-4de9-a322-42d966c42544"]
}, Open  ]],
Cell[CellGroupData[{
Cell[194856, 4989, 110, 0, 45, "Subsubsection",ExpressionUUID->"11ef4dfa-6fd5-458a-ae5d-bd394c6824ed"],
Cell[194969, 4991, 3340, 86, 220, "Input",ExpressionUUID->"02c86870-3109-44f6-8d4e-384dc117b535"],
Cell[198312, 5079, 12412, 312, 766, "Input",ExpressionUUID->"ab41ef5a-c557-4806-a7b7-d69630b2567c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[210761, 5396, 270, 7, 45, "Subsubsection",ExpressionUUID->"a31a5214-7f7b-4ce5-99b4-b89ffccf4aff"],
Cell[211034, 5405, 3340, 86, 220, "Input",ExpressionUUID->"fafd59f3-ab9d-4cf3-a449-afc25397f122"],
Cell[214377, 5493, 12407, 312, 766, "Input",ExpressionUUID->"60fc5a44-c59a-49b7-8c47-09f58a3be01c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[226821, 5810, 268, 7, 45, "Subsubsection",ExpressionUUID->"59cda4ac-6ee8-49bc-922e-64c2e773968e"],
Cell[227092, 5819, 3340, 86, 220, "Input",ExpressionUUID->"dbb84057-814d-4668-81da-6ff40f7e23b6"],
Cell[230435, 5907, 12408, 312, 766, "Input",ExpressionUUID->"e31ac146-0052-42ad-8d17-258db71cdef5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[242880, 6224, 90, 0, 45, "Subsubsection",ExpressionUUID->"1e7aaa3a-a570-4c24-b90e-64b34e4e4847"],
Cell[242973, 6226, 3340, 86, 220, "Input",ExpressionUUID->"8cceee78-63f9-48e9-a0e1-ce69f442f550"],
Cell[246316, 6314, 6495, 170, 325, "Input",ExpressionUUID->"8db6a45b-c8e9-49e7-afa5-cdc0f9e8712e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[252860, 6490, 82, 0, 54, "Subsection",ExpressionUUID->"87b5ea90-0db6-483f-8519-834bcf44ddac"],
Cell[252945, 6492, 2550, 67, 241, "Input",ExpressionUUID->"031100a5-f529-474a-ac83-268d5d7c25ba"],
Cell[255498, 6561, 1788, 50, 191, "Input",ExpressionUUID->"23e38fd0-5996-4b1e-8c87-749d77fb67b3"],
Cell[257289, 6613, 2395, 68, 191, "Input",ExpressionUUID->"87d366a1-c8ba-4815-8fc8-6bb45a27781b"],
Cell[259687, 6683, 4010, 109, 426, "Input",ExpressionUUID->"0c4a0d53-0227-4c1d-9df5-c49fe37333cd"],
Cell[263700, 6794, 3908, 105, 424, "Input",ExpressionUUID->"0d5aa188-ba6a-4cbc-8225-b6d0055eda98"],
Cell[CellGroupData[{
Cell[267633, 6903, 90, 0, 45, "Subsubsection",ExpressionUUID->"fe80e185-5197-42f8-b99f-9cca5f073b7d"],
Cell[267726, 6905, 899, 25, 94, "Input",ExpressionUUID->"f605ebca-de2f-4079-8328-128010bd5dda"],
Cell[268628, 6932, 34172, 783, 2782, "Input",ExpressionUUID->"5cdc9089-b8c9-4385-aa1b-7d765c270b48"]
}, Open  ]],
Cell[CellGroupData[{
Cell[302837, 7720, 93, 0, 45, "Subsubsection",ExpressionUUID->"ac9a0ef0-1ed7-4c49-894b-8d040b1265af"],
Cell[302933, 7722, 899, 25, 94, "Input",ExpressionUUID->"30e29baf-be22-4a23-9455-cfb8d5cc8176"],
Cell[303835, 7749, 34172, 783, 2782, "Input",ExpressionUUID->"24babefe-2ca7-45a8-bfe8-ab69c67cf459"]
}, Open  ]],
Cell[CellGroupData[{
Cell[338044, 8537, 102, 0, 45, "Subsubsection",ExpressionUUID->"e301e7dc-eb33-46da-86eb-8f8e6243a88e"],
Cell[338149, 8539, 899, 25, 94, "Input",ExpressionUUID->"354e6873-e1ec-483e-a49a-8830fb2ba2ec"],
Cell[339051, 8566, 35657, 821, 2875, "Input",ExpressionUUID->"1b1960bb-dfd3-42da-8f90-2cabf37dc77a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[374745, 9392, 105, 0, 45, "Subsubsection",ExpressionUUID->"f0e7d15b-2c81-4f41-868d-6745ac8e65db"],
Cell[374853, 9394, 899, 25, 94, "Input",ExpressionUUID->"0772f7b0-48e0-4b2d-8541-a07d79f2ca5d"],
Cell[375755, 9421, 35657, 821, 2875, "Input",ExpressionUUID->"516ce6ad-b483-4ff9-bf73-83ba5e152724"]
}, Open  ]],
Cell[CellGroupData[{
Cell[411449, 10247, 272, 7, 48, "Subsubsection",ExpressionUUID->"09c53460-8f0c-4f01-90b3-594ffa8138dc"],
Cell[411724, 10256, 899, 25, 94, "Input",ExpressionUUID->"d0cfef55-6cad-446f-8c55-c8501fc3af46"],
Cell[412626, 10283, 35648, 820, 2875, "Input",ExpressionUUID->"184f72e9-532f-4217-a144-e0bc44cc73c3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[448311, 11108, 272, 7, 48, "Subsubsection",ExpressionUUID->"674ebfdd-4362-4560-866b-f9fe043036cf"],
Cell[448586, 11117, 899, 25, 94, "Input",ExpressionUUID->"06c87354-63c2-4a6f-be12-e2fb0478ac00"],
Cell[449488, 11144, 35648, 820, 2875, "Input",ExpressionUUID->"f735f831-0bc3-40a4-9c52-c27695b114e1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[485173, 11969, 106, 0, 45, "Subsubsection",ExpressionUUID->"e264d83a-6c95-4ac5-9721-0f1e04acc04f"],
Cell[485282, 11971, 899, 25, 94, "Input",ExpressionUUID->"489b4e47-5b2e-482d-9fc0-69cf95a5d05f"],
Cell[486184, 11998, 33952, 777, 2761, "Input",ExpressionUUID->"a2b28cda-daca-4adb-8339-21de3d02e7dd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[520173, 12780, 95, 0, 45, "Subsubsection",ExpressionUUID->"6eb3c79b-eff6-4460-8253-47e96d5ee614"],
Cell[520271, 12782, 899, 25, 94, "Input",ExpressionUUID->"f57bb4e7-f06e-4745-bc6b-63fd2c0beb06"],
Cell[521173, 12809, 33955, 777, 2761, "Input",ExpressionUUID->"f0394d30-2067-47b3-8e35-57bbbfb8f7f1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[555165, 13591, 249, 6, 45, "Subsubsection",ExpressionUUID->"5dae1cb7-fb06-4091-b03e-968418fa9c75"],
Cell[555417, 13599, 899, 25, 94, "Input",ExpressionUUID->"f680c9c5-a9a6-49ee-bec0-059f006df748"],
Cell[556319, 13626, 33955, 777, 2761, "Input",ExpressionUUID->"5e21fdad-81e8-40e3-8834-d06a327d2dd8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[590311, 14408, 249, 6, 45, "Subsubsection",ExpressionUUID->"e115932c-e11d-4697-99f7-effb712dd1d5"],
Cell[590563, 14416, 902, 25, 94, "Input",ExpressionUUID->"e5c1bd5b-d3eb-4d82-9320-2133ba724e35"],
Cell[591468, 14443, 33956, 777, 2761, "Input",ExpressionUUID->"d467d30e-a58a-434d-bb04-91e18e536b77"]
}, Open  ]],
Cell[CellGroupData[{
Cell[625461, 15225, 105, 0, 45, "Subsubsection",ExpressionUUID->"88577145-53b2-45f2-befa-c6328576974c"],
Cell[625569, 15227, 902, 25, 94, "Input",ExpressionUUID->"27dce91b-13b3-4814-8ce6-7ae13050d04d"],
Cell[626474, 15254, 34431, 790, 2782, "Input",ExpressionUUID->"2eb96b85-47b8-4480-ad8a-e96c34742f20"]
}, Open  ]],
Cell[CellGroupData[{
Cell[660942, 16049, 110, 0, 45, "Subsubsection",ExpressionUUID->"a796a14f-e636-4854-9cf6-3b4263b58f82"],
Cell[661055, 16051, 902, 25, 94, "Input",ExpressionUUID->"762414c1-c427-4a2a-8924-be887f04946e"],
Cell[661960, 16078, 34434, 790, 2782, "Input",ExpressionUUID->"501f2c08-e5ac-452c-863d-19b1afa616af"]
}, Open  ]],
Cell[CellGroupData[{
Cell[696431, 16873, 270, 7, 45, "Subsubsection",ExpressionUUID->"70285619-b808-4ccf-a159-53e96984bebc"],
Cell[696704, 16882, 902, 25, 94, "Input",ExpressionUUID->"cd68cb77-d141-4727-9149-f0a16b904b97"],
Cell[697609, 16909, 34429, 790, 2782, "Input",ExpressionUUID->"f08b5895-f9e4-4037-a990-fe6fba0f7fb1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[732075, 17704, 272, 7, 45, "Subsubsection",ExpressionUUID->"c308e20b-faa5-4985-aea4-e6e226905b9c"],
Cell[732350, 17713, 902, 25, 94, "Input",ExpressionUUID->"03de21da-e94b-4ac2-84b3-8bd4a62a2813"],
Cell[733255, 17740, 34430, 790, 2782, "Input",ExpressionUUID->"6dd9eaac-b76a-4c19-9e1e-f0b0e7a222bb"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[767734, 18536, 85, 0, 54, "Subsection",ExpressionUUID->"5fd3b1be-689f-429f-b7e4-8019920ed1c4"],
Cell[767822, 18538, 2552, 67, 241, "Input",ExpressionUUID->"893da2a7-7e5d-432e-b173-f8eaf133cea4"],
Cell[770377, 18607, 1788, 50, 191, "Input",ExpressionUUID->"cb341572-e53f-4af1-9c6e-ed9448575ba6"],
Cell[772168, 18659, 2395, 68, 191, "Input",ExpressionUUID->"45b8a89b-813c-48e5-adf5-13fd6fe5a6f5"],
Cell[774566, 18729, 4010, 109, 426, "Input",ExpressionUUID->"a7dddd1d-ebb0-4cac-80db-99d04aa3ebec"],
Cell[778579, 18840, 3908, 105, 424, "Input",ExpressionUUID->"b5cd3f93-f0d4-4ff7-9ec0-63cb690624b2"],
Cell[CellGroupData[{
Cell[782512, 18949, 90, 0, 45, "Subsubsection",ExpressionUUID->"36a1f4fc-a9cc-4b45-a98e-bb5e12f6c6e3"],
Cell[782605, 18951, 4654, 115, 367, "Input",ExpressionUUID->"9f097443-e5b5-4b5e-a35b-87e5696bf097"],
Cell[787262, 19068, 18809, 437, 1666, "Input",ExpressionUUID->"1467e5f1-23c4-4fb5-b056-e0e7cdcb825d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[806108, 19510, 93, 0, 45, "Subsubsection",ExpressionUUID->"8adb1f5d-23b5-47fe-9819-00234264bcad"],
Cell[806204, 19512, 4654, 115, 367, "Input",ExpressionUUID->"fbd90576-d11a-4dd7-99ff-ee2dd90257e7"],
Cell[810861, 19629, 18809, 437, 1666, "Input",ExpressionUUID->"bdf67aff-9b63-49c3-8a4a-1fbbe0a4de5e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[829707, 20071, 102, 0, 45, "Subsubsection",ExpressionUUID->"ff204e1f-d465-4e45-9f15-b73c3c893168"],
Cell[829812, 20073, 4654, 115, 367, "Input",ExpressionUUID->"96fe0e7f-76ca-4d7d-a9ae-193e995d5e47"],
Cell[834469, 20190, 20312, 477, 1751, "Input",ExpressionUUID->"7b43c61b-d5ad-4fdd-a772-d4d0ed3a5201"]
}, Open  ]],
Cell[CellGroupData[{
Cell[854818, 20672, 105, 0, 45, "Subsubsection",ExpressionUUID->"07cb930f-0154-42c4-a84b-64000b6a5919"],
Cell[854926, 20674, 4654, 115, 367, "Input",ExpressionUUID->"f80e0095-8f0a-4fe4-90c4-7fb3081b8a1b"],
Cell[859583, 20791, 20312, 477, 1751, "Input",ExpressionUUID->"51ef39fa-77c6-4a43-9e93-38d99f692bac"]
}, Open  ]],
Cell[CellGroupData[{
Cell[879932, 21273, 272, 7, 48, "Subsubsection",ExpressionUUID->"453a29b7-4b7f-4c4e-8b5d-32e8bf4fe9a4"],
Cell[880207, 21282, 4654, 115, 367, "Input",ExpressionUUID->"0e51ec89-08a0-4054-84d8-3643b3203a1c"],
Cell[884864, 21399, 20303, 476, 1751, "Input",ExpressionUUID->"57e2e1ce-cc9a-4e6e-b9b0-5f50e329419d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[905204, 21880, 272, 7, 48, "Subsubsection",ExpressionUUID->"420d5dbe-eb47-4c9a-b990-17c8bf2c417f"],
Cell[905479, 21889, 4654, 115, 367, "Input",ExpressionUUID->"4128df59-a0ee-48c9-a3b5-58536eb92fd0"],
Cell[910136, 22006, 20303, 476, 1751, "Input",ExpressionUUID->"d183ec4e-ef5d-4e9e-89f7-1752fde91471"]
}, Open  ]],
Cell[CellGroupData[{
Cell[930476, 22487, 106, 0, 45, "Subsubsection",ExpressionUUID->"4cde35e2-2a6c-42fb-8a21-d536aaf2b1c0"],
Cell[930585, 22489, 4654, 115, 367, "Input",ExpressionUUID->"fdd05f59-c9bf-4ee7-b6e7-1ec4e8adb3e6"],
Cell[935242, 22606, 18608, 433, 1645, "Input",ExpressionUUID->"3b80149a-2520-4e15-9c72-3095b1089618"]
}, Open  ]],
Cell[CellGroupData[{
Cell[953887, 23044, 95, 0, 45, "Subsubsection",ExpressionUUID->"9c707734-a002-4b4f-a78f-4088c49d8d3c"],
Cell[953985, 23046, 4654, 115, 367, "Input",ExpressionUUID->"398aa1e0-b84f-4764-a659-9a8c5ffcdb98"],
Cell[958642, 23163, 18611, 433, 1645, "Input",ExpressionUUID->"26061cd9-12aa-490f-b1d5-6c11255c1278"]
}, Open  ]],
Cell[CellGroupData[{
Cell[977290, 23601, 249, 6, 45, "Subsubsection",ExpressionUUID->"50d02012-23a3-4fdc-b5f8-faf0710d9674"],
Cell[977542, 23609, 4654, 115, 367, "Input",ExpressionUUID->"9a7809fb-2c2d-4650-8a3f-b5bb9dfe2995"],
Cell[982199, 23726, 18611, 433, 1645, "Input",ExpressionUUID->"89c4593d-3e80-4b8f-bdd1-6fd0449d22c0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1000847, 24164, 249, 6, 45, "Subsubsection",ExpressionUUID->"7950b24b-c9da-4d79-9d2d-f2e2a50a72e5"],
Cell[1001099, 24172, 4657, 115, 367, "Input",ExpressionUUID->"8ec05565-1468-434e-90e1-fa9efc4065ed"],
Cell[1005759, 24289, 18612, 433, 1645, "Input",ExpressionUUID->"ed6fdec6-abd6-443c-b685-c3ef58ecb9e8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1024408, 24727, 105, 0, 45, "Subsubsection",ExpressionUUID->"4cec448c-3d7a-4fd7-9c0a-e1836675128f"],
Cell[1024516, 24729, 4657, 115, 367, "Input",ExpressionUUID->"e3f0d1a5-770d-47f9-9e5c-1b5acc92301f"],
Cell[1029176, 24846, 19086, 446, 1666, "Input",ExpressionUUID->"58814c80-a843-43cb-81e2-6f7b9a64138e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1048299, 25297, 110, 0, 45, "Subsubsection",ExpressionUUID->"b2787023-e854-4d97-bdb2-555e1e255c32"],
Cell[1048412, 25299, 4657, 115, 367, "Input",ExpressionUUID->"03e006c2-6f13-41fa-a52c-2268281afb64"],
Cell[1053072, 25416, 19089, 446, 1666, "Input",ExpressionUUID->"2ae1959d-ae38-4ff3-94a2-215a15b4a6e6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1072198, 25867, 270, 7, 45, "Subsubsection",ExpressionUUID->"425c0b4d-707b-4e30-9d81-0bacf5478281"],
Cell[1072471, 25876, 4657, 115, 367, "Input",ExpressionUUID->"7ede2f19-f009-4a5c-8a46-7b26e09fcfb4"],
Cell[1077131, 25993, 19084, 446, 1666, "Input",ExpressionUUID->"9150111a-7c50-4ba0-9fee-8a357fc77a15"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1096252, 26444, 268, 7, 45, "Subsubsection",ExpressionUUID->"e60b2247-50ac-4405-bbdb-493619026322"],
Cell[1096523, 26453, 4657, 115, 367, "Input",ExpressionUUID->"922fdd4b-1f2c-464d-b78f-98eed0571d1a"],
Cell[1101183, 26570, 19085, 446, 1666, "Input",ExpressionUUID->"d6f70ad5-fa18-4fe0-84df-eff5abcac98b"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[1120329, 27023, 86, 0, 53, "Section",ExpressionUUID->"049bdef6-6ff3-441e-9834-854918644d50"],
Cell[CellGroupData[{
Cell[1120440, 27027, 83, 0, 54, "Subsection",ExpressionUUID->"d6bbe9ce-e81c-4417-8a75-9db60646a1a1"],
Cell[1120526, 27029, 3492, 85, 304, "Input",ExpressionUUID->"5af87966-7ad5-4915-b423-a530c1b88ade"],
Cell[1124021, 27116, 147, 3, 30, "Input",ExpressionUUID->"01777970-3e72-4129-8b96-05a4ad95277a"],
Cell[1124171, 27121, 5577, 135, 472, "Input",ExpressionUUID->"7328c186-3089-40c8-b97d-7a65c857185d"],
Cell[1129751, 27258, 5127, 127, 493, "Input",ExpressionUUID->"fcab10d7-7b6d-4ee9-b2d1-81e593575264"],
Cell[1134881, 27387, 5551, 139, 493, "Input",ExpressionUUID->"9fdae9ed-6252-4ec2-b7e6-89d9ab850e3d"],
Cell[1140435, 27528, 5010, 130, 409, "Input",ExpressionUUID->"b3a0de19-ea50-4af9-b6fb-aec6c87ba033"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1145482, 27663, 83, 0, 54, "Subsection",ExpressionUUID->"8bab2c33-d95c-41f6-a9df-a55c1f8da90f"],
Cell[1145568, 27665, 2534, 67, 241, "Input",ExpressionUUID->"7fe74a65-87d2-41fd-9f7e-6086933d5ee9"],
Cell[1148105, 27734, 1788, 50, 191, "Input",ExpressionUUID->"3510a4dc-20bc-4764-8fcd-94131ca416fe"],
Cell[1149896, 27786, 2395, 68, 191, "Input",ExpressionUUID->"298398bb-8b8b-4a10-8c21-2ff961485459"],
Cell[1152294, 27856, 4010, 109, 426, "Input",ExpressionUUID->"e40fce72-be50-45ca-a8e6-1b607548d481"],
Cell[1156307, 27967, 3908, 105, 424, "Input",ExpressionUUID->"937a4f23-f60b-45c0-9c8f-3cde34fc2c75"],
Cell[CellGroupData[{
Cell[1160240, 28076, 90, 0, 45, "Subsubsection",ExpressionUUID->"ddc277b0-c34c-48ad-a79c-e36819923521"],
Cell[1160333, 28078, 3678, 94, 241, "Input",ExpressionUUID->"7a555eae-a0a9-4fed-82b9-c337510fe03c"],
Cell[1164014, 28174, 15667, 369, 1139, "Input",ExpressionUUID->"16d8e1ea-6c16-43c7-bdb1-9cb8ada304dc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1179718, 28548, 93, 0, 45, "Subsubsection",ExpressionUUID->"cfb74493-f898-425d-8e91-4d90c50a2157"],
Cell[1179814, 28550, 3678, 94, 241, "Input",ExpressionUUID->"6aca6b0c-7305-4db1-a30d-6e095dece959"],
Cell[1183495, 28646, 15667, 369, 1139, "Input",ExpressionUUID->"b09322f1-58bf-4f3d-8718-bec806aa24f0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1199199, 29020, 101, 0, 45, "Subsubsection",ExpressionUUID->"9d1ccb1f-8b24-4f8f-ba47-7fded7019e4e"],
Cell[1199303, 29022, 3678, 94, 241, "Input",ExpressionUUID->"41c9806f-94b8-4d02-ae04-ef94c4e9e016"],
Cell[1202984, 29118, 17303, 411, 1204, "Input",ExpressionUUID->"5974ab6e-13db-4e00-9c87-b9006dc9260a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1220324, 29534, 104, 0, 45, "Subsubsection",ExpressionUUID->"47a11008-a6c4-4886-a479-09376b05a9bd"],
Cell[1220431, 29536, 3678, 94, 241, "Input",ExpressionUUID->"237d1028-5bf3-4148-89a6-ff43d9df1091"],
Cell[1224112, 29632, 17303, 411, 1204, "Input",ExpressionUUID->"038e52a0-33c0-409e-bec9-540fa4082ead"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1241452, 30048, 271, 7, 45, "Subsubsection",ExpressionUUID->"ad1ee675-19c9-4bb5-87f7-6f5c23dc87fe"],
Cell[1241726, 30057, 3678, 94, 241, "Input",ExpressionUUID->"41f2eafb-7911-420f-8c46-2daaf4790f80"],
Cell[1245407, 30153, 17293, 410, 1204, "Input",ExpressionUUID->"14b10031-8666-4e0a-b81f-415a3bbaec35"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1262737, 30568, 271, 7, 45, "Subsubsection",ExpressionUUID->"7cd87267-c2be-498e-ba25-40560d948519"],
Cell[1263011, 30577, 3678, 94, 241, "Input",ExpressionUUID->"2d1e5b20-f65e-4c54-bf3c-9f45d6712df2"],
Cell[1266692, 30673, 17294, 410, 1204, "Input",ExpressionUUID->"1ccfe769-e751-49bc-8e9f-d98fcd25736c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1284023, 31088, 106, 0, 45, "Subsubsection",ExpressionUUID->"cdd4ca52-a017-4c36-baf5-a99f5ad778e9"],
Cell[1284132, 31090, 3678, 94, 241, "Input",ExpressionUUID->"de35aae0-eafc-400a-b227-8ce129d0917a"],
Cell[1287813, 31186, 15389, 362, 1096, "Input",ExpressionUUID->"27492e21-50be-40ed-bf2b-11a024f3cacc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1303239, 31553, 95, 0, 45, "Subsubsection",ExpressionUUID->"f3408f53-1470-4fbc-a420-68ab9b513b5d"],
Cell[1303337, 31555, 3678, 94, 241, "Input",ExpressionUUID->"71fc302a-b01c-45b9-93e2-2a89905e0be5"],
Cell[1307018, 31651, 15392, 362, 1096, "Input",ExpressionUUID->"59d5142a-c332-4c58-b59f-5208172f2c85"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1322447, 32018, 249, 6, 45, "Subsubsection",ExpressionUUID->"87b5b180-6800-464c-8cf9-86e78965ba97"],
Cell[1322699, 32026, 3678, 94, 241, "Input",ExpressionUUID->"0651bc90-a8fe-4302-9e6b-b8c5fb92bc8b"],
Cell[1326380, 32122, 15392, 362, 1096, "Input",ExpressionUUID->"d5c8ecb4-20ff-4027-adf6-3fad8e47a77d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1341809, 32489, 249, 6, 45, "Subsubsection",ExpressionUUID->"1fea2f03-a1cd-4796-bf70-0006266d721b"],
Cell[1342061, 32497, 3681, 94, 241, "Input",ExpressionUUID->"9cb50e31-8afc-41da-bfe8-4e823fae8b12"],
Cell[1345745, 32593, 15393, 362, 1096, "Input",ExpressionUUID->"d72e11f1-2040-4412-b40c-c71a6461c58a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1361175, 32960, 105, 0, 45, "Subsubsection",ExpressionUUID->"512a1dc4-163c-4a4a-a637-95d70a5bd3b6"],
Cell[1361283, 32962, 3681, 94, 241, "Input",ExpressionUUID->"7c2d7bea-b693-482c-8378-3c913d58d2f2"],
Cell[1364967, 33058, 15939, 377, 1117, "Input",ExpressionUUID->"0d50e98f-4d6c-4cfa-a38c-e1bf70097c1a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1380943, 33440, 110, 0, 45, "Subsubsection",ExpressionUUID->"e53922b5-9590-4b75-bfb7-b7142ad5bdda"],
Cell[1381056, 33442, 3681, 94, 241, "Input",ExpressionUUID->"3c45466c-5b60-4357-a172-2334f1d164a9"],
Cell[1384740, 33538, 15942, 377, 1117, "Input",ExpressionUUID->"537ca204-0c06-421e-8fa6-e5364b7c81b2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1400719, 33920, 270, 7, 45, "Subsubsection",ExpressionUUID->"7889ea8e-503f-477b-8723-60e8c50ed71b"],
Cell[1400992, 33929, 3681, 94, 241, "Input",ExpressionUUID->"d7127765-01e6-489a-b31b-ffc332ea7276"],
Cell[1404676, 34025, 15937, 377, 1117, "Input",ExpressionUUID->"c3ee5bd8-23bf-421c-84f4-53fe38705507"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1420650, 34407, 268, 7, 45, "Subsubsection",ExpressionUUID->"efc17c99-6c04-47ce-a4de-28171fe10af6"],
Cell[1420921, 34416, 3681, 94, 241, "Input",ExpressionUUID->"ed131f29-0dc6-4e46-9fbf-b30d0f643bf4"],
Cell[1424605, 34512, 15938, 377, 1117, "Input",ExpressionUUID->"12be4993-8a2c-41f6-acf1-2980bff3c131"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1440580, 34894, 90, 0, 45, "Subsubsection",ExpressionUUID->"4edb9e72-6721-4b18-870b-ec377a2f788e"],
Cell[1440673, 34896, 3681, 94, 241, "Input",ExpressionUUID->"7c8ef4d8-98c9-4077-8302-179b47115928"],
Cell[1444357, 34992, 6561, 173, 325, "Input",ExpressionUUID->"90c718fe-3a88-4069-a272-25467d8b4830"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1450967, 35171, 82, 0, 54, "Subsection",ExpressionUUID->"997996cf-89a4-4991-8ffc-c230229c881f"],
Cell[1451052, 35173, 2552, 67, 241, "Input",ExpressionUUID->"e117c764-e5f8-418c-a297-5adadaec257b"],
Cell[1453607, 35242, 1788, 50, 191, "Input",ExpressionUUID->"5909326c-1855-4206-8845-a65d02876914"],
Cell[1455398, 35294, 2395, 68, 191, "Input",ExpressionUUID->"4db05d20-a675-4dc3-9bda-2ee9c09c5366"],
Cell[1457796, 35364, 4010, 109, 426, "Input",ExpressionUUID->"a7859a12-107c-4fbe-a4d6-d12004caf481"],
Cell[1461809, 35475, 3908, 105, 424, "Input",ExpressionUUID->"153676d8-00eb-4307-9671-861e492d0c54"],
Cell[CellGroupData[{
Cell[1465742, 35584, 90, 0, 45, "Subsubsection",ExpressionUUID->"d10d8033-a66b-4393-a8cb-670cd72e5548"],
Cell[1465835, 35586, 911, 25, 94, "Input",ExpressionUUID->"da645338-f2a4-446c-be72-74ca60f5b244"],
Cell[1466749, 35613, 35079, 786, 2782, "Input",ExpressionUUID->"606d39b8-87cc-4bd9-bf59-67236fd16194"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1501865, 36404, 93, 0, 45, "Subsubsection",ExpressionUUID->"13a4823e-ac7d-411a-bfa7-214b68eed661"],
Cell[1501961, 36406, 911, 25, 94, "Input",ExpressionUUID->"358286e0-1852-4590-bd31-ee0d264e6157"],
Cell[1502875, 36433, 35079, 786, 2782, "Input",ExpressionUUID->"97722b2b-dd5e-4845-8646-8dea8c604bff"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1537991, 37224, 102, 0, 45, "Subsubsection",ExpressionUUID->"8b5a1d8f-2e7e-4610-8804-00cc69919962"],
Cell[1538096, 37226, 911, 25, 94, "Input",ExpressionUUID->"059c1c8d-d9c0-4514-804f-f6e54b939747"],
Cell[1539010, 37253, 36557, 824, 2875, "Input",ExpressionUUID->"e34fa43a-618f-455f-abf5-fcaadfe905ac"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1575604, 38082, 105, 0, 45, "Subsubsection",ExpressionUUID->"f3a0152c-b4bf-4104-9df7-9825b312236c"],
Cell[1575712, 38084, 911, 25, 94, "Input",ExpressionUUID->"0cdaf02d-030b-47ff-abd9-b2d8e5aaf998"],
Cell[1576626, 38111, 36557, 824, 2875, "Input",ExpressionUUID->"242c22bf-a27a-41e0-a95b-faf19f90b67e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1613220, 38940, 272, 7, 48, "Subsubsection",ExpressionUUID->"2d584d4e-aca4-40ea-abb1-5febd213865b"],
Cell[1613495, 38949, 911, 25, 94, "Input",ExpressionUUID->"f1930530-5934-4184-9bec-ac38bded1c6c"],
Cell[1614409, 38976, 36548, 823, 2875, "Input",ExpressionUUID->"419f4ebb-de08-4a93-b9a7-0272ae5b2cb8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1650994, 39804, 272, 7, 48, "Subsubsection",ExpressionUUID->"85c5e31b-54d9-48e7-af2e-c40d4f1a2cc6"],
Cell[1651269, 39813, 911, 25, 94, "Input",ExpressionUUID->"e82cfc9c-d286-4a5c-955d-f0bd54ee0e6c"],
Cell[1652183, 39840, 36548, 823, 2875, "Input",ExpressionUUID->"6db91dd7-71ec-4fd0-9c0d-ba5b3012ab76"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1688768, 40668, 106, 0, 45, "Subsubsection",ExpressionUUID->"013a1f16-e084-4c3e-ac42-d68210c8e57a"],
Cell[1688877, 40670, 911, 25, 94, "Input",ExpressionUUID->"2b8c8682-69fd-4f94-b209-1831d67f21a1"],
Cell[1689791, 40697, 34850, 780, 2761, "Input",ExpressionUUID->"7f4489aa-8ade-4596-8d9c-4d0058bff819"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1724678, 41482, 95, 0, 45, "Subsubsection",ExpressionUUID->"87264bae-dad2-40bc-9bd6-4728ef9f88c4"],
Cell[1724776, 41484, 911, 25, 94, "Input",ExpressionUUID->"252b1fc0-447a-4871-a3db-3122b47c9d02"],
Cell[1725690, 41511, 34853, 780, 2761, "Input",ExpressionUUID->"b19411bf-c796-49d0-b788-065d98d88ebb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1760580, 42296, 249, 6, 45, "Subsubsection",ExpressionUUID->"bf57786b-be3a-4b32-b539-b4ebb0366f3d"],
Cell[1760832, 42304, 911, 25, 94, "Input",ExpressionUUID->"35cf0d2d-ef01-4ee4-afad-a6ac1acbabb9"],
Cell[1761746, 42331, 34853, 780, 2761, "Input",ExpressionUUID->"be0a0374-2f78-40af-852a-464d3ea2cd98"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1796636, 43116, 249, 6, 45, "Subsubsection",ExpressionUUID->"691309da-dc5e-453b-b371-b7d84af6b73c"],
Cell[1796888, 43124, 914, 25, 94, "Input",ExpressionUUID->"9587ba05-32d4-4d37-a75c-ba7c5bfe1872"],
Cell[1797805, 43151, 34854, 780, 2761, "Input",ExpressionUUID->"c81072ea-4274-4e6d-8d0d-ec69e8bbfab8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1832696, 43936, 105, 0, 45, "Subsubsection",ExpressionUUID->"f49b195c-5d26-49a0-843e-75ca1b38127d"],
Cell[1832804, 43938, 914, 25, 94, "Input",ExpressionUUID->"2a01d1a6-615b-431b-a8dc-37d1919328dc"],
Cell[1833721, 43965, 35178, 789, 2782, "Input",ExpressionUUID->"3ceed081-7fd1-4671-b4ec-f309e4b9acbf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1868936, 44759, 110, 0, 45, "Subsubsection",ExpressionUUID->"8d5a1747-d016-43f6-9efe-36dc54347844"],
Cell[1869049, 44761, 914, 25, 94, "Input",ExpressionUUID->"2fb43abd-be6f-4d9c-b4e3-9a7c1d0d16a7"],
Cell[1869966, 44788, 35181, 789, 2782, "Input",ExpressionUUID->"e9ca8279-b0ad-4ba8-b4ba-60f8853c76ce"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1905184, 45582, 270, 7, 45, "Subsubsection",ExpressionUUID->"f7b2e3cf-ac3e-4058-820a-353f3bad2af3"],
Cell[1905457, 45591, 914, 25, 94, "Input",ExpressionUUID->"3dfedf8f-9eeb-4632-afe5-6210b8c45cb6"],
Cell[1906374, 45618, 35176, 789, 2782, "Input",ExpressionUUID->"f4c49113-2adf-4ae3-abe4-b884acfef679"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1941587, 46412, 272, 7, 45, "Subsubsection",ExpressionUUID->"0e1319e5-d33d-42be-92d6-84267ce260cf"],
Cell[1941862, 46421, 914, 25, 94, "Input",ExpressionUUID->"5e282e21-2474-43aa-ba16-d7caef70bbc1"],
Cell[1942779, 46448, 35177, 789, 2782, "Input",ExpressionUUID->"55bcee7f-b914-438b-911a-d91f78918edb"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1978005, 47243, 85, 0, 54, "Subsection",ExpressionUUID->"023b24a9-16b6-4fb7-b2e9-c6cf3a306a33"],
Cell[1978093, 47245, 2552, 67, 241, "Input",ExpressionUUID->"468f27fd-8a91-44f3-9254-2d6c5d26f5ce"],
Cell[1980648, 47314, 1788, 50, 191, "Input",ExpressionUUID->"b110facb-79d2-47de-8a1f-dc5092cfec2b"],
Cell[1982439, 47366, 2395, 68, 191, "Input",ExpressionUUID->"7ca9c11b-346c-4d01-8ead-6ea875f5a953"],
Cell[1984837, 47436, 4010, 109, 426, "Input",ExpressionUUID->"087b0d9f-e776-40d6-a246-3234f96b3215"],
Cell[1988850, 47547, 3908, 105, 424, "Input",ExpressionUUID->"f80d1f0a-25e1-4203-8d8d-4cac8d707808"],
Cell[CellGroupData[{
Cell[1992783, 47656, 90, 0, 45, "Subsubsection",ExpressionUUID->"479e96aa-b6c4-4c6e-a00b-44d7e9a04ac0"],
Cell[1992876, 47658, 5156, 122, 388, "Input",ExpressionUUID->"6f0c0881-47e1-49d1-9273-dda0b8b971bc"],
Cell[1998035, 47782, 16337, 371, 1522, "Input",ExpressionUUID->"4d3cf1f4-020b-426a-af0d-ea7e77c05cee"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2014409, 48158, 93, 0, 45, "Subsubsection",ExpressionUUID->"2e74fbbb-c808-4225-be09-4cdaf4d7a33d"],
Cell[2014505, 48160, 5156, 122, 388, "Input",ExpressionUUID->"7d0333b0-bbb2-45d3-bb64-e540f9b0e48d"],
Cell[2019664, 48284, 16337, 371, 1522, "Input",ExpressionUUID->"03540508-00cf-42bf-ac8f-6184de1717d9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2036038, 48660, 102, 0, 45, "Subsubsection",ExpressionUUID->"c77d42dd-e2e9-4afd-908d-a66540d6bb87"],
Cell[2036143, 48662, 5156, 122, 388, "Input",ExpressionUUID->"e9e1d5cf-7953-4cbc-be87-449979859ee9"],
Cell[2041302, 48786, 17841, 411, 1615, "Input",ExpressionUUID->"08ea6c9f-7a77-4fe8-8b19-23bf1b666bb9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2059180, 49202, 105, 0, 45, "Subsubsection",ExpressionUUID->"0b5175d8-72de-44cb-b539-9edad7abdd35"],
Cell[2059288, 49204, 5156, 122, 388, "Input",ExpressionUUID->"b4ca3669-b891-4814-a52f-2652d9727f9d"],
Cell[2064447, 49328, 17841, 411, 1615, "Input",ExpressionUUID->"3becc930-f168-4e52-9efb-482064c4c8d7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2082325, 49744, 272, 7, 48, "Subsubsection",ExpressionUUID->"99b8a46f-6c71-4123-9546-859235d4f8c5"],
Cell[2082600, 49753, 5156, 122, 388, "Input",ExpressionUUID->"3d1b38a5-30d9-4707-a77a-3827704aca13"],
Cell[2087759, 49877, 17832, 410, 1615, "Input",ExpressionUUID->"fee4b97f-8959-4ebf-82be-e2e327482bc3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2105628, 50292, 272, 7, 48, "Subsubsection",ExpressionUUID->"dfb9196d-59ad-4d1a-bedd-3726a86c664e"],
Cell[2105903, 50301, 5156, 122, 388, "Input",ExpressionUUID->"7679c66c-f6c3-406a-8ee8-50b8f6cd852b"],
Cell[2111062, 50425, 17832, 410, 1615, "Input",ExpressionUUID->"4da1be35-1b66-4c82-b7a5-b692e65e1317"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2128931, 50840, 106, 0, 45, "Subsubsection",ExpressionUUID->"1b1cc39a-eb3b-419b-896c-2ff3a1f6ed48"],
Cell[2129040, 50842, 5156, 122, 388, "Input",ExpressionUUID->"35465c77-e521-4104-8a14-80dc40ff44f2"],
Cell[2134199, 50966, 16135, 367, 1501, "Input",ExpressionUUID->"53b114e5-c4bb-4f2c-a09d-4189b3900904"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2150371, 51338, 95, 0, 45, "Subsubsection",ExpressionUUID->"6324afde-8eb2-445f-9caa-3e86cfb79deb"],
Cell[2150469, 51340, 5156, 122, 388, "Input",ExpressionUUID->"c4a1f921-0343-4134-a2cd-2627f19a9726"],
Cell[2155628, 51464, 16138, 367, 1501, "Input",ExpressionUUID->"885b5041-ccce-421d-8c68-d81323cdd220"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2171803, 51836, 249, 6, 45, "Subsubsection",ExpressionUUID->"57cd3b51-98b4-46e5-8f98-842d155a92d3"],
Cell[2172055, 51844, 5156, 122, 388, "Input",ExpressionUUID->"1416d2ec-7d3f-42a7-9315-c6f5c16197d2"],
Cell[2177214, 51968, 16138, 367, 1501, "Input",ExpressionUUID->"db6add99-68f6-4732-8796-031c7be4bbfa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2193389, 52340, 249, 6, 45, "Subsubsection",ExpressionUUID->"2a7e28b7-349b-4ff2-942b-db1023561f34"],
Cell[2193641, 52348, 5159, 122, 388, "Input",ExpressionUUID->"e88fbd2d-5216-460f-ac0f-384b9da418f5"],
Cell[2198803, 52472, 16139, 367, 1501, "Input",ExpressionUUID->"5090fcf7-34fb-40cb-9182-b4269ea09712"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2214979, 52844, 105, 0, 45, "Subsubsection",ExpressionUUID->"11c0e461-3c7a-422f-9ac4-030b6e6805a0"],
Cell[2215087, 52846, 5159, 122, 388, "Input",ExpressionUUID->"b1f5fecc-cfe8-464a-bc5c-eb46b08bf923"],
Cell[2220249, 52970, 16462, 376, 1522, "Input",ExpressionUUID->"57140b2c-50fd-41c2-96d0-217691ff39f7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2236748, 53351, 110, 0, 45, "Subsubsection",ExpressionUUID->"1f8d168b-e560-4003-a128-5c26722161f1"],
Cell[2236861, 53353, 5159, 122, 388, "Input",ExpressionUUID->"35f58b2e-0d67-4505-9a0c-fac49dbfeda0"],
Cell[2242023, 53477, 16465, 376, 1522, "Input",ExpressionUUID->"fe1c0584-c84f-4c8f-90c5-5d57c10907ab"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2258525, 53858, 270, 7, 45, "Subsubsection",ExpressionUUID->"1e54032e-3813-48c3-895c-5122319741ca"],
Cell[2258798, 53867, 5159, 122, 388, "Input",ExpressionUUID->"2fe8d16d-1ca0-4433-8507-8bf6f1b567d7"],
Cell[2263960, 53991, 16460, 376, 1522, "Input",ExpressionUUID->"1b15904d-23af-4c41-968b-a8ffc158a3a3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2280457, 54372, 272, 7, 45, "Subsubsection",ExpressionUUID->"9372b067-e2dd-42da-bf4c-edb2d7f275bb"],
Cell[2280732, 54381, 5159, 122, 388, "Input",ExpressionUUID->"40c1afe9-cc1b-44c8-9acf-85ddfac431e1"],
Cell[2285894, 54505, 16461, 376, 1522, "Input",ExpressionUUID->"4389c99a-957d-41d4-945b-89b6c49dd480"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

