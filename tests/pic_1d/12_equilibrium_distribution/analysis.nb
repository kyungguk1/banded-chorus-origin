(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[   1695620,      40228]
NotebookOptionsPosition[   1669075,      39834]
NotebookOutlinePosition[   1669475,      39850]
CellTagsIndexPosition[   1669432,      39847]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"Clear", "[", "\"\<`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]}], "Input",
 CellLabel->
  "In[2173]:=",ExpressionUUID->"35414358-9cce-404a-b33a-abdb7a6986c5"],

Cell[BoxData[
 RowBox[{"Get", "[", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{"\"\<../..\>\"", ",", "\"\<imports.wl\>\""}], "}"}], "]"}], 
  "]"}]], "Input",
 CellLabel->
  "In[2175]:=",ExpressionUUID->"98642d0f-5832-45f9-b8ed-04467496a470"],

Cell[BoxData[
 RowBox[{"wd", "=", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{"\"\<.\>\"", ",", "\"\<data\>\""}], "}"}], "]"}]}]], "Input",
 CellLabel->
  "In[2176]:=",ExpressionUUID->"7640abcc-40a3-4b02-a665-ad3c9af5d4f1"],

Cell[CellGroupData[{

Cell["Inhomogeneous Parameter", "Section",ExpressionUUID->"9f12e1c2-203b-454a-a884-7860554e9154"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["B", "x"]},
       {
        SubscriptBox["B", "y"]},
       {
        SubscriptBox["B", "z"]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["B", "0"], "(", GridBox[{
        {
         RowBox[{"1", "+", 
          RowBox[{
           SuperscriptBox["\[Xi]", "2"], 
           SuperscriptBox["x", "2"]}]}]},
        {
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["\[Xi]", "2"]}], "x", " ", "y"}]},
        {
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["\[Xi]", "2"]}], "x", " ", "z"}]}
       }], ")"}], "=", 
     RowBox[{
      SubscriptBox["B", "0"], "(", GridBox[{
        {
         RowBox[{
          SuperscriptBox["sec", "2"], 
          RowBox[{"(", 
           RowBox[{"\[Xi]", " ", 
            SubscriptBox["\[CapitalDelta]", "1"], 
            SuperscriptBox["q", "1"]}], ")"}]}]},
        {
         RowBox[{
          RowBox[{"-", "\[Xi]"}], " ", 
          SubscriptBox["\[CapitalDelta]", "2"], 
          SuperscriptBox["q", "2"], 
          RowBox[{"sin", "(", 
           RowBox[{"\[Xi]", " ", 
            SubscriptBox["\[CapitalDelta]", "1"], 
            SuperscriptBox["q", "1"]}], ")"}]}]},
        {
         RowBox[{
          RowBox[{"-", "\[Xi]"}], " ", 
          SubscriptBox["\[CapitalDelta]", "3"], 
          SuperscriptBox["q", "3"], 
          RowBox[{"sin", "(", 
           RowBox[{"\[Xi]", " ", 
            SubscriptBox["\[CapitalDelta]", "1"], 
            SuperscriptBox["q", "1"]}], ")"}]}]}
       }], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "8f13adcc-c76f-4d27-8999-3fa68c042baf"],
 ".\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Xi]", " ", 
     SubscriptBox["\[CapitalDelta]", "1"], 
     SuperscriptBox["q", "1"]}], "=", 
    RowBox[{
     SuperscriptBox["cos", 
      RowBox[{"-", "1"}]], 
     SqrtBox[
      FractionBox["1", 
       RowBox[{
        SubscriptBox["B", "x"], "/", 
        SubscriptBox["B", "0"]}]]]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "74594919-e3b9-4832-8b0d-55788a5a9d30"],
 "."
}], "Text",ExpressionUUID->"e412d333-35f8-4d7e-9c38-00959af76376"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"BOB0", "=", "2.1"}], ",", 
     RowBox[{"\[CapitalDelta]1", "=", ".5"}], ",", 
     RowBox[{"q1max", "=", "60"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[Xi]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Xi]", "=", 
      RowBox[{"Divide", "[", 
       RowBox[{
        RowBox[{"ArcCos", "[", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"1", "/", "BOB0"}], "]"}], "]"}], ",", 
        RowBox[{"\[CapitalDelta]1", " ", "q1max"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[470]:=",ExpressionUUID->"a0285dff-a04c-4fa0-9f2b-daf585a3e673"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Non-relativistic", "Section",ExpressionUUID->"847df2fa-4921-4ad3-8a12-772ae439a795"],

Cell[CellGroupData[{

Cell["Energy", "Subsection",ExpressionUUID->"d0695e24-7f9d-4334-8478-e96567942d55"],

Cell[BoxData[
 RowBox[{
  RowBox[{"energy", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"stride", "=", "6"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "step", ",", "time", ",", "dB2O2", ",", "dE2O2", ",", "mv2O2", ",", 
         "m\[Theta]2O2", ",", "\[IndentingNewLine]", 
         RowBox[{"data", "=", 
          RowBox[{
           RowBox[{"Chop", "@", 
            RowBox[{"Map", "[", 
             RowBox[{"Last", ",", 
              RowBox[{"SplitBy", "[", 
               RowBox[{
                RowBox[{"SortBy", "[", 
                 RowBox[{
                  RowBox[{"Import", "[", 
                   RowBox[{
                    RowBox[{"FileNameJoin", "[", 
                    RowBox[{"{", 
                    RowBox[{"wd", ",", "\"\<energy.csv\>\""}], "}"}], "]"}], 
                    ",", "\"\<CSV\>\"", ",", 
                    RowBox[{"\"\<HeaderLines\>\"", "\[Rule]", "1"}]}], "]"}], 
                  ",", "First"}], "]"}], ",", "First"}], "]"}]}], "]"}]}], "//",
            "Transpose"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"step", ",", "time"}], "}"}], "=", 
         RowBox[{"Take", "[", 
          RowBox[{"data", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"data", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dB2O2", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"Take", "[", 
           RowBox[{"data", ",", "3"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"data", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dE2O2", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"Take", "[", 
           RowBox[{"data", ",", "3"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"data", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"Take", "[", 
               RowBox[{"#", ",", "3"}], "]"}], "]"}], ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"Drop", "[", 
               RowBox[{"#", ",", "3"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
          RowBox[{"Partition", "[", 
           RowBox[{"data", ",", "stride"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"mv2O2", ",", "m\[Theta]2O2"}], "}"}], "=", 
         RowBox[{"data", "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<step\>\"", "\[Rule]", "step"}], ",", 
          RowBox[{"\"\<time\>\"", "\[Rule]", "time"}], ",", 
          RowBox[{"\"\<dB2O2\>\"", "->", "dB2O2"}], ",", 
          RowBox[{"\"\<dE2O2\>\"", "->", "dE2O2"}], ",", 
          RowBox[{"\"\<mv2O2\>\"", "->", "mv2O2"}], ",", 
          RowBox[{"\"\<m\[Theta]2O2\>\"", "->", "m\[Theta]2O2"}]}], "]"}]}]}],
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[640]:=",ExpressionUUID->"1ec44cd5-a184-4658-be8c-4fca21fac5bf"],

Cell[BoxData[
 RowBox[{"Dimensions", "/@", "energy"}]], "Input",
 CellLabel->
  "In[641]:=",ExpressionUUID->"25245137-5cfc-4fd5-8f8b-3b1727393e21"],

Cell[BoxData[
 RowBox[{"dynamic", "=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"energy", "=", "energy"}], ",", 
      RowBox[{"tlim", "=", 
       RowBox[{"Interval", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "Infinity"}], "}"}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"time", ",", "pos", ",", "dB2O2", ",", "dE2O2", ",", "mv2O2"}],
        "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"time", "=", 
        RowBox[{"energy", "[", "\"\<time\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"time", ",", 
          RowBox[{"$_Real", "/;", 
           RowBox[{"IntervalMemberQ", "[", 
            RowBox[{"tlim", ",", "$"}], "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "pos", "]"}], "\[LessEqual]", "1"}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<no time selected\>\"", "]"}], ";", 
            RowBox[{"Abort", "[", "]"}]}], ")"}], ",", 
          RowBox[{"pos", "//", "Extract"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"time", "=", 
        RowBox[{"pos", "[", "time", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dB2O2", "=", 
        RowBox[{
         RowBox[{"energy", "[", "\"\<dB2O2\>\"", "]"}], "//", "pos"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dE2O2", "=", 
        RowBox[{
         RowBox[{"energy", "[", "\"\<dE2O2\>\"", "]"}], "//", "pos"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mv2O2", "=", 
        RowBox[{
         RowBox[{"pos", "/@", 
          RowBox[{"energy", "[", "\"\<mv2O2\>\"", "]"}]}], "//", "Total"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{"#", ",", "\[IndentingNewLine]", 
            RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"AspectRatio", "\[Rule]", 
             RowBox[{"1", "/", "3"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Frame", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
           "]"}], "&"}], "/@", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"dB2O2", "//", "Transpose"}], ",", 
             RowBox[{"DataRange", "\[Rule]", 
              RowBox[{"time", "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", "\"\<dB^2/2\>\""}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"dE2O2", "//", "Transpose"}], ",", 
             RowBox[{"DataRange", "\[Rule]", 
              RowBox[{"time", "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", "\"\<dE^2/2\>\""}]}], "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"mv2O2", "//", "Transpose"}], ",", 
             RowBox[{"DataRange", "\[Rule]", 
              RowBox[{"time", "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", "\"\<mv^2/2\>\""}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#", ",", 
                 RowBox[{"#2", "-", 
                  RowBox[{"First", "[", "#2", "]"}]}], ",", 
                 RowBox[{"#", "+", "#2", "-", 
                  RowBox[{"First", "[", "#2", "]"}]}]}], "}"}], "&"}], "@@", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Plus", "@@@", 
                 RowBox[{"(", 
                  RowBox[{"dB2O2", "+", "dE2O2"}], ")"}]}], ",", 
                RowBox[{"Plus", "@@@", "mv2O2"}]}], "}"}]}], ",", 
             RowBox[{"DataRange", "\[Rule]", 
              RowBox[{"time", "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", "\"\<Total\>\""}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "}"}]}], "//", "Column"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellLabel->
  "In[642]:=",ExpressionUUID->"165b2a5c-70b2-4a34-9de2-2bc59b9970b5"],

Cell[BoxData[
 RowBox[{"dynamic", "=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"energy", "=", "energy"}], ",", 
      RowBox[{"tlim", "=", 
       RowBox[{"Interval", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "Infinity"}], "}"}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "time", ",", "pos", ",", "mv2O2", ",", "mU2O2", ",", "m\[Theta]2O2", 
        ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"time", "=", 
        RowBox[{"energy", "[", "\"\<time\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"time", ",", 
          RowBox[{"$_Real", "/;", 
           RowBox[{"IntervalMemberQ", "[", 
            RowBox[{"tlim", ",", "$"}], "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "pos", "]"}], "\[LessEqual]", "1"}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<no time selected\>\"", "]"}], ";", 
            RowBox[{"Abort", "[", "]"}]}], ")"}], ",", 
          RowBox[{"pos", "//", "Extract"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"time", "=", 
        RowBox[{"pos", "[", "time", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mv2O2", "=", 
        RowBox[{"pos", "/@", 
         RowBox[{"energy", "[", "\"\<mv2O2\>\"", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"m\[Theta]2O2", "=", 
        RowBox[{"pos", "/@", 
         RowBox[{"energy", "[", "\"\<m\[Theta]2O2\>\"", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mU2O2", "=", 
        RowBox[{"mv2O2", "-", "m\[Theta]2O2"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"plots", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Show", "[", 
            RowBox[{"#", ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "\[Rule]", "Small"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Frame", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
            "]"}], "&"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"ListPlot", "[", 
               RowBox[{
                RowBox[{"#", "//", "Transpose"}], ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"time", "[", 
                  RowBox[{"[", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
                RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "/@",
              "mv2O2"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"ListPlot", "[", 
               RowBox[{
                RowBox[{"#", "//", "Transpose"}], ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"time", "[", 
                  RowBox[{"[", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
                RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "/@",
              "m\[Theta]2O2"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"ListPlot", "[", 
               RowBox[{
                RowBox[{"#", "//", "Transpose"}], ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"time", "[", 
                  RowBox[{"[", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
                RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "/@",
              "mU2O2"}]}], "\[IndentingNewLine]", "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{
          RowBox[{"plots", "//", "Transpose"}], ",", 
          RowBox[{"Text", "/@", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Kinetic\>\"", ",", "\"\<Thermal\>\"", ",", "\"\<Bulk\>\""}], 
            "}"}]}]}], "]"}], "//", "Grid"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[643]:=",ExpressionUUID->"909e924c-4bab-402e-abac-e83db341f28d"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"energy", "=", "energy"}], ",", 
     RowBox[{"tlim", "=", 
      RowBox[{"Interval", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", "Infinity"}], "}"}], "]"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "time", ",", "pos", ",", "mv2O2", ",", "mU2O2", ",", "m\[Theta]2O2", 
       ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"time", "=", 
       RowBox[{"energy", "[", "\"\<time\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"Position", "[", 
        RowBox[{"time", ",", 
         RowBox[{"$_Real", "/;", 
          RowBox[{"IntervalMemberQ", "[", 
           RowBox[{"tlim", ",", "$"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "pos", "]"}], "\[LessEqual]", "1"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<no time selected\>\"", "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}], ")"}], ",", 
         RowBox[{"pos", "//", "Extract"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"time", "=", 
       RowBox[{"pos", "[", "time", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mv2O2", "=", 
       RowBox[{"pos", "/@", 
        RowBox[{"energy", "[", "\"\<mv2O2\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"m\[Theta]2O2", "=", 
       RowBox[{"pos", "/@", 
        RowBox[{"energy", "[", "\"\<m\[Theta]2O2\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mU2O2", "=", 
       RowBox[{"mv2O2", "-", "m\[Theta]2O2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{"#", ",", "\[IndentingNewLine]", 
            RowBox[{"ImageSize", "\[Rule]", "Small"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Frame", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
           "]"}], "&"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"#", "-", 
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"time", "[", 
                 RowBox[{"[", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "/@", 
            
            RowBox[{"Map", "[", 
             RowBox[{"Transpose", ",", "mv2O2"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"#", "-", 
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"time", "[", 
                 RowBox[{"[", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "/@", 
            
            RowBox[{"Map", "[", 
             RowBox[{"Transpose", ",", "m\[Theta]2O2"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"#", "-", 
                RowBox[{"#", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"time", "[", 
                 RowBox[{"[", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "/@", 
            
            RowBox[{"Map", "[", 
             RowBox[{"Transpose", ",", "mU2O2"}], "]"}]}]}], 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Prepend", "[", 
        RowBox[{
         RowBox[{"plots", "//", "Transpose"}], ",", 
         RowBox[{"Text", "/@", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Kinetic\>\"", ",", "\"\<Thermal\>\"", ",", "\"\<Bulk\>\""}], 
           "}"}]}]}], "]"}], "//", "Grid"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[644]:=",ExpressionUUID->"b11b8c30-ec3e-4ab2-83d0-d7e26f6f4a7d"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"energy", "=", "energy"}], ",", 
     RowBox[{"tlim", "=", 
      RowBox[{"Interval", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", "Infinity"}], "}"}], "]"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"time", ",", "pos", ",", "m\[Theta]2O2", ",", "T1", ",", "T2"}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"time", "=", 
       RowBox[{"energy", "[", "\"\<time\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"Position", "[", 
        RowBox[{"time", ",", 
         RowBox[{"$_Real", "/;", 
          RowBox[{"IntervalMemberQ", "[", 
           RowBox[{"tlim", ",", "$"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "pos", "]"}], "\[LessEqual]", "1"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<no time selected\>\"", "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}], ")"}], ",", 
         RowBox[{"pos", "//", "Extract"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"time", "=", 
       RowBox[{"pos", "[", "time", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"m\[Theta]2O2", "=", 
       RowBox[{"Map", "[", 
        RowBox[{"pos", ",", 
         RowBox[{"energy", "[", "\"\<m\[Theta]2O2\>\"", "]"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"m\[Theta]2O2", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"First", "[", "#", "]"}], ",", 
            RowBox[{".5", 
             RowBox[{"Plus", "@@", 
              RowBox[{"Rest", "[", "#", "]"}]}]}]}], "}"}], "&"}], ",", 
         "m\[Theta]2O2", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T1", "=", 
       RowBox[{
        RowBox[{"Chop", "[", 
         RowBox[{"m\[Theta]2O2", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "All", ",", "1"}], "]"}], "]"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"0", "\[Rule]", "Indeterminate"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"T2", "=", 
       RowBox[{
        RowBox[{"Chop", "[", 
         RowBox[{"m\[Theta]2O2", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"0", "\[Rule]", "Indeterminate"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{"#", ",", "\[IndentingNewLine]", 
           RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Frame", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
          "]"}], "&"}], "/@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"T1", "/", 
             RowBox[{"T1", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
            RowBox[{"DataRange", "\[Rule]", 
             RowBox[{"time", "[", 
              RowBox[{"[", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{
            "FrameLabel", "\[Rule]", 
             "\"\<\\!\\(\!\(\*SubscriptBox[\(T\), \
\(\[DoubleVerticalBar]\)]\)(t)/\!\(\*SubscriptBox[\(T\), \(\
\[DoubleVerticalBar]\)]\)(0)\\)\>\""}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"T2", "/", 
             RowBox[{"T1", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
            RowBox[{"DataRange", "\[Rule]", 
             RowBox[{"time", "[", 
              RowBox[{"[", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{
            "FrameLabel", "\[Rule]", 
             "\"\<\\!\\(\!\(\*SubscriptBox[\(T\), \
\(\[UpTee]\)]\)(t)/\!\(\*SubscriptBox[\(T\), \
\(\[DoubleVerticalBar]\)]\)(0)\\)\>\""}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
         "\[IndentingNewLine]", "}"}]}], "//", "Column"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[645]:=",ExpressionUUID->"42e0356c-1f39-445c-8c6c-7e391f279571"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Moment", "Subsection",ExpressionUUID->"cd6cf25d-e30d-4dae-8ee1-f32262fc6808"],

Cell[BoxData[
 RowBox[{
  RowBox[{"metadata", "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"files", "=", 
        RowBox[{"FileNames", "[", 
         RowBox[{"\"\<moment-*.h5\>\"", ",", "wd"}], "]"}]}], ",", "attrs", 
       ",", "steps", ",", "times", ",", "pos"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"attrs", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<HDF5\>\"", ",", "\"\<Attributes\>\"", ",", 
             "\"\</moment\>\""}], "}"}]}], "]"}], "&"}], "/@", "files"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{
        RowBox[{"Lookup", "[", "\"\<step\>\"", "]"}], "/@", "attrs"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"times", "=", 
       RowBox[{
        RowBox[{"Lookup", "[", "\"\<time\>\"", "]"}], "/@", "attrs"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"List", "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "times", "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"First", "/@", 
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"pos", ",", "times"}], "}"}], "]"}], ",", "Last"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"steps", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"times", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"times", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"files", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"files", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Association", "[", 
       RowBox[{
        RowBox[{"\"\<attr\>\"", "->", 
         RowBox[{"KeyDrop", "[", 
          RowBox[{
           RowBox[{"First", "[", "attrs", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<step\>\"", ",", "\"\<time\>\""}], "}"}]}], "]"}]}], 
        ",", 
        RowBox[{"\"\<step\>\"", "->", "steps"}], ",", 
        RowBox[{"\"\<time\>\"", "->", "times"}], ",", 
        RowBox[{"\"\<files\>\"", "->", "files"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[646]:=",ExpressionUUID->"6f598aed-c038-4db9-bf47-b3b56562c1e8"],

Cell[CellGroupData[{

Cell["Maxwellian", "Subsubsection",ExpressionUUID->"cb7d9ce6-eb9b-4f7d-9e35-77fe1e582769"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom1", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "1"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom1"}]}], "Input",
 CellLabel->
  "In[647]:=",ExpressionUUID->"5702dbab-a126-4023-a84b-59e5a35c7564"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom1"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"T2OT1eq", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", 
       "T2OT1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{
        RowBox[{"0", "q1"}], "+", "1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{"T2OT1eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n0"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2OT1", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2OT1", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[649]:=",ExpressionUUID->"924d8ae5-1219-456f-abd8-7e2ac6029643"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bi-Maxwellian", "Subsubsection",ExpressionUUID->"66338852-e001-46f5-8c9c-1b64d8c945c9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom2", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "2"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom2"}]}], "Input",
 CellLabel->
  "In[650]:=",ExpressionUUID->"c1158f36-932d-4e2f-947e-6f9911a933fb"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom2"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"T2OT1eq", "=", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", 
       "T2OT1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{"T2OT1eq", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "T2OT1eq"}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{"T2OT1eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n0"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2OT1", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2OT1", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[652]:=",ExpressionUUID->"3bdea17f-a210-4f60-bebe-49420255b9df"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Losscone - Maxwellian", "Subsubsection",ExpressionUUID->"7910da06-34ae-4593-bc9e-74a69272b100"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom3", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "3"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom3"}]}], "Input",
 CellLabel->
  "In[653]:=",ExpressionUUID->"bec4ae69-6202-4538-80b4-e2b9c215efee"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom3"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"T2OT1eq", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", 
       "T2OT1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{
        RowBox[{"0", "q1"}], "+", "1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{"T2OT1eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n0"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2OT1", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2OT1", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[655]:=",ExpressionUUID->"82413c55-b644-430b-99b2-f2f4526dbcc0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Losscone - Bi-Maxwellian", "Subsubsection",ExpressionUUID->"a3f84be9-399c-4419-9094-ed5eda12824f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom4", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "4"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom4"}]}], "Input",
 CellLabel->
  "In[656]:=",ExpressionUUID->"9d3f1bd2-ce0d-41f3-8537-b2f4ed60425e"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom4"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"T2OT1eq", "=", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", 
       "T2OT1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{"T2OT1eq", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "T2OT1eq"}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{"T2OT1eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n0"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2OT1", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2OT1", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[658]:=",ExpressionUUID->"e333d87b-eff8-4de5-8ff4-d8827bba57ee"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Loss cone - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Beta]", "0"], "=", "0.5"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "ccdb0590-1bd4-4ec8-ba41-3d161d358b69"]
}], "Subsubsection",ExpressionUUID->"4980b484-d4a1-42be-a914-13db437ac77d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom5", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "5"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom5"}]}], "Input",
 CellLabel->
  "In[659]:=",ExpressionUUID->"6b115070-2d54-49ba-b154-a649826185c9"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom5"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", ".5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "\[Eta]\[Beta]",
        ",", "n0", ",", "\[Beta]", ",", "\[Theta]2O\[Theta]1", ",", "T2OT1"}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n0"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2OT1", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2OT1", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[661]:=",ExpressionUUID->"20f092f7-6abd-4f6b-b097-f0bc08cc06ce"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Loss cone - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Beta]", "0"], "=", "2.5"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "621772c3-7022-4912-8ba2-52b5d131ac20"]
}], "Subsubsection",ExpressionUUID->"e3066ceb-9fb5-40aa-ba34-9cb0fd7abdac"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom6", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "6"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom6"}]}], "Input",
 CellLabel->
  "In[662]:=",ExpressionUUID->"2eedc04d-fe4a-4f27-8290-838dbd0c8747"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom6"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "2.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "\[Eta]\[Beta]",
        ",", "n0", ",", "\[Beta]", ",", "\[Theta]2O\[Theta]1", ",", "T2OT1"}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n0"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2OT1", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2OT1", " ", 
                 RowBox[{"\[Beta]1", "/", "2"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[664]:=",ExpressionUUID->"159758ce-5815-4bad-bdd7-5290ee91102e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Partial shell - Maxwellian", "Subsubsection",ExpressionUUID->"51115539-fd2f-43ec-a01d-08a57471c386"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom7", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "7"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom7"}]}], "Input",
 CellLabel->
  "In[665]:=",ExpressionUUID->"b5b93d3b-5890-4f43-8098-f48503432848"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom7"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]", "=", "1.5"}], ",", 
     RowBox[{"\[Zeta]", "=", "0"}], ",", 
     RowBox[{"vs", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", "Ab",
        ",", "B\[Zeta]", ",", "T", ",", "T1", ",", "T2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"b", ",", 
          RowBox[{".5", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"b", " ", 
              RowBox[{"Exp", "[", 
               RowBox[{"-", 
                RowBox[{"b", "^", "2"}]}], "]"}]}], "+", 
             RowBox[{
              SqrtBox["\[Pi]"], 
              RowBox[{"(", 
               RowBox[{".5", "+", 
                RowBox[{"b", "^", "2"}]}], ")"}], 
              RowBox[{"Erfc", "[", 
               RowBox[{"-", "b"}], "]"}]}]}], ")"}]}]}], "]"}], "[", 
        RowBox[{"vs", "/", 
         SqrtBox["\[Beta]"]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"B\[Zeta]", "=", 
       RowBox[{
        SqrtBox["\[Pi]"], 
        RowBox[{
         RowBox[{"Gamma", "[", 
          RowBox[{"1", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}], "/", 
         RowBox[{"Gamma", "[", 
          RowBox[{"1.5", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{".5", 
        RowBox[{"\[Beta]", "/", "Ab"}], " ", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"xs", ",", 
           RowBox[{
            RowBox[{"xs", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"5", "/", "2"}], "+", 
               RowBox[{"xs", "^", "2"}]}], ")"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{"xs", "^", "2"}]}], "]"}]}], "+", 
            RowBox[{
             SqrtBox["\[Pi]"], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", "/", "4"}], "+", 
               RowBox[{
                RowBox[{"xs", "^", "2"}], 
                RowBox[{"(", 
                 RowBox[{"3", "+", 
                  RowBox[{"xs", "^", "2"}]}], ")"}]}]}], ")"}], 
             RowBox[{"Erfc", "[", 
              RowBox[{"-", "xs"}], "]"}]}]}]}], "]"}], "[", 
         RowBox[{"vs", "/", 
          SqrtBox["\[Beta]"]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T1", "=", 
       RowBox[{"T", "/", 
        RowBox[{"(", 
         RowBox[{"3", "+", "\[Zeta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2", "=", 
       RowBox[{".5", "T", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "+", "\[Zeta]"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"3", "+", "\[Zeta]"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n0"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T1"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[680]:=",ExpressionUUID->"6e384b7b-cc72-454a-95be-0b3582ad5970"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Isotropic shell", "Subsubsection",ExpressionUUID->"7ec0129c-40d8-4631-bf1b-51fb8eb2c9e3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom8", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "8"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom8"}]}], "Input",
 CellLabel->
  "In[668]:=",ExpressionUUID->"6cd02a64-3575-4a51-8480-6b28b04b611f"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom8"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "0"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", "Ab",
        ",", "B\[Zeta]", ",", "T", ",", "T1", ",", "T2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"b", ",", 
          RowBox[{".5", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"b", " ", 
              RowBox[{"Exp", "[", 
               RowBox[{"-", 
                RowBox[{"b", "^", "2"}]}], "]"}]}], "+", 
             RowBox[{
              SqrtBox["\[Pi]"], 
              RowBox[{"(", 
               RowBox[{".5", "+", 
                RowBox[{"b", "^", "2"}]}], ")"}], 
              RowBox[{"Erfc", "[", 
               RowBox[{"-", "b"}], "]"}]}]}], ")"}]}]}], "]"}], "[", 
        RowBox[{"vs", "/", 
         SqrtBox["\[Beta]"]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"B\[Zeta]", "=", 
       RowBox[{
        SqrtBox["\[Pi]"], 
        RowBox[{
         RowBox[{"Gamma", "[", 
          RowBox[{"1", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}], "/", 
         RowBox[{"Gamma", "[", 
          RowBox[{"1.5", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{".5", 
        RowBox[{"\[Beta]", "/", "Ab"}], " ", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"xs", ",", 
           RowBox[{
            RowBox[{"xs", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"5", "/", "2"}], "+", 
               RowBox[{"xs", "^", "2"}]}], ")"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{"xs", "^", "2"}]}], "]"}]}], "+", 
            RowBox[{
             SqrtBox["\[Pi]"], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", "/", "4"}], "+", 
               RowBox[{
                RowBox[{"xs", "^", "2"}], 
                RowBox[{"(", 
                 RowBox[{"3", "+", 
                  RowBox[{"xs", "^", "2"}]}], ")"}]}]}], ")"}], 
             RowBox[{"Erfc", "[", 
              RowBox[{"-", "xs"}], "]"}]}]}]}], "]"}], "[", 
         RowBox[{"vs", "/", 
          SqrtBox["\[Beta]"]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T1", "=", 
       RowBox[{"T", "/", 
        RowBox[{"(", 
         RowBox[{"3", "+", "\[Zeta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2", "=", 
       RowBox[{".5", "T", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "+", "\[Zeta]"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"3", "+", "\[Zeta]"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n0"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T1"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[670]:=",ExpressionUUID->"b1edadf5-5bd5-4999-8212-03f4d774ff03"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Partial shell - ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Zeta]", "=", "1"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "dd9f1676-40dd-4042-8cbe-8692107020b5"]
}], "Subsubsection",ExpressionUUID->"22184aa1-da55-4c27-b9ac-23cc971f1ba8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom9", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "9"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom9"}]}], "Input",
 CellLabel->
  "In[671]:=",ExpressionUUID->"773c508a-4946-441c-b000-2db3a06a75b7"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom9"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "1"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", "Ab",
        ",", "B\[Zeta]", ",", "T", ",", "T1", ",", "T2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"b", ",", 
          RowBox[{".5", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"b", " ", 
              RowBox[{"Exp", "[", 
               RowBox[{"-", 
                RowBox[{"b", "^", "2"}]}], "]"}]}], "+", 
             RowBox[{
              SqrtBox["\[Pi]"], 
              RowBox[{"(", 
               RowBox[{".5", "+", 
                RowBox[{"b", "^", "2"}]}], ")"}], 
              RowBox[{"Erfc", "[", 
               RowBox[{"-", "b"}], "]"}]}]}], ")"}]}]}], "]"}], "[", 
        RowBox[{"vs", "/", 
         SqrtBox["\[Beta]"]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"B\[Zeta]", "=", 
       RowBox[{
        SqrtBox["\[Pi]"], 
        RowBox[{
         RowBox[{"Gamma", "[", 
          RowBox[{"1", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}], "/", 
         RowBox[{"Gamma", "[", 
          RowBox[{"1.5", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{".5", 
        RowBox[{"\[Beta]", "/", "Ab"}], " ", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"xs", ",", 
           RowBox[{
            RowBox[{"xs", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"5", "/", "2"}], "+", 
               RowBox[{"xs", "^", "2"}]}], ")"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{"xs", "^", "2"}]}], "]"}]}], "+", 
            RowBox[{
             SqrtBox["\[Pi]"], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", "/", "4"}], "+", 
               RowBox[{
                RowBox[{"xs", "^", "2"}], 
                RowBox[{"(", 
                 RowBox[{"3", "+", 
                  RowBox[{"xs", "^", "2"}]}], ")"}]}]}], ")"}], 
             RowBox[{"Erfc", "[", 
              RowBox[{"-", "xs"}], "]"}]}]}]}], "]"}], "[", 
         RowBox[{"vs", "/", 
          SqrtBox["\[Beta]"]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T1", "=", 
       RowBox[{"T", "/", 
        RowBox[{"(", 
         RowBox[{"3", "+", "\[Zeta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2", "=", 
       RowBox[{".5", "T", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "+", "\[Zeta]"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"3", "+", "\[Zeta]"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n0"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T1"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[673]:=",ExpressionUUID->"e9ba3453-4dd1-4101-a9d2-b6f662465aaa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Partial shell - ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Zeta]", "=", "5"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "80229383-8135-4a13-ae82-136c4f08f48b"]
}], "Subsubsection",ExpressionUUID->"27bef6b5-a9be-4af2-a6f7-a874de3627cd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom10", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "10"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom10"}]}], "Input",
 CellLabel->
  "In[674]:=",ExpressionUUID->"632d56b6-0f03-4ede-9a23-16788a182daf"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom10"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "5"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", "Ab",
        ",", "B\[Zeta]", ",", "T", ",", "T1", ",", "T2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"b", ",", 
          RowBox[{".5", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"b", " ", 
              RowBox[{"Exp", "[", 
               RowBox[{"-", 
                RowBox[{"b", "^", "2"}]}], "]"}]}], "+", 
             RowBox[{
              SqrtBox["\[Pi]"], 
              RowBox[{"(", 
               RowBox[{".5", "+", 
                RowBox[{"b", "^", "2"}]}], ")"}], 
              RowBox[{"Erfc", "[", 
               RowBox[{"-", "b"}], "]"}]}]}], ")"}]}]}], "]"}], "[", 
        RowBox[{"vs", "/", 
         SqrtBox["\[Beta]"]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"B\[Zeta]", "=", 
       RowBox[{
        SqrtBox["\[Pi]"], 
        RowBox[{
         RowBox[{"Gamma", "[", 
          RowBox[{"1", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}], "/", 
         RowBox[{"Gamma", "[", 
          RowBox[{"1.5", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{".5", 
        RowBox[{"\[Beta]", "/", "Ab"}], " ", 
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"xs", ",", 
           RowBox[{
            RowBox[{"xs", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"5", "/", "2"}], "+", 
               RowBox[{"xs", "^", "2"}]}], ")"}], 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{"xs", "^", "2"}]}], "]"}]}], "+", 
            RowBox[{
             SqrtBox["\[Pi]"], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"3", "/", "4"}], "+", 
               RowBox[{
                RowBox[{"xs", "^", "2"}], 
                RowBox[{"(", 
                 RowBox[{"3", "+", 
                  RowBox[{"xs", "^", "2"}]}], ")"}]}]}], ")"}], 
             RowBox[{"Erfc", "[", 
              RowBox[{"-", "xs"}], "]"}]}]}]}], "]"}], "[", 
         RowBox[{"vs", "/", 
          SqrtBox["\[Beta]"]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T1", "=", 
       RowBox[{"T", "/", 
        RowBox[{"(", 
         RowBox[{"3", "+", "\[Zeta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2", "=", 
       RowBox[{".5", "T", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "+", "\[Zeta]"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"3", "+", "\[Zeta]"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n0"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T1"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", 
                RowBox[{"n0", " ", "T2"}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[676]:=",ExpressionUUID->"ee0ad69f-bc34-42c3-809f-3080483ea1ca"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cold fluid", "Subsubsection",ExpressionUUID->"1e7aaa3a-a570-4c24-b90e-64b34e4e4847"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom11", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "11"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<n\>\"", ",", "\"\<time\>\""}], "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nv\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom11"}]}], "Input",
 CellLabel->
  "In[677]:=",ExpressionUUID->"8cceee78-63f9-48e9-a0e1-ce69f442f550"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom11"}], ",", 
     RowBox[{"n0", "=", "0.01"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"T1", ",", "T2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"T1", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"GridLinesStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"Opacity", "[", "1", "]"}], ",", 
             RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
             "Dashed"}], "]"}]}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
               "]"}], 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "n0", "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
               "]"}], 
              RowBox[{"moment", "[", "\"\<nv1v1\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"n0", 
               RowBox[{"{", "T1", "}"}]}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
               "]"}], 
              RowBox[{"moment", "[", "\"\<nv2v2\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"n0", 
               RowBox[{"{", "T2", "}"}]}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
               "]"}], 
              RowBox[{"moment", "[", "\"\<nv3v3\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"n0", 
               RowBox[{"{", "T2", "}"}]}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
        "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[679]:=",ExpressionUUID->"8db6a45b-c8e9-49e7-afa5-cdc0f9e8712e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["VHist", "Subsection",ExpressionUUID->"87b5ea90-0db6-483f-8519-834bcf44ddac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"metadata", "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"files", "=", 
        RowBox[{"FileNames", "[", 
         RowBox[{"\"\<vhist2d-*.h5\>\"", ",", "wd"}], "]"}]}], ",", "names", 
       ",", "attrs", ",", "steps", ",", "times", ",", "pos"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"attrs", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<HDF5\>\"", ",", "\"\<Attributes\>\"", ",", 
             "\"\</vhist2d\>\""}], "}"}]}], "]"}], "&"}], "/@", "files"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{
        RowBox[{"Lookup", "[", "\"\<step\>\"", "]"}], "/@", "attrs"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"times", "=", 
       RowBox[{
        RowBox[{"Lookup", "[", "\"\<time\>\"", "]"}], "/@", "attrs"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"List", "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "times", "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"First", "/@", 
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"pos", ",", "times"}], "}"}], "]"}], ",", "Last"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"steps", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"times", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"times", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"files", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"files", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Association", "[", 
       RowBox[{
        RowBox[{"\"\<attr\>\"", "->", 
         RowBox[{"KeyDrop", "[", 
          RowBox[{
           RowBox[{"First", "[", "attrs", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<step\>\"", ",", "\"\<time\>\""}], "}"}]}], "]"}]}], 
        ",", 
        RowBox[{"\"\<step\>\"", "->", "steps"}], ",", 
        RowBox[{"\"\<time\>\"", "->", "times"}], ",", 
        RowBox[{"\"\<files\>\"", "->", "files"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[681]:=",ExpressionUUID->"031100a5-f529-474a-ac83-268d5d7c25ba"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compileBiMaxwellian", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compileBiMaxwellian", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]1_", "?", "Positive"}], ",", 
    RowBox[{"T2OT1_", "?", "Positive"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]1", "=", 
       SqrtBox[
        RowBox[{"N", "[", "\[Beta]1", "]"}]]}], ",", 
      RowBox[{"\[Theta]2", "=", 
       SqrtBox[
        RowBox[{
         RowBox[{"N", "[", "\[Beta]1", "]"}], "T2OT1"}]]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"n", " ", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"v1", "^", "2"}]}], "/", 
            RowBox[{"\[Theta]1", "^", "2"}]}], "-", 
           RowBox[{
            RowBox[{"v2", "^", "2"}], "/", 
            RowBox[{"\[Theta]2", "^", "2"}]}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"Pi", "^", "1.5"}], " ", "\[Theta]1", " ", 
          RowBox[{"\[Theta]2", "^", "2"}]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[682]:=",ExpressionUUID->"23e38fd0-5996-4b1e-8c87-749d77fb67b3"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compileLossCone", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compileLossCone", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]1_", "?", "Positive"}], ",", 
    RowBox[{"T2OT1_", "?", "Positive"}], ",", 
    RowBox[{"\[Beta]_Real", "?", "Positive"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]1", "=", 
       SqrtBox[
        RowBox[{"N", "[", "\[Beta]1", "]"}]]}], ",", 
      RowBox[{"\[Theta]2", "=", 
       SqrtBox[
        RowBox[{
         RowBox[{"N", "[", "\[Beta]1", "]"}], 
         RowBox[{"T2OT1", "/", 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}]]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Beta]"}], ")"}]}], 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"v1", "^", "2"}]}], "/", 
            RowBox[{"\[Theta]1", "^", "2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"v2", "^", "2"}]}], "/", 
              RowBox[{"\[Theta]2", "^", "2"}]}], "]"}], "-", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"v2", "^", "2"}]}], "/", 
               RowBox[{"\[Theta]2", "^", "2"}]}], "/", "\[Beta]"}], "]"}]}], 
           ")"}]}], ",", 
         RowBox[{
          RowBox[{"Pi", "^", "1.5"}], " ", "\[Theta]1", " ", 
          RowBox[{"\[Theta]2", "^", "2"}]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[684]:=",ExpressionUUID->"87d366a1-c8ba-4815-8fc8-6bb45a27781b"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compilePartialShell", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compilePartialShell", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]_", "?", "Positive"}], ",", 
    RowBox[{"\[Zeta]_Integer", "?", "NonNegative"}], ",", 
    RowBox[{"vs_", "?", "NonNegative"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]", "=", 
       RowBox[{"N", "[", 
        SqrtBox["\[Beta]"], "]"}]}], ",", 
      RowBox[{"xs", "=", 
       RowBox[{"N", "[", 
        RowBox[{"vs", "/", 
         SqrtBox["\[Beta]"]}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{".5", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"vs", "/", 
            SqrtBox["\[Beta]"]}], 
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"vs", "/", 
                SqrtBox["\[Beta]"]}], ")"}], "^", "2"}]}], "]"}]}], "+", 
          RowBox[{
           SqrtBox["\[Pi]"], 
           RowBox[{"(", 
            RowBox[{".5", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"vs", "/", 
                SqrtBox["\[Beta]"]}], ")"}], "^", "2"}]}], ")"}], 
           RowBox[{"Erfc", "[", 
            RowBox[{
             RowBox[{"-", "vs"}], "/", 
             SqrtBox["\[Beta]"]}], "]"}]}]}], ")"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"B\[Zeta]", "=", 
       RowBox[{
        SqrtBox["\[Pi]"], 
        RowBox[{
         RowBox[{"Gamma", "[", 
          RowBox[{"1", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}], "/", 
         RowBox[{"Gamma", "[", 
          RowBox[{"1.5", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "x1", ",", "x2", ",", "\[Mu]"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x2", "=", 
          RowBox[{"v2", "/", "\[Theta]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x1", "=", 
          RowBox[{"v1", "/", "\[Theta]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x", "=", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"x1", "^", "2"}], "+", 
            RowBox[{"x2", "^", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Mu]", "=", 
          RowBox[{"x1", "/", "x"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"n", " ", 
          RowBox[{"Divide", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"x", "-", "xs"}], ")"}], "^", "2"}]}], "]"}], 
             RowBox[{"Power", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "\[Mu]"}], ")"}], 
                RowBox[{"(", 
                 RowBox[{"1", "+", "\[Mu]"}], ")"}]}], ",", 
               RowBox[{".5", "\[Zeta]"}]}], "]"}]}], ",", 
            RowBox[{"2", "Pi", " ", 
             RowBox[{"\[Theta]", "^", "3"}], "Ab", " ", "B\[Zeta]"}]}], 
           "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[686]:=",ExpressionUUID->"0c4a0d53-0227-4c1d-9df5-c49fe37333cd"],

Cell[CellGroupData[{

Cell["Maxwellian", "Subsubsection",ExpressionUUID->"fe80e185-5197-42f8-b99f-9cca5f073b7d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist1", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "1"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist1"}]}], "Input",
 CellLabel->
  "In[688]:=",ExpressionUUID->"f605ebca-de2f-4079-8328-128010bd5dda"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist1"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"T2OT1eq", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "fhist", ",", "ghist", ",", "whist", 
       ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "T2OT1", ",", "vv12", ",", 
       "ff", ",", "gg", ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{"T2OT1eq", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "T2OT1eq"}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{"T2OT1eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileBiMaxwellian", "[", 
          RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1"}], "]"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileBiMaxwellian", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1"}], "]"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",ExpressionUUID->"5cdc9089-b8c9-4385-\
aa1b-7d765c270b48"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bi-Maxwellian", "Subsubsection",ExpressionUUID->"ac9a0ef0-1ed7-4c49-894b-8d040b1265af"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist2", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "2"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist2"}]}], "Input",
 CellLabel->
  "In[691]:=",ExpressionUUID->"30e29baf-be22-4a23-9455-cfb8d5cc8176"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist2"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"T2OT1eq", "=", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "fhist", ",", "ghist", ",", "whist", 
       ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "T2OT1", ",", "vv12", ",", 
       "ff", ",", "gg", ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{"T2OT1eq", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "T2OT1eq"}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{"T2OT1eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileBiMaxwellian", "[", 
          RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1"}], "]"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileBiMaxwellian", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1"}], "]"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[693]:=",ExpressionUUID->"24babefe-2ca7-45a8-bfe8-ab69c67cf459"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Loss cone - Maxwellian", "Subsubsection",ExpressionUUID->"e301e7dc-eb33-46da-86eb-8f8e6243a88e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist3", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "3"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist3"}]}], "Input",
 CellLabel->
  "In[694]:=",ExpressionUUID->"354e6873-e1ec-483e-a49a-8830fb2ba2ec"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist3"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["1"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "1.0*^-10"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "fhist", ",", "ghist", ",", "whist", 
       ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "\[Eta]\[Beta]", ",", "n0", ",", 
       "\[Beta]", ",", "\[Theta]2O\[Theta]1", ",", "T2OT1", ",", "vv12", ",", 
       "ff", ",", "gg", ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileLossCone", "[", 
          RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], 
          "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileLossCone", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1", ",", "\[Beta]"}], 
          "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[696]:=",ExpressionUUID->"1b1960bb-dfd3-42da-8f90-2cabf37dc77a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Loss cone - Bi-Maxwellian", "Subsubsection",ExpressionUUID->"f0e7d15b-2c81-4f41-868d-6745ac8e65db"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist4", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "4"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist4"}]}], "Input",
 CellLabel->
  "In[697]:=",ExpressionUUID->"0772f7b0-48e0-4b2d-8541-a07d79f2ca5d"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist4"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "1.0*^-10"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "fhist", ",", "ghist", ",", "whist", 
       ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "\[Eta]\[Beta]", ",", "n0", ",", 
       "\[Beta]", ",", "\[Theta]2O\[Theta]1", ",", "T2OT1", ",", "vv12", ",", 
       "ff", ",", "gg", ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileLossCone", "[", 
          RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], 
          "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileLossCone", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1", ",", "\[Beta]"}], 
          "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[699]:=",ExpressionUUID->"516ce6ad-b483-4ff9-bf73-83ba5e152724"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Loss cone - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Beta]", "eq"], "=", "0.5"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "2e205f47-9f33-41a7-8fbf-e9a62dc828f2"]
}], "Subsubsection",ExpressionUUID->"09c53460-8f0c-4f01-90b3-594ffa8138dc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist5", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "5"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist5"}]}], "Input",
 CellLabel->
  "In[700]:=",ExpressionUUID->"d0cfef55-6cad-446f-8c55-c8501fc3af46"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist5"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "0.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "fhist", ",", "ghist", ",", "whist", 
       ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "\[Eta]\[Beta]", ",", "n0", ",", 
       "\[Beta]", ",", "\[Theta]2O\[Theta]1", ",", "T2OT1", ",", "vv12", ",", 
       "ff", ",", "gg", ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileLossCone", "[", 
          RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], 
          "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileLossCone", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1", ",", "\[Beta]"}], 
          "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[702]:=",ExpressionUUID->"184f72e9-532f-4217-a144-e0bc44cc73c3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Loss cone - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Beta]", "eq"], "=", "2.5"}], TraditionalForm]],
  ExpressionUUID->"5150e459-15b5-4b63-8c71-5bfdf0418bb6"]
}], "Subsubsection",ExpressionUUID->"674ebfdd-4362-4560-866b-f9fe043036cf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist6", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "6"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist6"}]}], "Input",
 CellLabel->
  "In[703]:=",ExpressionUUID->"06c87354-63c2-4a6f-be12-e2fb0478ac00"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist6"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "2.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "fhist", ",", "ghist", ",", "whist", 
       ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "\[Eta]\[Beta]", ",", "n0", ",", 
       "\[Beta]", ",", "\[Theta]2O\[Theta]1", ",", "T2OT1", ",", "vv12", ",", 
       "ff", ",", "gg", ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileLossCone", "[", 
          RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], 
          "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileLossCone", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1", ",", "\[Beta]"}], 
          "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[705]:=",ExpressionUUID->"f735f831-0bc3-40a4-9c52-c27695b114e1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Partial shell - Maxwellian", "Subsubsection",ExpressionUUID->"e264d83a-6c95-4ac5-9721-0f1e04acc04f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist7", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "7"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist7"}]}], "Input",
 CellLabel->
  "In[706]:=",ExpressionUUID->"489b4e47-5b2e-482d-9fc0-69cf95a5d05f"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist7"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "1.5"}], ",", 
     RowBox[{"\[Zeta]", "=", "0"}], ",", 
     RowBox[{"vs", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "fhist", ",", "ghist", ",", "whist", 
       ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "vv12", ",", "ff", ",", "gg",
        ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compilePartialShell", "[", 
          RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compilePartialShell", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]", " ", "gT"}], ",", "\[Zeta]", ",", "vs"}], "]"}],
          "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[708]:=",ExpressionUUID->"a2b28cda-daca-4adb-8339-21de3d02e7dd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Isotropic shell", "Subsubsection",ExpressionUUID->"6eb3c79b-eff6-4460-8253-47e96d5ee614"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist8", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "8"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist8"}]}], "Input",
 CellLabel->
  "In[709]:=",ExpressionUUID->"f57bb4e7-f06e-4745-bc6b-63fd2c0beb06"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist8"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "0"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "fhist", ",", "ghist", ",", "whist", 
       ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "vv12", ",", "ff", ",", "gg",
        ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compilePartialShell", "[", 
          RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compilePartialShell", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]", " ", "gT"}], ",", "\[Zeta]", ",", "vs"}], "]"}],
          "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[711]:=",ExpressionUUID->"f0394d30-2067-47b3-8e35-57bbbfb8f7f1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Partial shell - ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Zeta]", "=", "1"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "380dbb2c-602c-4f1e-964c-89fb1ceb2c06"]
}], "Subsubsection",ExpressionUUID->"5dae1cb7-fb06-4091-b03e-968418fa9c75"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist9", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "9"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist9"}]}], "Input",
 CellLabel->
  "In[712]:=",ExpressionUUID->"f680c9c5-a9a6-49ee-bec0-059f006df748"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist9"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "1"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "fhist", ",", "ghist", ",", "whist", 
       ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "vv12", ",", "ff", ",", "gg",
        ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compilePartialShell", "[", 
          RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compilePartialShell", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]", " ", "gT"}], ",", "\[Zeta]", ",", "vs"}], "]"}],
          "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[714]:=",ExpressionUUID->"5e21fdad-81e8-40e3-8834-d06a327d2dd8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Partial shell - ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Zeta]", "=", "5"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "08a6fdfd-6d84-4369-812f-b9d9fe349ad0"]
}], "Subsubsection",ExpressionUUID->"e115932c-e11d-4697-99f7-effb712dd1d5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist10", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "10"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist10"}]}], "Input",
 CellLabel->
  "In[715]:=",ExpressionUUID->"e5c1bd5b-d3eb-4d82-9320-2133ba724e35"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist10"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "5"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "fhist", ",", "ghist", ",", "whist", 
       ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "vv12", ",", "ff", ",", "gg",
        ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compilePartialShell", "[", 
          RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compilePartialShell", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]", " ", "gT"}], ",", "\[Zeta]", ",", "vs"}], "]"}],
          "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[717]:=",ExpressionUUID->"d467d30e-a58a-434d-bb04-91e18e536b77"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Particle", "Subsection",ExpressionUUID->"5fd3b1be-689f-429f-b7e4-8019920ed1c4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"metadata", "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"files", "=", 
        RowBox[{"FileNames", "[", 
         RowBox[{"\"\<particle-*.h5\>\"", ",", "wd"}], "]"}]}], ",", "names", 
       ",", "attrs", ",", "steps", ",", "times", ",", "pos"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"attrs", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<HDF5\>\"", ",", "\"\<Attributes\>\"", ",", 
             "\"\</particle\>\""}], "}"}]}], "]"}], "&"}], "/@", "files"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{
        RowBox[{"Lookup", "[", "\"\<step\>\"", "]"}], "/@", "attrs"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"times", "=", 
       RowBox[{
        RowBox[{"Lookup", "[", "\"\<time\>\"", "]"}], "/@", "attrs"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"List", "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "times", "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"First", "/@", 
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"pos", ",", "times"}], "}"}], "]"}], ",", "Last"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"steps", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"times", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"times", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"files", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"files", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Association", "[", 
       RowBox[{
        RowBox[{"\"\<attr\>\"", "->", 
         RowBox[{"KeyDrop", "[", 
          RowBox[{
           RowBox[{"First", "[", "attrs", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<step\>\"", ",", "\"\<time\>\""}], "}"}]}], "]"}]}], 
        ",", 
        RowBox[{"\"\<step\>\"", "->", "steps"}], ",", 
        RowBox[{"\"\<time\>\"", "->", "times"}], ",", 
        RowBox[{"\"\<files\>\"", "->", "files"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[718]:=",ExpressionUUID->"893da2a7-7e5d-432e-b173-f8eaf133cea4"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compileBiMaxwellian", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compileBiMaxwellian", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]1_", "?", "Positive"}], ",", 
    RowBox[{"T2OT1_", "?", "Positive"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]1", "=", 
       SqrtBox[
        RowBox[{"N", "[", "\[Beta]1", "]"}]]}], ",", 
      RowBox[{"\[Theta]2", "=", 
       SqrtBox[
        RowBox[{
         RowBox[{"N", "[", "\[Beta]1", "]"}], "T2OT1"}]]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"n", " ", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"v1", "^", "2"}]}], "/", 
            RowBox[{"\[Theta]1", "^", "2"}]}], "-", 
           RowBox[{
            RowBox[{"v2", "^", "2"}], "/", 
            RowBox[{"\[Theta]2", "^", "2"}]}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"Pi", "^", "1.5"}], " ", "\[Theta]1", " ", 
          RowBox[{"\[Theta]2", "^", "2"}]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[719]:=",ExpressionUUID->"cb341572-e53f-4af1-9c6e-ed9448575ba6"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compileLossCone", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compileLossCone", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]1_", "?", "Positive"}], ",", 
    RowBox[{"T2OT1_", "?", "Positive"}], ",", 
    RowBox[{"\[Beta]_Real", "?", "Positive"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]1", "=", 
       SqrtBox[
        RowBox[{"N", "[", "\[Beta]1", "]"}]]}], ",", 
      RowBox[{"\[Theta]2", "=", 
       SqrtBox[
        RowBox[{
         RowBox[{"N", "[", "\[Beta]1", "]"}], 
         RowBox[{"T2OT1", "/", 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}]]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Beta]"}], ")"}]}], 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"v1", "^", "2"}]}], "/", 
            RowBox[{"\[Theta]1", "^", "2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"v2", "^", "2"}]}], "/", 
              RowBox[{"\[Theta]2", "^", "2"}]}], "]"}], "-", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"v2", "^", "2"}]}], "/", 
               RowBox[{"\[Theta]2", "^", "2"}]}], "/", "\[Beta]"}], "]"}]}], 
           ")"}]}], ",", 
         RowBox[{
          RowBox[{"Pi", "^", "1.5"}], " ", "\[Theta]1", " ", 
          RowBox[{"\[Theta]2", "^", "2"}]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[721]:=",ExpressionUUID->"45b8a89b-813c-48e5-adf5-13fd6fe5a6f5"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compilePartialShell", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compilePartialShell", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]_", "?", "Positive"}], ",", 
    RowBox[{"\[Zeta]_Integer", "?", "NonNegative"}], ",", 
    RowBox[{"vs_", "?", "NonNegative"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]", "=", 
       RowBox[{"N", "[", 
        SqrtBox["\[Beta]"], "]"}]}], ",", 
      RowBox[{"xs", "=", 
       RowBox[{"N", "[", 
        RowBox[{"vs", "/", 
         SqrtBox["\[Beta]"]}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{".5", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"vs", "/", 
            SqrtBox["\[Beta]"]}], 
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"vs", "/", 
                SqrtBox["\[Beta]"]}], ")"}], "^", "2"}]}], "]"}]}], "+", 
          RowBox[{
           SqrtBox["\[Pi]"], 
           RowBox[{"(", 
            RowBox[{".5", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"vs", "/", 
                SqrtBox["\[Beta]"]}], ")"}], "^", "2"}]}], ")"}], 
           RowBox[{"Erfc", "[", 
            RowBox[{
             RowBox[{"-", "vs"}], "/", 
             SqrtBox["\[Beta]"]}], "]"}]}]}], ")"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"B\[Zeta]", "=", 
       RowBox[{
        SqrtBox["\[Pi]"], 
        RowBox[{
         RowBox[{"Gamma", "[", 
          RowBox[{"1", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}], "/", 
         RowBox[{"Gamma", "[", 
          RowBox[{"1.5", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "x1", ",", "x2", ",", "\[Mu]"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x2", "=", 
          RowBox[{"v2", "/", "\[Theta]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x1", "=", 
          RowBox[{"v1", "/", "\[Theta]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x", "=", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"x1", "^", "2"}], "+", 
            RowBox[{"x2", "^", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Mu]", "=", 
          RowBox[{"x1", "/", "x"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"n", " ", 
          RowBox[{"Divide", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"x", "-", "xs"}], ")"}], "^", "2"}]}], "]"}], 
             RowBox[{"Power", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "\[Mu]"}], ")"}], 
                RowBox[{"(", 
                 RowBox[{"1", "+", "\[Mu]"}], ")"}]}], ",", 
               RowBox[{".5", "\[Zeta]"}]}], "]"}]}], ",", 
            RowBox[{"2", "Pi", " ", 
             RowBox[{"\[Theta]", "^", "3"}], "Ab", " ", "B\[Zeta]"}]}], 
           "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[723]:=",ExpressionUUID->"a7dddd1d-ebb0-4cac-80db-99d04aa3ebec"],

Cell[CellGroupData[{

Cell["Maxwellian", "Subsubsection",ExpressionUUID->"36a1f4fc-a9cc-4b45-a98e-bb5e12f6c6e3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl1", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "1"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"v1lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v2lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv2", "=", "51"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "vhist", ",", "q1", ",", "rhist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vhist", "=", 
         RowBox[{"calVelocityHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"v1lim", ",", "Nv1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v2lim", ",", "Nv2"}], "}"}], ",", "q1lim"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nv\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl1"}]}], "Input",
 CellLabel->
  "In[725]:=",ExpressionUUID->"9f097443-e5b5-4b5e-a35b-87e5696bf097"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl1"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"T2OT1eq", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "\[Xi]\[CapitalDelta]1", ",", "q1", 
       ",", "\[Eta]", ",", "n0", ",", "T2OT1", ",", "vv12", ",", "ff", ",", 
       "gg", ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{"T2OT1eq", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "T2OT1eq"}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{"T2OT1eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileBiMaxwellian", "[", 
            RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1"}], "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileBiMaxwellian", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1"}], "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vhist", "[", "\"\<df\>\"", "]"}], "//", "Reverse"}],
                 ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Divide", ",", 
                  RowBox[{"Subtract", "@@@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRangePadding", "->", 
               RowBox[{"Thread", "[", 
                RowBox[{"Scaled", "[", 
                 RowBox[{".02", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[727]:=",ExpressionUUID->"1467e5f1-23c4-4fb5-b056-e0e7cdcb825d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bi-Maxwellian", "Subsubsection",ExpressionUUID->"8adb1f5d-23b5-47fe-9819-00234264bcad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl2", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "2"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"v1lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v2lim", "=", 
        RowBox[{"6.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "vhist", ",", "q1", ",", "rhist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vhist", "=", 
         RowBox[{"calVelocityHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"v1lim", ",", "Nv1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v2lim", ",", "Nv2"}], "}"}], ",", "q1lim"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nv\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl2"}]}], "Input",
 CellLabel->
  "In[728]:=",ExpressionUUID->"fbd90576-d11a-4dd7-99ff-ee2dd90257e7"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl2"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"T2OT1eq", "=", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "\[Xi]\[CapitalDelta]1", ",", "q1", 
       ",", "\[Eta]", ",", "n0", ",", "T2OT1", ",", "vv12", ",", "ff", ",", 
       "gg", ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{"T2OT1eq", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "T2OT1eq"}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{"T2OT1eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileBiMaxwellian", "[", 
            RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1"}], "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileBiMaxwellian", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1"}], "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vhist", "[", "\"\<df\>\"", "]"}], "//", "Reverse"}],
                 ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Divide", ",", 
                  RowBox[{"Subtract", "@@@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRangePadding", "->", 
               RowBox[{"Thread", "[", 
                RowBox[{"Scaled", "[", 
                 RowBox[{".02", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[730]:=",ExpressionUUID->"bdf67aff-9b63-49c3-8a4a-1fbbe0a4de5e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Loss cone - Maxwellian", "Subsubsection",ExpressionUUID->"ff204e1f-d465-4e45-9f15-b73c3c893168"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl3", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "3"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"v1lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v2lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv2", "=", "51"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "vhist", ",", "q1", ",", "rhist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vhist", "=", 
         RowBox[{"calVelocityHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"v1lim", ",", "Nv1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v2lim", ",", "Nv2"}], "}"}], ",", "q1lim"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nv\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl3"}]}], "Input",
 CellLabel->
  "In[731]:=",ExpressionUUID->"96fe0e7f-76ca-4d7d-a9ae-193e995d5e47"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl3"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["1"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "1.0*^-10"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "\[Xi]\[CapitalDelta]1", ",", "q1", 
       ",", "\[Eta]", ",", "\[Eta]\[Beta]", ",", "\[Beta]", ",", "n0", ",", 
       "\[Theta]2O\[Theta]1", ",", "T2OT1", ",", "vv12", ",", "ff", ",", "gg",
        ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileLossCone", "[", 
            RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], 
            "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileLossCone", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1", ",", "\[Beta]"}], 
            "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vhist", "[", "\"\<df\>\"", "]"}], "//", "Reverse"}],
                 ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Divide", ",", 
                  RowBox[{"Subtract", "@@@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRangePadding", "->", 
               RowBox[{"Thread", "[", 
                RowBox[{"Scaled", "[", 
                 RowBox[{".02", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[733]:=",ExpressionUUID->"7b43c61b-d5ad-4fdd-a772-d4d0ed3a5201"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Loss cone - Bi-Maxwellian", "Subsubsection",ExpressionUUID->"07cb930f-0154-42c4-a84b-64000b6a5919"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl4", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "4"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"v1lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v2lim", "=", 
        RowBox[{"6.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "vhist", ",", "q1", ",", "rhist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vhist", "=", 
         RowBox[{"calVelocityHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"v1lim", ",", "Nv1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v2lim", ",", "Nv2"}], "}"}], ",", "q1lim"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nv\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl4"}]}], "Input",
 CellLabel->
  "In[734]:=",ExpressionUUID->"f80e0095-8f0a-4fe4-90c4-7fb3081b8a1b"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl4"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "1.0*^-10"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "\[Xi]\[CapitalDelta]1", ",", "q1", 
       ",", "\[Eta]", ",", "\[Eta]\[Beta]", ",", "\[Beta]", ",", "n0", ",", 
       "\[Theta]2O\[Theta]1", ",", "T2OT1", ",", "vv12", ",", "ff", ",", "gg",
        ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileLossCone", "[", 
            RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], 
            "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileLossCone", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1", ",", "\[Beta]"}], 
            "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vhist", "[", "\"\<df\>\"", "]"}], "//", "Reverse"}],
                 ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Divide", ",", 
                  RowBox[{"Subtract", "@@@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRangePadding", "->", 
               RowBox[{"Thread", "[", 
                RowBox[{"Scaled", "[", 
                 RowBox[{".02", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[736]:=",ExpressionUUID->"51ef39fa-77c6-4a43-9e93-38d99f692bac"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Loss cone - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Beta]", "eq"], "=", "0.5"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "0d219fcd-ec78-4885-b380-67af10638728"]
}], "Subsubsection",ExpressionUUID->"453a29b7-4b7f-4c4e-8b5d-32e8bf4fe9a4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl5", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "5"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"v1lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v2lim", "=", 
        RowBox[{"6.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "vhist", ",", "q1", ",", "rhist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vhist", "=", 
         RowBox[{"calVelocityHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"v1lim", ",", "Nv1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v2lim", ",", "Nv2"}], "}"}], ",", "q1lim"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nv\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl5"}]}], "Input",
 CellLabel->
  "In[737]:=",ExpressionUUID->"0e51ec89-08a0-4054-84d8-3643b3203a1c"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl5"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "0.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "\[Xi]\[CapitalDelta]1", ",", "q1", 
       ",", "\[Eta]", ",", "\[Eta]\[Beta]", ",", "\[Beta]", ",", "n0", ",", 
       "\[Theta]2O\[Theta]1", ",", "T2OT1", ",", "vv12", ",", "ff", ",", "gg",
        ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileLossCone", "[", 
            RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], 
            "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileLossCone", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1", ",", "\[Beta]"}], 
            "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vhist", "[", "\"\<df\>\"", "]"}], "//", "Reverse"}],
                 ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Divide", ",", 
                  RowBox[{"Subtract", "@@@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRangePadding", "->", 
               RowBox[{"Thread", "[", 
                RowBox[{"Scaled", "[", 
                 RowBox[{".02", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[739]:=",ExpressionUUID->"57e2e1ce-cc9a-4e6e-b9b0-5f50e329419d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Loss cone - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Beta]", "eq"], "=", "2.5"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "b870e055-b1c7-449b-902d-f94bf4f76d10"]
}], "Subsubsection",ExpressionUUID->"420d5dbe-eb47-4c9a-b990-17c8bf2c417f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl6", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "6"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"v1lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v2lim", "=", 
        RowBox[{"6.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "vhist", ",", "q1", ",", "rhist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vhist", "=", 
         RowBox[{"calVelocityHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"v1lim", ",", "Nv1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v2lim", ",", "Nv2"}], "}"}], ",", "q1lim"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nv\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl6"}]}], "Input",
 CellLabel->
  "In[740]:=",ExpressionUUID->"4128df59-a0ee-48c9-a3b5-58536eb92fd0"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl6"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "2.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "\[Xi]\[CapitalDelta]1", ",", "q1", 
       ",", "\[Eta]", ",", "\[Eta]\[Beta]", ",", "\[Beta]", ",", "n0", ",", 
       "\[Theta]2O\[Theta]1", ",", "T2OT1", ",", "vv12", ",", "ff", ",", "gg",
        ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileLossCone", "[", 
            RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], 
            "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileLossCone", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1", ",", "\[Beta]"}], 
            "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vhist", "[", "\"\<df\>\"", "]"}], "//", "Reverse"}],
                 ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Divide", ",", 
                  RowBox[{"Subtract", "@@@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRangePadding", "->", 
               RowBox[{"Thread", "[", 
                RowBox[{"Scaled", "[", 
                 RowBox[{".02", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[742]:=",ExpressionUUID->"d183ec4e-ef5d-4e9e-89f7-1752fde91471"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Partial Shell - Maxwellian", "Subsubsection",ExpressionUUID->"4cde35e2-2a6c-42fb-8a21-d536aaf2b1c0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl7", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "7"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"v1lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v2lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv2", "=", "51"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "vhist", ",", "q1", ",", "rhist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vhist", "=", 
         RowBox[{"calVelocityHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"v1lim", ",", "Nv1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v2lim", ",", "Nv2"}], "}"}], ",", "q1lim"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nv\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl7"}]}], "Input",
 CellLabel->
  "In[743]:=",ExpressionUUID->"fdd05f59-c9bf-4ee7-b6e7-1ec4e8adb3e6"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl7"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "1.5"}], ",", 
     RowBox[{"\[Zeta]", "=", "0"}], ",", 
     RowBox[{"vs", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "plots", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "vv12", ",", "ff", ",", 
       "gg"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compilePartialShell", "[", 
            RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], "]"}], 
           ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compilePartialShell", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]", " ", "gT"}], ",", "\[Zeta]", ",", "vs"}], 
            "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vhist", "[", "\"\<df\>\"", "]"}], "//", "Reverse"}],
                 ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Divide", ",", 
                  RowBox[{"Subtract", "@@@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRangePadding", "->", 
               RowBox[{"Thread", "[", 
                RowBox[{"Scaled", "[", 
                 RowBox[{".02", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[745]:=",ExpressionUUID->"3b80149a-2520-4e15-9c72-3095b1089618"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Isotropic shell", "Subsubsection",ExpressionUUID->"9c707734-a002-4b4f-a78f-4088c49d8d3c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl8", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "8"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"v1lim", "=", 
        RowBox[{"2.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v2lim", "=", 
        RowBox[{"3.0", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "vhist", ",", "q1", ",", "rhist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vhist", "=", 
         RowBox[{"calVelocityHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"v1lim", ",", "Nv1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v2lim", ",", "Nv2"}], "}"}], ",", "q1lim"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nv\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl8"}]}], "Input",
 CellLabel->
  "In[746]:=",ExpressionUUID->"398aa1e0-b84f-4764-a659-9a8c5ffcdb98"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl8"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "0"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "plots", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "vv12", ",", "ff", ",", 
       "gg"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compilePartialShell", "[", 
            RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], "]"}], 
           ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compilePartialShell", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]", " ", "gT"}], ",", "\[Zeta]", ",", "vs"}], 
            "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vhist", "[", "\"\<df\>\"", "]"}], "//", "Reverse"}],
                 ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Divide", ",", 
                  RowBox[{"Subtract", "@@@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRangePadding", "->", 
               RowBox[{"Thread", "[", 
                RowBox[{"Scaled", "[", 
                 RowBox[{".02", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[748]:=",ExpressionUUID->"26061cd9-12aa-490f-b1d5-6c11255c1278"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Partial shell - ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Zeta]", "=", "1"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "5dfeb8ae-ab61-4209-b791-0ab3e6edf841"]
}], "Subsubsection",ExpressionUUID->"50d02012-23a3-4fdc-b5f8-faf0710d9674"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl9", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "9"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"v1lim", "=", 
        RowBox[{"2.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v2lim", "=", 
        RowBox[{"3.0", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "vhist", ",", "q1", ",", "rhist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vhist", "=", 
         RowBox[{"calVelocityHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"v1lim", ",", "Nv1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v2lim", ",", "Nv2"}], "}"}], ",", "q1lim"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nv\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl9"}]}], "Input",
 CellLabel->
  "In[749]:=",ExpressionUUID->"9a7809fb-2c2d-4650-8a3f-b5bb9dfe2995"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl9"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "1"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "plots", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "vv12", ",", "ff", ",", 
       "gg"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compilePartialShell", "[", 
            RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], "]"}], 
           ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compilePartialShell", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]", " ", "gT"}], ",", "\[Zeta]", ",", "vs"}], 
            "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vhist", "[", "\"\<df\>\"", "]"}], "//", "Reverse"}],
                 ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Divide", ",", 
                  RowBox[{"Subtract", "@@@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRangePadding", "->", 
               RowBox[{"Thread", "[", 
                RowBox[{"Scaled", "[", 
                 RowBox[{".02", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[751]:=",ExpressionUUID->"89c4593d-3e80-4b8f-bdd1-6fd0449d22c0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Partial shell - ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Zeta]", "=", "5"}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "3feba518-3360-48bc-bd4f-19007b6c6f11"]
}], "Subsubsection",ExpressionUUID->"7950b24b-c9da-4d79-9d2d-f2e2a50a72e5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl10", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "10"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"v1lim", "=", 
        RowBox[{"2.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"v2lim", "=", 
        RowBox[{"3.0", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"Nv2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "vhist", ",", "q1", ",", "rhist"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vhist", "=", 
         RowBox[{"calVelocityHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"v1lim", ",", "Nv1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v2lim", ",", "Nv2"}], "}"}], ",", "q1lim"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nv\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl10"}]}], "Input",
 CellLabel->
  "In[752]:=",ExpressionUUID->"8ec05565-1468-434e-90e1-fa9efc4065ed"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl10"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "5"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "v1", ",", "v2", ",", "plots", ",", "\[Xi]\[CapitalDelta]1", 
       ",", "q1", ",", "\[Eta]", ",", "n0", ",", "vv12", ",", "ff", ",", 
       "gg"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v1", "=", 
       RowBox[{"vhist", "[", "\"\<v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2", "=", 
       RowBox[{"vhist", "[", "\"\<v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compilePartialShell", "[", 
            RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], "]"}], 
           ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compilePartialShell", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]", " ", "gT"}], ",", "\[Zeta]", ",", "vs"}], 
            "]"}], ",", 
           RowBox[{"vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"ArrayPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"vhist", "[", "\"\<df\>\"", "]"}], "//", "Reverse"}],
                 ",", 
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                   RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
                RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
               "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AspectRatio", "->", 
               RowBox[{"1", "/", 
                RowBox[{"Apply", "[", 
                 RowBox[{"Divide", ",", 
                  RowBox[{"Subtract", "@@@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                 "]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"PlotRangePadding", "->", 
               RowBox[{"Thread", "[", 
                RowBox[{"Scaled", "[", 
                 RowBox[{".02", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
              "]"}]}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[754]:=",ExpressionUUID->"ed6fdec6-abd6-443c-b685-c3ef58ecb9e8"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Relativistic", "Section",ExpressionUUID->"049bdef6-6ff3-441e-9834-854918644d50"],

Cell[CellGroupData[{

Cell["Energy", "Subsection",ExpressionUUID->"d6bbe9ce-e81c-4417-8a75-9db60646a1a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"energy", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"stride", "=", "8"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "step", ",", "time", ",", "dB2O2", ",", "dE2O2", ",", "mv2O2", ",", 
         "m\[Theta]2O2", ",", "\[IndentingNewLine]", 
         RowBox[{"data", "=", 
          RowBox[{
           RowBox[{"Chop", "@", 
            RowBox[{"Map", "[", 
             RowBox[{"Last", ",", 
              RowBox[{"SplitBy", "[", 
               RowBox[{
                RowBox[{"SortBy", "[", 
                 RowBox[{
                  RowBox[{"Import", "[", 
                   RowBox[{
                    RowBox[{"FileNameJoin", "[", 
                    RowBox[{"{", 
                    RowBox[{"wd", ",", "\"\<energy.csv\>\""}], "}"}], "]"}], 
                    ",", "\"\<CSV\>\"", ",", 
                    RowBox[{"\"\<HeaderLines\>\"", "\[Rule]", "1"}]}], "]"}], 
                  ",", "First"}], "]"}], ",", "First"}], "]"}]}], "]"}]}], "//",
            "Transpose"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"step", ",", "time"}], "}"}], "=", 
         RowBox[{"Take", "[", 
          RowBox[{"data", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"data", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dB2O2", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"Take", "[", 
           RowBox[{"data", ",", "3"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"data", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dE2O2", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"Take", "[", 
           RowBox[{"data", ",", "3"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"data", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"Take", "[", 
               RowBox[{"#", ",", "4"}], "]"}], "]"}], ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"Drop", "[", 
               RowBox[{"#", ",", "4"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
          RowBox[{"Partition", "[", 
           RowBox[{"data", ",", "stride"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"mv2O2", ",", "m\[Theta]2O2"}], "}"}], "=", 
         RowBox[{"data", "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Association", "[", 
         RowBox[{
          RowBox[{"\"\<step\>\"", "\[Rule]", "step"}], ",", 
          RowBox[{"\"\<time\>\"", "\[Rule]", "time"}], ",", 
          RowBox[{"\"\<dB2O2\>\"", "->", "dB2O2"}], ",", 
          RowBox[{"\"\<dE2O2\>\"", "->", "dE2O2"}], ",", 
          RowBox[{"\"\<mv2O2\>\"", "->", "mv2O2"}], ",", 
          RowBox[{"\"\<m\[Theta]2O2\>\"", "->", "m\[Theta]2O2"}]}], "]"}]}]}],
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[2177]:=",ExpressionUUID->"5af87966-7ad5-4915-b423-a530c1b88ade"],

Cell[BoxData[
 RowBox[{"Dimensions", "/@", "energy"}]], "Input",
 CellLabel->
  "In[2178]:=",ExpressionUUID->"01777970-3e72-4129-8b96-05a4ad95277a"],

Cell[BoxData[
 RowBox[{"dynamic", "=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"energy", "=", "energy"}], ",", 
      RowBox[{"tlim", "=", 
       RowBox[{"Interval", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "Infinity"}], "}"}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"time", ",", "pos", ",", "dB2O2", ",", "dE2O2", ",", "mv2O2"}],
        "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"time", "=", 
        RowBox[{"energy", "[", "\"\<time\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"time", ",", 
          RowBox[{"$_Real", "/;", 
           RowBox[{"IntervalMemberQ", "[", 
            RowBox[{"tlim", ",", "$"}], "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "pos", "]"}], "\[LessEqual]", "1"}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<no time selected\>\"", "]"}], ";", 
            RowBox[{"Abort", "[", "]"}]}], ")"}], ",", 
          RowBox[{"pos", "//", "Extract"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"time", "=", 
        RowBox[{"pos", "[", "time", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dB2O2", "=", 
        RowBox[{
         RowBox[{"energy", "[", "\"\<dB2O2\>\"", "]"}], "//", "pos"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dE2O2", "=", 
        RowBox[{
         RowBox[{"energy", "[", "\"\<dE2O2\>\"", "]"}], "//", "pos"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mv2O2", "=", 
        RowBox[{
         RowBox[{"pos", "/@", 
          RowBox[{"energy", "[", "\"\<mv2O2\>\"", "]"}]}], "//", "Total"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{"#", ",", "\[IndentingNewLine]", 
            RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"AspectRatio", "\[Rule]", 
             RowBox[{"1", "/", "3"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Frame", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
           "]"}], "&"}], "/@", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"dB2O2", "//", "Transpose"}], ",", 
             RowBox[{"DataRange", "\[Rule]", 
              RowBox[{"time", "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", "\"\<dB^2/2\>\""}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"dE2O2", "//", "Transpose"}], ",", 
             RowBox[{"DataRange", "\[Rule]", 
              RowBox[{"time", "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", "\"\<dE^2/2\>\""}]}], "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Rest", "/@", "mv2O2"}], "//", "Transpose"}], ",", 
             RowBox[{"DataRange", "\[Rule]", 
              RowBox[{"time", "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", "\"\<mv^2/2\>\""}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#", ",", 
                 RowBox[{"#2", "-", 
                  RowBox[{"First", "[", "#2", "]"}]}], ",", 
                 RowBox[{"#", "+", "#2", "-", 
                  RowBox[{"First", "[", "#2", "]"}]}]}], "}"}], "&"}], "@@", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Plus", "@@@", 
                 RowBox[{"(", 
                  RowBox[{"dB2O2", "+", "dE2O2"}], ")"}]}], ",", 
                RowBox[{"First", "/@", "mv2O2"}]}], "}"}]}], ",", 
             RowBox[{"DataRange", "\[Rule]", 
              RowBox[{"time", "[", 
               RowBox[{"[", 
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", "\"\<Total\>\""}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "}"}]}], "//", "Column"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellLabel->
  "In[2179]:=",ExpressionUUID->"7328c186-3089-40c8-b97d-7a65c857185d"],

Cell[BoxData[
 RowBox[{"dynamic", "=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"energy", "=", "energy"}], ",", 
      RowBox[{"tlim", "=", 
       RowBox[{"Interval", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "Infinity"}], "}"}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "time", ",", "pos", ",", "mv2O2", ",", "mU2O2", ",", "m\[Theta]2O2", 
        ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"time", "=", 
        RowBox[{"energy", "[", "\"\<time\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"time", ",", 
          RowBox[{"$_Real", "/;", 
           RowBox[{"IntervalMemberQ", "[", 
            RowBox[{"tlim", ",", "$"}], "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "pos", "]"}], "\[LessEqual]", "1"}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<no time selected\>\"", "]"}], ";", 
            RowBox[{"Abort", "[", "]"}]}], ")"}], ",", 
          RowBox[{"pos", "//", "Extract"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"time", "=", 
        RowBox[{"pos", "[", "time", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mv2O2", "=", 
        RowBox[{"pos", "/@", 
         RowBox[{"energy", "[", "\"\<mv2O2\>\"", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"m\[Theta]2O2", "=", 
        RowBox[{"pos", "/@", 
         RowBox[{"energy", "[", "\"\<m\[Theta]2O2\>\"", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mU2O2", "=", 
        RowBox[{"mv2O2", "-", "m\[Theta]2O2"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"plots", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Show", "[", 
            RowBox[{"#", ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "\[Rule]", "Small"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Frame", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
            "]"}], "&"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"ListPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"RotateLeft", "/@", "#"}], "//", "Transpose"}], ",", 
                
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"time", "[", 
                  RowBox[{"[", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
                RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "/@",
              "mv2O2"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"ListPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"RotateLeft", "/@", "#"}], "//", "Transpose"}], ",", 
                
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"time", "[", 
                  RowBox[{"[", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
                RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "/@",
              "m\[Theta]2O2"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"ListPlot", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"RotateLeft", "/@", "#"}], "//", "Transpose"}], ",", 
                
                RowBox[{"DataRange", "\[Rule]", 
                 RowBox[{"time", "[", 
                  RowBox[{"[", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
                RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "/@",
              "mU2O2"}]}], "\[IndentingNewLine]", "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{
          RowBox[{"plots", "//", "Transpose"}], ",", 
          RowBox[{"Text", "/@", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Kinetic\>\"", ",", "\"\<Thermal\>\"", ",", "\"\<Bulk\>\""}], 
            "}"}]}]}], "]"}], "//", "Grid"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[2180]:=",ExpressionUUID->"fcab10d7-7b6d-4ee9-b2d1-81e593575264"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"energy", "=", "energy"}], ",", 
     RowBox[{"tlim", "=", 
      RowBox[{"Interval", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", "Infinity"}], "}"}], "]"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "time", ",", "pos", ",", "mv2O2", ",", "mU2O2", ",", "m\[Theta]2O2", 
       ",", "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"time", "=", 
       RowBox[{"energy", "[", "\"\<time\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"Position", "[", 
        RowBox[{"time", ",", 
         RowBox[{"$_Real", "/;", 
          RowBox[{"IntervalMemberQ", "[", 
           RowBox[{"tlim", ",", "$"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "pos", "]"}], "\[LessEqual]", "1"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<no time selected\>\"", "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}], ")"}], ",", 
         RowBox[{"pos", "//", "Extract"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"time", "=", 
       RowBox[{"pos", "[", "time", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mv2O2", "=", 
       RowBox[{"pos", "/@", 
        RowBox[{"energy", "[", "\"\<mv2O2\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"m\[Theta]2O2", "=", 
       RowBox[{"pos", "/@", 
        RowBox[{"energy", "[", "\"\<m\[Theta]2O2\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mU2O2", "=", 
       RowBox[{"mv2O2", "-", "m\[Theta]2O2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{"#", ",", "\[IndentingNewLine]", 
            RowBox[{"ImageSize", "\[Rule]", "Small"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Frame", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
           "]"}], "&"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"RotateLeft", "[", 
                RowBox[{"#", "-", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"time", "[", 
                 RowBox[{"[", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "/@", 
            
            RowBox[{"Map", "[", 
             RowBox[{"Transpose", ",", "mv2O2"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"RotateLeft", "[", 
                RowBox[{"#", "-", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"time", "[", 
                 RowBox[{"[", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "/@", 
            
            RowBox[{"Map", "[", 
             RowBox[{"Transpose", ",", "m\[Theta]2O2"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"RotateLeft", "[", 
                RowBox[{"#", "-", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"time", "[", 
                 RowBox[{"[", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "&"}], "/@", 
            
            RowBox[{"Map", "[", 
             RowBox[{"Transpose", ",", "mU2O2"}], "]"}]}]}], 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Prepend", "[", 
        RowBox[{
         RowBox[{"plots", "//", "Transpose"}], ",", 
         RowBox[{"Text", "/@", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Kinetic\>\"", ",", "\"\<Thermal\>\"", ",", "\"\<Bulk\>\""}], 
           "}"}]}]}], "]"}], "//", "Grid"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[2181]:=",ExpressionUUID->"9fdae9ed-6252-4ec2-b7e6-89d9ab850e3d"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"energy", "=", "energy"}], ",", 
     RowBox[{"tlim", "=", 
      RowBox[{"Interval", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", "Infinity"}], "}"}], "]"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"time", ",", "pos", ",", "m\[Theta]2O2", ",", "T1", ",", "T2"}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"time", "=", 
       RowBox[{"energy", "[", "\"\<time\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"Position", "[", 
        RowBox[{"time", ",", 
         RowBox[{"$_Real", "/;", 
          RowBox[{"IntervalMemberQ", "[", 
           RowBox[{"tlim", ",", "$"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "pos", "]"}], "\[LessEqual]", "1"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<no time selected\>\"", "]"}], ";", 
           RowBox[{"Abort", "[", "]"}]}], ")"}], ",", 
         RowBox[{"pos", "//", "Extract"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"time", "=", 
       RowBox[{"pos", "[", "time", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"m\[Theta]2O2", "=", 
       RowBox[{"Map", "[", 
        RowBox[{"pos", ",", 
         RowBox[{"energy", "[", "\"\<m\[Theta]2O2\>\"", "]"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"m\[Theta]2O2", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{"#", ",", "2"}], "]"}], ",", 
            RowBox[{".5", 
             RowBox[{"Plus", "@@", 
              RowBox[{"Drop", "[", 
               RowBox[{"#", ",", "2"}], "]"}]}]}]}], "}"}], "&"}], ",", 
         "m\[Theta]2O2", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T1", "=", 
       RowBox[{
        RowBox[{"Chop", "[", 
         RowBox[{"m\[Theta]2O2", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "All", ",", "1"}], "]"}], "]"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"0", "\[Rule]", "Indeterminate"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"T2", "=", 
       RowBox[{
        RowBox[{"Chop", "[", 
         RowBox[{"m\[Theta]2O2", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{"0", "\[Rule]", "Indeterminate"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Show", "[", 
          RowBox[{"#", ",", "\[IndentingNewLine]", 
           RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Frame", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
          "]"}], "&"}], "/@", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"T1", "/", 
             RowBox[{"T1", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
            RowBox[{"DataRange", "\[Rule]", 
             RowBox[{"time", "[", 
              RowBox[{"[", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{
            "FrameLabel", "\[Rule]", 
             "\"\<\\!\\(\!\(\*SubscriptBox[\(T\), \
\(\[DoubleVerticalBar]\)]\)(t)/\!\(\*SubscriptBox[\(T\), \(\
\[DoubleVerticalBar]\)]\)(0)\\)\>\""}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"T2", "/", 
             RowBox[{"T1", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
            RowBox[{"DataRange", "\[Rule]", 
             RowBox[{"time", "[", 
              RowBox[{"[", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{
            "FrameLabel", "\[Rule]", 
             "\"\<\\!\\(\!\(\*SubscriptBox[\(T\), \
\(\[UpTee]\)]\)(t)/\!\(\*SubscriptBox[\(T\), \
\(\[DoubleVerticalBar]\)]\)(0)\\)\>\""}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
         "\[IndentingNewLine]", "}"}]}], "//", "Column"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[2182]:=",ExpressionUUID->"b3a0de19-ea50-4af9-b6fb-aec6c87ba033"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Moment", "Subsection",ExpressionUUID->"8bab2c33-d95c-41f6-a9df-a55c1f8da90f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"metadata", "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"files", "=", 
        RowBox[{"FileNames", "[", 
         RowBox[{"\"\<moment-*.h5\>\"", ",", "wd"}], "]"}]}], ",", "attrs", 
       ",", "steps", ",", "times", ",", "pos"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"attrs", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<HDF5\>\"", ",", "\"\<Attributes\>\"", ",", 
             "\"\</moment\>\""}], "}"}]}], "]"}], "&"}], "/@", "files"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{
        RowBox[{"Lookup", "[", "\"\<step\>\"", "]"}], "/@", "attrs"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"times", "=", 
       RowBox[{
        RowBox[{"Lookup", "[", "\"\<time\>\"", "]"}], "/@", "attrs"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"List", "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "times", "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"First", "/@", 
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"pos", ",", "times"}], "}"}], "]"}], ",", "Last"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"steps", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"times", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"times", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"files", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"files", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Association", "[", 
       RowBox[{
        RowBox[{"\"\<attr\>\"", "->", 
         RowBox[{"KeyDrop", "[", 
          RowBox[{
           RowBox[{"First", "[", "attrs", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<step\>\"", ",", "\"\<time\>\""}], "}"}]}], "]"}]}], 
        ",", 
        RowBox[{"\"\<step\>\"", "->", "steps"}], ",", 
        RowBox[{"\"\<time\>\"", "->", "times"}], ",", 
        RowBox[{"\"\<files\>\"", "->", "files"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[2183]:=",ExpressionUUID->"7fe74a65-87d2-41fd-9f7e-6086933d5ee9"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compileBiMaxwellian", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compileBiMaxwellian", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]1_", "?", "Positive"}], ",", 
    RowBox[{"T2OT1_", "?", "Positive"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]1", "=", 
       SqrtBox[
        RowBox[{"N", "[", "\[Beta]1", "]"}]]}], ",", 
      RowBox[{"\[Theta]2", "=", 
       SqrtBox[
        RowBox[{
         RowBox[{"N", "[", "\[Beta]1", "]"}], "T2OT1"}]]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"n", " ", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"v1", "^", "2"}]}], "/", 
            RowBox[{"\[Theta]1", "^", "2"}]}], "-", 
           RowBox[{
            RowBox[{"v2", "^", "2"}], "/", 
            RowBox[{"\[Theta]2", "^", "2"}]}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"Pi", "^", "1.5"}], " ", "\[Theta]1", " ", 
          RowBox[{"\[Theta]2", "^", "2"}]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[2184]:=",ExpressionUUID->"3510a4dc-20bc-4764-8fcd-94131ca416fe"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compileLossCone", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compileLossCone", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]1_", "?", "Positive"}], ",", 
    RowBox[{"T2OT1_", "?", "Positive"}], ",", 
    RowBox[{"\[Beta]_Real", "?", "Positive"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]1", "=", 
       SqrtBox[
        RowBox[{"N", "[", "\[Beta]1", "]"}]]}], ",", 
      RowBox[{"\[Theta]2", "=", 
       SqrtBox[
        RowBox[{
         RowBox[{"N", "[", "\[Beta]1", "]"}], 
         RowBox[{"T2OT1", "/", 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}]]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Beta]"}], ")"}]}], 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"v1", "^", "2"}]}], "/", 
            RowBox[{"\[Theta]1", "^", "2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"v2", "^", "2"}]}], "/", 
              RowBox[{"\[Theta]2", "^", "2"}]}], "]"}], "-", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"v2", "^", "2"}]}], "/", 
               RowBox[{"\[Theta]2", "^", "2"}]}], "/", "\[Beta]"}], "]"}]}], 
           ")"}]}], ",", 
         RowBox[{
          RowBox[{"Pi", "^", "1.5"}], " ", "\[Theta]1", " ", 
          RowBox[{"\[Theta]2", "^", "2"}]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[2186]:=",ExpressionUUID->"298398bb-8b8b-4a10-8c21-2ff961485459"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compilePartialShell", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compilePartialShell", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]_", "?", "Positive"}], ",", 
    RowBox[{"\[Zeta]_Integer", "?", "NonNegative"}], ",", 
    RowBox[{"vs_", "?", "NonNegative"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]", "=", 
       RowBox[{"N", "[", 
        SqrtBox["\[Beta]"], "]"}]}], ",", 
      RowBox[{"xs", "=", 
       RowBox[{"N", "[", 
        RowBox[{"vs", "/", 
         SqrtBox["\[Beta]"]}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{".5", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"vs", "/", 
            SqrtBox["\[Beta]"]}], 
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"vs", "/", 
                SqrtBox["\[Beta]"]}], ")"}], "^", "2"}]}], "]"}]}], "+", 
          RowBox[{
           SqrtBox["\[Pi]"], 
           RowBox[{"(", 
            RowBox[{".5", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"vs", "/", 
                SqrtBox["\[Beta]"]}], ")"}], "^", "2"}]}], ")"}], 
           RowBox[{"Erfc", "[", 
            RowBox[{
             RowBox[{"-", "vs"}], "/", 
             SqrtBox["\[Beta]"]}], "]"}]}]}], ")"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"B\[Zeta]", "=", 
       RowBox[{
        SqrtBox["\[Pi]"], 
        RowBox[{
         RowBox[{"Gamma", "[", 
          RowBox[{"1", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}], "/", 
         RowBox[{"Gamma", "[", 
          RowBox[{"1.5", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "x1", ",", "x2", ",", "\[Mu]"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x2", "=", 
          RowBox[{"v2", "/", "\[Theta]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x1", "=", 
          RowBox[{"v1", "/", "\[Theta]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x", "=", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"x1", "^", "2"}], "+", 
            RowBox[{"x2", "^", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Mu]", "=", 
          RowBox[{"x1", "/", "x"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"n", " ", 
          RowBox[{"Divide", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"x", "-", "xs"}], ")"}], "^", "2"}]}], "]"}], 
             RowBox[{"Power", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "\[Mu]"}], ")"}], 
                RowBox[{"(", 
                 RowBox[{"1", "+", "\[Mu]"}], ")"}]}], ",", 
               RowBox[{".5", "\[Zeta]"}]}], "]"}]}], ",", 
            RowBox[{"2", "Pi", " ", 
             RowBox[{"\[Theta]", "^", "3"}], "Ab", " ", "B\[Zeta]"}]}], 
           "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[2188]:=",ExpressionUUID->"e40fce72-be50-45ca-a8e6-1b607548d481"],

Cell[CellGroupData[{

Cell["Maxwellian", "Subsubsection",ExpressionUUID->"ddc277b0-c34c-48ad-a79c-e36819923521"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom1", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "1"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<n\>\"", ",", "\"\<time\>\"", ",", "\"\<n\[Gamma]cc\>\""}], 
           "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<c\>\""}], "}"}], "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importRelativisticMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom1"}]}], "Input",
 CellLabel->
  "In[2190]:=",ExpressionUUID->"7a555eae-a0a9-4fed-82b9-c337510fe03c"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom1"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"T2OT1eq", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "q1", ",", "\[Xi]\[CapitalDelta]1", ",", "\[Eta]", ",", "n0", ",", 
       "T2OT1", ",", "n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", 
       "n\[Gamma]v2v2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{"T2OT1eq", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "T2OT1eq"}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{"T2OT1eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}],
         "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"n0", ",", "T2OT1"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\[Theta]1", ",", "\[Theta]2", ",", "\[Gamma]v1", ",", 
               "\[Gamma]v2", ",", "dV", ",", "\[Gamma]vv1", ",", 
               "\[Gamma]vv2", ",", "\[Gamma]\[Gamma]", ",", "ff"}], "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\[Theta]1", "=", 
               SqrtBox["\[Beta]1"]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Theta]2", "=", 
               SqrtBox[
                RowBox[{"\[Beta]1", " ", "T2OT1"}]]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v1", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "501", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "4", 
                    "\[Theta]1"}]}], "]"}], ",", "2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v2", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "251", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], "4", "\[Theta]2"}]}], 
                  "]"}], ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"dV", "=", 
               RowBox[{"2", "\[Pi]", " ", "\[Gamma]vv2", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "}"}], "=", 
               RowBox[{"Transpose", "[", 
                RowBox[{"Tuples", "[", 
                 RowBox[{"{", 
                  RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]\[Gamma]", "=", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"1", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[Gamma]vv1", "^", "2"}], "+", 
                    RowBox[{"\[Gamma]vv2", "^", "2"}]}], ")"}], "/", 
                  RowBox[{
                   RowBox[{"moment", "[", "\"\<c\>\"", "]"}], "^", "2"}]}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"ff", "=", 
               RowBox[{
                RowBox[{"compileBiMaxwellian", "[", 
                 RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1"}], "]"}], "[", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n", "=", 
               RowBox[{"Total", "[", 
                RowBox[{"ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"nV1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{"\[Gamma]vv1", "/", "\[Gamma]\[Gamma]"}], "*", "ff", 
                 "*", "dV"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v1v1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Gamma]vv1", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v2v2", "=", 
               RowBox[{"Total", "[", 
                RowBox[{".5", 
                 RowBox[{
                  RowBox[{"\[Gamma]vv2", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}], 
               "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", "Listable", "}"}]}], "\[IndentingNewLine]", "]"}], 
         "[", 
         RowBox[{"n0", ",", "T2OT1"}], "]"}], "\[Transpose]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"GridLinesStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "nV1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v1v1\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v1v1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v2v2\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v3v3\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[2192]:=",ExpressionUUID->"16d8e1ea-6c16-43c7-bdb1-9cb8ada304dc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bi-Maxwellian", "Subsubsection",ExpressionUUID->"cfb74493-f898-425d-8e91-4d90c50a2157"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom2", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "2"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<n\>\"", ",", "\"\<time\>\"", ",", "\"\<n\[Gamma]cc\>\""}], 
           "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<c\>\""}], "}"}], "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importRelativisticMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom2"}]}], "Input",
 CellLabel->
  "In[2193]:=",ExpressionUUID->"6aca6b0c-7305-4db1-a30d-6e095dece959"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom2"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"T2OT1eq", "=", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "q1", ",", "\[Xi]\[CapitalDelta]1", ",", "\[Eta]", ",", "n0", ",", 
       "T2OT1", ",", "n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", 
       "n\[Gamma]v2v2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{"T2OT1eq", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "T2OT1eq"}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{"T2OT1eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}],
         "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"n0", ",", "T2OT1"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\[Theta]1", ",", "\[Theta]2", ",", "\[Gamma]v1", ",", 
               "\[Gamma]v2", ",", "dV", ",", "\[Gamma]vv1", ",", 
               "\[Gamma]vv2", ",", "\[Gamma]\[Gamma]", ",", "ff"}], "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\[Theta]1", "=", 
               SqrtBox["\[Beta]1"]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Theta]2", "=", 
               SqrtBox[
                RowBox[{"\[Beta]1", " ", "T2OT1"}]]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v1", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "501", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "4", 
                    "\[Theta]1"}]}], "]"}], ",", "2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v2", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "251", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], "4", "\[Theta]2"}]}], 
                  "]"}], ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"dV", "=", 
               RowBox[{"2", "\[Pi]", " ", "\[Gamma]vv2", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "}"}], "=", 
               RowBox[{"Transpose", "[", 
                RowBox[{"Tuples", "[", 
                 RowBox[{"{", 
                  RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]\[Gamma]", "=", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"1", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[Gamma]vv1", "^", "2"}], "+", 
                    RowBox[{"\[Gamma]vv2", "^", "2"}]}], ")"}], "/", 
                  RowBox[{
                   RowBox[{"moment", "[", "\"\<c\>\"", "]"}], "^", "2"}]}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"ff", "=", 
               RowBox[{
                RowBox[{"compileBiMaxwellian", "[", 
                 RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1"}], "]"}], "[", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n", "=", 
               RowBox[{"Total", "[", 
                RowBox[{"ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"nV1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{"\[Gamma]vv1", "/", "\[Gamma]\[Gamma]"}], "*", "ff", 
                 "*", "dV"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v1v1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Gamma]vv1", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v2v2", "=", 
               RowBox[{"Total", "[", 
                RowBox[{".5", 
                 RowBox[{
                  RowBox[{"\[Gamma]vv2", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}], 
               "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", "Listable", "}"}]}], "\[IndentingNewLine]", "]"}], 
         "[", 
         RowBox[{"n0", ",", "T2OT1"}], "]"}], "\[Transpose]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"GridLinesStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "nV1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v1v1\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v1v1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v2v2\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v3v3\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[2195]:=",ExpressionUUID->"b09322f1-58bf-4f3d-8718-bec806aa24f0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Losscone - Maxwellian", "Subsubsection",ExpressionUUID->"9d1ccb1f-8b24-4f8f-ba47-7fded7019e4e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom3", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "3"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<n\>\"", ",", "\"\<time\>\"", ",", "\"\<n\[Gamma]cc\>\""}], 
           "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<c\>\""}], "}"}], "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importRelativisticMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom3"}]}], "Input",
 CellLabel->
  "In[2196]:=",ExpressionUUID->"41c9806f-94b8-4d02-ae04-ef94c4e9e016"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom3"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["1"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "1.0*^-10"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "q1", ",", "\[Xi]\[CapitalDelta]1", ",", "\[Eta]", ",", "\[Eta]\[Beta]",
        ",", "n0", ",", "\[Beta]", ",", "\[Theta]2O\[Theta]1", ",", "n", ",", 
       "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}],
         "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"n0", ",", "\[Theta]2O\[Theta]1", ",", "\[Beta]"}], "}"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "T2OT1", ",", "\[Theta]1", ",", "\[Theta]2", ",", "\[Gamma]v1", 
               ",", "\[Gamma]v2", ",", "dV", ",", "\[Gamma]vv1", ",", 
               "\[Gamma]vv2", ",", "\[Gamma]\[Gamma]", ",", "ff"}], "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"T2OT1", "=", 
               RowBox[{
                RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
                RowBox[{"(", 
                 RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"\[Theta]1", "=", 
               SqrtBox["\[Beta]1"]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Theta]2", "=", 
               RowBox[{
                SqrtBox["\[Beta]1"], "\[Theta]2O\[Theta]1"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v1", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "501", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "5", 
                    "\[Theta]1"}]}], "]"}], ",", "2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v2", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "251", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], "5", "\[Theta]2"}]}], 
                  "]"}], ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"dV", "=", 
               RowBox[{"2", "\[Pi]", " ", "\[Gamma]vv2", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "}"}], "=", 
               RowBox[{"Transpose", "[", 
                RowBox[{"Tuples", "[", 
                 RowBox[{"{", 
                  RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]\[Gamma]", "=", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"1", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[Gamma]vv1", "^", "2"}], "+", 
                    RowBox[{"\[Gamma]vv2", "^", "2"}]}], ")"}], "/", 
                  RowBox[{
                   RowBox[{"moment", "[", "\"\<c\>\"", "]"}], "^", "2"}]}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"ff", "=", 
               RowBox[{
                RowBox[{"compileLossCone", "[", 
                 RowBox[{
                 "n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], "]"}],
                 "[", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n", "=", 
               RowBox[{"Total", "[", 
                RowBox[{"ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"nV1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{"\[Gamma]vv1", "/", "\[Gamma]\[Gamma]"}], "*", "ff", 
                 "*", "dV"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v1v1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Gamma]vv1", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v2v2", "=", 
               RowBox[{"Total", "[", 
                RowBox[{".5", 
                 RowBox[{
                  RowBox[{"\[Gamma]vv2", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}], 
               "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", "Listable", "}"}]}], "\[IndentingNewLine]", "]"}], 
         "[", 
         RowBox[{"n0", ",", "\[Theta]2O\[Theta]1", ",", "\[Beta]"}], "]"}], 
        "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"GridLinesStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "nV1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v1v1\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v1v1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v2v2\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v3v3\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[2198]:=",ExpressionUUID->"5974ab6e-13db-4e00-9c87-b9006dc9260a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Losscone - Bi-Maxwellian", "Subsubsection",ExpressionUUID->"47a11008-a6c4-4886-a479-09376b05a9bd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom4", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "4"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<n\>\"", ",", "\"\<time\>\"", ",", "\"\<n\[Gamma]cc\>\""}], 
           "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<c\>\""}], "}"}], "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importRelativisticMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom4"}]}], "Input",
 CellLabel->
  "In[2199]:=",ExpressionUUID->"237d1028-5bf3-4148-89a6-ff43d9df1091"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom4"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "1.0*^-10"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "q1", ",", "\[Xi]\[CapitalDelta]1", ",", "\[Eta]", ",", "\[Eta]\[Beta]",
        ",", "n0", ",", "\[Beta]", ",", "\[Theta]2O\[Theta]1", ",", "n", ",", 
       "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}],
         "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"n0", ",", "\[Theta]2O\[Theta]1", ",", "\[Beta]"}], "}"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "T2OT1", ",", "\[Theta]1", ",", "\[Theta]2", ",", "\[Gamma]v1", 
               ",", "\[Gamma]v2", ",", "dV", ",", "\[Gamma]vv1", ",", 
               "\[Gamma]vv2", ",", "\[Gamma]\[Gamma]", ",", "ff"}], "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"T2OT1", "=", 
               RowBox[{
                RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
                RowBox[{"(", 
                 RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"\[Theta]1", "=", 
               SqrtBox["\[Beta]1"]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Theta]2", "=", 
               RowBox[{
                SqrtBox["\[Beta]1"], "\[Theta]2O\[Theta]1"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v1", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "501", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "5", 
                    "\[Theta]1"}]}], "]"}], ",", "2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v2", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "251", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], "5", "\[Theta]2"}]}], 
                  "]"}], ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"dV", "=", 
               RowBox[{"2", "\[Pi]", " ", "\[Gamma]vv2", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "}"}], "=", 
               RowBox[{"Transpose", "[", 
                RowBox[{"Tuples", "[", 
                 RowBox[{"{", 
                  RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]\[Gamma]", "=", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"1", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[Gamma]vv1", "^", "2"}], "+", 
                    RowBox[{"\[Gamma]vv2", "^", "2"}]}], ")"}], "/", 
                  RowBox[{
                   RowBox[{"moment", "[", "\"\<c\>\"", "]"}], "^", "2"}]}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"ff", "=", 
               RowBox[{
                RowBox[{"compileLossCone", "[", 
                 RowBox[{
                 "n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], "]"}],
                 "[", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n", "=", 
               RowBox[{"Total", "[", 
                RowBox[{"ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"nV1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{"\[Gamma]vv1", "/", "\[Gamma]\[Gamma]"}], "*", "ff", 
                 "*", "dV"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v1v1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Gamma]vv1", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v2v2", "=", 
               RowBox[{"Total", "[", 
                RowBox[{".5", 
                 RowBox[{
                  RowBox[{"\[Gamma]vv2", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}], 
               "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", "Listable", "}"}]}], "\[IndentingNewLine]", "]"}], 
         "[", 
         RowBox[{"n0", ",", "\[Theta]2O\[Theta]1", ",", "\[Beta]"}], "]"}], 
        "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"GridLinesStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "nV1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v1v1\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v1v1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v2v2\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v3v3\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[2201]:=",ExpressionUUID->"038e52a0-33c0-409e-bec9-540fa4082ead"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Loss cone - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Beta]", "0"], "=", "0.5"}], TraditionalForm]],
  ExpressionUUID->"0ef200c0-a194-4e4f-a500-597529bcd010"]
}], "Subsubsection",ExpressionUUID->"ad1ee675-19c9-4bb5-87f7-6f5c23dc87fe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom5", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "5"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<n\>\"", ",", "\"\<time\>\"", ",", "\"\<n\[Gamma]cc\>\""}], 
           "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<c\>\""}], "}"}], "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importRelativisticMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom5"}]}], "Input",
 CellLabel->
  "In[2202]:=",ExpressionUUID->"41f2eafb-7911-420f-8c46-2daaf4790f80"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom5"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", ".5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "q1", ",", "\[Xi]\[CapitalDelta]1", ",", "\[Eta]", ",", "\[Eta]\[Beta]",
        ",", "n0", ",", "\[Beta]", ",", "\[Theta]2O\[Theta]1", ",", "n", ",", 
       "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}],
         "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"n0", ",", "\[Theta]2O\[Theta]1", ",", "\[Beta]"}], "}"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "T2OT1", ",", "\[Theta]1", ",", "\[Theta]2", ",", "\[Gamma]v1", 
               ",", "\[Gamma]v2", ",", "dV", ",", "\[Gamma]vv1", ",", 
               "\[Gamma]vv2", ",", "\[Gamma]\[Gamma]", ",", "ff"}], "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"T2OT1", "=", 
               RowBox[{
                RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
                RowBox[{"(", 
                 RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"\[Theta]1", "=", 
               SqrtBox["\[Beta]1"]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Theta]2", "=", 
               RowBox[{
                SqrtBox["\[Beta]1"], "\[Theta]2O\[Theta]1"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v1", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "501", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "5", 
                    "\[Theta]1"}]}], "]"}], ",", "2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v2", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "251", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], "5", "\[Theta]2"}]}], 
                  "]"}], ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"dV", "=", 
               RowBox[{"2", "\[Pi]", " ", "\[Gamma]vv2", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "}"}], "=", 
               RowBox[{"Transpose", "[", 
                RowBox[{"Tuples", "[", 
                 RowBox[{"{", 
                  RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]\[Gamma]", "=", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"1", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[Gamma]vv1", "^", "2"}], "+", 
                    RowBox[{"\[Gamma]vv2", "^", "2"}]}], ")"}], "/", 
                  RowBox[{
                   RowBox[{"moment", "[", "\"\<c\>\"", "]"}], "^", "2"}]}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"ff", "=", 
               RowBox[{
                RowBox[{"compileLossCone", "[", 
                 RowBox[{
                 "n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], "]"}],
                 "[", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n", "=", 
               RowBox[{"Total", "[", 
                RowBox[{"ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"nV1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{"\[Gamma]vv1", "/", "\[Gamma]\[Gamma]"}], "*", "ff", 
                 "*", "dV"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v1v1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Gamma]vv1", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v2v2", "=", 
               RowBox[{"Total", "[", 
                RowBox[{".5", 
                 RowBox[{
                  RowBox[{"\[Gamma]vv2", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}], 
               "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", "Listable", "}"}]}], "\[IndentingNewLine]", "]"}], 
         "[", 
         RowBox[{"n0", ",", "\[Theta]2O\[Theta]1", ",", "\[Beta]"}], "]"}], 
        "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"GridLinesStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "nV1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v1v1\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v1v1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v2v2\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v3v3\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[2204]:=",ExpressionUUID->"14b10031-8666-4e0a-b81f-415a3bbaec35"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Loss cone - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Beta]", "0"], "=", "2.5"}], TraditionalForm]],
  ExpressionUUID->"33e39057-5c44-4293-918f-ba709e4a7fbd"]
}], "Subsubsection",ExpressionUUID->"7cd87267-c2be-498e-ba25-40560d948519"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom6", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "6"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<n\>\"", ",", "\"\<time\>\"", ",", "\"\<n\[Gamma]cc\>\""}], 
           "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<c\>\""}], "}"}], "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importRelativisticMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom6"}]}], "Input",
 CellLabel->
  "In[2205]:=",ExpressionUUID->"2d1e5b20-f65e-4c54-bf3c-9f45d6712df2"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom6"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "2.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "q1", ",", "\[Xi]\[CapitalDelta]1", ",", "\[Eta]", ",", "\[Eta]\[Beta]",
        ",", "n0", ",", "\[Beta]", ",", "\[Theta]2O\[Theta]1", ",", "n", ",", 
       "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}],
         "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"n0", ",", "\[Theta]2O\[Theta]1", ",", "\[Beta]"}], "}"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "T2OT1", ",", "\[Theta]1", ",", "\[Theta]2", ",", "\[Gamma]v1", 
               ",", "\[Gamma]v2", ",", "dV", ",", "\[Gamma]vv1", ",", 
               "\[Gamma]vv2", ",", "\[Gamma]\[Gamma]", ",", "ff"}], "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"T2OT1", "=", 
               RowBox[{
                RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
                RowBox[{"(", 
                 RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"\[Theta]1", "=", 
               SqrtBox["\[Beta]1"]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Theta]2", "=", 
               RowBox[{
                SqrtBox["\[Beta]1"], "\[Theta]2O\[Theta]1"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v1", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "501", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "5", 
                    "\[Theta]1"}]}], "]"}], ",", "2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v2", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "251", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], "5", "\[Theta]2"}]}], 
                  "]"}], ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"dV", "=", 
               RowBox[{"2", "\[Pi]", " ", "\[Gamma]vv2", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "}"}], "=", 
               RowBox[{"Transpose", "[", 
                RowBox[{"Tuples", "[", 
                 RowBox[{"{", 
                  RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]\[Gamma]", "=", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"1", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[Gamma]vv1", "^", "2"}], "+", 
                    RowBox[{"\[Gamma]vv2", "^", "2"}]}], ")"}], "/", 
                  RowBox[{
                   RowBox[{"moment", "[", "\"\<c\>\"", "]"}], "^", "2"}]}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"ff", "=", 
               RowBox[{
                RowBox[{"compileLossCone", "[", 
                 RowBox[{
                 "n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], "]"}],
                 "[", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n", "=", 
               RowBox[{"Total", "[", 
                RowBox[{"ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"nV1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{"\[Gamma]vv1", "/", "\[Gamma]\[Gamma]"}], "*", "ff", 
                 "*", "dV"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v1v1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Gamma]vv1", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v2v2", "=", 
               RowBox[{"Total", "[", 
                RowBox[{".5", 
                 RowBox[{
                  RowBox[{"\[Gamma]vv2", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}], 
               "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", "Listable", "}"}]}], "\[IndentingNewLine]", "]"}], 
         "[", 
         RowBox[{"n0", ",", "\[Theta]2O\[Theta]1", ",", "\[Beta]"}], "]"}], 
        "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"GridLinesStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "nV1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v1v1\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v1v1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v2v2\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v3v3\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[2207]:=",ExpressionUUID->"1ccfe769-e751-49bc-8e9f-d98fcd25736c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Partial shell - Maxwellian", "Subsubsection",ExpressionUUID->"cdd4ca52-a017-4c36-baf5-a99f5ad778e9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom7", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "7"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<n\>\"", ",", "\"\<time\>\"", ",", "\"\<n\[Gamma]cc\>\""}], 
           "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<c\>\""}], "}"}], "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importRelativisticMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom7"}]}], "Input",
 CellLabel->
  "In[2208]:=",ExpressionUUID->"de35aae0-eafc-400a-b227-8ce129d0917a"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom7"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]", "=", "1.5"}], ",", 
     RowBox[{"\[Zeta]", "=", "0"}], ",", 
     RowBox[{"vs", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "q1", ",", "\[Xi]\[CapitalDelta]1", ",", "\[Eta]", ",", "n0", ",", "n", 
       ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}],
         "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", "n0", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\[Theta]", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "dV", 
               ",", "\[Gamma]vv1", ",", "\[Gamma]vv2", ",", 
               "\[Gamma]\[Gamma]", ",", "ff"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\[Theta]", "=", 
               SqrtBox["\[Beta]"]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v1", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "501", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", "\[Theta]"}], "+", "vs"}], ")"}]}]}], "]"}], 
                 ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v2", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "251", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", "\[Theta]"}], "+", "vs"}], ")"}]}]}], "]"}], 
                 ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"dV", "=", 
               RowBox[{"2", "\[Pi]", " ", "\[Gamma]vv2", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "}"}], "=", 
               RowBox[{"Transpose", "[", 
                RowBox[{"Tuples", "[", 
                 RowBox[{"{", 
                  RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]\[Gamma]", "=", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"1", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[Gamma]vv1", "^", "2"}], "+", 
                    RowBox[{"\[Gamma]vv2", "^", "2"}]}], ")"}], "/", 
                  RowBox[{
                   RowBox[{"moment", "[", "\"\<c\>\"", "]"}], "^", "2"}]}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"ff", "=", 
               RowBox[{
                RowBox[{"compilePartialShell", "[", 
                 RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], 
                 "]"}], "[", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n", "=", 
               RowBox[{"Total", "[", 
                RowBox[{"ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"nV1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{"\[Gamma]vv1", "/", "\[Gamma]\[Gamma]"}], "*", "ff", 
                 "*", "dV"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v1v1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Gamma]vv1", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v2v2", "=", 
               RowBox[{"Total", "[", 
                RowBox[{".5", 
                 RowBox[{
                  RowBox[{"\[Gamma]vv2", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}], 
               "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", "Listable", "}"}]}], "\[IndentingNewLine]", "]"}], 
         "[", "n0", "]"}], "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"GridLinesStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "nV1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v1v1\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v1v1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v2v2\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v3v3\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[2210]:=",ExpressionUUID->"27492e21-50be-40ed-bf2b-11a024f3cacc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Isotropic shell", "Subsubsection",ExpressionUUID->"f3408f53-1470-4fbc-a420-68ab9b513b5d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom8", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "8"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<n\>\"", ",", "\"\<time\>\"", ",", "\"\<n\[Gamma]cc\>\""}], 
           "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<c\>\""}], "}"}], "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importRelativisticMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom8"}]}], "Input",
 CellLabel->
  "In[2211]:=",ExpressionUUID->"71fc302a-b01c-45b9-93e2-2a89905e0be5"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom8"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "0"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "q1", ",", "\[Xi]\[CapitalDelta]1", ",", "\[Eta]", ",", "n0", ",", "n", 
       ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}],
         "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", "n0", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\[Theta]", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "dV", 
               ",", "\[Gamma]vv1", ",", "\[Gamma]vv2", ",", 
               "\[Gamma]\[Gamma]", ",", "ff"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\[Theta]", "=", 
               SqrtBox["\[Beta]"]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v1", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "501", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", "\[Theta]"}], "+", "vs"}], ")"}]}]}], "]"}], 
                 ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v2", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "251", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", "\[Theta]"}], "+", "vs"}], ")"}]}]}], "]"}], 
                 ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"dV", "=", 
               RowBox[{"2", "\[Pi]", " ", "\[Gamma]vv2", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "}"}], "=", 
               RowBox[{"Transpose", "[", 
                RowBox[{"Tuples", "[", 
                 RowBox[{"{", 
                  RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]\[Gamma]", "=", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"1", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[Gamma]vv1", "^", "2"}], "+", 
                    RowBox[{"\[Gamma]vv2", "^", "2"}]}], ")"}], "/", 
                  RowBox[{
                   RowBox[{"moment", "[", "\"\<c\>\"", "]"}], "^", "2"}]}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"ff", "=", 
               RowBox[{
                RowBox[{"compilePartialShell", "[", 
                 RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], 
                 "]"}], "[", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n", "=", 
               RowBox[{"Total", "[", 
                RowBox[{"ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"nV1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{"\[Gamma]vv1", "/", "\[Gamma]\[Gamma]"}], "*", "ff", 
                 "*", "dV"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v1v1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Gamma]vv1", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v2v2", "=", 
               RowBox[{"Total", "[", 
                RowBox[{".5", 
                 RowBox[{
                  RowBox[{"\[Gamma]vv2", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}], 
               "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", "Listable", "}"}]}], "\[IndentingNewLine]", "]"}], 
         "[", "n0", "]"}], "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"GridLinesStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "nV1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v1v1\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v1v1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v2v2\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v3v3\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[2213]:=",ExpressionUUID->"59d5142a-c332-4c58-b59f-5208172f2c85"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Partial shell - ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Zeta]", "=", "1"}], TraditionalForm]],ExpressionUUID->
  "563f15d3-6ca1-4e67-bab9-cf62c270509d"]
}], "Subsubsection",ExpressionUUID->"87b5b180-6800-464c-8cf9-86e78965ba97"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom9", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "9"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<n\>\"", ",", "\"\<time\>\"", ",", "\"\<n\[Gamma]cc\>\""}], 
           "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<c\>\""}], "}"}], "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importRelativisticMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom9"}]}], "Input",
 CellLabel->
  "In[2214]:=",ExpressionUUID->"0651bc90-a8fe-4302-9e6b-b8c5fb92bc8b"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom9"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "1"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "q1", ",", "\[Xi]\[CapitalDelta]1", ",", "\[Eta]", ",", "n0", ",", "n", 
       ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}],
         "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", "n0", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\[Theta]", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "dV", 
               ",", "\[Gamma]vv1", ",", "\[Gamma]vv2", ",", 
               "\[Gamma]\[Gamma]", ",", "ff"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\[Theta]", "=", 
               SqrtBox["\[Beta]"]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v1", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "501", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", "\[Theta]"}], "+", "vs"}], ")"}]}]}], "]"}], 
                 ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v2", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "251", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", "\[Theta]"}], "+", "vs"}], ")"}]}]}], "]"}], 
                 ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"dV", "=", 
               RowBox[{"2", "\[Pi]", " ", "\[Gamma]vv2", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "}"}], "=", 
               RowBox[{"Transpose", "[", 
                RowBox[{"Tuples", "[", 
                 RowBox[{"{", 
                  RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]\[Gamma]", "=", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"1", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[Gamma]vv1", "^", "2"}], "+", 
                    RowBox[{"\[Gamma]vv2", "^", "2"}]}], ")"}], "/", 
                  RowBox[{
                   RowBox[{"moment", "[", "\"\<c\>\"", "]"}], "^", "2"}]}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"ff", "=", 
               RowBox[{
                RowBox[{"compilePartialShell", "[", 
                 RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], 
                 "]"}], "[", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n", "=", 
               RowBox[{"Total", "[", 
                RowBox[{"ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"nV1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{"\[Gamma]vv1", "/", "\[Gamma]\[Gamma]"}], "*", "ff", 
                 "*", "dV"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v1v1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Gamma]vv1", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v2v2", "=", 
               RowBox[{"Total", "[", 
                RowBox[{".5", 
                 RowBox[{
                  RowBox[{"\[Gamma]vv2", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}], 
               "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", "Listable", "}"}]}], "\[IndentingNewLine]", "]"}], 
         "[", "n0", "]"}], "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"GridLinesStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "nV1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v1v1\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v1v1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v2v2\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v3v3\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[2216]:=",ExpressionUUID->"d5c8ecb4-20ff-4027-adf6-3fad8e47a77d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Partial shell - ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Zeta]", "=", "5"}], TraditionalForm]],ExpressionUUID->
  "774ef169-0ebb-4aac-a979-e4ad8d8a2120"]
}], "Subsubsection",ExpressionUUID->"1fea2f03-a1cd-4796-bf70-0006266d721b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom10", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "10"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<n\>\"", ",", "\"\<time\>\"", ",", "\"\<n\[Gamma]cc\>\""}], 
           "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<c\>\""}], "}"}], "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importRelativisticMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom10"}]}], "Input",
 CellLabel->
  "In[2217]:=",ExpressionUUID->"9cb50e31-8afc-41da-bfe8-4e823fae8b12"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom10"}], ",", 
     RowBox[{"n0eq", "=", "0.01"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "5"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "q1", ",", "\[Xi]\[CapitalDelta]1", ",", "\[Eta]", ",", "n0", ",", "n", 
       ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"q1", "=", 
       RowBox[{"moment", "[", "\"\<q1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"moment", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"moment", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}],
         "}"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", "n0", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\[Theta]", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "dV", 
               ",", "\[Gamma]vv1", ",", "\[Gamma]vv2", ",", 
               "\[Gamma]\[Gamma]", ",", "ff"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\[Theta]", "=", 
               SqrtBox["\[Beta]"]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v1", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "501", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", "\[Theta]"}], "+", "vs"}], ")"}]}]}], "]"}], 
                 ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]v2", "=", 
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"Array", "[", 
                  RowBox[{"N", ",", "251", ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", "\[Theta]"}], "+", "vs"}], ")"}]}]}], "]"}], 
                 ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"dV", "=", 
               RowBox[{"2", "\[Pi]", " ", "\[Gamma]vv2", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "}"}], "=", 
               RowBox[{"Transpose", "[", 
                RowBox[{"Tuples", "[", 
                 RowBox[{"{", 
                  RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"\[Gamma]\[Gamma]", "=", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"1", "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"\[Gamma]vv1", "^", "2"}], "+", 
                    RowBox[{"\[Gamma]vv2", "^", "2"}]}], ")"}], "/", 
                  RowBox[{
                   RowBox[{"moment", "[", "\"\<c\>\"", "]"}], "^", "2"}]}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"ff", "=", 
               RowBox[{
                RowBox[{"compilePartialShell", "[", 
                 RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], 
                 "]"}], "[", 
                RowBox[{"\[Gamma]vv1", ",", "\[Gamma]vv2"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n", "=", 
               RowBox[{"Total", "[", 
                RowBox[{"ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"nV1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{"\[Gamma]vv1", "/", "\[Gamma]\[Gamma]"}], "*", "ff", 
                 "*", "dV"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v1v1", "=", 
               RowBox[{"Total", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Gamma]vv1", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"n\[Gamma]v2v2", "=", 
               RowBox[{"Total", "[", 
                RowBox[{".5", 
                 RowBox[{
                  RowBox[{"\[Gamma]vv2", "^", "2"}], "/", 
                  "\[Gamma]\[Gamma]"}], "*", "ff", "*", "dV"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
               "n", ",", "nV1", ",", "n\[Gamma]v1v1", ",", "n\[Gamma]v2v2"}], 
               "}"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", "Listable", "}"}]}], "\[IndentingNewLine]", "]"}], 
         "[", "n0", "]"}], "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"PlotRange", "->", "All"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
                RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
             RowBox[{"GridLinesStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "nV1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"GridLinesStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
              "Dashed"}], "]"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v1v1\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v1v1"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v2v2\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
                 "]"}], 
                RowBox[{"moment", "[", "\"\<n\[Gamma]v3v3\>\"", "]"}]}], 
               ")"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "n\[Gamma]v2v2"}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
                "Dashed"}], "]"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[2219]:=",ExpressionUUID->"d72e11f1-2040-4412-b40c-c71a6461c58a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cold fluid", "Subsubsection",ExpressionUUID->"4edb9e72-6721-4b18-870b-ec377a2f788e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mom11", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "11"}], ",", 
       RowBox[{"files", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dsets", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<n\>\"", ",", "\"\<time\>\"", ",", "\"\<n\[Gamma]cc\>\""}], 
           "}"}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<nV\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<c\>\""}], "}"}], "]"}]}], ",", 
          RowBox[{"StringJoin", "/@", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
              "\"\<v\>\"", ",", 
              RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
            "]"}]}]}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"1", "<=", "spid", "<=", 
         RowBox[{"attr", "[", "\"\<Ns\>\"", "]"}]}], ",", "Null", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<invalid spid\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q1", ",", "assoc"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q1", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", 
             RowBox[{
              RowBox[{"attr", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
             RowBox[{"attr", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
            "]"}], "//", "Most"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"assoc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"importRelativisticMoment", "[", 
             RowBox[{"#", ",", "spid"}], "]"}], "&"}], "/@", "files"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"KeyDrop", "[", 
              RowBox[{
               RowBox[{"assoc", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "dsets"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<q1\>\"", "->", "q1"}], "}"}], ",", 
             RowBox[{"Chop", "/@", 
              RowBox[{"Merge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KeyTake", "[", "dsets", "]"}], "/@", "assoc"}], ",",
                 "Identity"}], "]"}]}]}], "}"}], ",", "Last"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "mom11"}]}], "Input",
 CellLabel->
  "In[2220]:=",ExpressionUUID->"7c8ef4d8-98c9-4077-8302-179b47115928"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"moment", "=", "mom11"}], ",", 
     RowBox[{"n0", "=", "0.01"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"T1", ",", "T2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"T1", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ImageSize", "->", "Medium"}], ",", 
          RowBox[{"GridLinesStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"Opacity", "[", "1", "]"}], ",", 
             RowBox[{"Thickness", "[", "Large", "]"}], ",", "Red", ",", 
             "Dashed"}], "]"}]}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
               "]"}], 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "n0", "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV1\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV2\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"moment", "[", "\"\<nV3\>\"", "]"}], "/", 
              RowBox[{"moment", "[", "\"\<n\>\"", "]"}]}], ")"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
               "]"}], 
              RowBox[{"moment", "[", "\"\<n\[Gamma]v1v1\>\"", "]"}]}], 
             ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"n0", 
               RowBox[{"{", "T1", "}"}]}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
               "]"}], 
              RowBox[{"moment", "[", "\"\<n\[Gamma]v2v2\>\"", "]"}]}], 
             ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"n0", 
               RowBox[{"{", "T2", "}"}]}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"moment", "[", "\"\<q1\>\"", "]"}], ",", "#"}], "}"}],
               "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "moment", "[", "\"\<energy_density_conversion_factor\>\"", 
               "]"}], 
              RowBox[{"moment", "[", "\"\<n\[Gamma]v3v3\>\"", "]"}]}], 
             ")"}]}], ",", 
           RowBox[{"GridLines", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"n0", 
               RowBox[{"{", "T2", "}"}]}]}], "}"}]}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
        "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[2222]:=",ExpressionUUID->"90c718fe-3a88-4069-a272-25467d8b4830"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["VHist", "Subsection",ExpressionUUID->"997996cf-89a4-4991-8ffc-c230229c881f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"metadata", "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"files", "=", 
        RowBox[{"FileNames", "[", 
         RowBox[{"\"\<gvhist2d-*.h5\>\"", ",", "wd"}], "]"}]}], ",", "names", 
       ",", "attrs", ",", "steps", ",", "times", ",", "pos"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"attrs", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<HDF5\>\"", ",", "\"\<Attributes\>\"", ",", 
             "\"\</gvhist2d\>\""}], "}"}]}], "]"}], "&"}], "/@", "files"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{
        RowBox[{"Lookup", "[", "\"\<step\>\"", "]"}], "/@", "attrs"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"times", "=", 
       RowBox[{
        RowBox[{"Lookup", "[", "\"\<time\>\"", "]"}], "/@", "attrs"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"List", "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "times", "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"First", "/@", 
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"pos", ",", "times"}], "}"}], "]"}], ",", "Last"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"steps", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"times", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"times", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"files", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"files", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Association", "[", 
       RowBox[{
        RowBox[{"\"\<attr\>\"", "->", 
         RowBox[{"KeyDrop", "[", 
          RowBox[{
           RowBox[{"First", "[", "attrs", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<step\>\"", ",", "\"\<time\>\""}], "}"}]}], "]"}]}], 
        ",", 
        RowBox[{"\"\<step\>\"", "->", "steps"}], ",", 
        RowBox[{"\"\<time\>\"", "->", "times"}], ",", 
        RowBox[{"\"\<files\>\"", "->", "files"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[2223]:=",ExpressionUUID->"e117c764-e5f8-418c-a297-5adadaec257b"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compileBiMaxwellian", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compileBiMaxwellian", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]1_", "?", "Positive"}], ",", 
    RowBox[{"T2OT1_", "?", "Positive"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]1", "=", 
       SqrtBox[
        RowBox[{"N", "[", "\[Beta]1", "]"}]]}], ",", 
      RowBox[{"\[Theta]2", "=", 
       SqrtBox[
        RowBox[{
         RowBox[{"N", "[", "\[Beta]1", "]"}], "T2OT1"}]]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"n", " ", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"v1", "^", "2"}]}], "/", 
            RowBox[{"\[Theta]1", "^", "2"}]}], "-", 
           RowBox[{
            RowBox[{"v2", "^", "2"}], "/", 
            RowBox[{"\[Theta]2", "^", "2"}]}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"Pi", "^", "1.5"}], " ", "\[Theta]1", " ", 
          RowBox[{"\[Theta]2", "^", "2"}]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[2224]:=",ExpressionUUID->"5909326c-1855-4206-8845-a65d02876914"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compileLossCone", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compileLossCone", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]1_", "?", "Positive"}], ",", 
    RowBox[{"T2OT1_", "?", "Positive"}], ",", 
    RowBox[{"\[Beta]_Real", "?", "Positive"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]1", "=", 
       SqrtBox[
        RowBox[{"N", "[", "\[Beta]1", "]"}]]}], ",", 
      RowBox[{"\[Theta]2", "=", 
       SqrtBox[
        RowBox[{
         RowBox[{"N", "[", "\[Beta]1", "]"}], 
         RowBox[{"T2OT1", "/", 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}]]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Beta]"}], ")"}]}], 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"v1", "^", "2"}]}], "/", 
            RowBox[{"\[Theta]1", "^", "2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"v2", "^", "2"}]}], "/", 
              RowBox[{"\[Theta]2", "^", "2"}]}], "]"}], "-", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"v2", "^", "2"}]}], "/", 
               RowBox[{"\[Theta]2", "^", "2"}]}], "/", "\[Beta]"}], "]"}]}], 
           ")"}]}], ",", 
         RowBox[{
          RowBox[{"Pi", "^", "1.5"}], " ", "\[Theta]1", " ", 
          RowBox[{"\[Theta]2", "^", "2"}]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[2226]:=",ExpressionUUID->"4db05d20-a675-4dc3-9bda-2ee9c09c5366"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compilePartialShell", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compilePartialShell", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]_", "?", "Positive"}], ",", 
    RowBox[{"\[Zeta]_Integer", "?", "NonNegative"}], ",", 
    RowBox[{"vs_", "?", "NonNegative"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]", "=", 
       RowBox[{"N", "[", 
        SqrtBox["\[Beta]"], "]"}]}], ",", 
      RowBox[{"xs", "=", 
       RowBox[{"N", "[", 
        RowBox[{"vs", "/", 
         SqrtBox["\[Beta]"]}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{".5", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"vs", "/", 
            SqrtBox["\[Beta]"]}], 
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"vs", "/", 
                SqrtBox["\[Beta]"]}], ")"}], "^", "2"}]}], "]"}]}], "+", 
          RowBox[{
           SqrtBox["\[Pi]"], 
           RowBox[{"(", 
            RowBox[{".5", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"vs", "/", 
                SqrtBox["\[Beta]"]}], ")"}], "^", "2"}]}], ")"}], 
           RowBox[{"Erfc", "[", 
            RowBox[{
             RowBox[{"-", "vs"}], "/", 
             SqrtBox["\[Beta]"]}], "]"}]}]}], ")"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"B\[Zeta]", "=", 
       RowBox[{
        SqrtBox["\[Pi]"], 
        RowBox[{
         RowBox[{"Gamma", "[", 
          RowBox[{"1", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}], "/", 
         RowBox[{"Gamma", "[", 
          RowBox[{"1.5", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "x1", ",", "x2", ",", "\[Mu]"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x2", "=", 
          RowBox[{"v2", "/", "\[Theta]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x1", "=", 
          RowBox[{"v1", "/", "\[Theta]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x", "=", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"x1", "^", "2"}], "+", 
            RowBox[{"x2", "^", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Mu]", "=", 
          RowBox[{"x1", "/", "x"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"n", " ", 
          RowBox[{"Divide", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"x", "-", "xs"}], ")"}], "^", "2"}]}], "]"}], 
             RowBox[{"Power", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "\[Mu]"}], ")"}], 
                RowBox[{"(", 
                 RowBox[{"1", "+", "\[Mu]"}], ")"}]}], ",", 
               RowBox[{".5", "\[Zeta]"}]}], "]"}]}], ",", 
            RowBox[{"2", "Pi", " ", 
             RowBox[{"\[Theta]", "^", "3"}], "Ab", " ", "B\[Zeta]"}]}], 
           "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[2228]:=",ExpressionUUID->"a7859a12-107c-4fbe-a4d6-d12004caf481"],

Cell[CellGroupData[{

Cell["Maxwellian", "Subsubsection",ExpressionUUID->"d10d8033-a66b-4393-a8cb-670cd72e5548"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist1", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "1"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importRelativisticVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist1"}]}], "Input",
 CellLabel->
  "In[2230]:=",ExpressionUUID->"da645338-f2a4-446c-be72-74ca60f5b244"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist1"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"T2OT1eq", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "fhist", ",", "ghist", 
       ",", "whist", ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", 
       "T2OT1", ",", "\[Gamma]vv12", ",", "ff", ",", "gg", ",", "plots"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{"T2OT1eq", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "T2OT1eq"}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{"T2OT1eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileBiMaxwellian", "[", 
          RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1"}], "]"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "\[Eta]", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileBiMaxwellian", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1"}], "]"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "\[Eta]", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[2232]:=",ExpressionUUID->"606d39b8-87cc-4bd9-bf59-67236fd16194"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bi-Maxwellian", "Subsubsection",ExpressionUUID->"13a4823e-ac7d-411a-bfa7-214b68eed661"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist2", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "2"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importRelativisticVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist2"}]}], "Input",
 CellLabel->
  "In[2233]:=",ExpressionUUID->"358286e0-1852-4590-bd31-ee0d264e6157"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist2"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"T2OT1eq", "=", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "fhist", ",", "ghist", 
       ",", "whist", ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", 
       "T2OT1", ",", "\[Gamma]vv12", ",", "ff", ",", "gg", ",", "plots"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{"T2OT1eq", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "T2OT1eq"}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{"T2OT1eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileBiMaxwellian", "[", 
          RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1"}], "]"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "\[Eta]", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileBiMaxwellian", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1"}], "]"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "\[Eta]", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[2235]:=",ExpressionUUID->"97722b2b-dd5e-4845-8646-8dea8c604bff"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Loss cone - Maxwellian", "Subsubsection",ExpressionUUID->"8b5a1d8f-2e7e-4610-8804-00cc69919962"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist3", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "3"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importRelativisticVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist3"}]}], "Input",
 CellLabel->
  "In[2236]:=",ExpressionUUID->"059c1c8d-d9c0-4514-804f-f6e54b939747"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist3"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["1"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "1.0*^-10"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "fhist", ",", "ghist", 
       ",", "whist", ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", 
       "\[Eta]\[Beta]", ",", "n0", ",", "\[Beta]", ",", "\[Theta]2O\[Theta]1",
        ",", "T2OT1", ",", "\[Gamma]vv12", ",", "ff", ",", "gg", ",", 
       "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileLossCone", "[", 
          RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], 
          "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileLossCone", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1", ",", "\[Beta]"}], 
          "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[2238]:=",ExpressionUUID->"e34fa43a-618f-455f-abf5-fcaadfe905ac"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Loss cone - Bi-Maxwellian", "Subsubsection",ExpressionUUID->"f3a0152c-b4bf-4104-9df7-9825b312236c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist4", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "4"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importRelativisticVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist4"}]}], "Input",
 CellLabel->
  "In[2239]:=",ExpressionUUID->"0cdaf02d-030b-47ff-abd9-b2d8e5aaf998"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist4"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "1.0*^-10"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "fhist", ",", "ghist", 
       ",", "whist", ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", 
       "\[Eta]\[Beta]", ",", "n0", ",", "\[Beta]", ",", "\[Theta]2O\[Theta]1",
        ",", "T2OT1", ",", "\[Gamma]vv12", ",", "ff", ",", "gg", ",", 
       "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileLossCone", "[", 
          RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], 
          "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileLossCone", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1", ",", "\[Beta]"}], 
          "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[2241]:=",ExpressionUUID->"242c22bf-a27a-41e0-a95b-faf19f90b67e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Loss cone - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Beta]", "eq"], "=", "0.5"}], TraditionalForm]],
  ExpressionUUID->"2a856998-27f3-4145-a59f-d33452dffbb5"]
}], "Subsubsection",ExpressionUUID->"2d584d4e-aca4-40ea-abb1-5febd213865b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist5", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "5"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importRelativisticVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist5"}]}], "Input",
 CellLabel->
  "In[2242]:=",ExpressionUUID->"f1930530-5934-4184-9bec-ac38bded1c6c"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist5"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "0.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "fhist", ",", "ghist", 
       ",", "whist", ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", 
       "\[Eta]\[Beta]", ",", "n0", ",", "\[Beta]", ",", "\[Theta]2O\[Theta]1",
        ",", "T2OT1", ",", "\[Gamma]vv12", ",", "ff", ",", "gg", ",", 
       "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileLossCone", "[", 
          RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], 
          "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileLossCone", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1", ",", "\[Beta]"}], 
          "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[2244]:=",ExpressionUUID->"419f4ebb-de08-4a93-b9a7-0272ae5b2cb8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Loss cone - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Beta]", "eq"], "=", "2.5"}], TraditionalForm]],
  ExpressionUUID->"0ee8da94-321d-4e20-bbd3-b50b98ad3695"]
}], "Subsubsection",ExpressionUUID->"85c5e31b-54d9-48e7-af2e-c40d4f1a2cc6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist6", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "6"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importRelativisticVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist6"}]}], "Input",
 CellLabel->
  "In[2245]:=",ExpressionUUID->"e82cfc9c-d286-4a5c-955d-f0bd54ee0e6c"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist6"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "2.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "fhist", ",", "ghist", 
       ",", "whist", ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", 
       "\[Eta]\[Beta]", ",", "n0", ",", "\[Beta]", ",", "\[Theta]2O\[Theta]1",
        ",", "T2OT1", ",", "\[Gamma]vv12", ",", "ff", ",", "gg", ",", 
       "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileLossCone", "[", 
          RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], 
          "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compileLossCone", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1", ",", "\[Beta]"}], 
          "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[2247]:=",ExpressionUUID->"6db91dd7-71ec-4fd0-9c0d-ba5b3012ab76"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Partial shell - Maxwellian", "Subsubsection",ExpressionUUID->"013a1f16-e084-4c3e-ac42-d68210c8e57a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist7", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "7"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importRelativisticVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist7"}]}], "Input",
 CellLabel->
  "In[2248]:=",ExpressionUUID->"2b8c8682-69fd-4f94-b209-1831d67f21a1"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist7"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "1.5"}], ",", 
     RowBox[{"\[Zeta]", "=", "0"}], ",", 
     RowBox[{"vs", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "fhist", ",", "ghist", 
       ",", "whist", ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", 
       "\[Gamma]vv12", ",", "ff", ",", "gg", ",", "plots"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compilePartialShell", "[", 
          RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compilePartialShell", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]", " ", "gT"}], ",", "\[Zeta]", ",", "vs"}], "]"}],
          "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[2250]:=",ExpressionUUID->"7f4489aa-8ade-4596-8d9c-4d0058bff819"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Isotropic shell", "Subsubsection",ExpressionUUID->"87264bae-dad2-40bc-9bd6-4728ef9f88c4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist8", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "8"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importRelativisticVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist8"}]}], "Input",
 CellLabel->
  "In[2251]:=",ExpressionUUID->"252b1fc0-447a-4871-a3db-3122b47c9d02"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist8"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "0"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "fhist", ",", "ghist", 
       ",", "whist", ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", 
       "\[Gamma]vv12", ",", "ff", ",", "gg", ",", "plots"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compilePartialShell", "[", 
          RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compilePartialShell", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]", " ", "gT"}], ",", "\[Zeta]", ",", "vs"}], "]"}],
          "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[2253]:=",ExpressionUUID->"b19411bf-c796-49d0-b788-065d98d88ebb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Partial shell - ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Zeta]", "=", "1"}], TraditionalForm]],ExpressionUUID->
  "3a7997b3-d3dc-4e4b-b522-622110e6a3d2"]
}], "Subsubsection",ExpressionUUID->"bf57786b-be3a-4b32-b539-b4ebb0366f3d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist9", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "9"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importRelativisticVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist9"}]}], "Input",
 CellLabel->
  "In[2254]:=",ExpressionUUID->"35cf0d2d-ef01-4ee4-afad-a6ac1acbabb9"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist9"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "1"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "fhist", ",", "ghist", 
       ",", "whist", ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", 
       "\[Gamma]vv12", ",", "ff", ",", "gg", ",", "plots"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compilePartialShell", "[", 
          RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compilePartialShell", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]", " ", "gT"}], ",", "\[Zeta]", ",", "vs"}], "]"}],
          "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[2256]:=",ExpressionUUID->"be0a0374-2f78-40af-852a-464d3ea2cd98"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Partial shell - ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Zeta]", "=", "5"}], TraditionalForm]],ExpressionUUID->
  "6d9b073b-4fa6-426e-ad6c-6908631dfe60"]
}], "Subsubsection",ExpressionUUID->"691309da-dc5e-453b-b371-b7d84af6b73c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vhist10", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "10"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"attr", ",", 
         RowBox[{"importRelativisticVHistogram", "[", 
          RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "vhist10"}]}], "Input",
 CellLabel->
  "In[2257]:=",ExpressionUUID->"9587ba05-32d4-4d37-a75c-ba7c5bfe1872"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "vhist10"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "5"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "fhist", ",", "ghist", 
       ",", "whist", ",", "fpsd", ",", "gpsd", ",", "wpsd", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", 
       "\[Gamma]vv12", ",", "ff", ",", "gg", ",", "plots"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fhist", "=", 
       RowBox[{"vhist", "[", "\"\<fhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ghist", "=", 
       RowBox[{"vhist", "[", "\"\<vhist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"whist", "=", 
       RowBox[{"vhist", "[", "\"\<whist\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fpsd", "=", 
       RowBox[{"vhist", "[", "\"\<fpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gpsd", "=", 
       RowBox[{"vhist", "[", "\"\<vpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wpsd", "=", 
       RowBox[{"vhist", "[", "\"\<wpsd\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Most", "@", 
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", 
          RowBox[{
           RowBox[{"vhist", "[", "\"\<Nx\>\"", "]"}], "+", "1"}], ",", 
          RowBox[{"vhist", "[", "\"\<half_grid_domain_extent\>\"", "]"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compilePartialShell", "[", 
          RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{
        RowBox[{"Total", "[", "ff", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"f", ",", 
          RowBox[{"ArrayReshape", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"f", ",", 
              RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
            RowBox[{"Length", "/@", 
             RowBox[{"{", 
              RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], 
         "]"}], "/@", 
        RowBox[{"Thread", "[", 
         RowBox[{"compilePartialShell", "[", 
          RowBox[{"n0", ",", 
           RowBox[{"\[Beta]", " ", "gT"}], ",", "\[Zeta]", ",", "vs"}], "]"}],
          "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{
        RowBox[{"Total", "[", "gg", "]"}], "/", 
        RowBox[{"Total", "[", "n0", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", "histogram", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fhist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ghist", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "fhist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "ghist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Total", ",", "whist"}], "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "fhist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "ghist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{
                    RowBox[{"Total", "[", "whist", "]"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", "\[Gamma]v2", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", "PSD", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"gpsd", "\[Transpose]"}], "//", "Reverse"}], ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "fpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gpsd"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "wpsd"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"fpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"wpsd", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"2", "\[Pi]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}]}], 
                   "}"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[2259]:=",ExpressionUUID->"c81072ea-4274-4e6d-8d0d-ec69e8bbfab8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Particle", "Subsection",ExpressionUUID->"023b24a9-16b6-4fb7-b2e9-c6cf3a306a33"],

Cell[BoxData[
 RowBox[{
  RowBox[{"metadata", "=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"files", "=", 
        RowBox[{"FileNames", "[", 
         RowBox[{"\"\<particle-*.h5\>\"", ",", "wd"}], "]"}]}], ",", "names", 
       ",", "attrs", ",", "steps", ",", "times", ",", "pos"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"attrs", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<HDF5\>\"", ",", "\"\<Attributes\>\"", ",", 
             "\"\</particle\>\""}], "}"}]}], "]"}], "&"}], "/@", "files"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{
        RowBox[{"Lookup", "[", "\"\<step\>\"", "]"}], "/@", "attrs"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"times", "=", 
       RowBox[{
        RowBox[{"Lookup", "[", "\"\<time\>\"", "]"}], "/@", "attrs"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"List", "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "times", "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"First", "/@", 
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{"pos", ",", "times"}], "}"}], "]"}], ",", "Last"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"steps", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"steps", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"times", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"times", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"files", "=", 
       RowBox[{"Extract", "[", 
        RowBox[{"files", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Association", "[", 
       RowBox[{
        RowBox[{"\"\<attr\>\"", "->", 
         RowBox[{"KeyDrop", "[", 
          RowBox[{
           RowBox[{"First", "[", "attrs", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<step\>\"", ",", "\"\<time\>\""}], "}"}]}], "]"}]}], 
        ",", 
        RowBox[{"\"\<step\>\"", "->", "steps"}], ",", 
        RowBox[{"\"\<time\>\"", "->", "times"}], ",", 
        RowBox[{"\"\<files\>\"", "->", "files"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[2260]:=",ExpressionUUID->"468f27fd-8a91-44f3-9254-2d6c5d26f5ce"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compileBiMaxwellian", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compileBiMaxwellian", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]1_", "?", "Positive"}], ",", 
    RowBox[{"T2OT1_", "?", "Positive"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]1", "=", 
       SqrtBox[
        RowBox[{"N", "[", "\[Beta]1", "]"}]]}], ",", 
      RowBox[{"\[Theta]2", "=", 
       SqrtBox[
        RowBox[{
         RowBox[{"N", "[", "\[Beta]1", "]"}], "T2OT1"}]]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"n", " ", 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"v1", "^", "2"}]}], "/", 
            RowBox[{"\[Theta]1", "^", "2"}]}], "-", 
           RowBox[{
            RowBox[{"v2", "^", "2"}], "/", 
            RowBox[{"\[Theta]2", "^", "2"}]}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"Pi", "^", "1.5"}], " ", "\[Theta]1", " ", 
          RowBox[{"\[Theta]2", "^", "2"}]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[2261]:=",ExpressionUUID->"b110facb-79d2-47de-8a1f-dc5092cfec2b"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compileLossCone", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compileLossCone", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]1_", "?", "Positive"}], ",", 
    RowBox[{"T2OT1_", "?", "Positive"}], ",", 
    RowBox[{"\[Beta]_Real", "?", "Positive"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Theta]1", "=", 
       SqrtBox[
        RowBox[{"N", "[", "\[Beta]1", "]"}]]}], ",", 
      RowBox[{"\[Theta]2", "=", 
       SqrtBox[
        RowBox[{
         RowBox[{"N", "[", "\[Beta]1", "]"}], 
         RowBox[{"T2OT1", "/", 
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}]]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Beta]"}], ")"}]}], 
       RowBox[{"Divide", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"v1", "^", "2"}]}], "/", 
            RowBox[{"\[Theta]1", "^", "2"}]}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"v2", "^", "2"}]}], "/", 
              RowBox[{"\[Theta]2", "^", "2"}]}], "]"}], "-", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"v2", "^", "2"}]}], "/", 
               RowBox[{"\[Theta]2", "^", "2"}]}], "/", "\[Beta]"}], "]"}]}], 
           ")"}]}], ",", 
         RowBox[{
          RowBox[{"Pi", "^", "1.5"}], " ", "\[Theta]1", " ", 
          RowBox[{"\[Theta]2", "^", "2"}]}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[2263]:=",ExpressionUUID->"7ca9c11b-346c-4d01-8ead-6ea875f5a953"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compilePartialShell", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compilePartialShell", "[", 
   RowBox[{"n_Real", ",", 
    RowBox[{"\[Beta]_", "?", "Positive"}], ",", 
    RowBox[{"\[Zeta]_Integer", "?", "NonNegative"}], ",", 
    RowBox[{"vs_", "?", "NonNegative"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]", "=", 
       RowBox[{"N", "[", 
        SqrtBox["\[Beta]"], "]"}]}], ",", 
      RowBox[{"xs", "=", 
       RowBox[{"N", "[", 
        RowBox[{"vs", "/", 
         SqrtBox["\[Beta]"]}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Ab", "=", 
       RowBox[{".5", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"vs", "/", 
            SqrtBox["\[Beta]"]}], 
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"vs", "/", 
                SqrtBox["\[Beta]"]}], ")"}], "^", "2"}]}], "]"}]}], "+", 
          RowBox[{
           SqrtBox["\[Pi]"], 
           RowBox[{"(", 
            RowBox[{".5", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"vs", "/", 
                SqrtBox["\[Beta]"]}], ")"}], "^", "2"}]}], ")"}], 
           RowBox[{"Erfc", "[", 
            RowBox[{
             RowBox[{"-", "vs"}], "/", 
             SqrtBox["\[Beta]"]}], "]"}]}]}], ")"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"B\[Zeta]", "=", 
       RowBox[{
        SqrtBox["\[Pi]"], 
        RowBox[{
         RowBox[{"Gamma", "[", 
          RowBox[{"1", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}], "/", 
         RowBox[{"Gamma", "[", 
          RowBox[{"1.5", "+", 
           RowBox[{".5", "\[Zeta]"}]}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "_Real"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"v2", ",", "_Real"}], "}"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "x1", ",", "x2", ",", "\[Mu]"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x2", "=", 
          RowBox[{"v2", "/", "\[Theta]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x1", "=", 
          RowBox[{"v1", "/", "\[Theta]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x", "=", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"x1", "^", "2"}], "+", 
            RowBox[{"x2", "^", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Mu]", "=", 
          RowBox[{"x1", "/", "x"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"n", " ", 
          RowBox[{"Divide", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"x", "-", "xs"}], ")"}], "^", "2"}]}], "]"}], 
             RowBox[{"Power", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "\[Mu]"}], ")"}], 
                RowBox[{"(", 
                 RowBox[{"1", "+", "\[Mu]"}], ")"}]}], ",", 
               RowBox[{".5", "\[Zeta]"}]}], "]"}]}], ",", 
            RowBox[{"2", "Pi", " ", 
             RowBox[{"\[Theta]", "^", "3"}], "Ab", " ", "B\[Zeta]"}]}], 
           "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->
  "In[2265]:=",ExpressionUUID->"087b0d9f-e776-40d6-a246-3234f96b3215"],

Cell[CellGroupData[{

Cell["Maxwellian", "Subsubsection",ExpressionUUID->"479e96aa-b6c4-4c6e-a00b-44d7e9a04ac0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl1", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "1"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v1lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v2lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v2", "=", "51"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "\[Gamma]vhist", ",", "q1", ",", "rhist"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importRelativisticParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Gamma]vhist", "=", 
         RowBox[{"calMomentumHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v1lim", ",", "N\[Gamma]v1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v2lim", ",", "N\[Gamma]v2"}], "}"}], ",", 
           "q1lim"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<n\[Gamma]cc\>\"", 
                   ",", "\"\<\[Gamma]c\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<c\>\""}], "}"}], "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "\[Gamma]vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl1"}]}], "Input",
 CellLabel->
  "In[2267]:=",ExpressionUUID->"6f0c0881-47e1-49d1-9273-dda0b8b971bc"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl1"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"T2OT1eq", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", 
       "T2OT1", ",", "\[Gamma]vv12", ",", "ff", ",", "gg", ",", "plots"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{"T2OT1eq", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "T2OT1eq"}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{"T2OT1eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileBiMaxwellian", "[", 
            RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1"}], "]"}], ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileBiMaxwellian", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1"}], "]"}], ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[2269]:=",ExpressionUUID->"4d3cf1f4-020b-426a-af0d-ea7e77c05cee"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bi-Maxwellian", "Subsubsection",ExpressionUUID->"2e74fbbb-c808-4225-be09-4cdaf4d7a33d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl2", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "2"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v1lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v2lim", "=", 
        RowBox[{"6.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "\[Gamma]vhist", ",", "q1", ",", "rhist"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importRelativisticParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Gamma]vhist", "=", 
         RowBox[{"calMomentumHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v1lim", ",", "N\[Gamma]v1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v2lim", ",", "N\[Gamma]v2"}], "}"}], ",", 
           "q1lim"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<n\[Gamma]cc\>\"", 
                   ",", "\"\<\[Gamma]c\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<c\>\""}], "}"}], "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "\[Gamma]vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl2"}]}], "Input",
 CellLabel->
  "In[2270]:=",ExpressionUUID->"7d0333b0-bbb2-45d3-bb64-e540f9b0e48d"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl2"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"T2OT1eq", "=", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", 
       "T2OT1", ",", "\[Gamma]vv12", ",", "ff", ",", "gg", ",", "plots"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{"T2OT1eq", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "T2OT1eq"}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{"T2OT1eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileBiMaxwellian", "[", 
            RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1"}], "]"}], ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileBiMaxwellian", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1"}], "]"}], ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[2272]:=",ExpressionUUID->"03540508-00cf-42bf-ac8f-6184de1717d9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Loss cone - Maxwellian", "Subsubsection",ExpressionUUID->"c77d42dd-e2e9-4afd-908d-a66540d6bb87"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl3", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "3"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v1lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v2lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v2", "=", "51"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "\[Gamma]vhist", ",", "q1", ",", "rhist"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importRelativisticParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Gamma]vhist", "=", 
         RowBox[{"calMomentumHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v1lim", ",", "N\[Gamma]v1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v2lim", ",", "N\[Gamma]v2"}], "}"}], ",", 
           "q1lim"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<n\[Gamma]cc\>\"", 
                   ",", "\"\<\[Gamma]c\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<c\>\""}], "}"}], "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "\[Gamma]vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl3"}]}], "Input",
 CellLabel->
  "In[2273]:=",ExpressionUUID->"e9e1d5cf-7953-4cbc-be87-449979859ee9"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl3"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["1"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "1.0*^-10"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", 
       "\[Eta]\[Beta]", ",", "\[Beta]", ",", "n0", ",", "\[Theta]2O\[Theta]1",
        ",", "T2OT1", ",", "\[Gamma]vv12", ",", "ff", ",", "gg", ",", 
       "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileLossCone", "[", 
            RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], 
            "]"}], ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileLossCone", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1", ",", "\[Beta]"}], 
            "]"}], ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[2275]:=",ExpressionUUID->"08ea6c9f-7a77-4fe8-8b19-23bf1b666bb9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Loss cone - Bi-Maxwellian", "Subsubsection",ExpressionUUID->"0b5175d8-72de-44cb-b539-9edad7abdd35"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl4", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "4"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v1lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v2lim", "=", 
        RowBox[{"6.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "\[Gamma]vhist", ",", "q1", ",", "rhist"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importRelativisticParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Gamma]vhist", "=", 
         RowBox[{"calMomentumHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v1lim", ",", "N\[Gamma]v1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v2lim", ",", "N\[Gamma]v2"}], "}"}], ",", 
           "q1lim"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<n\[Gamma]cc\>\"", 
                   ",", "\"\<\[Gamma]c\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<c\>\""}], "}"}], "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "\[Gamma]vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl4"}]}], "Input",
 CellLabel->
  "In[2276]:=",ExpressionUUID->"b4ca3669-b891-4814-a52f-2652d9727f9d"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl4"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "1.0*^-10"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", 
       "\[Eta]\[Beta]", ",", "\[Beta]", ",", "n0", ",", "\[Theta]2O\[Theta]1",
        ",", "T2OT1", ",", "\[Gamma]vv12", ",", "ff", ",", "gg", ",", 
       "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileLossCone", "[", 
            RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], 
            "]"}], ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileLossCone", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1", ",", "\[Beta]"}], 
            "]"}], ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[2278]:=",ExpressionUUID->"3becc930-f168-4e52-9efb-482064c4c8d7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Loss cone - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Beta]", "eq"], "=", "0.5"}], TraditionalForm]],
  ExpressionUUID->"c7951850-3148-4644-804f-5d1863a30421"]
}], "Subsubsection",ExpressionUUID->"99b8a46f-6c71-4123-9546-859235d4f8c5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl5", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "5"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v1lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v2lim", "=", 
        RowBox[{"6.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "\[Gamma]vhist", ",", "q1", ",", "rhist"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importRelativisticParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Gamma]vhist", "=", 
         RowBox[{"calMomentumHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v1lim", ",", "N\[Gamma]v1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v2lim", ",", "N\[Gamma]v2"}], "}"}], ",", 
           "q1lim"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<n\[Gamma]cc\>\"", 
                   ",", "\"\<\[Gamma]c\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<c\>\""}], "}"}], "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "\[Gamma]vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl5"}]}], "Input",
 CellLabel->
  "In[2279]:=",ExpressionUUID->"3d1b38a5-30d9-4707-a77a-3827704aca13"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl5"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "0.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", 
       "\[Eta]\[Beta]", ",", "\[Beta]", ",", "n0", ",", "\[Theta]2O\[Theta]1",
        ",", "T2OT1", ",", "\[Gamma]vv12", ",", "ff", ",", "gg", ",", 
       "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileLossCone", "[", 
            RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], 
            "]"}], ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileLossCone", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1", ",", "\[Beta]"}], 
            "]"}], ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[2281]:=",ExpressionUUID->"fee4b97f-8959-4ebf-82be-e2e327482bc3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Loss cone - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Beta]", "eq"], "=", "2.5"}], TraditionalForm]],
  ExpressionUUID->"3f06920e-d864-4751-a794-72d4ee46e99f"]
}], "Subsubsection",ExpressionUUID->"dfb9196d-59ad-4d1a-bedd-3726a86c664e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl6", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "6"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v1lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v2lim", "=", 
        RowBox[{"6.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "\[Gamma]vhist", ",", "q1", ",", "rhist"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importRelativisticParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Gamma]vhist", "=", 
         RowBox[{"calMomentumHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v1lim", ",", "N\[Gamma]v1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v2lim", ",", "N\[Gamma]v2"}], "}"}], ",", 
           "q1lim"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<n\[Gamma]cc\>\"", 
                   ",", "\"\<\[Gamma]c\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<c\>\""}], "}"}], "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "\[Gamma]vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl6"}]}], "Input",
 CellLabel->
  "In[2282]:=",ExpressionUUID->"7679c66c-f6c3-406a-8ee8-50b8f6cd852b"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl6"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
     RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
      SqrtBox["2"]}], ",", 
     RowBox[{"\[Beta]eq", "=", "2.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", 
       "\[Eta]\[Beta]", ",", "\[Beta]", ",", "n0", ",", "\[Theta]2O\[Theta]1",
        ",", "T2OT1", ",", "\[Gamma]vv12", ",", "ff", ",", "gg", ",", 
       "plots"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
            "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Eta]", "-", 
           RowBox[{"\[Beta]eq", " ", "\[Eta]\[Beta]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Beta]", "=", 
       RowBox[{"\[Beta]eq", " ", 
        RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       RowBox[{"\[Theta]2O\[Theta]1eq", 
        SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"T2OT1", "=", 
       RowBox[{
        RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileLossCone", "[", 
            RowBox[{"n0", ",", "\[Beta]1", ",", "T2OT1", ",", "\[Beta]"}], 
            "]"}], ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compileLossCone", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]1", " ", "gT"}], ",", "T2OT1", ",", "\[Beta]"}], 
            "]"}], ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[2284]:=",ExpressionUUID->"4da1be35-1b66-4c82-b7a5-b692e65e1317"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Partial Shell - Maxwellian", "Subsubsection",ExpressionUUID->"1b1cc39a-eb3b-419b-896c-2ff3a1f6ed48"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl7", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "7"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v1lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v2lim", "=", 
        RowBox[{"4.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v2", "=", "51"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "\[Gamma]vhist", ",", "q1", ",", "rhist"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importRelativisticParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Gamma]vhist", "=", 
         RowBox[{"calMomentumHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v1lim", ",", "N\[Gamma]v1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v2lim", ",", "N\[Gamma]v2"}], "}"}], ",", 
           "q1lim"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<n\[Gamma]cc\>\"", 
                   ",", "\"\<\[Gamma]c\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<c\>\""}], "}"}], "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "\[Gamma]vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl7"}]}], "Input",
 CellLabel->
  "In[2285]:=",ExpressionUUID->"35465c77-e521-4104-8a14-80dc40ff44f2"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl7"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "1.5"}], ",", 
     RowBox[{"\[Zeta]", "=", "0"}], ",", 
     RowBox[{"vs", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "plots", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", 
       "\[Gamma]vv12", ",", "ff", ",", "gg"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compilePartialShell", "[", 
            RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], "]"}], 
           ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compilePartialShell", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]", " ", "gT"}], ",", "\[Zeta]", ",", "vs"}], 
            "]"}], ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[2287]:=",ExpressionUUID->"53b114e5-c4bb-4f2c-a09d-4189b3900904"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Isotropic shell", "Subsubsection",ExpressionUUID->"6324afde-8eb2-445f-9caa-3e86cfb79deb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl8", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "8"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v1lim", "=", 
        RowBox[{"2.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v2lim", "=", 
        RowBox[{"3.0", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "\[Gamma]vhist", ",", "q1", ",", "rhist"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importRelativisticParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Gamma]vhist", "=", 
         RowBox[{"calMomentumHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v1lim", ",", "N\[Gamma]v1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v2lim", ",", "N\[Gamma]v2"}], "}"}], ",", 
           "q1lim"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<n\[Gamma]cc\>\"", 
                   ",", "\"\<\[Gamma]c\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<c\>\""}], "}"}], "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "\[Gamma]vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl8"}]}], "Input",
 CellLabel->
  "In[2288]:=",ExpressionUUID->"c4a1f921-0343-4134-a2cd-2627f19a9726"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl8"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "0"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "plots", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", 
       "\[Gamma]vv12", ",", "ff", ",", "gg"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compilePartialShell", "[", 
            RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], "]"}], 
           ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compilePartialShell", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]", " ", "gT"}], ",", "\[Zeta]", ",", "vs"}], 
            "]"}], ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[2290]:=",ExpressionUUID->"885b5041-ccce-421d-8c68-d81323cdd220"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Partial shell - ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Zeta]", "=", "1"}], TraditionalForm]],ExpressionUUID->
  "bf39d3d2-75e5-4ee1-a635-b7bb4badd820"]
}], "Subsubsection",ExpressionUUID->"57cd3b51-98b4-46e5-8f98-842d155a92d3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl9", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "9"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v1lim", "=", 
        RowBox[{"2.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v2lim", "=", 
        RowBox[{"3.0", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "\[Gamma]vhist", ",", "q1", ",", "rhist"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importRelativisticParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Gamma]vhist", "=", 
         RowBox[{"calMomentumHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v1lim", ",", "N\[Gamma]v1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v2lim", ",", "N\[Gamma]v2"}], "}"}], ",", 
           "q1lim"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<n\[Gamma]cc\>\"", 
                   ",", "\"\<\[Gamma]c\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<c\>\""}], "}"}], "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "\[Gamma]vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl9"}]}], "Input",
 CellLabel->
  "In[2291]:=",ExpressionUUID->"1416d2ec-7d3f-42a7-9315-c6f5c16197d2"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl9"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "1"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "plots", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", 
       "\[Gamma]vv12", ",", "ff", ",", "gg"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compilePartialShell", "[", 
            RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], "]"}], 
           ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compilePartialShell", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]", " ", "gT"}], ",", "\[Zeta]", ",", "vs"}], 
            "]"}], ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[2293]:=",ExpressionUUID->"db6add99-68f6-4732-8796-031c7be4bbfa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Partial shell - ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Zeta]", "=", "5"}], TraditionalForm]],ExpressionUUID->
  "9ddf4c3b-4526-443e-a28e-7030060b35a7"]
}], "Subsubsection",ExpressionUUID->"2a7e28b7-349b-4ff2-942b-db1023561f34"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ptl10", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"spid", "=", "10"}], ",", 
       RowBox[{"file", "=", 
        RowBox[{"metadata", "[", 
         RowBox[{"[", 
          RowBox[{"\"\<files\>\"", ",", 
           RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
       RowBox[{"attr", "=", 
        RowBox[{"metadata", "[", "\"\<attr\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v1lim", "=", 
        RowBox[{"2.5", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v1", "=", "100"}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]v2lim", "=", 
        RowBox[{"3.0", "*", "1.4", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}]}], ",", 
       RowBox[{"N\[Gamma]v2", "=", "70"}], ",", "\[IndentingNewLine]", 
       RowBox[{"q1lim", "=", 
        RowBox[{"50", "+", 
         RowBox[{"10", 
          RowBox[{"Interval", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ptl", ",", "\[Gamma]vhist", ",", "q1", ",", "rhist"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"attr", ",", 
             RowBox[{"importRelativisticParticle", "[", 
              RowBox[{"file", ",", "spid"}], "]"}]}], "}"}], ",", "Last"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Gamma]vhist", "=", 
         RowBox[{"calMomentumHistogram", "[", 
          RowBox[{"ptl", ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v1lim", ",", "N\[Gamma]v1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Gamma]v2lim", ",", "N\[Gamma]v2"}], "}"}], ",", 
           "q1lim"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"q1", ",", "rhist"}], "}"}], "=", 
         RowBox[{"HistogramList", "[", 
          RowBox[{
           RowBox[{"ptl", "[", "\"\<q1\>\"", "]"}], ",", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"ptl", "[", "\"\<full_grid_domain_extent\>\"", "]"}], 
             ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"q1", "=", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"q1", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ptl", "=", 
         RowBox[{"Merge", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"KeyDrop", "[", 
              RowBox[{"ptl", ",", 
               RowBox[{"Join", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<n\>\"", ",", "\"\<id\>\"", ",", "\"\<n\[Gamma]cc\>\"", 
                   ",", "\"\<\[Gamma]c\>\"", ",", "\"\<w\>\"", ",", 
                   "\"\<f\>\"", ",", "\"\<g\>\"", ",", "\"\<q1\>\""}], "}"}], 
                 ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<nV\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<c\>\""}], "}"}], "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<n\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}], ",", 
                    "\"\<v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}], ",", 
                 RowBox[{"StringJoin", "/@", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<\[Gamma]v\>\"", ",", 
                    RowBox[{"Characters", "[", "\"\<123\>\"", "]"}]}], "}"}], 
                   "]"}]}]}], "]"}]}], "]"}], ",", "\[Gamma]vhist", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<q1\>\"", "->", "q1"}], ",", 
               RowBox[{"\"\<rhist\>\"", "->", "rhist"}]}], "}"}]}], "}"}], 
           ",", "Last"}], "]"}]}], ";", "\[IndentingNewLine]", "ptl"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "/@", "ptl10"}]}], "Input",
 CellLabel->
  "In[2294]:=",ExpressionUUID->"e88fbd2d-5216-460f-ac0f-384b9da418f5"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vhist", "=", "ptl10"}], ",", 
     RowBox[{"n0eq", "=", "1"}], ",", 
     RowBox[{"\[Beta]", "=", "0.25"}], ",", 
     RowBox[{"\[Zeta]", "=", "5"}], ",", 
     RowBox[{"vs", "=", "1.5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "gT", ",", "\[Gamma]v1", ",", "\[Gamma]v2", ",", "plots", ",", 
       "\[Xi]\[CapitalDelta]1", ",", "q1", ",", "\[Eta]", ",", "n0", ",", 
       "\[Gamma]vv12", ",", "ff", ",", "gg"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gT", "=", 
       RowBox[{"vhist", "[", "\"\<marker_temp_ratio\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v1", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v1\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]v2", "=", 
       RowBox[{"vhist", "[", "\"\<\[Gamma]v2\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
       RowBox[{
        RowBox[{"vhist", "[", "\"\<xi\>\"", "]"}], "*", 
        RowBox[{"vhist", "[", "\"\<Dx\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1", "=", 
       RowBox[{"Mean", "[", 
        RowBox[{"vhist", "[", "\"\<q1lim\>\"", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n0", "=", 
       RowBox[{"n0eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Gamma]vv12", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compilePartialShell", "[", 
            RowBox[{"n0", ",", "\[Beta]", ",", "\[Zeta]", ",", "vs"}], "]"}], 
           ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"ff", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{
           RowBox[{"compilePartialShell", "[", 
            RowBox[{"n0", ",", 
             RowBox[{"\[Beta]", " ", "gT"}], ",", "\[Zeta]", ",", "vs"}], 
            "]"}], ",", 
           RowBox[{"\[Gamma]vv12", "\[Transpose]"}]}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"\[Gamma]v1", ",", "\[Gamma]v2"}], "}"}]}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"gg", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"gg", ",", "n0"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<f\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ArrayPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"vhist", "[", "\"\<g\>\"", "]"}], "//", "Reverse"}], 
               ",", 
               RowBox[{"DataRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"\[Gamma]v1", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                  RowBox[{"\[Gamma]v2", "[", 
                   RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}], ",", 
               RowBox[{"ColorFunction", "\[Rule]", "\"\<Rainbow\>\""}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"FrameTicks", "->", "Automatic"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", 
               RowBox[{"Apply", "[", 
                RowBox[{"Divide", ",", 
                 RowBox[{"Subtract", "@@@", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                "]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"PlotRangePadding", "->", 
              RowBox[{"Thread", "[", 
               RowBox[{"Scaled", "[", 
                RowBox[{".02", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"Apply", "[", 
                    RowBox[{"Divide", ",", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}], ",", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], "]"}], "]"}]}], "}"}]}]}], 
                    "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<f1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<g1\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"vhist", "[", "\"\<df1\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "ff"}], "]"}]}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v1", ",", 
                    RowBox[{"Map", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"#", " ", "2", "\[Pi]", " ", "\[Gamma]v2", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}], "&"}], 
                    ",", "gg"}], "]"}]}], "}"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<f2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<g2\>\"", "]"}]}], "}"}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"vhist", "[", "\"\<df2\>\"", "]"}]}], "}"}], 
                  "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"ff", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Gamma]v2", ",", 
                    RowBox[{"Total", "[", 
                    RowBox[{"gg", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", 
                    RowBox[{"\[Gamma]v1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], "}"}],
                   "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Black", ",", "Dashed", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "->", "Medium"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]",
             "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Grid", "[", "plots", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[2296]:=",ExpressionUUID->"5090fcf7-34fb-40cb-9182-b4269ea09712"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1468, 1047},
WindowMargins->{{45, Automatic}, {103, Automatic}},
FrontEndVersion->"13.2 for Mac OS X x86 (64-bit) (November 18, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"13c7468d-72b3-4754-a7ae-58931f6d390a"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 277, 6, 52, "Input",ExpressionUUID->"35414358-9cce-404a-b33a-abdb7a6986c5"],
Cell[838, 28, 260, 7, 30, "Input",ExpressionUUID->"98642d0f-5832-45f9-b8ed-04467496a470"],
Cell[1101, 37, 241, 6, 30, "Input",ExpressionUUID->"7640abcc-40a3-4b02-a665-ad3c9af5d4f1"],
Cell[CellGroupData[{
Cell[1367, 47, 97, 0, 67, "Section",ExpressionUUID->"9f12e1c2-203b-454a-a884-7860554e9154"],
Cell[1467, 49, 2252, 76, 125, "Text",ExpressionUUID->"e412d333-35f8-4d7e-9c38-00959af76376"],
Cell[3722, 127, 766, 20, 115, "Input",ExpressionUUID->"a0285dff-a04c-4fa0-9f2b-daf585a3e673"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4525, 152, 90, 0, 67, "Section",ExpressionUUID->"847df2fa-4921-4ad3-8a12-772ae439a795"],
Cell[CellGroupData[{
Cell[4640, 156, 83, 0, 54, "Subsection",ExpressionUUID->"d0695e24-7f9d-4334-8478-e96567942d55"],
Cell[4726, 158, 3492, 85, 304, "Input",ExpressionUUID->"1ec44cd5-a184-4658-be8c-4fca21fac5bf"],
Cell[8221, 245, 147, 3, 30, "Input",ExpressionUUID->"25245137-5cfc-4fd5-8f8b-3b1727393e21"],
Cell[8371, 250, 5538, 134, 451, "Input",ExpressionUUID->"165b2a5c-70b2-4a34-9de2-2bc59b9970b5"],
Cell[13912, 386, 4932, 121, 493, "Input",ExpressionUUID->"909e924c-4bab-402e-abac-e83db341f28d"],
Cell[18847, 509, 5389, 136, 493, "Input",ExpressionUUID->"b11b8c30-ec3e-4ab2-83d0-d7e26f6f4a7d"],
Cell[24239, 647, 4941, 128, 409, "Input",ExpressionUUID->"42e0356c-1f39-445c-8c6c-7e391f279571"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29217, 780, 83, 0, 54, "Subsection",ExpressionUUID->"cd6cf25d-e30d-4dae-8ee1-f32262fc6808"],
Cell[29303, 782, 2534, 67, 241, "Input",ExpressionUUID->"6f598aed-c038-4db9-bf47-b3b56562c1e8"],
Cell[CellGroupData[{
Cell[31862, 853, 90, 0, 45, "Subsubsection",ExpressionUUID->"cb7d9ce6-eb9b-4f7d-9e35-77fe1e582769"],
Cell[31955, 855, 3337, 86, 220, "Input",ExpressionUUID->"5702dbab-a126-4023-a84b-59e5a35c7564"],
Cell[35295, 943, 9786, 236, 640, "Input",ExpressionUUID->"924d8ae5-1219-456f-abd8-7e2ac6029643"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45118, 1184, 93, 0, 45, "Subsubsection",ExpressionUUID->"66338852-e001-46f5-8c9c-1b64d8c945c9"],
Cell[45214, 1186, 3337, 86, 220, "Input",ExpressionUUID->"c1158f36-932d-4e2f-947e-6f9911a933fb"],
Cell[48554, 1274, 10073, 244, 640, "Input",ExpressionUUID->"3bdea17f-a210-4f60-bebe-49420255b9df"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58664, 1523, 101, 0, 45, "Subsubsection",ExpressionUUID->"7910da06-34ae-4593-bc9e-74a69272b100"],
Cell[58768, 1525, 3337, 86, 220, "Input",ExpressionUUID->"bec4ae69-6202-4538-80b4-e2b9c215efee"],
Cell[62108, 1613, 9786, 236, 640, "Input",ExpressionUUID->"82413c55-b644-430b-99b2-f2f4526dbcc0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71931, 1854, 104, 0, 45, "Subsubsection",ExpressionUUID->"a3f84be9-399c-4419-9094-ed5eda12824f"],
Cell[72038, 1856, 3337, 86, 220, "Input",ExpressionUUID->"9d3f1bd2-ce0d-41f3-8537-b2f4ed60425e"],
Cell[75378, 1944, 10073, 244, 640, "Input",ExpressionUUID->"e333d87b-eff8-4de5-8ff4-d8827bba57ee"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85488, 2193, 302, 8, 45, "Subsubsection",ExpressionUUID->"4980b484-d4a1-42be-a914-13db437ac77d"],
Cell[85793, 2203, 3337, 86, 220, "Input",ExpressionUUID->"6b115070-2d54-49ba-b154-a649826185c9"],
Cell[89133, 2291, 11515, 281, 733, "Input",ExpressionUUID->"20f092f7-6abd-4f6b-b097-f0bc08cc06ce"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100685, 2577, 302, 8, 45, "Subsubsection",ExpressionUUID->"e3066ceb-9fb5-40aa-ba34-9cb0fd7abdac"],
Cell[100990, 2587, 3337, 86, 220, "Input",ExpressionUUID->"2eedc04d-fe4a-4f27-8290-838dbd0c8747"],
Cell[104330, 2675, 11516, 281, 733, "Input",ExpressionUUID->"159758ce-5815-4bad-bdd7-5290ee91102e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[115883, 2961, 106, 0, 45, "Subsubsection",ExpressionUUID->"51115539-fd2f-43ec-a01d-08a57471c386"],
Cell[115992, 2963, 3337, 86, 220, "Input",ExpressionUUID->"b5b93d3b-5890-4f43-8098-f48503432848"],
Cell[119332, 3051, 12235, 308, 767, "Input",ExpressionUUID->"6e384b7b-cc72-454a-95be-0b3582ad5970"]
}, Open  ]],
Cell[CellGroupData[{
Cell[131604, 3364, 95, 0, 45, "Subsubsection",ExpressionUUID->"7ec0129c-40d8-4631-bf1b-51fb8eb2c9e3"],
Cell[131702, 3366, 3337, 86, 220, "Input",ExpressionUUID->"6cd02a64-3575-4a51-8480-6b28b04b611f"],
Cell[135042, 3454, 12238, 308, 767, "Input",ExpressionUUID->"b1edadf5-5bd5-4999-8212-03f4d774ff03"]
}, Open  ]],
Cell[CellGroupData[{
Cell[147317, 3767, 280, 7, 45, "Subsubsection",ExpressionUUID->"22184aa1-da55-4c27-b9ac-23cc971f1ba8"],
Cell[147600, 3776, 3337, 86, 220, "Input",ExpressionUUID->"773c508a-4946-441c-b000-2db3a06a75b7"],
Cell[150940, 3864, 12238, 308, 767, "Input",ExpressionUUID->"e9ba3453-4dd1-4101-a9d2-b6f662465aaa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[163215, 4177, 280, 7, 45, "Subsubsection",ExpressionUUID->"27bef6b5-a9be-4af2-a6f7-a874de3627cd"],
Cell[163498, 4186, 3340, 86, 220, "Input",ExpressionUUID->"632d56b6-0f03-4ede-9a23-16788a182daf"],
Cell[166841, 4274, 12239, 308, 767, "Input",ExpressionUUID->"ee0ad69f-bc34-42c3-809f-3080483ea1ca"]
}, Open  ]],
Cell[CellGroupData[{
Cell[179117, 4587, 90, 0, 45, "Subsubsection",ExpressionUUID->"1e7aaa3a-a570-4c24-b90e-64b34e4e4847"],
Cell[179210, 4589, 3340, 86, 220, "Input",ExpressionUUID->"8cceee78-63f9-48e9-a0e1-ce69f442f550"],
Cell[182553, 4677, 6495, 170, 325, "Input",ExpressionUUID->"8db6a45b-c8e9-49e7-afa5-cdc0f9e8712e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[189097, 4853, 82, 0, 54, "Subsection",ExpressionUUID->"87b5ea90-0db6-483f-8519-834bcf44ddac"],
Cell[189182, 4855, 2550, 67, 241, "Input",ExpressionUUID->"031100a5-f529-474a-ac83-268d5d7c25ba"],
Cell[191735, 4924, 1788, 50, 191, "Input",ExpressionUUID->"23e38fd0-5996-4b1e-8c87-749d77fb67b3"],
Cell[193526, 4976, 2395, 68, 191, "Input",ExpressionUUID->"87d366a1-c8ba-4815-8fc8-6bb45a27781b"],
Cell[195924, 5046, 4010, 109, 426, "Input",ExpressionUUID->"0c4a0d53-0227-4c1d-9df5-c49fe37333cd"],
Cell[CellGroupData[{
Cell[199959, 5159, 90, 0, 45, "Subsubsection",ExpressionUUID->"fe80e185-5197-42f8-b99f-9cca5f073b7d"],
Cell[200052, 5161, 899, 25, 94, "Input",ExpressionUUID->"f605ebca-de2f-4079-8328-128010bd5dda"],
Cell[200954, 5188, 34146, 782, 2782, "Input",ExpressionUUID->"5cdc9089-b8c9-4385-aa1b-7d765c270b48"]
}, Open  ]],
Cell[CellGroupData[{
Cell[235137, 5975, 93, 0, 45, "Subsubsection",ExpressionUUID->"ac9a0ef0-1ed7-4c49-894b-8d040b1265af"],
Cell[235233, 5977, 899, 25, 94, "Input",ExpressionUUID->"30e29baf-be22-4a23-9455-cfb8d5cc8176"],
Cell[236135, 6004, 34172, 783, 2782, "Input",ExpressionUUID->"24babefe-2ca7-45a8-bfe8-ab69c67cf459"]
}, Open  ]],
Cell[CellGroupData[{
Cell[270344, 6792, 102, 0, 45, "Subsubsection",ExpressionUUID->"e301e7dc-eb33-46da-86eb-8f8e6243a88e"],
Cell[270449, 6794, 899, 25, 94, "Input",ExpressionUUID->"354e6873-e1ec-483e-a49a-8830fb2ba2ec"],
Cell[271351, 6821, 35657, 821, 2875, "Input",ExpressionUUID->"1b1960bb-dfd3-42da-8f90-2cabf37dc77a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[307045, 7647, 105, 0, 45, "Subsubsection",ExpressionUUID->"f0e7d15b-2c81-4f41-868d-6745ac8e65db"],
Cell[307153, 7649, 899, 25, 94, "Input",ExpressionUUID->"0772f7b0-48e0-4b2d-8541-a07d79f2ca5d"],
Cell[308055, 7676, 35657, 821, 2875, "Input",ExpressionUUID->"516ce6ad-b483-4ff9-bf73-83ba5e152724"]
}, Open  ]],
Cell[CellGroupData[{
Cell[343749, 8502, 303, 8, 48, "Subsubsection",ExpressionUUID->"09c53460-8f0c-4f01-90b3-594ffa8138dc"],
Cell[344055, 8512, 899, 25, 94, "Input",ExpressionUUID->"d0cfef55-6cad-446f-8c55-c8501fc3af46"],
Cell[344957, 8539, 35648, 820, 2875, "Input",ExpressionUUID->"184f72e9-532f-4217-a144-e0bc44cc73c3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[380642, 9364, 272, 7, 48, "Subsubsection",ExpressionUUID->"674ebfdd-4362-4560-866b-f9fe043036cf"],
Cell[380917, 9373, 899, 25, 94, "Input",ExpressionUUID->"06c87354-63c2-4a6f-be12-e2fb0478ac00"],
Cell[381819, 9400, 35648, 820, 2875, "Input",ExpressionUUID->"f735f831-0bc3-40a4-9c52-c27695b114e1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[417504, 10225, 106, 0, 45, "Subsubsection",ExpressionUUID->"e264d83a-6c95-4ac5-9721-0f1e04acc04f"],
Cell[417613, 10227, 899, 25, 94, "Input",ExpressionUUID->"489b4e47-5b2e-482d-9fc0-69cf95a5d05f"],
Cell[418515, 10254, 33952, 777, 2761, "Input",ExpressionUUID->"a2b28cda-daca-4adb-8339-21de3d02e7dd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[452504, 11036, 95, 0, 45, "Subsubsection",ExpressionUUID->"6eb3c79b-eff6-4460-8253-47e96d5ee614"],
Cell[452602, 11038, 899, 25, 94, "Input",ExpressionUUID->"f57bb4e7-f06e-4745-bc6b-63fd2c0beb06"],
Cell[453504, 11065, 33955, 777, 2761, "Input",ExpressionUUID->"f0394d30-2067-47b3-8e35-57bbbfb8f7f1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[487496, 11847, 280, 7, 45, "Subsubsection",ExpressionUUID->"5dae1cb7-fb06-4091-b03e-968418fa9c75"],
Cell[487779, 11856, 899, 25, 94, "Input",ExpressionUUID->"f680c9c5-a9a6-49ee-bec0-059f006df748"],
Cell[488681, 11883, 33955, 777, 2761, "Input",ExpressionUUID->"5e21fdad-81e8-40e3-8834-d06a327d2dd8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[522673, 12665, 280, 7, 45, "Subsubsection",ExpressionUUID->"e115932c-e11d-4697-99f7-effb712dd1d5"],
Cell[522956, 12674, 902, 25, 94, "Input",ExpressionUUID->"e5c1bd5b-d3eb-4d82-9320-2133ba724e35"],
Cell[523861, 12701, 33956, 777, 2761, "Input",ExpressionUUID->"d467d30e-a58a-434d-bb04-91e18e536b77"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[557866, 13484, 85, 0, 54, "Subsection",ExpressionUUID->"5fd3b1be-689f-429f-b7e4-8019920ed1c4"],
Cell[557954, 13486, 2552, 67, 241, "Input",ExpressionUUID->"893da2a7-7e5d-432e-b173-f8eaf133cea4"],
Cell[560509, 13555, 1788, 50, 191, "Input",ExpressionUUID->"cb341572-e53f-4af1-9c6e-ed9448575ba6"],
Cell[562300, 13607, 2395, 68, 191, "Input",ExpressionUUID->"45b8a89b-813c-48e5-adf5-13fd6fe5a6f5"],
Cell[564698, 13677, 4010, 109, 426, "Input",ExpressionUUID->"a7dddd1d-ebb0-4cac-80db-99d04aa3ebec"],
Cell[CellGroupData[{
Cell[568733, 13790, 90, 0, 45, "Subsubsection",ExpressionUUID->"36a1f4fc-a9cc-4b45-a98e-bb5e12f6c6e3"],
Cell[568826, 13792, 4654, 115, 367, "Input",ExpressionUUID->"9f097443-e5b5-4b5e-a35b-87e5696bf097"],
Cell[573483, 13909, 18809, 437, 1666, "Input",ExpressionUUID->"1467e5f1-23c4-4fb5-b056-e0e7cdcb825d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[592329, 14351, 93, 0, 45, "Subsubsection",ExpressionUUID->"8adb1f5d-23b5-47fe-9819-00234264bcad"],
Cell[592425, 14353, 4654, 115, 367, "Input",ExpressionUUID->"fbd90576-d11a-4dd7-99ff-ee2dd90257e7"],
Cell[597082, 14470, 18809, 437, 1666, "Input",ExpressionUUID->"bdf67aff-9b63-49c3-8a4a-1fbbe0a4de5e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[615928, 14912, 102, 0, 45, "Subsubsection",ExpressionUUID->"ff204e1f-d465-4e45-9f15-b73c3c893168"],
Cell[616033, 14914, 4654, 115, 367, "Input",ExpressionUUID->"96fe0e7f-76ca-4d7d-a9ae-193e995d5e47"],
Cell[620690, 15031, 20312, 477, 1751, "Input",ExpressionUUID->"7b43c61b-d5ad-4fdd-a772-d4d0ed3a5201"]
}, Open  ]],
Cell[CellGroupData[{
Cell[641039, 15513, 105, 0, 45, "Subsubsection",ExpressionUUID->"07cb930f-0154-42c4-a84b-64000b6a5919"],
Cell[641147, 15515, 4654, 115, 367, "Input",ExpressionUUID->"f80e0095-8f0a-4fe4-90c4-7fb3081b8a1b"],
Cell[645804, 15632, 20312, 477, 1751, "Input",ExpressionUUID->"51ef39fa-77c6-4a43-9e93-38d99f692bac"]
}, Open  ]],
Cell[CellGroupData[{
Cell[666153, 16114, 303, 8, 48, "Subsubsection",ExpressionUUID->"453a29b7-4b7f-4c4e-8b5d-32e8bf4fe9a4"],
Cell[666459, 16124, 4654, 115, 367, "Input",ExpressionUUID->"0e51ec89-08a0-4054-84d8-3643b3203a1c"],
Cell[671116, 16241, 20303, 476, 1751, "Input",ExpressionUUID->"57e2e1ce-cc9a-4e6e-b9b0-5f50e329419d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[691456, 16722, 303, 8, 48, "Subsubsection",ExpressionUUID->"420d5dbe-eb47-4c9a-b990-17c8bf2c417f"],
Cell[691762, 16732, 4654, 115, 367, "Input",ExpressionUUID->"4128df59-a0ee-48c9-a3b5-58536eb92fd0"],
Cell[696419, 16849, 20303, 476, 1751, "Input",ExpressionUUID->"d183ec4e-ef5d-4e9e-89f7-1752fde91471"]
}, Open  ]],
Cell[CellGroupData[{
Cell[716759, 17330, 106, 0, 45, "Subsubsection",ExpressionUUID->"4cde35e2-2a6c-42fb-8a21-d536aaf2b1c0"],
Cell[716868, 17332, 4654, 115, 367, "Input",ExpressionUUID->"fdd05f59-c9bf-4ee7-b6e7-1ec4e8adb3e6"],
Cell[721525, 17449, 18608, 433, 1645, "Input",ExpressionUUID->"3b80149a-2520-4e15-9c72-3095b1089618"]
}, Open  ]],
Cell[CellGroupData[{
Cell[740170, 17887, 95, 0, 45, "Subsubsection",ExpressionUUID->"9c707734-a002-4b4f-a78f-4088c49d8d3c"],
Cell[740268, 17889, 4654, 115, 367, "Input",ExpressionUUID->"398aa1e0-b84f-4764-a659-9a8c5ffcdb98"],
Cell[744925, 18006, 18611, 433, 1645, "Input",ExpressionUUID->"26061cd9-12aa-490f-b1d5-6c11255c1278"]
}, Open  ]],
Cell[CellGroupData[{
Cell[763573, 18444, 280, 7, 45, "Subsubsection",ExpressionUUID->"50d02012-23a3-4fdc-b5f8-faf0710d9674"],
Cell[763856, 18453, 4654, 115, 367, "Input",ExpressionUUID->"9a7809fb-2c2d-4650-8a3f-b5bb9dfe2995"],
Cell[768513, 18570, 18611, 433, 1645, "Input",ExpressionUUID->"89c4593d-3e80-4b8f-bdd1-6fd0449d22c0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[787161, 19008, 280, 7, 45, "Subsubsection",ExpressionUUID->"7950b24b-c9da-4d79-9d2d-f2e2a50a72e5"],
Cell[787444, 19017, 4657, 115, 367, "Input",ExpressionUUID->"8ec05565-1468-434e-90e1-fa9efc4065ed"],
Cell[792104, 19134, 18612, 433, 1645, "Input",ExpressionUUID->"ed6fdec6-abd6-443c-b685-c3ef58ecb9e8"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[810777, 19574, 86, 0, 53, "Section",ExpressionUUID->"049bdef6-6ff3-441e-9834-854918644d50"],
Cell[CellGroupData[{
Cell[810888, 19578, 83, 0, 54, "Subsection",ExpressionUUID->"d6bbe9ce-e81c-4417-8a75-9db60646a1a1"],
Cell[810974, 19580, 3493, 85, 304, "Input",ExpressionUUID->"5af87966-7ad5-4915-b423-a530c1b88ade"],
Cell[814470, 19667, 148, 3, 30, "Input",ExpressionUUID->"01777970-3e72-4129-8b96-05a4ad95277a"],
Cell[814621, 19672, 5578, 135, 451, "Input",ExpressionUUID->"7328c186-3089-40c8-b97d-7a65c857185d"],
Cell[820202, 19809, 5128, 127, 493, "Input",ExpressionUUID->"fcab10d7-7b6d-4ee9-b2d1-81e593575264"],
Cell[825333, 19938, 5552, 139, 493, "Input",ExpressionUUID->"9fdae9ed-6252-4ec2-b7e6-89d9ab850e3d"],
Cell[830888, 20079, 5011, 130, 409, "Input",ExpressionUUID->"b3a0de19-ea50-4af9-b6fb-aec6c87ba033"]
}, Open  ]],
Cell[CellGroupData[{
Cell[835936, 20214, 83, 0, 54, "Subsection",ExpressionUUID->"8bab2c33-d95c-41f6-a9df-a55c1f8da90f"],
Cell[836022, 20216, 2535, 67, 241, "Input",ExpressionUUID->"7fe74a65-87d2-41fd-9f7e-6086933d5ee9"],
Cell[838560, 20285, 1789, 50, 191, "Input",ExpressionUUID->"3510a4dc-20bc-4764-8fcd-94131ca416fe"],
Cell[840352, 20337, 2396, 68, 191, "Input",ExpressionUUID->"298398bb-8b8b-4a10-8c21-2ff961485459"],
Cell[842751, 20407, 4011, 109, 426, "Input",ExpressionUUID->"e40fce72-be50-45ca-a8e6-1b607548d481"],
Cell[CellGroupData[{
Cell[846787, 20520, 90, 0, 45, "Subsubsection",ExpressionUUID->"ddc277b0-c34c-48ad-a79c-e36819923521"],
Cell[846880, 20522, 3679, 94, 241, "Input",ExpressionUUID->"7a555eae-a0a9-4fed-82b9-c337510fe03c"],
Cell[850562, 20618, 15668, 369, 1139, "Input",ExpressionUUID->"16d8e1ea-6c16-43c7-bdb1-9cb8ada304dc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[866267, 20992, 93, 0, 45, "Subsubsection",ExpressionUUID->"cfb74493-f898-425d-8e91-4d90c50a2157"],
Cell[866363, 20994, 3679, 94, 241, "Input",ExpressionUUID->"6aca6b0c-7305-4db1-a30d-6e095dece959"],
Cell[870045, 21090, 15668, 369, 1139, "Input",ExpressionUUID->"b09322f1-58bf-4f3d-8718-bec806aa24f0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[885750, 21464, 101, 0, 45, "Subsubsection",ExpressionUUID->"9d1ccb1f-8b24-4f8f-ba47-7fded7019e4e"],
Cell[885854, 21466, 3679, 94, 241, "Input",ExpressionUUID->"41c9806f-94b8-4d02-ae04-ef94c4e9e016"],
Cell[889536, 21562, 17304, 411, 1204, "Input",ExpressionUUID->"5974ab6e-13db-4e00-9c87-b9006dc9260a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[906877, 21978, 104, 0, 45, "Subsubsection",ExpressionUUID->"47a11008-a6c4-4886-a479-09376b05a9bd"],
Cell[906984, 21980, 3679, 94, 241, "Input",ExpressionUUID->"237d1028-5bf3-4148-89a6-ff43d9df1091"],
Cell[910666, 22076, 17304, 411, 1204, "Input",ExpressionUUID->"038e52a0-33c0-409e-bec9-540fa4082ead"]
}, Open  ]],
Cell[CellGroupData[{
Cell[928007, 22492, 271, 7, 45, "Subsubsection",ExpressionUUID->"ad1ee675-19c9-4bb5-87f7-6f5c23dc87fe"],
Cell[928281, 22501, 3679, 94, 241, "Input",ExpressionUUID->"41f2eafb-7911-420f-8c46-2daaf4790f80"],
Cell[931963, 22597, 17294, 410, 1204, "Input",ExpressionUUID->"14b10031-8666-4e0a-b81f-415a3bbaec35"]
}, Open  ]],
Cell[CellGroupData[{
Cell[949294, 23012, 271, 7, 45, "Subsubsection",ExpressionUUID->"7cd87267-c2be-498e-ba25-40560d948519"],
Cell[949568, 23021, 3679, 94, 241, "Input",ExpressionUUID->"2d1e5b20-f65e-4c54-bf3c-9f45d6712df2"],
Cell[953250, 23117, 17295, 410, 1204, "Input",ExpressionUUID->"1ccfe769-e751-49bc-8e9f-d98fcd25736c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[970582, 23532, 106, 0, 45, "Subsubsection",ExpressionUUID->"cdd4ca52-a017-4c36-baf5-a99f5ad778e9"],
Cell[970691, 23534, 3679, 94, 241, "Input",ExpressionUUID->"de35aae0-eafc-400a-b227-8ce129d0917a"],
Cell[974373, 23630, 15390, 362, 1096, "Input",ExpressionUUID->"27492e21-50be-40ed-bf2b-11a024f3cacc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[989800, 23997, 95, 0, 45, "Subsubsection",ExpressionUUID->"f3408f53-1470-4fbc-a420-68ab9b513b5d"],
Cell[989898, 23999, 3679, 94, 241, "Input",ExpressionUUID->"71fc302a-b01c-45b9-93e2-2a89905e0be5"],
Cell[993580, 24095, 15393, 362, 1096, "Input",ExpressionUUID->"59d5142a-c332-4c58-b59f-5208172f2c85"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1009010, 24462, 249, 6, 45, "Subsubsection",ExpressionUUID->"87b5b180-6800-464c-8cf9-86e78965ba97"],
Cell[1009262, 24470, 3679, 94, 241, "Input",ExpressionUUID->"0651bc90-a8fe-4302-9e6b-b8c5fb92bc8b"],
Cell[1012944, 24566, 15393, 362, 1096, "Input",ExpressionUUID->"d5c8ecb4-20ff-4027-adf6-3fad8e47a77d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1028374, 24933, 249, 6, 45, "Subsubsection",ExpressionUUID->"1fea2f03-a1cd-4796-bf70-0006266d721b"],
Cell[1028626, 24941, 3682, 94, 241, "Input",ExpressionUUID->"9cb50e31-8afc-41da-bfe8-4e823fae8b12"],
Cell[1032311, 25037, 15394, 362, 1096, "Input",ExpressionUUID->"d72e11f1-2040-4412-b40c-c71a6461c58a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1047742, 25404, 90, 0, 45, "Subsubsection",ExpressionUUID->"4edb9e72-6721-4b18-870b-ec377a2f788e"],
Cell[1047835, 25406, 3682, 94, 241, "Input",ExpressionUUID->"7c8ef4d8-98c9-4077-8302-179b47115928"],
Cell[1051520, 25502, 6562, 173, 325, "Input",ExpressionUUID->"90c718fe-3a88-4069-a272-25467d8b4830"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1058131, 25681, 82, 0, 54, "Subsection",ExpressionUUID->"997996cf-89a4-4991-8ffc-c230229c881f"],
Cell[1058216, 25683, 2553, 67, 241, "Input",ExpressionUUID->"e117c764-e5f8-418c-a297-5adadaec257b"],
Cell[1060772, 25752, 1789, 50, 191, "Input",ExpressionUUID->"5909326c-1855-4206-8845-a65d02876914"],
Cell[1062564, 25804, 2396, 68, 191, "Input",ExpressionUUID->"4db05d20-a675-4dc3-9bda-2ee9c09c5366"],
Cell[1064963, 25874, 4011, 109, 426, "Input",ExpressionUUID->"a7859a12-107c-4fbe-a4d6-d12004caf481"],
Cell[CellGroupData[{
Cell[1068999, 25987, 90, 0, 45, "Subsubsection",ExpressionUUID->"d10d8033-a66b-4393-a8cb-670cd72e5548"],
Cell[1069092, 25989, 912, 25, 94, "Input",ExpressionUUID->"da645338-f2a4-446c-be72-74ca60f5b244"],
Cell[1070007, 26016, 35080, 786, 2782, "Input",ExpressionUUID->"606d39b8-87cc-4bd9-bf59-67236fd16194"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1105124, 26807, 93, 0, 45, "Subsubsection",ExpressionUUID->"13a4823e-ac7d-411a-bfa7-214b68eed661"],
Cell[1105220, 26809, 912, 25, 94, "Input",ExpressionUUID->"358286e0-1852-4590-bd31-ee0d264e6157"],
Cell[1106135, 26836, 35080, 786, 2782, "Input",ExpressionUUID->"97722b2b-dd5e-4845-8646-8dea8c604bff"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1141252, 27627, 102, 0, 45, "Subsubsection",ExpressionUUID->"8b5a1d8f-2e7e-4610-8804-00cc69919962"],
Cell[1141357, 27629, 912, 25, 94, "Input",ExpressionUUID->"059c1c8d-d9c0-4514-804f-f6e54b939747"],
Cell[1142272, 27656, 36558, 824, 2875, "Input",ExpressionUUID->"e34fa43a-618f-455f-abf5-fcaadfe905ac"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1178867, 28485, 105, 0, 45, "Subsubsection",ExpressionUUID->"f3a0152c-b4bf-4104-9df7-9825b312236c"],
Cell[1178975, 28487, 912, 25, 94, "Input",ExpressionUUID->"0cdaf02d-030b-47ff-abd9-b2d8e5aaf998"],
Cell[1179890, 28514, 36558, 824, 2875, "Input",ExpressionUUID->"242c22bf-a27a-41e0-a95b-faf19f90b67e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1216485, 29343, 272, 7, 48, "Subsubsection",ExpressionUUID->"2d584d4e-aca4-40ea-abb1-5febd213865b"],
Cell[1216760, 29352, 912, 25, 94, "Input",ExpressionUUID->"f1930530-5934-4184-9bec-ac38bded1c6c"],
Cell[1217675, 29379, 36549, 823, 2875, "Input",ExpressionUUID->"419f4ebb-de08-4a93-b9a7-0272ae5b2cb8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1254261, 30207, 272, 7, 48, "Subsubsection",ExpressionUUID->"85c5e31b-54d9-48e7-af2e-c40d4f1a2cc6"],
Cell[1254536, 30216, 912, 25, 94, "Input",ExpressionUUID->"e82cfc9c-d286-4a5c-955d-f0bd54ee0e6c"],
Cell[1255451, 30243, 36549, 823, 2875, "Input",ExpressionUUID->"6db91dd7-71ec-4fd0-9c0d-ba5b3012ab76"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1292037, 31071, 106, 0, 45, "Subsubsection",ExpressionUUID->"013a1f16-e084-4c3e-ac42-d68210c8e57a"],
Cell[1292146, 31073, 912, 25, 94, "Input",ExpressionUUID->"2b8c8682-69fd-4f94-b209-1831d67f21a1"],
Cell[1293061, 31100, 34851, 780, 2761, "Input",ExpressionUUID->"7f4489aa-8ade-4596-8d9c-4d0058bff819"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1327949, 31885, 95, 0, 45, "Subsubsection",ExpressionUUID->"87264bae-dad2-40bc-9bd6-4728ef9f88c4"],
Cell[1328047, 31887, 912, 25, 94, "Input",ExpressionUUID->"252b1fc0-447a-4871-a3db-3122b47c9d02"],
Cell[1328962, 31914, 34854, 780, 2761, "Input",ExpressionUUID->"b19411bf-c796-49d0-b788-065d98d88ebb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1363853, 32699, 249, 6, 45, "Subsubsection",ExpressionUUID->"bf57786b-be3a-4b32-b539-b4ebb0366f3d"],
Cell[1364105, 32707, 912, 25, 94, "Input",ExpressionUUID->"35cf0d2d-ef01-4ee4-afad-a6ac1acbabb9"],
Cell[1365020, 32734, 34854, 780, 2761, "Input",ExpressionUUID->"be0a0374-2f78-40af-852a-464d3ea2cd98"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1399911, 33519, 249, 6, 45, "Subsubsection",ExpressionUUID->"691309da-dc5e-453b-b371-b7d84af6b73c"],
Cell[1400163, 33527, 915, 25, 94, "Input",ExpressionUUID->"9587ba05-32d4-4d37-a75c-ba7c5bfe1872"],
Cell[1401081, 33554, 34855, 780, 2761, "Input",ExpressionUUID->"c81072ea-4274-4e6d-8d0d-ec69e8bbfab8"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1435985, 34340, 85, 0, 54, "Subsection",ExpressionUUID->"023b24a9-16b6-4fb7-b2e9-c6cf3a306a33"],
Cell[1436073, 34342, 2553, 67, 241, "Input",ExpressionUUID->"468f27fd-8a91-44f3-9254-2d6c5d26f5ce"],
Cell[1438629, 34411, 1789, 50, 191, "Input",ExpressionUUID->"b110facb-79d2-47de-8a1f-dc5092cfec2b"],
Cell[1440421, 34463, 2396, 68, 191, "Input",ExpressionUUID->"7ca9c11b-346c-4d01-8ead-6ea875f5a953"],
Cell[1442820, 34533, 4011, 109, 426, "Input",ExpressionUUID->"087b0d9f-e776-40d6-a246-3234f96b3215"],
Cell[CellGroupData[{
Cell[1446856, 34646, 90, 0, 45, "Subsubsection",ExpressionUUID->"479e96aa-b6c4-4c6e-a00b-44d7e9a04ac0"],
Cell[1446949, 34648, 5157, 122, 388, "Input",ExpressionUUID->"6f0c0881-47e1-49d1-9273-dda0b8b971bc"],
Cell[1452109, 34772, 16338, 371, 1522, "Input",ExpressionUUID->"4d3cf1f4-020b-426a-af0d-ea7e77c05cee"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1468484, 35148, 93, 0, 45, "Subsubsection",ExpressionUUID->"2e74fbbb-c808-4225-be09-4cdaf4d7a33d"],
Cell[1468580, 35150, 5157, 122, 388, "Input",ExpressionUUID->"7d0333b0-bbb2-45d3-bb64-e540f9b0e48d"],
Cell[1473740, 35274, 16338, 371, 1522, "Input",ExpressionUUID->"03540508-00cf-42bf-ac8f-6184de1717d9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1490115, 35650, 102, 0, 45, "Subsubsection",ExpressionUUID->"c77d42dd-e2e9-4afd-908d-a66540d6bb87"],
Cell[1490220, 35652, 5157, 122, 388, "Input",ExpressionUUID->"e9e1d5cf-7953-4cbc-be87-449979859ee9"],
Cell[1495380, 35776, 17842, 411, 1615, "Input",ExpressionUUID->"08ea6c9f-7a77-4fe8-8b19-23bf1b666bb9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1513259, 36192, 105, 0, 45, "Subsubsection",ExpressionUUID->"0b5175d8-72de-44cb-b539-9edad7abdd35"],
Cell[1513367, 36194, 5157, 122, 388, "Input",ExpressionUUID->"b4ca3669-b891-4814-a52f-2652d9727f9d"],
Cell[1518527, 36318, 17842, 411, 1615, "Input",ExpressionUUID->"3becc930-f168-4e52-9efb-482064c4c8d7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1536406, 36734, 272, 7, 48, "Subsubsection",ExpressionUUID->"99b8a46f-6c71-4123-9546-859235d4f8c5"],
Cell[1536681, 36743, 5157, 122, 388, "Input",ExpressionUUID->"3d1b38a5-30d9-4707-a77a-3827704aca13"],
Cell[1541841, 36867, 17833, 410, 1615, "Input",ExpressionUUID->"fee4b97f-8959-4ebf-82be-e2e327482bc3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1559711, 37282, 272, 7, 48, "Subsubsection",ExpressionUUID->"dfb9196d-59ad-4d1a-bedd-3726a86c664e"],
Cell[1559986, 37291, 5157, 122, 388, "Input",ExpressionUUID->"7679c66c-f6c3-406a-8ee8-50b8f6cd852b"],
Cell[1565146, 37415, 17833, 410, 1615, "Input",ExpressionUUID->"4da1be35-1b66-4c82-b7a5-b692e65e1317"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1583016, 37830, 106, 0, 45, "Subsubsection",ExpressionUUID->"1b1cc39a-eb3b-419b-896c-2ff3a1f6ed48"],
Cell[1583125, 37832, 5157, 122, 388, "Input",ExpressionUUID->"35465c77-e521-4104-8a14-80dc40ff44f2"],
Cell[1588285, 37956, 16136, 367, 1501, "Input",ExpressionUUID->"53b114e5-c4bb-4f2c-a09d-4189b3900904"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1604458, 38328, 95, 0, 45, "Subsubsection",ExpressionUUID->"6324afde-8eb2-445f-9caa-3e86cfb79deb"],
Cell[1604556, 38330, 5157, 122, 388, "Input",ExpressionUUID->"c4a1f921-0343-4134-a2cd-2627f19a9726"],
Cell[1609716, 38454, 16139, 367, 1501, "Input",ExpressionUUID->"885b5041-ccce-421d-8c68-d81323cdd220"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1625892, 38826, 249, 6, 45, "Subsubsection",ExpressionUUID->"57cd3b51-98b4-46e5-8f98-842d155a92d3"],
Cell[1626144, 38834, 5157, 122, 388, "Input",ExpressionUUID->"1416d2ec-7d3f-42a7-9315-c6f5c16197d2"],
Cell[1631304, 38958, 16139, 367, 1501, "Input",ExpressionUUID->"db6add99-68f6-4732-8796-031c7be4bbfa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1647480, 39330, 249, 6, 45, "Subsubsection",ExpressionUUID->"2a7e28b7-349b-4ff2-942b-db1023561f34"],
Cell[1647732, 39338, 5160, 122, 388, "Input",ExpressionUUID->"e88fbd2d-5216-460f-ac0f-384b9da418f5"],
Cell[1652895, 39462, 16140, 367, 1501, "Input",ExpressionUUID->"5090fcf7-34fb-40cb-9182-b4269ea09712"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

