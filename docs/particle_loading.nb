(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[    633419,      17271]
NotebookOptionsPosition[    625621,      17156]
NotebookOutlinePosition[    626074,      17174]
CellTagsIndexPosition[    626031,      17171]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
This documentation describes simulation particle loading along the central \
mirror field line.\
\>", "Text",ExpressionUUID->"ea49810a-19a0-408a-9574-e6115b0b72c3"],

Cell[CellGroupData[{

Cell["Non-Relativistic Particle Loading", "Section",ExpressionUUID->"aed77aa3-6cc7-4cce-92c0-733cd30fbc93"],

Cell[TextData[{
 "According to Liouville's theorem, the phase space density, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "(", 
    RowBox[{"\[DoubleStruckV]", ",", "\[DoubleStruckR]"}], ")"}], 
   TraditionalForm]],ExpressionUUID->"6d9adb9b-907e-4650-9ada-b2f0a8f707b5"],
 ", is constant along the characteristic path.\nBy virtue of conservation of \
total energy (",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CurlyEpsilon]", "=", 
    FractionBox[
     RowBox[{"m", " ", 
      SuperscriptBox["v", "2"]}], "2"]}], TraditionalForm]],ExpressionUUID->
  "b074071b-fd20-4d3b-89a1-338d1c38bbe0"],
 ") and first adiabatic moment (",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Mu]", "=", 
    FractionBox[
     RowBox[{"m", " ", 
      SubsuperscriptBox["v", "\[UpTee]", "2"]}], 
     RowBox[{"2", "B"}]]}], TraditionalForm]],ExpressionUUID->
  "18c59466-8267-40e2-a571-7f0ee8cf0c9f"],
 "), \n",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "(", 
    RowBox[{
     RowBox[{"\[DoubleStruckV]", "(", 
      RowBox[{"\[CurlyEpsilon]", ",", "\[Mu]"}], ")"}], ",", 
     RowBox[{"\[DoubleStruckR]", "(", 
      RowBox[{"\[CurlyEpsilon]", ",", "\[Mu]"}], ")"}]}], ")"}], 
   TraditionalForm]],ExpressionUUID->"bfc16a7f-4be0-4f86-a524-97d78d99c239"],
 " is constant of motion, if ",
 Cell[BoxData[
  FormBox["f", TraditionalForm]],ExpressionUUID->
  "cd87a44c-88d5-4ec4-9480-dbcce5a74516"],
 " is gyrotropic.\n\nConservation of \[Mu]:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     SubsuperscriptBox["v", "\[UpTee]", "2"], "B"], "=", 
    FractionBox[
     SubsuperscriptBox["v", 
      RowBox[{"\[UpTee]", 
       RowBox[{",", "0"}]}], "2"], 
     SubscriptBox["B", "0"]]}], TraditionalForm]],ExpressionUUID->
  "5814d292-ec0f-4649-8123-9daa748a97c1"],
 " \[Rule] ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["v", 
     RowBox[{"\[UpTee]", 
      RowBox[{",", "0"}]}], "2"], "=", 
    RowBox[{
     FractionBox[
      SubscriptBox["B", "0"], "B"], 
     SubsuperscriptBox["v", "\[UpTee]", "2"]}]}], TraditionalForm]],
  ExpressionUUID->"f856e86c-3029-42c4-ba3a-b3f7a889cbf9"],
 ", \nwhere subscript 0 denotes quantities at the origin.\n\nConservation of \
\[CurlyEpsilon]:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubsuperscriptBox["v", "\[DoubleVerticalBar]", "2"], "+", 
     SubsuperscriptBox["v", "\[UpTee]", "2"]}], "=", 
    RowBox[{
     SubsuperscriptBox["v", 
      RowBox[{"\[DoubleVerticalBar]", 
       RowBox[{",", "0"}]}], "2"], "+", 
     SubsuperscriptBox["v", 
      RowBox[{"\[UpTee]", 
       RowBox[{",", "0"}]}], "2"]}]}], TraditionalForm]],ExpressionUUID->
  "f5aab23f-5fba-4ba3-acad-50075be5c696"],
 " \[Rule] ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["v", 
     RowBox[{"\[DoubleVerticalBar]", 
      RowBox[{",", "0"}]}], "2"], "=", 
    RowBox[{
     RowBox[{
      SubsuperscriptBox["v", "\[DoubleVerticalBar]", "2"], "+", 
      SubsuperscriptBox["v", "\[UpTee]", "2"], "-", 
      SubsuperscriptBox["v", 
       RowBox[{"\[UpTee]", 
        RowBox[{",", "0"}]}], "2"]}], "=", 
     RowBox[{
      SubsuperscriptBox["v", "\[DoubleVerticalBar]", "2"], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         FractionBox[
          SubscriptBox["B", "0"], "B"]}], ")"}], 
       SubsuperscriptBox["v", "\[UpTee]", "2"]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"076049f0-7198-4c4e-b8c9-7bc43dbc4f36"],
 "."
}], "Text",ExpressionUUID->"cd9f94c7-844a-4993-9c99-897580e19880"],

Cell[CellGroupData[{

Cell["Bi-Maxwellian velocity distribution", "Subsection",ExpressionUUID->"c8f5f4e6-12a3-4acf-9719-fb5d95658b0a"],

Cell[TextData[{
 "Consider a bi-Maxwellian velocity distribution at the origin\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["f", "0"], "[", 
     RowBox[{
      SubscriptBox["v", 
       RowBox[{"\[DoubleVerticalBar]", 
        RowBox[{",", "0"}]}]], ",", 
      SubscriptBox["v", 
       RowBox[{"\[UpTee]", 
        RowBox[{",", "0"}]}]]}], "]"}], "=", 
    RowBox[{
     SubscriptBox["n", "0"], 
     FractionBox[
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         SubsuperscriptBox["v", 
          RowBox[{"\[DoubleVerticalBar]", 
           RowBox[{",", "0"}]}], "2"]}], "/", 
        SubsuperscriptBox["\[Theta]", 
         RowBox[{"\[DoubleVerticalBar]", 
          RowBox[{",", "0"}]}], "2"]}]], 
      RowBox[{
       SqrtBox["\[Pi]"], 
       SubscriptBox["\[Theta]", 
        RowBox[{"\[DoubleVerticalBar]", 
         RowBox[{",", "0"}]}]]}]], 
     FractionBox[
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         SubsuperscriptBox["v", 
          RowBox[{"\[UpTee]", 
           RowBox[{",", "0"}]}], "2"]}], "/", 
        SubsuperscriptBox["\[Theta]", 
         RowBox[{"\[UpTee]", 
          RowBox[{",", "0"}]}], "2"]}]], 
      RowBox[{"\[Pi]", " ", 
       SubsuperscriptBox["\[Theta]", 
        RowBox[{"\[UpTee]", 
         RowBox[{",", "0"}]}], "2"]}]]}]}], TraditionalForm]],ExpressionUUID->
  "a5c63c9b-43b8-46cc-ad85-bab6b74eb3b1"],
 ".\nSubstituting ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["v", 
     RowBox[{"\[DoubleVerticalBar]", 
      RowBox[{",", "0"}]}]], "(", 
    RowBox[{
     SubscriptBox["v", "\[DoubleVerticalBar]"], ",", 
     SubscriptBox["v", "\[UpTee]"]}], ")"}], TraditionalForm]],ExpressionUUID->
  "a104ce08-d3cb-4435-be95-c07bbbe13bb5"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["v", 
     RowBox[{"\[UpTee]", 
      RowBox[{",", "0"}]}]], "(", 
    RowBox[{
     SubscriptBox["v", "\[DoubleVerticalBar]"], ",", 
     SubscriptBox["v", "\[UpTee]"]}], ")"}], TraditionalForm]],ExpressionUUID->
  "9685a158-5e88-4139-9fe2-38be842da582"],
 " from above, the distribution at a given location can be obtained from\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{
      SubscriptBox["v", "\[DoubleVerticalBar]"], ",", 
      SubscriptBox["v", "\[UpTee]"]}], "]"}], "=", 
    RowBox[{
     SubscriptBox["f", "0"], "[", 
     RowBox[{
      SqrtBox[
       RowBox[{
        SubsuperscriptBox["v", "\[DoubleVerticalBar]", "2"], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            SubscriptBox["B", "0"], "B"]}], ")"}], 
         SubsuperscriptBox["v", "\[UpTee]", "2"]}]}]], ",", 
      RowBox[{
       SqrtBox[
        FractionBox[
         SubscriptBox["B", "0"], "B"]], 
       SubscriptBox["v", "\[UpTee]"]}]}], "]"}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     SubscriptBox["n", "0"], 
     FractionBox["1", 
      RowBox[{
       SqrtBox["\[Pi]"], 
       SubscriptBox["\[Theta]", 
        RowBox[{"\[DoubleVerticalBar]", 
         RowBox[{",", "0"}]}]]}]], 
     FractionBox["1", 
      RowBox[{"\[Pi]", " ", 
       SubsuperscriptBox["\[Theta]", 
        RowBox[{"\[UpTee]", 
         RowBox[{",", "0"}]}], "2"]}]], 
     RowBox[{"Exp", "[", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SubsuperscriptBox["v", "\[DoubleVerticalBar]", "2"], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            FractionBox[
             SubscriptBox["B", "0"], "B"]}], ")"}], 
          SubsuperscriptBox["v", "\[UpTee]", "2"]}]}], 
        SubsuperscriptBox["\[Theta]", 
         RowBox[{"\[DoubleVerticalBar]", 
          RowBox[{",", "0"}]}], "2"]]}], "]"}], 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SubscriptBox["B", "0"], "B"]}], 
       FractionBox[
        SubsuperscriptBox["v", "\[UpTee]", "2"], 
        SubsuperscriptBox["\[Theta]", 
         RowBox[{"\[UpTee]", 
          RowBox[{",", "0"}]}], "2"]]}], "]"}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     SubscriptBox["n", "0"], 
     FractionBox["1", 
      RowBox[{
       SqrtBox["\[Pi]"], 
       SubscriptBox["\[Theta]", 
        RowBox[{"\[DoubleVerticalBar]", 
         RowBox[{",", "0"}]}]]}]], 
     FractionBox["1", 
      RowBox[{"\[Pi]", " ", 
       SubsuperscriptBox["\[Theta]", 
        RowBox[{"\[UpTee]", 
         RowBox[{",", "0"}]}], "2"]}]], 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SubsuperscriptBox["v", "\[DoubleVerticalBar]", "2"], 
         SubsuperscriptBox["\[Theta]", 
          RowBox[{"\[DoubleVerticalBar]", 
           RowBox[{",", "0"}]}], "2"]]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox[
           SubscriptBox["B", "0"], "B"]}], ")"}], 
        FractionBox[
         SubsuperscriptBox["v", "\[UpTee]", "2"], 
         SubsuperscriptBox["\[Theta]", 
          RowBox[{"\[DoubleVerticalBar]", 
           RowBox[{",", "0"}]}], "2"]]}]}], "]"}], 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SubscriptBox["B", "0"], "B"]}], 
       FractionBox[
        SubsuperscriptBox["v", "\[UpTee]", "2"], 
        SubsuperscriptBox["\[Theta]", 
         RowBox[{"\[UpTee]", 
          RowBox[{",", "0"}]}], "2"]]}], "]"}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     SubscriptBox["n", "0"], 
     FractionBox["1", 
      RowBox[{
       SqrtBox["\[Pi]"], 
       SubscriptBox["\[Theta]", 
        RowBox[{"\[DoubleVerticalBar]", 
         RowBox[{",", "0"}]}]]}]], 
     FractionBox["1", 
      RowBox[{"\[Pi]", " ", 
       SubsuperscriptBox["\[Theta]", 
        RowBox[{"\[UpTee]", 
         RowBox[{",", "0"}]}], "2"]}]], 
     RowBox[{"Exp", "[", 
      RowBox[{"-", 
       FractionBox[
        SubsuperscriptBox["v", "\[DoubleVerticalBar]", "2"], 
        SubsuperscriptBox["\[Theta]", 
         RowBox[{"\[DoubleVerticalBar]", 
          RowBox[{",", "0"}]}], "2"]]}], "]"}], 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            SubscriptBox["B", "0"], "B"]}], ")"}]}], 
        FractionBox[
         SubsuperscriptBox["v", "\[UpTee]", "2"], 
         SubsuperscriptBox["\[Theta]", 
          RowBox[{"\[DoubleVerticalBar]", 
           RowBox[{",", "0"}]}], "2"]]}], "-", 
       RowBox[{
        FractionBox[
         SubscriptBox["B", "0"], "B"], 
        FractionBox[
         SubsuperscriptBox["v", "\[UpTee]", "2"], 
         SubsuperscriptBox["\[Theta]", 
          RowBox[{"\[UpTee]", 
           RowBox[{",", "0"}]}], "2"]]}]}], "]"}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     SubscriptBox["n", "0"], 
     FractionBox["1", 
      RowBox[{
       SqrtBox["\[Pi]"], 
       SubscriptBox["\[Theta]", 
        RowBox[{"\[DoubleVerticalBar]", 
         RowBox[{",", "0"}]}]]}]], 
     FractionBox["1", 
      RowBox[{"\[Pi]", " ", 
       SubsuperscriptBox["\[Theta]", 
        RowBox[{"\[UpTee]", 
         RowBox[{",", "0"}]}], "2"]}]], 
     RowBox[{"Exp", "[", 
      RowBox[{"-", 
       FractionBox[
        SubsuperscriptBox["v", "\[DoubleVerticalBar]", "2"], 
        SubsuperscriptBox["\[Theta]", 
         RowBox[{"\[DoubleVerticalBar]", 
          RowBox[{",", "0"}]}], "2"]]}], "]"}], 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             FractionBox[
              SubscriptBox["B", "0"], "B"]}], ")"}], 
           FractionBox[
            SubsuperscriptBox["\[Theta]", 
             RowBox[{"\[UpTee]", 
              RowBox[{",", "0"}]}], "2"], 
            SubsuperscriptBox["\[Theta]", 
             RowBox[{"\[DoubleVerticalBar]", 
              RowBox[{",", "0"}]}], "2"]]}], "+", 
          FractionBox[
           SubscriptBox["B", "0"], "B"]}], ")"}]}], 
       FractionBox[
        SubsuperscriptBox["v", "\[UpTee]", "2"], 
        SubsuperscriptBox["\[Theta]", 
         RowBox[{"\[UpTee]", 
          RowBox[{",", "0"}]}], "2"]]}], "]"}]}]}], TraditionalForm]}],
  ExpressionUUID->"f0a869e2-ac73-4414-8296-779fe765de3e"],
 ".\nExpressing it using new thermal speeds \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["\[Theta]", "\[DoubleVerticalBar]", "2"], "=", 
    SubsuperscriptBox["\[Theta]", 
     RowBox[{"\[DoubleVerticalBar]", 
      RowBox[{",", "0"}]}], "2"]}], TraditionalForm]],ExpressionUUID->
  "d0a6d150-ebc8-4f0b-b18c-058299043213"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["\[Theta]", "\[UpTee]", "2"], "=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            SubscriptBox["B", "0"], "B"]}], ")"}], 
         FractionBox[
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}], "2"], 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}], "2"]]}], "+", 
        FractionBox[
         SubscriptBox["B", "0"], "B"]}], ")"}], 
      RowBox[{"-", "1"}]], 
     SubsuperscriptBox["\[Theta]", 
      RowBox[{"\[UpTee]", 
       RowBox[{",", "0"}]}], "2"]}]}], TraditionalForm]],ExpressionUUID->
  "8fbcd009-5b78-4431-ace8-6dd1b17037f4"],
 " \nand a new number density \n",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            SubscriptBox["B", "0"], "B"]}], ")"}], 
         FractionBox[
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}], "2"], 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}], "2"]]}], "+", 
        FractionBox[
         SubscriptBox["B", "0"], "B"]}], ")"}], 
      RowBox[{"-", "1"}]], 
     SubscriptBox["n", "0"]}]}], TraditionalForm]],ExpressionUUID->
  "c5f3ecdb-c8f4-43af-87de-4e2250260e66"],
 " \nyields\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{
      SubscriptBox["v", "\[DoubleVerticalBar]"], ",", 
      SubscriptBox["v", "\[UpTee]"]}], "]"}], "=", 
    RowBox[{"n", 
     FractionBox["1", 
      RowBox[{
       SqrtBox["\[Pi]"], 
       SubscriptBox["\[Theta]", "\[DoubleVerticalBar]"]}]], 
     FractionBox["1", 
      RowBox[{"\[Pi]", " ", 
       SubsuperscriptBox["\[Theta]", "\[UpTee]", "2"]}]], 
     RowBox[{"Exp", "[", 
      RowBox[{"-", 
       FractionBox[
        SubsuperscriptBox["v", "\[DoubleVerticalBar]", "2"], 
        SubsuperscriptBox["\[Theta]", "\[DoubleVerticalBar]", "2"]]}], "]"}], 
     
     RowBox[{"Exp", "[", 
      RowBox[{"-", 
       FractionBox[
        SubsuperscriptBox["v", "\[UpTee]", "2"], 
        SubsuperscriptBox["\[Theta]", "\[UpTee]", "2"]]}], "]"}]}]}], 
   TraditionalForm]],ExpressionUUID->"b11264e4-17e0-45d5-8f09-6e748127ab11"],
 ".\nHence, the distribution at any location along the field line is a \
bi-Maxwellian with adjusted thermal speeds.\nWe can write the following macro \
variables in terms of the ones at origin:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["T", "\[DoubleVerticalBar]"], "=", 
    SubscriptBox["T", 
     RowBox[{"\[DoubleVerticalBar]", 
      RowBox[{",", "0"}]}]]}], TraditionalForm]],ExpressionUUID->
  "39ba05bf-5022-40af-82d1-f1cd7958de8f"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["T", "\[UpTee]"], "=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            SubscriptBox["B", "0"], "B"]}], ")"}], 
         FractionBox[
          SubscriptBox["T", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}]], 
          SubscriptBox["T", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}]]]}], "+", 
        FractionBox[
         SubscriptBox["B", "0"], "B"]}], ")"}], 
      RowBox[{"-", "1"}]], 
     SubscriptBox["T", 
      RowBox[{"\[UpTee]", 
       RowBox[{",", "0"}]}]]}]}], TraditionalForm]],ExpressionUUID->
  "e119e66c-aa47-4668-8731-8782c34b3504"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            SubscriptBox["B", "0"], "B"]}], ")"}], 
         FractionBox[
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}], "2"], 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}], "2"]]}], "+", 
        FractionBox[
         SubscriptBox["B", "0"], "B"]}], ")"}], 
      RowBox[{"-", "1"}]], 
     SubscriptBox["n", "0"]}]}], TraditionalForm]],ExpressionUUID->
  "7a35d305-0c6e-48fe-96e1-3de117198812"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["P", "\[DoubleVerticalBar]"], "=", 
    RowBox[{
     RowBox[{"n", " ", 
      SubscriptBox["T", "\[DoubleVerticalBar]"]}], "=", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             FractionBox[
              SubscriptBox["B", "0"], "B"]}], ")"}], 
           FractionBox[
            SubsuperscriptBox["\[Theta]", 
             RowBox[{"\[UpTee]", 
              RowBox[{",", "0"}]}], "2"], 
            SubsuperscriptBox["\[Theta]", 
             RowBox[{"\[DoubleVerticalBar]", 
              RowBox[{",", "0"}]}], "2"]]}], "+", 
          FractionBox[
           SubscriptBox["B", "0"], "B"]}], ")"}], 
        RowBox[{"-", "1"}]], 
       SubscriptBox["n", "0"], 
       SubscriptBox["T", 
        RowBox[{"\[DoubleVerticalBar]", 
         RowBox[{",", "0"}]}]]}], "=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             FractionBox[
              SubscriptBox["B", "0"], "B"]}], ")"}], 
           FractionBox[
            SubsuperscriptBox["\[Theta]", 
             RowBox[{"\[UpTee]", 
              RowBox[{",", "0"}]}], "2"], 
            SubsuperscriptBox["\[Theta]", 
             RowBox[{"\[DoubleVerticalBar]", 
              RowBox[{",", "0"}]}], "2"]]}], "+", 
          FractionBox[
           SubscriptBox["B", "0"], "B"]}], ")"}], 
        RowBox[{"-", "1"}]], 
       SubscriptBox["P", 
        RowBox[{"\[DoubleVerticalBar]", 
         RowBox[{",", "0"}]}]]}]}]}]}], TraditionalForm]],ExpressionUUID->
  "9238f6dd-a1b3-450b-a5f2-e1104f4f69a8"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["P", "\[UpTee]"], "=", 
    RowBox[{
     RowBox[{"n", " ", 
      SubscriptBox["T", "\[UpTee]"]}], "=", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             FractionBox[
              SubscriptBox["B", "0"], "B"]}], ")"}], 
           FractionBox[
            SubsuperscriptBox["\[Theta]", 
             RowBox[{"\[UpTee]", 
              RowBox[{",", "0"}]}], "2"], 
            SubsuperscriptBox["\[Theta]", 
             RowBox[{"\[DoubleVerticalBar]", 
              RowBox[{",", "0"}]}], "2"]]}], "+", 
          FractionBox[
           SubscriptBox["B", "0"], "B"]}], ")"}], 
        RowBox[{"-", "2"}]], 
       SubscriptBox["n", "0"], 
       SubscriptBox["T", 
        RowBox[{"\[UpTee]", 
         RowBox[{",", "0"}]}]]}], "=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             FractionBox[
              SubscriptBox["B", "0"], "B"]}], ")"}], 
           FractionBox[
            SubsuperscriptBox["\[Theta]", 
             RowBox[{"\[UpTee]", 
              RowBox[{",", "0"}]}], "2"], 
            SubsuperscriptBox["\[Theta]", 
             RowBox[{"\[DoubleVerticalBar]", 
              RowBox[{",", "0"}]}], "2"]]}], "+", 
          FractionBox[
           SubscriptBox["B", "0"], "B"]}], ")"}], 
        RowBox[{"-", "2"}]], 
       SubscriptBox["P", 
        RowBox[{"\[UpTee]", 
         RowBox[{",", "0"}]}]]}]}]}]}], TraditionalForm]],ExpressionUUID->
  "6bf8f670-d0d2-4ada-abd1-59b666ca111d"],
 "."
}], "Text",ExpressionUUID->"db1d95a5-d8b6-41cc-9071-21953d181309"],

Cell[TextData[{
 "Since we are concerned with the central field line of the mirror magnetic \
field,\nwe can substitute ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"B", "(", "x", ")"}], 
     SubscriptBox["B", "0"]], "=", 
    RowBox[{
     FractionBox[
      RowBox[{
       SubscriptBox["B", "x"], "(", "x", ")"}], 
      SubscriptBox["B", "0"]], "=", 
     RowBox[{
      RowBox[{"1", "+", 
       RowBox[{
        SuperscriptBox["\[Xi]", "2"], 
        SuperscriptBox["x", "2"]}]}], "=", 
      RowBox[{
       SuperscriptBox["sec", "2"], "(", 
       RowBox[{"\[Xi]", " ", 
        SubscriptBox["\[CapitalDelta]", "1"], 
        SuperscriptBox["q", "1"]}], ")"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"e116c216-e893-4732-a00c-298da092c56f"],
 " to the common factor:\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{"\[Eta]", "=", 
    RowBox[{
     FractionBox["n", 
      SubscriptBox["n", "0"]], "=", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            FractionBox[
             SubscriptBox["B", "0"], "B"]}], ")"}], 
          FractionBox[
           SubsuperscriptBox["\[Theta]", 
            RowBox[{"\[UpTee]", 
             RowBox[{",", "0"}]}], "2"], 
           SubsuperscriptBox["\[Theta]", 
            RowBox[{"\[DoubleVerticalBar]", 
             RowBox[{",", "0"}]}], "2"]]}], "+", 
         FractionBox[
          SubscriptBox["B", "0"], "B"]}], ")"}], 
       RowBox[{"-", "1"}]], "=", 
      FractionBox[
       RowBox[{"B", "/", 
        SubscriptBox["B", "0"]}], 
       RowBox[{"1", "-", 
        RowBox[{
         FractionBox[
          SubscriptBox["T", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}]], 
          SubscriptBox["T", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}]]], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox["B", 
            SubscriptBox["B", "0"]]}], ")"}]}]}]]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     FractionBox[
      RowBox[{"1", "+", 
       RowBox[{
        SuperscriptBox["\[Xi]", "2"], 
        SuperscriptBox["x", "2"]}]}], 
      RowBox[{"1", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["T", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}]], "/", 
          SubscriptBox["T", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}]]}], ")"}], 
        SuperscriptBox["\[Xi]", "2"], 
        SuperscriptBox["x", "2"]}]}]], "=", 
     FractionBox[
      RowBox[{"1", "+", 
       RowBox[{
        SuperscriptBox["\[Xi]", "2"], 
        SuperscriptBox["x", "2"]}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          SqrtBox[
           RowBox[{
            SubscriptBox["T", 
             RowBox[{"\[UpTee]", 
              RowBox[{",", "0"}]}]], "/", 
            SubscriptBox["T", 
             RowBox[{"\[DoubleVerticalBar]", 
              RowBox[{",", "0"}]}]]}]], "\[Xi]", " ", "x"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          SqrtBox[
           RowBox[{
            SubscriptBox["T", 
             RowBox[{"\[UpTee]", 
              RowBox[{",", "0"}]}]], "/", 
            SubscriptBox["T", 
             RowBox[{"\[DoubleVerticalBar]", 
              RowBox[{",", "0"}]}]]}]], "\[Xi]", " ", "x"}]}], ")"}]}]]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     FractionBox[
      RowBox[{
       SuperscriptBox["sec", "2"], "(", 
       RowBox[{"\[Xi]", " ", 
        SubscriptBox["\[CapitalDelta]", "1"], 
        SuperscriptBox["q", "1"]}], ")"}], 
      RowBox[{"1", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["T", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}]], "/", 
          SubscriptBox["T", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}]]}], ")"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           SuperscriptBox["sec", "2"], "(", 
           RowBox[{"\[Xi]", " ", 
            SubscriptBox["\[CapitalDelta]", "1"], 
            SuperscriptBox["q", "1"]}], ")"}]}], ")"}]}]}]], "=", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["T", 
          RowBox[{"\[UpTee]", 
           RowBox[{",", "0"}]}]], "/", 
         SubscriptBox["T", 
          RowBox[{"\[DoubleVerticalBar]", 
           RowBox[{",", "0"}]}]]}], ")"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["T", 
             RowBox[{"\[UpTee]", 
              RowBox[{",", "0"}]}]], "/", 
            SubscriptBox["T", 
             RowBox[{"\[DoubleVerticalBar]", 
              RowBox[{",", "0"}]}]]}], ")"}]}], ")"}], 
        RowBox[{
         SuperscriptBox["cos", "2"], "(", 
         RowBox[{"\[Xi]", " ", 
          SubscriptBox["\[CapitalDelta]", "1"], 
          SuperscriptBox["q", "1"]}], ")"}]}]}]]}]}], TraditionalForm]}],
  ExpressionUUID->"fb08b4b6-e469-49f6-b5a3-f65d40f1bf0b"],
 ".\nNote that ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Eta]", "=", "1"}], TraditionalForm]],ExpressionUUID->
  "b68d4c14-14ab-4197-b24c-1391ad88c436"],
 " if ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Xi]", "=", "0"}], TraditionalForm]],ExpressionUUID->
  "3cd71752-606d-4bd0-8281-d2b4d9d44b0b"],
 " or ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["T", 
      RowBox[{"\[UpTee]", 
       RowBox[{",", "0"}]}]], "/", 
     SubscriptBox["T", 
      RowBox[{"\[DoubleVerticalBar]", 
       RowBox[{",", "0"}]}]]}], "=", "1"}], TraditionalForm]],ExpressionUUID->
  "d16e67d1-cf72-416f-88f6-d3df03186d14"],
 ".\nThe number of particles in a differential volume, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[DifferentialD]", "V"}], TraditionalForm]],ExpressionUUID->
  "244eaa48-0522-496b-8a8b-21a535f1f68f"],
 ", is given by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[DifferentialD]", "N"}], "=", 
    RowBox[{"n", 
     RowBox[{"\[DifferentialD]", "V"}]}]}], TraditionalForm]],ExpressionUUID->
  "0f7bbed2-4d6f-4237-842c-62472991fe56"],
 ".\nSince ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[DifferentialD]", "V"}], "=", 
    RowBox[{
     SubscriptBox["\[CapitalDelta]", "1"], 
     SubscriptBox["\[CapitalDelta]", "2"], 
     SubscriptBox["\[CapitalDelta]", "3"], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "1"]}], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "2"]}], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "3"]}]}]}], TraditionalForm]],ExpressionUUID->
  "da156c82-b841-4e56-a3ab-bacecd1309dd"],
 " is constant in terms of curvilinear coordinates, \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[DifferentialD]", "N"}], "\[Proportional]", 
    RowBox[{"\[Eta]", "(", 
     SuperscriptBox["q", "1"], ")"}]}], TraditionalForm]],ExpressionUUID->
  "168df8c4-7df9-472d-9591-5a650255eed2"],
 ".\nConsidering a flux tube of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[DifferentialD]", 
     SuperscriptBox["q", "2"]}], "\[Times]", 
    RowBox[{"\[DifferentialD]", 
     SuperscriptBox["q", "3"]}]}], TraditionalForm]],ExpressionUUID->
  "df6a0fb4-c505-4fe0-a207-40df98e707d5"],
 " wide, the integrated number of particles with respect to ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["q", "1"], TraditionalForm]],ExpressionUUID->
  "6f355f25-43b4-4937-bc0a-f318c1566a96"],
 " is given by\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"N", "(", 
      SuperscriptBox["q", "1"], ")"}], 
     SubscriptBox["n", "0"]], "=", 
    RowBox[{
     SubscriptBox["\[CapitalDelta]", "1"], 
     SubscriptBox["\[CapitalDelta]", "2"], 
     SubscriptBox["\[CapitalDelta]", "3"], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "2"]}], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "3"]}], 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", 
       SuperscriptBox["q", "1"]], 
      RowBox[{
       RowBox[{"\[Eta]", "(", 
        SuperscriptBox["q", "1"], ")"}], 
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox["q", "1"]}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     SubscriptBox["\[CapitalDelta]", "1"], 
     SubscriptBox["\[CapitalDelta]", "2"], 
     SubscriptBox["\[CapitalDelta]", "3"], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "2"]}], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "3"]}], 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", 
       SuperscriptBox["q", "1"]], 
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox["q", "1"]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["T", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}]], "/", 
          SubscriptBox["T", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}]]}], ")"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["T", 
              RowBox[{"\[UpTee]", 
               RowBox[{",", "0"}]}]], "/", 
             SubscriptBox["T", 
              RowBox[{"\[DoubleVerticalBar]", 
               RowBox[{",", "0"}]}]]}], ")"}]}], ")"}], 
         RowBox[{
          SuperscriptBox["cos", "2"], "(", 
          RowBox[{"\[Xi]", " ", 
           SubscriptBox["\[CapitalDelta]", "1"], 
           SuperscriptBox["q", "1"]}], ")"}]}]}]]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     FractionBox[
      RowBox[{
       SubscriptBox["\[CapitalDelta]", "2"], 
       SubscriptBox["\[CapitalDelta]", "3"], 
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox["q", "2"]}], 
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox["q", "3"]}]}], "\[Xi]"], 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", 
       SuperscriptBox["q", "1"]], 
      FractionBox[
       RowBox[{"\[Xi]", " ", 
        SubscriptBox["\[CapitalDelta]", "1"], 
        RowBox[{"\[DifferentialD]", 
         SuperscriptBox["q", "1"]}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["T", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}]], "/", 
          SubscriptBox["T", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}]]}], ")"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["T", 
              RowBox[{"\[UpTee]", 
               RowBox[{",", "0"}]}]], "/", 
             SubscriptBox["T", 
              RowBox[{"\[DoubleVerticalBar]", 
               RowBox[{",", "0"}]}]]}], ")"}]}], ")"}], 
         RowBox[{
          SuperscriptBox["cos", "2"], "(", 
          RowBox[{"\[Xi]", " ", 
           SubscriptBox["\[CapitalDelta]", "1"], 
           SuperscriptBox["q", "1"]}], ")"}]}]}]]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     SubscriptBox["\[CapitalDelta]", "1"], 
     SubscriptBox["\[CapitalDelta]", "2"], 
     SubscriptBox["\[CapitalDelta]", "3"], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "2"]}], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "3"]}], 
     FractionBox[
      RowBox[{
       SuperscriptBox["tan", 
        RowBox[{"-", "1"}]], "(", 
       RowBox[{
        SqrtBox[
         RowBox[{
          SubscriptBox["T", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}]], "/", 
          SubscriptBox["T", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}]]}]], 
        RowBox[{"tan", "(", 
         RowBox[{"\[Xi]", " ", 
          SubscriptBox["\[CapitalDelta]", "1"], 
          SuperscriptBox["q", "1"]}], ")"}]}], ")"}], 
      RowBox[{
       SqrtBox[
        RowBox[{
         SubscriptBox["T", 
          RowBox[{"\[UpTee]", 
           RowBox[{",", "0"}]}]], "/", 
         SubscriptBox["T", 
          RowBox[{"\[DoubleVerticalBar]", 
           RowBox[{",", "0"}]}]]}]], 
       SubscriptBox["\[CapitalDelta]", "1"], "\[Xi]"}]]}]}], 
   TraditionalForm]}],ExpressionUUID->
  "a20abf5a-9058-4c4b-a38d-c00587890c53"],
 ",\nwhere ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"N", "(", "0", ")"}], "=", "0"}], TraditionalForm]],
  ExpressionUUID->"c16f211a-2bba-427f-a211-d641af7f5623"],
 ".\nFor small \[Xi], \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"N", "(", 
      SuperscriptBox["q", "1"], ")"}], 
     SubscriptBox["n", "0"]], "\[TildeTilde]", 
    RowBox[{
     SuperscriptBox["q", "1"], 
     SubscriptBox["\[CapitalDelta]", "1"], 
     SubscriptBox["\[CapitalDelta]", "2"], 
     SubscriptBox["\[CapitalDelta]", "3"], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "2"]}], 
     RowBox[{"\[DifferentialD]", 
      RowBox[{
       SuperscriptBox["q", "3"], "(", 
       RowBox[{"1", "-", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{
            SubscriptBox["T", 
             RowBox[{"\[UpTee]", 
              RowBox[{",", "0"}]}]], "/", 
            SubscriptBox["T", 
             RowBox[{"\[DoubleVerticalBar]", 
              RowBox[{",", "0"}]}]]}], "-", "1"}], "3"], 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox["\[Xi]", "2"], "(", 
           RowBox[{
            SubscriptBox["\[CapitalDelta]", "1"], 
            SuperscriptBox["q", "1"]}], ")"}], "2"]}]}], ")"}]}]}]}], 
   TraditionalForm]],ExpressionUUID->"41764b98-807c-4fcc-85b4-99bff2c2bb90"],
 ".\nThe inverse relation ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["q", "1"], "(", "N", ")"}], TraditionalForm]],
  ExpressionUUID->"d8e87379-c548-412b-b68e-85f19ff5b4f6"],
 " is given by\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["q", "1"], "(", "N", ")"}], "=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"\[Xi]", " ", 
       SubscriptBox["\[CapitalDelta]", "1"]}]], 
     RowBox[{
      SuperscriptBox["tan", 
       RowBox[{"-", "1"}]], "(", 
      RowBox[{
       FractionBox["1", 
        SqrtBox[
         RowBox[{
          SubscriptBox["T", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}]], "/", 
          SubscriptBox["T", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}]]}]]], 
       RowBox[{"tan", "(", 
        RowBox[{
         FractionBox[
          RowBox[{
           SqrtBox[
            RowBox[{
             SubscriptBox["T", 
              RowBox[{"\[UpTee]", 
               RowBox[{",", "0"}]}]], "/", 
             SubscriptBox["T", 
              RowBox[{"\[DoubleVerticalBar]", 
               RowBox[{",", "0"}]}]]}]], 
           SubscriptBox["\[CapitalDelta]", "1"], "\[Xi]"}], 
          RowBox[{
           SubscriptBox["\[CapitalDelta]", "1"], 
           SubscriptBox["\[CapitalDelta]", "2"], 
           SubscriptBox["\[CapitalDelta]", "3"], 
           RowBox[{"\[DifferentialD]", 
            SuperscriptBox["q", "2"]}], 
           RowBox[{"\[DifferentialD]", 
            SuperscriptBox["q", "3"]}]}]], 
         FractionBox["N", 
          SubscriptBox["n", "0"]]}], ")"}]}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"cb32ad13-d619-4c00-b35e-06e8f77d371a"],
 ".\nFor small \[Xi], \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["q", "1"], "(", "N", ")"}], "\[TildeTilde]", 
    RowBox[{
     FractionBox[
      RowBox[{"N", "/", 
       SubscriptBox["n", "0"]}], 
      RowBox[{
       SubscriptBox["\[CapitalDelta]", "1"], 
       SubscriptBox["\[CapitalDelta]", "2"], 
       SubscriptBox["\[CapitalDelta]", "3"], 
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox["q", "2"]}], 
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox["q", "3"]}]}]], 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{
           SubscriptBox["T", 
            RowBox[{"\[UpTee]", 
             RowBox[{",", "0"}]}]], "/", 
           SubscriptBox["T", 
            RowBox[{"\[DoubleVerticalBar]", 
             RowBox[{",", "0"}]}]]}], "-", "1"}], "3"], 
        SuperscriptBox["\[Xi]", "2"], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["\[CapitalDelta]", "1"], 
           FractionBox["N", 
            SubscriptBox["n", "0"]]}], ")"}], "2"]}]}], ")"}]}]}], 
   TraditionalForm]],ExpressionUUID->"688dd9dd-d7ab-4c67-8362-0ccf050b7456"],
 "."
}], "Text",ExpressionUUID->"145932c4-25a7-4a16-8bcc-38d7898d5314"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"T2OT1", "=", "5.35"}], ",", 
     RowBox[{"\[Xi]", "=", ".876"}], ",", 
     RowBox[{"q1lim", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "24"}], ",", "50"}], "}"}]}], ",", 
     RowBox[{"\[Xi]\[CapitalDelta]1q1max", "=", 
      RowBox[{
       RowBox[{"Pi", "/", "2"}], "*", ".8"}]}], ",", 
     RowBox[{"nsamples", "=", "50000"}]}], "}"}], ",", "\[IndentingNewLine]", 
   
   RowBox[{"BlockRandom", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "49038", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[CapitalDelta]1", ",", "q1s", ",", "Bs", ",", "\[Eta]s", ",", "xs", 
         ",", "Nofq1", ",", "tmp", ",", "q1ofN", ",", "q1samples", ",", 
         "bins", ",", "hist"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[CapitalDelta]1", "=", 
         RowBox[{"Divide", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1q1max", ",", 
           RowBox[{"\[Xi]", " ", 
            RowBox[{"Max", "[", 
             RowBox[{"Abs", "[", "q1lim", "]"}], "]"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"q1s", "=", 
         RowBox[{"Range", "@@", "q1lim"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xs", "=", 
         RowBox[{
          RowBox[{"Tan", "[", 
           RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1s"}], "]"}], "/",
           "\[Xi]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Bs", "=", 
         RowBox[{
          RowBox[{"Sec", "[", 
           RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1s"}], "]"}], "^",
           "2"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Eta]s", "=", 
         RowBox[{"Divide", "[", 
          RowBox[{"1", ",", 
           RowBox[{"T2OT1", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "T2OT1"}], ")"}], 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1s"}], "]"}], 
              "^", "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"Apply", "[", 
            RowBox[{"And", ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"0", "==", 
               RowBox[{"Chop", "[", 
                RowBox[{"\[Eta]s", "-", 
                 RowBox[{"Power", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"1", "/", "Bs"}]}], ")"}], "T2OT1"}], "+", 
                    RowBox[{"1", "/", "Bs"}]}], ",", 
                   RowBox[{"-", "1"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
          ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<\[Eta]s incorrect\>\"", "]"}], ";", 
            RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Nofq1", "=", 
         RowBox[{
          RowBox[{"ArcTan", "[", 
           RowBox[{
            SqrtBox["T2OT1"], 
            RowBox[{"Tan", "[", 
             RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1s"}], "]"}]}], 
           "]"}], "/", 
          RowBox[{"(", 
           RowBox[{"\[Xi]", 
            SqrtBox["T2OT1"]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{"MinMax", "[", "Nofq1", "]"}], "-", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"NIntegrate", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Power", "[", 
                 RowBox[{
                  RowBox[{"T2OT1", "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "T2OT1"}], ")"}], 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1"}], 
                    "]"}], "^", "2"}]}]}], ",", 
                  RowBox[{"-", "1"}]}], "]"}], "\[CapitalDelta]1"}], ",", 
               RowBox[{"{", 
                RowBox[{"q1", ",", "0", ",", "#"}], "}"}]}], "]"}], "&"}], 
            ",", 
            RowBox[{"MinMax", "[", "q1s", "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"Apply", "[", 
            RowBox[{"And", ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"0", "==", 
               RowBox[{"Chop", "[", "tmp", "]"}]}], "]"}]}], "]"}]}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<N(q1) incorrect\>\"", "]"}], ";", 
            RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"q1ofN", "=", 
         RowBox[{
          RowBox[{"ArcTan", "[", 
           RowBox[{
            RowBox[{"Tan", "[", 
             RowBox[{
              SqrtBox["T2OT1"], "\[Xi]", " ", "Nofq1"}], "]"}], "/", 
            SqrtBox["T2OT1"]}], "]"}], "/", 
          RowBox[{"(", 
           RowBox[{"\[Xi]", " ", "\[CapitalDelta]1"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"Apply", "[", 
            RowBox[{"And", ",", 
             RowBox[{"Thread", "[", 
              RowBox[{
               RowBox[{"Chop", "[", 
                RowBox[{"q1s", "-", "q1ofN"}], "]"}], "==", "0"}], "]"}]}], 
            "]"}]}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<q1(N) incorrect\>\"", "]"}], ";", 
            RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"q1samples", "=", 
         RowBox[{
          RowBox[{"ArcTan", "[", 
           RowBox[{
            RowBox[{"Tan", "[", 
             RowBox[{
              SqrtBox["T2OT1"], "\[Xi]", " ", 
              RowBox[{"RandomReal", "[", 
               RowBox[{
                RowBox[{"MinMax", "[", "Nofq1", "]"}], ",", "nsamples"}], 
               "]"}]}], "]"}], "/", 
            SqrtBox["T2OT1"]}], "]"}], "/", 
          RowBox[{"(", 
           RowBox[{"\[Xi]", " ", "\[CapitalDelta]1"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"bins", ",", "hist"}], "}"}], "=", 
         RowBox[{"N", "@", 
          RowBox[{"HistogramList", "[", 
           RowBox[{"q1samples", ",", 
            RowBox[{"Append", "[", 
             RowBox[{"q1lim", ",", "1"}], "]"}], ",", "\"\<Count\>\""}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bins", "=", 
         RowBox[{"Flatten", "[", "bins", "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{"#", ",", "\[IndentingNewLine]", 
            RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
           "]"}], "&"}], "/@", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"q1s", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
                RowBox[{"{", 
                 RowBox[{"\[Eta]s", ",", 
                  RowBox[{"\[Eta]s", "^", "2"}]}], "}"}]}], ",", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               RowBox[{"AxesLabel", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<\\!\\(\!\(\*SuperscriptBox[\(q\), \(1\)]\)\\)\>\"", 
                  ",", "\"\<\\!\\(\[Eta](\!\(\*SuperscriptBox[\(q\), \
\(1\)]\))\\)\>\""}], "}"}]}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Thread", "[", 
                 RowBox[{"Directive", "[", 
                  RowBox[{"{", 
                   RowBox[{"Black", ",", "Blue"}], "}"}], "]"}], "]"}]}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListStepPlot", "[", 
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"MovingAverage", "[", 
                   RowBox[{"bins", ",", "2"}], "]"}], ",", 
                  RowBox[{"hist", "/", 
                   RowBox[{"Max", "[", "hist", "]"}]}]}], "}"}], "]"}], ",", 
               "Center", ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Red", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"xs", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
                RowBox[{"{", 
                 RowBox[{"\[Eta]s", ",", 
                  RowBox[{"\[Eta]s", "^", "2"}]}], "}"}]}], ",", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               RowBox[{"AxesLabel", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<\\!\\(x\\)\>\"", ",", 
                  
                  "\"\<\\!\\(\[Eta](\!\(\*SuperscriptBox[\(q\), \
\(1\)]\))\\)\>\""}], "}"}]}]}], "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1s", ",", 
                RowBox[{"Nofq1", "-", 
                 RowBox[{"Min", "[", "Nofq1", "]"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"AxesLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<\\!\\(\!\(\*SuperscriptBox[\(q\), \(1\)]\)\\)\>\"", ",", 
                "\"\<\\!\\(N(\!\(\*SuperscriptBox[\(q\), \(1\)]\))\\)\>\""}], 
               "}"}]}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[19]:=",ExpressionUUID->"126a70e9-55b4-470a-be84-76d6e335a719"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]", "=", 
      RowBox[{"0.", "Degree"}]}], ",", 
     RowBox[{"\[Beta]1", "=", 
      RowBox[{".1", "*", "2.1"}]}], ",", 
     RowBox[{"T2OT1", "=", "5.35"}], ",", 
     RowBox[{"Vd", "=", "0"}], ",", 
     RowBox[{"q1lim", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "7"}], ",", "15"}], "}"}]}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"data", "=", 
      RowBox[{"Get", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<~/Downloads\>\"", ",", "\"\<MaxwellianVDF-homogeneous.m\>\""}], 
         "}"}], "]"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "e1", ",", "e3", ",", "e2", ",", "Lcarts2mfa", ",", "vel", ",", "pos", 
       ",", "q1s", ",", "\[Eta]s", ",", "binpos", ",", "histpos", ",", 
       "binv1", ",", "histv1", ",", "binv2", ",", "histv2", ",", "binv3", ",",
        "histv3"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"e1", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}], ",", "0"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"e3", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"e2", "=", 
       RowBox[{"Cross", "[", 
        RowBox[{"e3", ",", "e1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Lcarts2mfa", "=", 
       RowBox[{"{", 
        RowBox[{"e1", ",", "e2", ",", "e3"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1s", "=", 
       RowBox[{"Range", "@@", "q1lim"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]s", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"1.", ",", 
         RowBox[{"Length", "[", "q1s", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vel", "=", 
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"L", "=", "Lcarts2mfa"}], "}"}], ",", 
          RowBox[{"Compile", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"v", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Divide", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"L", ".", "v"}], "-", 
               RowBox[{"{", 
                RowBox[{"Vd", ",", "0", ",", "0"}], "}"}]}], ",", 
              SqrtBox[
               RowBox[{"\[Beta]1", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "T2OT1", ",", "T2OT1"}], "}"}]}]]}], "]"}],
             ",", "\[IndentingNewLine]", 
            RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"RuntimeAttributes", "\[Rule]", 
             RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", 
           "]"}]}], "]"}], "[", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"Join", "@@", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binpos", ",", "histpos"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"pos", ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"q1lim", "+", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"+", ".5"}], ",", 
              RowBox[{"-", ".5"}]}], "}"}]}], ",", "1"}], "]"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binv1", ",", "histv1"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"vel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3"}], ",", "3", ",", ".2"}], "}"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binv2", ",", "histv2"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"vel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3"}], ",", "3", ",", ".2"}], "}"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binv3", ",", "histv3"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"vel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3"}], ",", "3", ",", ".2"}], "}"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"q1s", ",", "\[Eta]s"}], "}"}], "]"}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binpos", ",", "2"}], "]"}], ",", 
               RowBox[{"histpos", "/", 
                RowBox[{"Max", "[", "histpos", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{"v", "^", "2"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"v", ",", 
              RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binv1", ",", "2"}], "]"}], ",", 
               RowBox[{"histv1", "/", 
                RowBox[{"Max", "[", "histv1", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{"v", "^", "2"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"v", ",", 
              RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binv2", ",", "2"}], "]"}], ",", 
               RowBox[{"histv2", "/", 
                RowBox[{"Max", "[", "histv2", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{"v", "^", "2"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"v", ",", 
              RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binv3", ",", "2"}], "]"}], ",", 
               RowBox[{"histv3", "/", 
                RowBox[{"Max", "[", "histv3", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}]}], "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->
  "In[348]:=",ExpressionUUID->"0546f177-4ef3-4eef-83c3-bd089f300fc9"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Beta]1", "=", 
      RowBox[{".1", "*", "2.1"}]}], ",", 
     RowBox[{"T2OT1eq", "=", "5.35"}], ",", 
     RowBox[{"\[Xi]", "=", ".876"}], ",", 
     RowBox[{"q1lim", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "7"}], ",", "15"}], "}"}]}], ",", 
     RowBox[{"\[Xi]\[CapitalDelta]1q1max", "=", 
      RowBox[{
       RowBox[{"Pi", "/", "2"}], "*", ".8"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Get", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<~/Downloads\>\"", ",", 
          "\"\<MaxwellianVDF-inhomogeneous.m\>\""}], "}"}], "]"}], "]"}]}]}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "vel", ",", "pos", ",", "\[CapitalDelta]1", ",", "q1s", ",", "\[Eta]s", 
       ",", "binpos", ",", "histpos", ",", "binv1", ",", "histv1", ",", 
       "binv2", ",", "histv2", ",", "binv3", ",", "histv3"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[CapitalDelta]1", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"\[Xi]\[CapitalDelta]1q1max", ",", 
         RowBox[{"\[Xi]", " ", 
          RowBox[{"Max", "[", 
           RowBox[{"Abs", "[", "q1lim", "]"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1s", "=", 
       RowBox[{"Range", "@@", "q1lim"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
        RowBox[{"Divide", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Apply", "[", 
           RowBox[{"Subtract", ",", 
            RowBox[{
             RowBox[{"ArcTan", "[", 
              RowBox[{
               SqrtBox["T2OT1eq"], 
               RowBox[{"Tan", "[", 
                RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", 
                 RowBox[{"{", 
                  RowBox[{".5", ",", 
                   RowBox[{"-", ".5"}]}], "}"}]}], "]"}]}], "]"}], "/", 
             RowBox[{"(", 
              RowBox[{"\[Xi]", 
               SqrtBox["T2OT1eq"]}], ")"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Apply", "[", 
           RowBox[{"Subtract", ",", 
            RowBox[{
             RowBox[{"ArcTan", "[", 
              RowBox[{
               SqrtBox["T2OT1eq"], 
               RowBox[{"Tan", "[", 
                RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", 
                 RowBox[{"q1s", "[", 
                  RowBox[{"[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], "]"}]}], 
                "]"}]}], "]"}], "/", 
             RowBox[{"(", 
              RowBox[{"\[Xi]", 
               SqrtBox["T2OT1eq"]}], ")"}]}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}], "//", "CForm"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]s", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{"T2OT1eq", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "T2OT1eq"}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1s"}], "]"}], 
            "^", "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"Join", "@@", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vel", "=", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vel", "=", 
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
            RowBox[{"Divide", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1q1max", ",", 
              RowBox[{"Max", "[", 
               RowBox[{"Abs", "[", "q1lim", "]"}], "]"}]}], "]"}]}], "}"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Compile", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"v", ",", "_Real", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "_Real"}], "}"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\[Eta]", ",", "T2OT1"}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"\[Eta]", "=", 
                RowBox[{"Divide", "[", 
                 RowBox[{"1", ",", 
                  RowBox[{"T2OT1eq", "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "T2OT1eq"}], ")"}], 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
                    "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"T2OT1", "=", 
                RowBox[{"T2OT1eq", " ", "\[Eta]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Divide", "[", 
                RowBox[{"v", ",", 
                 SqrtBox[
                  RowBox[{"\[Beta]1", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "T2OT1", ",", "T2OT1"}], "}"}]}]]}], 
                "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"RuntimeAttributes", "\[Rule]", 
             RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", 
           "]"}]}], "\[IndentingNewLine]", "]"}], "[", 
        RowBox[{"vel", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binpos", ",", "histpos"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"pos", ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"q1lim", "+", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"+", ".5"}], ",", 
              RowBox[{"-", ".5"}]}], "}"}]}], ",", "1"}], "]"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binv1", ",", "histv1"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"vel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3"}], ",", "3", ",", ".2"}], "}"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binv2", ",", "histv2"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"vel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3"}], ",", "3", ",", ".2"}], "}"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binv3", ",", "histv3"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"vel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3"}], ",", "3", ",", ".2"}], "}"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"q1s", ",", "\[Eta]s"}], "}"}], "]"}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binpos", ",", "2"}], "]"}], ",", 
               RowBox[{"histpos", "/", 
                RowBox[{"Max", "[", "histpos", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{"v", "^", "2"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"v", ",", 
              RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binv1", ",", "2"}], "]"}], ",", 
               RowBox[{"histv1", "/", 
                RowBox[{"Max", "[", "histv1", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{"v", "^", "2"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"v", ",", 
              RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binv2", ",", "2"}], "]"}], ",", 
               RowBox[{"histv2", "/", 
                RowBox[{"Max", "[", "histv2", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{"v", "^", "2"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"v", ",", 
              RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binv3", ",", "2"}], "]"}], ",", 
               RowBox[{"histv3", "/", 
                RowBox[{"Max", "[", "histv3", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}]}], "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",ExpressionUUID->"03315541-\
ef4a-452b-bb88-58f740724e46"]
}, Closed]],

Cell[CellGroupData[{

Cell["Loss-cone velocity distribution", "Subsection",ExpressionUUID->"bcafc670-df21-4216-80de-00b62fb5c091"],

Cell[TextData[{
 "Consider a loss-cone velocity distribution at the origin with ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalDelta]", "=", "0"}], TraditionalForm]],ExpressionUUID->
  "4371b514-f7fa-4409-a22b-84b264c10063"],
 "\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["f", "0"], "(", 
     RowBox[{
      SubscriptBox["v", 
       RowBox[{"\[DoubleVerticalBar]", 
        RowBox[{",", "0"}]}]], ",", 
      SubscriptBox["v", 
       RowBox[{"\[UpTee]", 
        RowBox[{",", "0"}]}]]}], ")"}], "=", 
    RowBox[{
     FractionBox[
      SubscriptBox["n", "0"], 
      RowBox[{
       SuperscriptBox["\[Pi]", 
        RowBox[{"3", "/", "2"}]], 
       SubscriptBox["\[Theta]", 
        RowBox[{"\[DoubleVerticalBar]", 
         RowBox[{",", "0"}]}]], 
       SubsuperscriptBox["\[Theta]", 
        RowBox[{"\[UpTee]", 
         RowBox[{",", "0"}]}], "2"]}]], 
     FractionBox["1", 
      RowBox[{"1", "-", 
       SubscriptBox["\[Beta]", "0"]}]], 
     RowBox[{"exp", "(", 
      RowBox[{"-", 
       FractionBox[
        SubsuperscriptBox["v", 
         RowBox[{"\[DoubleVerticalBar]", 
          RowBox[{",", "0"}]}], "2"], 
        SubsuperscriptBox["\[Theta]", 
         RowBox[{"\[DoubleVerticalBar]", 
          RowBox[{",", "0"}]}], "2"]]}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"exp", "(", 
        RowBox[{"-", 
         FractionBox[
          SubsuperscriptBox["v", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}], "2"], 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}], "2"]]}], ")"}], "-", 
       RowBox[{"exp", "(", 
        RowBox[{"-", 
         FractionBox[
          SubsuperscriptBox["v", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}], "2"], 
          RowBox[{
           SubscriptBox["\[Beta]", "0"], 
           SubsuperscriptBox["\[Theta]", 
            RowBox[{"\[UpTee]", 
             RowBox[{",", "0"}]}], "2"]}]]}], ")"}]}], ")"}]}]}], 
   TraditionalForm]],ExpressionUUID->"4091e90b-a1dd-4214-93ab-269b35148060"],
 ".\nThe choice ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalDelta]", "=", "0"}], TraditionalForm]],ExpressionUUID->
  "b8044c3a-4bd6-48ef-b902-0f05ee0f1e48"],
 " makes the relationship simple.\nThe distribution at a given location is \
given by\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    RowBox[{"f", "(", 
     RowBox[{
      SubscriptBox["v", "\[DoubleVerticalBar]"], ",", 
      SubscriptBox["v", "\[UpTee]"]}], ")"}], "=", 
    RowBox[{
     SubscriptBox["f", "0"], "(", 
     RowBox[{
      RowBox[{
       SubscriptBox["v", 
        RowBox[{"\[DoubleVerticalBar]", 
         RowBox[{",", "0"}]}]], "(", 
       RowBox[{
        SubscriptBox["v", "\[DoubleVerticalBar]"], ",", 
        SubscriptBox["v", "\[UpTee]"]}], ")"}], ",", 
      RowBox[{
       SubscriptBox["v", 
        RowBox[{"\[UpTee]", 
         RowBox[{",", "0"}]}]], "(", 
       RowBox[{
        SubscriptBox["v", "\[DoubleVerticalBar]"], ",", 
        SubscriptBox["v", "\[UpTee]"]}], ")"}]}], ")"}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     FractionBox[
      SubscriptBox["n", "0"], 
      RowBox[{
       SuperscriptBox["\[Pi]", 
        RowBox[{"3", "/", "2"}]], 
       SubscriptBox["\[Theta]", 
        RowBox[{"\[DoubleVerticalBar]", 
         RowBox[{",", "0"}]}]], 
       SubsuperscriptBox["\[Theta]", 
        RowBox[{"\[UpTee]", 
         RowBox[{",", "0"}]}], "2"]}]], 
     FractionBox["1", 
      RowBox[{"1", "-", 
       SubscriptBox["\[Beta]", "0"]}]], 
     RowBox[{"exp", "(", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SubsuperscriptBox["v", "\[DoubleVerticalBar]", "2"], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            FractionBox[
             SubscriptBox["B", "0"], "B"]}], ")"}], 
          SubsuperscriptBox["v", "\[UpTee]", "2"]}]}], 
        SubsuperscriptBox["\[Theta]", 
         RowBox[{"\[DoubleVerticalBar]", 
          RowBox[{",", "0"}]}], "2"]]}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"exp", "(", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           FractionBox[
            SubscriptBox["B", "0"], "B"], 
           SubsuperscriptBox["v", "\[UpTee]", "2"]}], 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}], "2"]]}], ")"}], "-", 
       RowBox[{"exp", "(", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           FractionBox[
            SubscriptBox["B", "0"], "B"], 
           SubsuperscriptBox["v", "\[UpTee]", "2"]}], 
          RowBox[{
           SubscriptBox["\[Beta]", "0"], 
           SubsuperscriptBox["\[Theta]", 
            RowBox[{"\[UpTee]", 
             RowBox[{",", "0"}]}], "2"]}]]}], ")"}]}], ")"}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     FractionBox[
      SubscriptBox["n", "0"], 
      RowBox[{
       SuperscriptBox["\[Pi]", 
        RowBox[{"3", "/", "2"}]], 
       SubscriptBox["\[Theta]", 
        RowBox[{"\[DoubleVerticalBar]", 
         RowBox[{",", "0"}]}]], 
       SubsuperscriptBox["\[Theta]", 
        RowBox[{"\[UpTee]", 
         RowBox[{",", "0"}]}], "2"]}]], 
     FractionBox["1", 
      RowBox[{"1", "-", 
       SubscriptBox["\[Beta]", "0"]}]], 
     RowBox[{"exp", "(", 
      RowBox[{"-", 
       FractionBox[
        SubsuperscriptBox["v", "\[DoubleVerticalBar]", "2"], 
        SubsuperscriptBox["\[Theta]", 
         RowBox[{"\[DoubleVerticalBar]", 
          RowBox[{",", "0"}]}], "2"]]}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"exp", "(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              FractionBox[
               SubscriptBox["B", "0"], "B"]}], ")"}], 
            SubsuperscriptBox["v", "\[UpTee]", "2"]}], 
           SubsuperscriptBox["\[Theta]", 
            RowBox[{"\[DoubleVerticalBar]", 
             RowBox[{",", "0"}]}], "2"]]}], "-", 
         FractionBox[
          RowBox[{
           FractionBox[
            SubscriptBox["B", "0"], "B"], 
           SubsuperscriptBox["v", "\[UpTee]", "2"]}], 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}], "2"]]}], ")"}], "-", 
       RowBox[{"exp", "(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              FractionBox[
               SubscriptBox["B", "0"], "B"]}], ")"}], 
            SubsuperscriptBox["v", "\[UpTee]", "2"]}], 
           SubsuperscriptBox["\[Theta]", 
            RowBox[{"\[DoubleVerticalBar]", 
             RowBox[{",", "0"}]}], "2"]]}], "-", 
         FractionBox[
          RowBox[{
           FractionBox[
            SubscriptBox["B", "0"], "B"], 
           SubsuperscriptBox["v", "\[UpTee]", "2"]}], 
          RowBox[{
           SubscriptBox["\[Beta]", "0"], 
           SubsuperscriptBox["\[Theta]", 
            RowBox[{"\[UpTee]", 
             RowBox[{",", "0"}]}], "2"]}]]}], ")"}]}], ")"}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     FractionBox[
      SubscriptBox["n", "0"], 
      RowBox[{
       SuperscriptBox["\[Pi]", 
        RowBox[{"3", "/", "2"}]], 
       SubscriptBox["\[Theta]", 
        RowBox[{"\[DoubleVerticalBar]", 
         RowBox[{",", "0"}]}]], 
       SubsuperscriptBox["\[Theta]", 
        RowBox[{"\[UpTee]", 
         RowBox[{",", "0"}]}], "2"]}]], 
     FractionBox["1", 
      RowBox[{"1", "-", 
       SubscriptBox["\[Beta]", "0"]}]], 
     RowBox[{"exp", "(", 
      RowBox[{"-", 
       FractionBox[
        SubsuperscriptBox["v", "\[DoubleVerticalBar]", "2"], 
        SubsuperscriptBox["\[Theta]", 
         RowBox[{"\[DoubleVerticalBar]", 
          RowBox[{",", "0"}]}], "2"]]}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"exp", "(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               FractionBox[
                SubscriptBox["B", "0"], "B"]}], ")"}], 
             FractionBox[
              SubsuperscriptBox["\[Theta]", 
               RowBox[{"\[UpTee]", 
                RowBox[{",", "0"}]}], "2"], 
              SubsuperscriptBox["\[Theta]", 
               RowBox[{"\[DoubleVerticalBar]", 
                RowBox[{",", "0"}]}], "2"]]}], "+", 
            FractionBox[
             SubscriptBox["B", "0"], "B"]}], ")"}]}], 
         FractionBox[
          SubsuperscriptBox["v", "\[UpTee]", "2"], 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}], "2"]]}], ")"}], "-", 
       RowBox[{"exp", "(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               FractionBox[
                SubscriptBox["B", "0"], "B"]}], ")"}], 
             FractionBox[
              RowBox[{
               SubscriptBox["\[Beta]", "0"], 
               SubsuperscriptBox["\[Theta]", 
                RowBox[{"\[UpTee]", 
                 RowBox[{",", "0"}]}], "2"]}], 
              SubsuperscriptBox["\[Theta]", 
               RowBox[{"\[DoubleVerticalBar]", 
                RowBox[{",", "0"}]}], "2"]]}], "+", 
            FractionBox[
             SubscriptBox["B", "0"], "B"]}], ")"}]}], 
         FractionBox[
          SubsuperscriptBox["v", "\[UpTee]", "2"], 
          RowBox[{
           SubscriptBox["\[Beta]", "0"], 
           SubsuperscriptBox["\[Theta]", 
            RowBox[{"\[UpTee]", 
             RowBox[{",", "0"}]}], "2"]}]]}], ")"}]}], ")"}]}]}], 
   TraditionalForm]}],ExpressionUUID->
  "8f4166c3-6f44-4ea3-a6b3-2e8dc978f1f0"],
 ".\nTo make it look like a loss-cone, we define\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["\[Theta]", 
     RowBox[{"\[DoubleVerticalBar]", 
      RowBox[{",", "0"}]}], "2"], "=", 
    SubsuperscriptBox["\[Theta]", "\[DoubleVerticalBar]", "2"]}], 
   TraditionalForm]],ExpressionUUID->"e8d18fb1-89b1-495b-bee0-d9f863343448"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["\[Theta]", 
     RowBox[{"\[UpTee]", 
      RowBox[{",", "0"}]}], "2"], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox[
           SubscriptBox["B", "0"], "B"]}], ")"}], 
        FractionBox[
         SubsuperscriptBox["\[Theta]", 
          RowBox[{"\[UpTee]", 
           RowBox[{",", "0"}]}], "2"], 
         SubsuperscriptBox["\[Theta]", 
          RowBox[{"\[DoubleVerticalBar]", 
           RowBox[{",", "0"}]}], "2"]]}], "+", 
       FractionBox[
        SubscriptBox["B", "0"], "B"]}], ")"}], 
     SubsuperscriptBox["\[Theta]", "\[UpTee]", "2"]}]}], TraditionalForm]],
  ExpressionUUID->"8180fc4f-29ea-4c41-b68a-fc24d199cb6c"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Beta]", "0"], "=", 
    RowBox[{"\[Beta]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox[
           SubscriptBox["B", "0"], "B"]}], ")"}], 
        FractionBox[
         RowBox[{
          SubscriptBox["\[Beta]", "0"], 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}], "2"]}], 
         SubsuperscriptBox["\[Theta]", 
          RowBox[{"\[DoubleVerticalBar]", 
           RowBox[{",", "0"}]}], "2"]]}], "+", 
       FractionBox[
        SubscriptBox["B", "0"], "B"]}], ")"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            SubscriptBox["B", "0"], "B"]}], ")"}], 
         FractionBox[
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}], "2"], 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}], "2"]]}], "+", 
        FractionBox[
         SubscriptBox["B", "0"], "B"]}], ")"}], 
      RowBox[{"-", "1"}]]}]}], TraditionalForm]],ExpressionUUID->
  "ff0be61b-a518-430d-a716-788688cb67f1"],
 ".\nSubstituting them yields\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{"f", "(", 
    RowBox[{
     SubscriptBox["v", "\[DoubleVerticalBar]"], ",", 
     SubscriptBox["v", "\[UpTee]"]}], ")"}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     FractionBox[
      SubscriptBox["n", "0"], 
      RowBox[{
       SuperscriptBox["\[Pi]", 
        RowBox[{"3", "/", "2"}]], 
       SubscriptBox["\[Theta]", 
        RowBox[{"\[DoubleVerticalBar]", 
         RowBox[{",", "0"}]}]], 
       SubsuperscriptBox["\[Theta]", 
        RowBox[{"\[UpTee]", 
         RowBox[{",", "0"}]}], "2"]}]], 
     FractionBox["1", 
      RowBox[{"1", "-", 
       SubscriptBox["\[Beta]", "0"]}]], 
     RowBox[{"exp", "(", 
      RowBox[{"-", 
       FractionBox[
        SubsuperscriptBox["v", "\[DoubleVerticalBar]", "2"], 
        SubsuperscriptBox["\[Theta]", "\[DoubleVerticalBar]", "2"]]}], ")"}], 
     
     RowBox[{"(", 
      RowBox[{
       RowBox[{"exp", "(", 
        RowBox[{"-", 
         FractionBox[
          SubsuperscriptBox["v", "\[UpTee]", "2"], 
          SubsuperscriptBox["\[Theta]", "\[UpTee]", "2"]]}], ")"}], "-", 
       RowBox[{"exp", "(", 
        RowBox[{"-", 
         FractionBox[
          SubsuperscriptBox["v", "\[UpTee]", "2"], 
          RowBox[{"\[Beta]", " ", 
           SubsuperscriptBox["\[Theta]", "\[UpTee]", "2"]}]]}], ")"}]}], 
      ")"}]}]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     FractionBox[
      RowBox[{"1", "-", "\[Beta]"}], 
      RowBox[{"1", "-", 
       SubscriptBox["\[Beta]", "0"]}]], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            SubscriptBox["B", "0"], "B"]}], ")"}], 
         FractionBox[
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}], "2"], 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}], "2"]]}], "+", 
        FractionBox[
         SubscriptBox["B", "0"], "B"]}], ")"}], 
      RowBox[{"-", "1"}]], 
     FractionBox[
      SubscriptBox["n", "0"], 
      RowBox[{
       SuperscriptBox["\[Pi]", 
        RowBox[{"3", "/", "2"}]], 
       SubscriptBox["\[Theta]", "\[DoubleVerticalBar]"], 
       SubsuperscriptBox["\[Theta]", "\[UpTee]", "2"]}]], 
     FractionBox["1", 
      RowBox[{"1", "-", "\[Beta]"}]], 
     RowBox[{"exp", "(", 
      RowBox[{"-", 
       FractionBox[
        SubsuperscriptBox["v", "\[DoubleVerticalBar]", "2"], 
        SubsuperscriptBox["\[Theta]", "\[DoubleVerticalBar]", "2"]]}], ")"}], 
     
     RowBox[{"(", 
      RowBox[{
       RowBox[{"exp", "(", 
        RowBox[{"-", 
         FractionBox[
          SubsuperscriptBox["v", "\[UpTee]", "2"], 
          SubsuperscriptBox["\[Theta]", "\[UpTee]", "2"]]}], ")"}], "-", 
       RowBox[{"exp", "(", 
        RowBox[{"-", 
         FractionBox[
          SubsuperscriptBox["v", "\[UpTee]", "2"], 
          RowBox[{"\[Beta]", " ", 
           SubsuperscriptBox["\[Theta]", "\[UpTee]", "2"]}]]}], ")"}]}], 
      ")"}]}]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     FractionBox["n", 
      RowBox[{
       SuperscriptBox["\[Pi]", 
        RowBox[{"3", "/", "2"}]], 
       SubscriptBox["\[Theta]", "\[DoubleVerticalBar]"], 
       SubsuperscriptBox["\[Theta]", "\[UpTee]", "2"]}]], 
     FractionBox["1", 
      RowBox[{"1", "-", "\[Beta]"}]], 
     RowBox[{"exp", "(", 
      RowBox[{"-", 
       FractionBox[
        SubsuperscriptBox["v", "\[DoubleVerticalBar]", "2"], 
        SubsuperscriptBox["\[Theta]", "\[DoubleVerticalBar]", "2"]]}], ")"}], 
     
     RowBox[{"(", 
      RowBox[{
       RowBox[{"exp", "(", 
        RowBox[{"-", 
         FractionBox[
          SubsuperscriptBox["v", "\[UpTee]", "2"], 
          SubsuperscriptBox["\[Theta]", "\[UpTee]", "2"]]}], ")"}], "-", 
       RowBox[{"exp", "(", 
        RowBox[{"-", 
         FractionBox[
          SubsuperscriptBox["v", "\[UpTee]", "2"], 
          RowBox[{"\[Beta]", " ", 
           SubsuperscriptBox["\[Theta]", "\[UpTee]", "2"]}]]}], ")"}]}], 
      ")"}]}]}], TraditionalForm]}],ExpressionUUID->
  "325f1f63-1747-4f76-8ec5-ede5ee65cbe4"],
 ",\nwhere we have defined a new density\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "=", 
    RowBox[{
     FractionBox[
      RowBox[{"1", "-", "\[Beta]"}], 
      RowBox[{"1", "-", 
       SubscriptBox["\[Beta]", "0"]}]], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            SubscriptBox["B", "0"], "B"]}], ")"}], 
         FractionBox[
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}], "2"], 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}], "2"]]}], "+", 
        FractionBox[
         SubscriptBox["B", "0"], "B"]}], ")"}], 
      RowBox[{"-", "1"}]], 
     SubscriptBox["n", "0"]}]}], TraditionalForm]],ExpressionUUID->
  "954991d0-35ac-4327-b7ba-9195c1b12f54"],
 ".\nIn summary, we can write the following macro variables in terms of the \
ones at origin:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["\[Theta]", "\[DoubleVerticalBar]", "2"], "=", 
    SubsuperscriptBox["\[Theta]", 
     RowBox[{"\[DoubleVerticalBar]", 
      RowBox[{",", "0"}]}], "2"]}], TraditionalForm]],ExpressionUUID->
  "8c526692-bb47-4104-8c53-f625bc05136b"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["\[Theta]", "\[UpTee]", "2"], "=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            SubscriptBox["B", "0"], "B"]}], ")"}], 
         FractionBox[
          SubscriptBox["T", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}]], 
          SubscriptBox["T", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}]]]}], "+", 
        FractionBox[
         SubscriptBox["B", "0"], "B"]}], ")"}], 
      RowBox[{"-", "1"}]], 
     SubsuperscriptBox["\[Theta]", 
      RowBox[{"\[UpTee]", 
       RowBox[{",", "0"}]}], "2"]}]}], TraditionalForm]],ExpressionUUID->
  "0aa6ac3c-5170-43b2-ba63-431cd35695a0"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Beta]", "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Beta]", "0"], "(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox[
           SubscriptBox["B", "0"], "B"]}], ")"}], 
        FractionBox[
         SubsuperscriptBox["\[Theta]", 
          RowBox[{"\[UpTee]", 
           RowBox[{",", "0"}]}], "2"], 
         SubsuperscriptBox["\[Theta]", 
          RowBox[{"\[DoubleVerticalBar]", 
           RowBox[{",", "0"}]}], "2"]]}], "+", 
       FractionBox[
        SubscriptBox["B", "0"], "B"]}], ")"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            SubscriptBox["B", "0"], "B"]}], ")"}], 
         FractionBox[
          RowBox[{
           SubscriptBox["\[Beta]", "0"], 
           SubsuperscriptBox["\[Theta]", 
            RowBox[{"\[UpTee]", 
             RowBox[{",", "0"}]}], "2"]}], 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}], "2"]]}], "+", 
        FractionBox[
         SubscriptBox["B", "0"], "B"]}], ")"}], 
      RowBox[{"-", "1"}]]}]}], TraditionalForm]],ExpressionUUID->
  "ea03bef1-5dc1-4375-9da8-443f12f466bd"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "=", 
    RowBox[{
     FractionBox[
      RowBox[{"1", "-", "\[Beta]"}], 
      RowBox[{"1", "-", 
       SubscriptBox["\[Beta]", "0"]}]], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            SubscriptBox["B", "0"], "B"]}], ")"}], 
         FractionBox[
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}], "2"], 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}], "2"]]}], "+", 
        FractionBox[
         SubscriptBox["B", "0"], "B"]}], ")"}], 
      RowBox[{"-", "1"}]], 
     SubscriptBox["n", "0"]}]}], TraditionalForm]],ExpressionUUID->
  "73a7d8cd-9655-410e-b942-0883c701ceeb"],
 "."
}], "Text",ExpressionUUID->"eca842dc-7fb9-4f5b-bdd2-096c455c68bf"],

Cell[TextData[{
 "Since we are concerned with the central field line of the mirror magnetic \
field,\nwe can substitute ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"B", "(", "x", ")"}], 
     SubscriptBox["B", "0"]], "=", 
    RowBox[{
     FractionBox[
      RowBox[{
       SubscriptBox["B", "x"], "(", "x", ")"}], 
      SubscriptBox["B", "0"]], "=", 
     RowBox[{
      RowBox[{"1", "+", 
       RowBox[{
        SuperscriptBox["\[Xi]", "2"], 
        SuperscriptBox["x", "2"]}]}], "=", 
      RowBox[{
       SuperscriptBox["sec", "2"], "(", 
       RowBox[{"\[Xi]", " ", 
        SubscriptBox["\[CapitalDelta]", "1"], 
        SuperscriptBox["q", "1"]}], ")"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"a3f80eca-5a93-4868-b480-80956b1e8be2"],
 ".\nAs before, define\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{"\[Eta]", "=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            SubscriptBox["B", "0"], "B"]}], ")"}], 
         FractionBox[
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}], "2"], 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}], "2"]]}], "+", 
        FractionBox[
         SubscriptBox["B", "0"], "B"]}], ")"}], 
      RowBox[{"-", "1"}]], "=", 
     FractionBox[
      RowBox[{"B", "/", 
       SubscriptBox["B", "0"]}], 
      RowBox[{"1", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}], "2"], "/", 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}], "2"]}], ")"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox["B", 
           SubscriptBox["B", "0"]]}], ")"}]}]}]]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     FractionBox[
      RowBox[{"1", "+", 
       RowBox[{
        SuperscriptBox["\[Xi]", "2"], 
        SuperscriptBox["x", "2"]}]}], 
      RowBox[{"1", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}], "2"], "/", 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}], "2"]}], ")"}], 
        SuperscriptBox["\[Xi]", "2"], 
        SuperscriptBox["x", "2"]}]}]], "=", 
     FractionBox[
      RowBox[{"1", "+", 
       RowBox[{
        SuperscriptBox["\[Xi]", "2"], 
        SuperscriptBox["x", "2"]}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["\[Theta]", 
             RowBox[{"\[UpTee]", 
              RowBox[{",", "0"}]}]], "/", 
            SubscriptBox["\[Theta]", 
             RowBox[{"\[DoubleVerticalBar]", 
              RowBox[{",", "0"}]}]]}], ")"}], "\[Xi]", " ", "x"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["\[Theta]", 
             RowBox[{"\[UpTee]", 
              RowBox[{",", "0"}]}]], "/", 
            SubscriptBox["\[Theta]", 
             RowBox[{"\[DoubleVerticalBar]", 
              RowBox[{",", "0"}]}]]}], ")"}], "\[Xi]", " ", "x"}]}], 
        ")"}]}]]}]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     FractionBox[
      RowBox[{
       SuperscriptBox["sec", "2"], "(", 
       RowBox[{"\[Xi]", " ", 
        SubscriptBox["\[CapitalDelta]", "1"], 
        SuperscriptBox["q", "1"]}], ")"}], 
      RowBox[{"1", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}], "2"], "/", 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}], "2"]}], ")"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           SuperscriptBox["sec", "2"], "(", 
           RowBox[{"\[Xi]", " ", 
            SubscriptBox["\[CapitalDelta]", "1"], 
            SuperscriptBox["q", "1"]}], ")"}]}], ")"}]}]}]], "=", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubsuperscriptBox["\[Theta]", 
          RowBox[{"\[UpTee]", 
           RowBox[{",", "0"}]}], "2"], "/", 
         SubsuperscriptBox["\[Theta]", 
          RowBox[{"\[DoubleVerticalBar]", 
           RowBox[{",", "0"}]}], "2"]}], ")"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           RowBox[{
            SubsuperscriptBox["\[Theta]", 
             RowBox[{"\[UpTee]", 
              RowBox[{",", "0"}]}], "2"], "/", 
            SubsuperscriptBox["\[Theta]", 
             RowBox[{"\[DoubleVerticalBar]", 
              RowBox[{",", "0"}]}], "2"]}], ")"}]}], ")"}], 
        RowBox[{
         SuperscriptBox["cos", "2"], "(", 
         RowBox[{"\[Xi]", " ", 
          SubscriptBox["\[CapitalDelta]", "1"], 
          SuperscriptBox["q", "1"]}], ")"}]}]}]]}]}], TraditionalForm]}],
  ExpressionUUID->"de499990-031d-498e-99c0-eb8f3945b37b"],
 ".\nSimilarly, define\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Eta]", "\[Beta]"], "=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            SubscriptBox["B", "0"], "B"]}], ")"}], 
         FractionBox[
          RowBox[{
           SubscriptBox["\[Beta]", "0"], 
           SubsuperscriptBox["\[Theta]", 
            RowBox[{"\[UpTee]", 
             RowBox[{",", "0"}]}], "2"]}], 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}], "2"]]}], "+", 
        FractionBox[
         SubscriptBox["B", "0"], "B"]}], ")"}], 
      RowBox[{"-", "1"}]], "=", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[Beta]", "0"], 
         RowBox[{
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}], "2"], "/", 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}], "2"]}]}], ")"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["\[Beta]", "0"], 
            RowBox[{
             SubsuperscriptBox["\[Theta]", 
              RowBox[{"\[UpTee]", 
               RowBox[{",", "0"}]}], "2"], "/", 
             SubsuperscriptBox["\[Theta]", 
              RowBox[{"\[DoubleVerticalBar]", 
               RowBox[{",", "0"}]}], "2"]}]}], ")"}]}], ")"}], 
        RowBox[{
         SuperscriptBox["cos", "2"], "(", 
         RowBox[{"\[Xi]", " ", 
          SubscriptBox["\[CapitalDelta]", "1"], 
          SuperscriptBox["q", "1"]}], ")"}]}]}]]}]}], TraditionalForm]],
  ExpressionUUID->"3c7387f7-14ea-489a-9c1c-ae41e68191f1"],
 ".\nThen,\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{"\[Beta]", "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Beta]", "0"], "(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox[
           SubscriptBox["B", "0"], "B"]}], ")"}], 
        FractionBox[
         SubsuperscriptBox["\[Theta]", 
          RowBox[{"\[UpTee]", 
           RowBox[{",", "0"}]}], "2"], 
         SubsuperscriptBox["\[Theta]", 
          RowBox[{"\[DoubleVerticalBar]", 
           RowBox[{",", "0"}]}], "2"]]}], "+", 
       FractionBox[
        SubscriptBox["B", "0"], "B"]}], ")"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            SubscriptBox["B", "0"], "B"]}], ")"}], 
         FractionBox[
          RowBox[{
           SubscriptBox["\[Beta]", "0"], 
           SubsuperscriptBox["\[Theta]", 
            RowBox[{"\[UpTee]", 
             RowBox[{",", "0"}]}], "2"]}], 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}], "2"]]}], "+", 
        FractionBox[
         SubscriptBox["B", "0"], "B"]}], ")"}], 
      RowBox[{"-", "1"}]]}]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     SubscriptBox["\[Beta]", "0"], 
     FractionBox[
      SubscriptBox["\[Eta]", "\[Beta]"], "\[Eta]"]}]}], TraditionalForm]}],
  ExpressionUUID->"e22709cc-ed2c-4bfd-a108-6a5a1585941b"],
 ";\nand\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{"n", "=", 
    RowBox[{
     FractionBox[
      RowBox[{"1", "-", "\[Beta]"}], 
      RowBox[{"1", "-", 
       SubscriptBox["\[Beta]", "0"]}]], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            SubscriptBox["B", "0"], "B"]}], ")"}], 
         FractionBox[
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}], "2"], 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}], "2"]]}], "+", 
        FractionBox[
         SubscriptBox["B", "0"], "B"]}], ")"}], 
      RowBox[{"-", "1"}]], 
     SubscriptBox["n", "0"]}]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Beta]", "0"]}]], "-", 
       FractionBox["\[Beta]", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Beta]", "0"]}]]}], ")"}], "\[Eta]", " ", 
     SubscriptBox["n", "0"]}]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     FractionBox[
      SubscriptBox["n", "0"], 
      RowBox[{"1", "-", 
       SubscriptBox["\[Beta]", "0"]}]], 
     RowBox[{"(", 
      RowBox[{"\[Eta]", "-", 
       RowBox[{
        SubscriptBox["\[Beta]", "0"], 
        SubscriptBox["\[Eta]", "\[Beta]"]}]}], ")"}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     FractionBox[
      RowBox[{
       SubscriptBox["n", "0"], "\[Eta]"}], 
      RowBox[{"1", "-", 
       SubscriptBox["\[Beta]", "0"]}]], 
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Beta]"}], ")"}]}]}], TraditionalForm]}],
  ExpressionUUID->"236d3f18-e06c-437c-ac7a-a221794df527"],
 ".\nNote that ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Eta]", "=", 
    RowBox[{
     SubscriptBox["\[Eta]", "\[Beta]"], "=", "1"}]}], TraditionalForm]],
  ExpressionUUID->"39285e64-63a0-4ec6-bee0-7262d194c2cd"],
 " if ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Xi]", "=", "0"}], TraditionalForm]],ExpressionUUID->
  "4ae753db-e92f-4544-a81b-2385e9765a2f"],
 ".\nThe number of particles in a differential volume, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[DifferentialD]", "V"}], TraditionalForm]],ExpressionUUID->
  "1fd163b9-fcf1-48c4-92cc-28a43334350d"],
 ", is given by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[DifferentialD]", "N"}], "=", 
    RowBox[{"n", 
     RowBox[{"\[DifferentialD]", "V"}]}]}], TraditionalForm]],ExpressionUUID->
  "22620bc8-1f72-4260-afc2-8a759d190c74"],
 ".\nSince ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[DifferentialD]", "V"}], "=", 
    RowBox[{
     SubscriptBox["\[CapitalDelta]", "1"], 
     SubscriptBox["\[CapitalDelta]", "2"], 
     SubscriptBox["\[CapitalDelta]", "3"], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "1"]}], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "2"]}], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "3"]}]}]}], TraditionalForm]],ExpressionUUID->
  "b5e4b07d-95fe-42cf-a908-098a52ddcde1"],
 " is constant in terms of curvilinear coordinates, \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[DifferentialD]", "N"}], "\[Proportional]", 
    RowBox[{"n", "(", 
     SuperscriptBox["q", "1"], ")"}]}], TraditionalForm]],ExpressionUUID->
  "fadffd80-ebbf-4532-a343-206f8f999e14"],
 ".\nFrom the bi-Maxwellian case, we have\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubsuperscriptBox["\[Integral]", "0", 
      SuperscriptBox["q", "1"]], 
     RowBox[{
      RowBox[{"\[Eta]", "(", 
       SuperscriptBox["q", "1"], ")"}], 
      RowBox[{"\[DifferentialD]", 
       SuperscriptBox["q", "1"]}]}]}], "=", 
    FractionBox[
     RowBox[{
      SuperscriptBox["tan", 
       RowBox[{"-", "1"}]], "(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[Theta]", 
          RowBox[{"\[UpTee]", 
           RowBox[{",", "0"}]}]], "/", 
         SubscriptBox["\[Theta]", 
          RowBox[{"\[DoubleVerticalBar]", 
           RowBox[{",", "0"}]}]]}], ")"}], 
       RowBox[{"tan", "(", 
        RowBox[{"\[Xi]", " ", 
         SubscriptBox["\[CapitalDelta]", "1"], 
         SuperscriptBox["q", "1"]}], ")"}]}], ")"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["\[Theta]", 
         RowBox[{"\[UpTee]", 
          RowBox[{",", "0"}]}]], "/", 
        SubscriptBox["\[Theta]", 
         RowBox[{"\[DoubleVerticalBar]", 
          RowBox[{",", "0"}]}]]}], ")"}], 
      SubscriptBox["\[CapitalDelta]", "1"], "\[Xi]"}]]}], TraditionalForm]],
  ExpressionUUID->"81a359b1-5ad4-4e0f-ba31-6191531f51a4"],
 ",\nand likewise\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubsuperscriptBox["\[Integral]", "0", 
      SuperscriptBox["q", "1"]], 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Eta]", "\[Beta]"], "(", 
       SuperscriptBox["q", "1"], ")"}], 
      RowBox[{"\[DifferentialD]", 
       SuperscriptBox["q", "1"]}]}]}], "=", 
    FractionBox[
     RowBox[{
      SuperscriptBox["tan", 
       RowBox[{"-", "1"}]], "(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SqrtBox[
          SubscriptBox["\[Beta]", "0"]], 
         RowBox[{
          SubscriptBox["\[Theta]", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}]], "/", 
          SubscriptBox["\[Theta]", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}]]}]}], ")"}], 
       RowBox[{"tan", "(", 
        RowBox[{"\[Xi]", " ", 
         SubscriptBox["\[CapitalDelta]", "1"], 
         SuperscriptBox["q", "1"]}], ")"}]}], ")"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SqrtBox[
         SubscriptBox["\[Beta]", "0"]], 
        RowBox[{
         SubscriptBox["\[Theta]", 
          RowBox[{"\[UpTee]", 
           RowBox[{",", "0"}]}]], "/", 
         SubscriptBox["\[Theta]", 
          RowBox[{"\[DoubleVerticalBar]", 
           RowBox[{",", "0"}]}]]}]}], ")"}], 
      SubscriptBox["\[CapitalDelta]", "1"], "\[Xi]"}]]}], TraditionalForm]],
  ExpressionUUID->"a1de2089-d750-4ff1-90c2-5cdd60d25d01"],
 ".\nConsidering a flux tube of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[DifferentialD]", 
     SuperscriptBox["q", "2"]}], "\[Times]", 
    RowBox[{"\[DifferentialD]", 
     SuperscriptBox["q", "3"]}]}], TraditionalForm]],ExpressionUUID->
  "216ed02c-290c-4811-9019-b7bd97c3fab7"],
 " wide, the integrated number of particles with respect to ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["q", "1"], TraditionalForm]],ExpressionUUID->
  "17b6ca48-0480-46be-b52a-d9033c00820a"],
 " is given by\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"N", "(", 
      SuperscriptBox["q", "1"], ")"}], 
     SubscriptBox["n", "0"]], "=", 
    RowBox[{
     SubscriptBox["\[CapitalDelta]", "1"], 
     SubscriptBox["\[CapitalDelta]", "2"], 
     SubscriptBox["\[CapitalDelta]", "3"], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "2"]}], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "3"]}], 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", 
       SuperscriptBox["q", "1"]], 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Beta]", "0"]}]], 
       RowBox[{"(", 
        RowBox[{"\[Eta]", "-", 
         RowBox[{
          SubscriptBox["\[Beta]", "0"], 
          SubscriptBox["\[Eta]", "\[Beta]"]}]}], ")"}], 
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox["q", "1"]}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     SubscriptBox["\[CapitalDelta]", "1"], 
     SubscriptBox["\[CapitalDelta]", "2"], 
     SubscriptBox["\[CapitalDelta]", "3"], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "2"]}], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "3"]}], 
     FractionBox["1", 
      RowBox[{"1", "-", 
       SubscriptBox["\[Beta]", "0"]}]], 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{
         SuperscriptBox["tan", 
          RowBox[{"-", "1"}]], "(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["\[Theta]", 
             RowBox[{"\[UpTee]", 
              RowBox[{",", "0"}]}]], "/", 
            SubscriptBox["\[Theta]", 
             RowBox[{"\[DoubleVerticalBar]", 
              RowBox[{",", "0"}]}]]}], ")"}], 
          RowBox[{"tan", "(", 
           RowBox[{"\[Xi]", " ", 
            SubscriptBox["\[CapitalDelta]", "1"], 
            SuperscriptBox["q", "1"]}], ")"}]}], ")"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["\[Theta]", 
            RowBox[{"\[UpTee]", 
             RowBox[{",", "0"}]}]], "/", 
           SubscriptBox["\[Theta]", 
            RowBox[{"\[DoubleVerticalBar]", 
             RowBox[{",", "0"}]}]]}], ")"}], 
         SubscriptBox["\[CapitalDelta]", "1"], "\[Xi]"}]], "-", 
       RowBox[{
        SubscriptBox["\[Beta]", "0"], 
        FractionBox[
         RowBox[{
          SuperscriptBox["tan", 
           RowBox[{"-", "1"}]], "(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SqrtBox[
              SubscriptBox["\[Beta]", "0"]], 
             RowBox[{
              SubscriptBox["\[Theta]", 
               RowBox[{"\[UpTee]", 
                RowBox[{",", "0"}]}]], "/", 
              SubscriptBox["\[Theta]", 
               RowBox[{"\[DoubleVerticalBar]", 
                RowBox[{",", "0"}]}]]}]}], ")"}], 
           RowBox[{"tan", "(", 
            RowBox[{"\[Xi]", " ", 
             SubscriptBox["\[CapitalDelta]", "1"], 
             SuperscriptBox["q", "1"]}], ")"}]}], ")"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SqrtBox[
             SubscriptBox["\[Beta]", "0"]], 
            RowBox[{
             SubscriptBox["\[Theta]", 
              RowBox[{"\[UpTee]", 
               RowBox[{",", "0"}]}]], "/", 
             SubscriptBox["\[Theta]", 
              RowBox[{"\[DoubleVerticalBar]", 
               RowBox[{",", "0"}]}]]}]}], ")"}], 
          SubscriptBox["\[CapitalDelta]", "1"], "\[Xi]"}]]}]}], ")"}]}]}], 
   TraditionalForm]}],ExpressionUUID->
  "2eb576bd-72a2-43a8-b6e9-af4c59e5b253"],
 ",\nwhere ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"N", "(", "0", ")"}], "=", "0"}], TraditionalForm]],
  ExpressionUUID->"f3efad75-9a38-4052-b613-15266bff945e"],
 ".\nFor small \[Xi],\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"N", "(", 
      SuperscriptBox["q", "1"], ")"}], 
     SubscriptBox["n", "0"]], "\[TildeTilde]", 
    RowBox[{
     SubscriptBox["\[CapitalDelta]", "1"], 
     SubscriptBox["\[CapitalDelta]", "2"], 
     SubscriptBox["\[CapitalDelta]", "3"], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "2"]}], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "3"]}], 
     FractionBox[
      SuperscriptBox["q", "1"], 
      RowBox[{"1", "-", 
       SubscriptBox["\[Beta]", "0"]}]], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{
        FractionBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["\[Theta]", 
              RowBox[{"\[UpTee]", 
               RowBox[{",", "0"}]}]], "/", 
             SubscriptBox["\[Theta]", 
              RowBox[{"\[DoubleVerticalBar]", 
               RowBox[{",", "0"}]}]]}], ")"}], "2"], "-", "1"}], "3"], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"\[Xi]", " ", 
           SubscriptBox["\[CapitalDelta]", "1"], 
           SuperscriptBox["q", "1"]}], ")"}], "2"]}], "-", 
       RowBox[{
        SubscriptBox["\[Beta]", "0"], "(", 
        RowBox[{"1", "-", 
         RowBox[{
          FractionBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{
              SubscriptBox["\[Beta]", "0"], "(", 
              RowBox[{
               SubscriptBox["\[Theta]", 
                RowBox[{"\[UpTee]", 
                 RowBox[{",", "0"}]}]], "/", 
               SubscriptBox["\[Theta]", 
                RowBox[{"\[DoubleVerticalBar]", 
                 RowBox[{",", "0"}]}]]}], ")"}], "2"], "-", "1"}], "3"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"\[Xi]", " ", 
             SubscriptBox["\[CapitalDelta]", "1"], 
             SuperscriptBox["q", "1"]}], ")"}], "2"]}]}], ")"}]}], ")"}]}]}], 
   TraditionalForm]],ExpressionUUID->"c255282d-ed8e-43f4-984c-eb76f381bb70"],
 ".\nThe inverse relation ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["q", "1"], "(", "N", ")"}], TraditionalForm]],
  ExpressionUUID->"2305b02a-b2b1-453f-b7ba-2821dd9bf65c"],
 " is not straightforward."
}], "Text",ExpressionUUID->"48b9b2b4-dc90-4208-8b92-d3a2f8504f03"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]2O\[Theta]1", "=", "3.35"}], ",", 
     RowBox[{"\[Beta]0", "=", ".7"}], ",", 
     RowBox[{"\[Xi]", "=", ".876"}], ",", 
     RowBox[{"q1lim", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "24"}], ",", "50"}], "}"}]}], ",", 
     RowBox[{"\[Xi]\[CapitalDelta]1q1max", "=", 
      RowBox[{
       RowBox[{"Pi", "/", "2"}], "*", ".8"}]}], ",", 
     RowBox[{"nsamples", "=", "50000"}]}], "}"}], ",", "\[IndentingNewLine]", 
   
   RowBox[{"BlockRandom", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "49038", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[CapitalDelta]1", ",", "q1s", ",", "Bs", ",", "xs", ",", "\[Eta]s", 
         ",", "\[Eta]\[Beta]s", ",", "tmp", ",", "int\[Eta]s", ",", 
         "int\[Eta]\[Beta]s", ",", "Nofq1", ",", "q1samples", ",", "bins", 
         ",", "hist"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[CapitalDelta]1", "=", 
         RowBox[{"Divide", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1q1max", ",", 
           RowBox[{"\[Xi]", " ", 
            RowBox[{"Max", "[", 
             RowBox[{"Abs", "[", "q1lim", "]"}], "]"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"q1s", "=", 
         RowBox[{"Range", "@@", "q1lim"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xs", "=", 
         RowBox[{
          RowBox[{"Tan", "[", 
           RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1s"}], "]"}], "/",
           "\[Xi]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Bs", "=", 
         RowBox[{
          RowBox[{"Sec", "[", 
           RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1s"}], "]"}], "^",
           "2"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Eta]s", "=", 
         RowBox[{"Divide", "[", 
          RowBox[{"1", ",", 
           RowBox[{
            RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}]}], ")"}], 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1s"}], "]"}], 
              "^", "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"Apply", "[", 
            RowBox[{"And", ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"0", "==", 
               RowBox[{"Chop", "[", 
                RowBox[{"\[Eta]s", "-", 
                 RowBox[{"Power", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"1", "/", "Bs"}]}], ")"}], 
                    RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}]}], "+", 
                    RowBox[{"1", "/", "Bs"}]}], ",", 
                   RowBox[{"-", "1"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
          ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<\[Eta]s incorrect\>\"", "]"}], ";", 
            RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Eta]\[Beta]s", "=", 
         RowBox[{"Divide", "[", 
          RowBox[{"1", ",", 
           RowBox[{
            RowBox[{"\[Beta]0", " ", 
             RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"\[Beta]0", " ", 
                RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}]}]}], ")"}], 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1s"}], "]"}], 
              "^", "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"Apply", "[", 
            RowBox[{"And", ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"0", "==", 
               RowBox[{"Chop", "[", 
                RowBox[{"\[Eta]\[Beta]s", "-", 
                 RowBox[{"Power", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"1", "/", "Bs"}]}], ")"}], "\[Beta]0", " ", 
                    RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}]}], "+", 
                    RowBox[{"1", "/", "Bs"}]}], ",", 
                   RowBox[{"-", "1"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
          ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<\[Eta]s incorrect\>\"", "]"}], ";", 
            RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"int\[Eta]s", "=", 
         RowBox[{
          RowBox[{"ArcTan", "[", 
           RowBox[{"\[Theta]2O\[Theta]1", " ", 
            RowBox[{"Tan", "[", 
             RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1s"}], "]"}]}], 
           "]"}], "/", 
          RowBox[{"(", 
           RowBox[{
           "\[CapitalDelta]1", " ", "\[Xi]", " ", "\[Theta]2O\[Theta]1"}], 
           ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{"MinMax", "[", "int\[Eta]s", "]"}], "-", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"NIntegrate", "[", 
              RowBox[{
               RowBox[{"Divide", "[", 
                RowBox[{"1", ",", 
                 RowBox[{
                  RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}]}], ")"}], 
                   RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1"}], 
                    "]"}], "^", "2"}]}]}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"q1", ",", "0", ",", "#"}], "}"}]}], "]"}], "&"}], 
            ",", 
            RowBox[{"MinMax", "[", "q1s", "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"Apply", "[", 
            RowBox[{"And", ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"0", "==", 
               RowBox[{"Chop", "[", "tmp", "]"}]}], "]"}]}], "]"}]}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<int\[Eta](q1) incorrect\>\"", "]"}], 
            ";", 
            RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"int\[Eta]\[Beta]s", "=", 
         RowBox[{
          RowBox[{"ArcTan", "[", 
           RowBox[{
            SqrtBox["\[Beta]0"], "\[Theta]2O\[Theta]1", " ", 
            RowBox[{"Tan", "[", 
             RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1s"}], "]"}]}], 
           "]"}], "/", 
          RowBox[{"(", 
           RowBox[{"\[CapitalDelta]1", " ", "\[Xi]", " ", 
            SqrtBox["\[Beta]0"], "\[Theta]2O\[Theta]1"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{"MinMax", "[", "int\[Eta]\[Beta]s", "]"}], "-", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"NIntegrate", "[", 
              RowBox[{
               RowBox[{"Divide", "[", 
                RowBox[{"1", ",", 
                 RowBox[{
                  RowBox[{"\[Beta]0", " ", 
                   RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"\[Beta]0", " ", 
                    RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}]}]}], ")"}], 
                   RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1"}], 
                    "]"}], "^", "2"}]}]}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"q1", ",", "0", ",", "#"}], "}"}]}], "]"}], "&"}], 
            ",", 
            RowBox[{"MinMax", "[", "q1s", "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"Apply", "[", 
            RowBox[{"And", ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"0", "==", 
               RowBox[{"Chop", "[", "tmp", "]"}]}], "]"}]}], "]"}]}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
            "Print", "[", "\"\<int\[Eta]\[Beta](q1) incorrect\>\"", "]"}], 
            ";", 
            RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Nofq1", "=", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Beta]0"}], ")"}]}], 
          RowBox[{"(", 
           RowBox[{"int\[Eta]s", "-", 
            RowBox[{"\[Beta]0", " ", "int\[Eta]\[Beta]s"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Beta]0"}], ")"}]}], 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"NIntegrate", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Divide", "[", 
                 RowBox[{"1", ",", 
                  RowBox[{
                   RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}]}], ")"}], 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1"}], 
                    "]"}], "^", "2"}]}]}]}], "]"}], "-", 
                RowBox[{"\[Beta]0", " ", 
                 RowBox[{"Divide", "[", 
                  RowBox[{"1", ",", 
                   RowBox[{
                    RowBox[{"\[Beta]0", " ", 
                    RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"\[Beta]0", " ", 
                    RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}]}]}], ")"}], 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1"}], 
                    "]"}], "^", "2"}]}]}]}], "]"}]}]}], ",", 
               RowBox[{"{", 
                RowBox[{"q1", ",", "0", ",", "#"}], "}"}]}], "]"}], "&"}], 
            ",", 
            RowBox[{"MinMax", "[", "q1s", "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"Apply", "[", 
            RowBox[{"And", ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"0", "==", 
               RowBox[{"Chop", "[", 
                RowBox[{
                 RowBox[{"MinMax", "[", "Nofq1", "]"}], "-", "tmp"}], "]"}]}],
               "]"}]}], "]"}]}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<N(q1) incorrect\>\"", "]"}], ";", 
            RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"q1samples", "=", 
         RowBox[{
          RowBox[{"Interpolation", "[", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"Nofq1", ",", "q1s"}], "}"}], "]"}], "]"}], "[", 
          RowBox[{"RandomReal", "[", 
           RowBox[{
            RowBox[{"MinMax", "[", "Nofq1", "]"}], ",", "nsamples"}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"bins", ",", "hist"}], "}"}], "=", 
         RowBox[{"N", "@", 
          RowBox[{"HistogramList", "[", 
           RowBox[{"q1samples", ",", 
            RowBox[{"Append", "[", 
             RowBox[{"q1lim", ",", "1"}], "]"}], ",", "\"\<Count\>\""}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bins", "=", 
         RowBox[{"Flatten", "[", "bins", "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{"#", ",", "\[IndentingNewLine]", 
            RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
           "]"}], "&"}], "/@", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"q1s", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
                RowBox[{"{", 
                 RowBox[{"\[Eta]s", ",", "\[Eta]\[Beta]s", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"\[Eta]s", "-", 
                    RowBox[{"\[Beta]0", " ", "\[Eta]\[Beta]s"}]}], ")"}], "/", 
                   RowBox[{"(", 
                    RowBox[{"1", "-", "\[Beta]0"}], ")"}]}]}], "}"}]}], ",", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               RowBox[{"AxesLabel", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<\\!\\(\!\(\*SuperscriptBox[\(q\), \(1\)]\)\\)\>\"", 
                  ",", "\"\<\\!\\(\[Eta](\!\(\*SuperscriptBox[\(q\), \
\(1\)]\))\\)\>\""}], "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListStepPlot", "[", 
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"MovingAverage", "[", 
                   RowBox[{"bins", ",", "2"}], "]"}], ",", 
                  RowBox[{"hist", "/", 
                   RowBox[{"Max", "[", "hist", "]"}]}]}], "}"}], "]"}], ",", 
               "Center", ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Red", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1s", ",", 
                  RowBox[{"Nofq1", "-", 
                   RowBox[{"Min", "[", "Nofq1", "]"}]}]}], "}"}], "]"}], ",", 
               
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1s", ",", 
                  RowBox[{"int\[Eta]s", "-", 
                   RowBox[{"Min", "[", "int\[Eta]s", "]"}]}]}], "}"}], "]"}], 
               ",", 
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1s", ",", 
                  RowBox[{"int\[Eta]\[Beta]s", "-", 
                   RowBox[{"Min", "[", "int\[Eta]\[Beta]s", "]"}]}]}], "}"}], 
                "]"}]}], "}"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"AxesLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<\\!\\(\!\(\*SuperscriptBox[\(q\), \(1\)]\)\\)\>\"", ",", 
                "\"\<\\!\\(N(\!\(\*SuperscriptBox[\(q\), \(1\)]\))\\)\>\""}], 
               "}"}]}], ",", 
             RowBox[{"GridLines", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"00fd0186-4b7a-46cf-91ce-a7b00623ed4c"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Beta]1", "=", 
      RowBox[{"1.5", "*", "2.1"}]}], ",", 
     RowBox[{"T2OT1", "=", "5.35"}], ",", 
     RowBox[{"q1lim", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "7"}], ",", "15"}], "}"}]}], ",", 
     RowBox[{"\[CapitalDelta]1", "=", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Get", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<~/Downloads\>\"", ",", 
          "\"\<LossconeVDF-bi_max-homogeneous.m\>\""}], "}"}], "]"}], 
       "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "vel", ",", "pos", ",", "q1s", ",", "\[Eta]s", ",", "binpos", ",", 
       "histpos", ",", "binv1", ",", "histv1", ",", "binv2", ",", "histv2", 
       ",", "binv3", ",", "histv3"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"q1s", "=", 
       RowBox[{"Range", "@@", "q1lim"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]s", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"1.", ",", 
         RowBox[{"Length", "[", "q1s", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vel", "=", 
       RowBox[{
        RowBox[{"Compile", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"v", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Divide", "[", 
           RowBox[{"v", ",", 
            SqrtBox[
             RowBox[{"\[Beta]1", 
              RowBox[{"{", 
               RowBox[{"1", ",", "T2OT1", ",", "T2OT1"}], "}"}]}]]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"RuntimeAttributes", "\[Rule]", 
           RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}], 
        "[", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"Join", "@@", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binpos", ",", "histpos"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"pos", ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"q1lim", "+", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"+", ".5"}], ",", 
              RowBox[{"-", ".5"}]}], "}"}]}], ",", "1"}], "]"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binv1", ",", "histv1"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"vel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3"}], ",", "3", ",", ".2"}], "}"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binv2", ",", "histv2"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"vel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3"}], ",", "3", ",", ".2"}], "}"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binv3", ",", "histv3"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"vel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3"}], ",", "3", ",", ".2"}], "}"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"q1s", ",", "\[Eta]s"}], "}"}], "]"}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binpos", ",", "2"}], "]"}], ",", 
               RowBox[{"histpos", "/", 
                RowBox[{"Max", "[", "histpos", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{"v", "^", "2"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"v", ",", 
              RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binv1", ",", "2"}], "]"}], ",", 
               RowBox[{"histv1", "/", 
                RowBox[{"Max", "[", "histv1", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{"v", "^", "2"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"v", ",", 
              RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binv2", ",", "2"}], "]"}], ",", 
               RowBox[{"histv2", "/", 
                RowBox[{"Max", "[", "histv2", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{"v", "^", "2"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"v", ",", 
              RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binv3", ",", "2"}], "]"}], ",", 
               RowBox[{"histv3", "/", 
                RowBox[{"Max", "[", "histv3", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}]}], "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[2]:=",ExpressionUUID->"fb36ed3c-9923-4026-ab72-299f5e035ccb"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Beta]1", "=", 
      RowBox[{"1.5", "*", "2.1"}]}], ",", 
     RowBox[{"T2OT1eq", "=", "5.35"}], ",", 
     RowBox[{"\[Xi]", "=", ".876"}], ",", 
     RowBox[{"q1lim", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "7"}], ",", "15"}], "}"}]}], ",", 
     RowBox[{"\[Xi]\[CapitalDelta]1q1max", "=", 
      RowBox[{
       RowBox[{"Pi", "/", "2"}], "*", ".8"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Get", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<~/Downloads\>\"", ",", 
          "\"\<LossconeVDF-bi_max-inhomogeneous.m\>\""}], "}"}], "]"}], 
       "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "vel", ",", "pos", ",", "\[CapitalDelta]1", ",", "q1s", ",", "\[Eta]s", 
       ",", "binpos", ",", "histpos", ",", "binv1", ",", "histv1", ",", 
       "binv2", ",", "histv2", ",", "binv3", ",", "histv3"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[CapitalDelta]1", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"\[Xi]\[CapitalDelta]1q1max", ",", 
         RowBox[{"\[Xi]", " ", 
          RowBox[{"Max", "[", 
           RowBox[{"Abs", "[", "q1lim", "]"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1s", "=", 
       RowBox[{"Range", "@@", "q1lim"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
        RowBox[{"Divide", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Apply", "[", 
           RowBox[{"Subtract", ",", 
            RowBox[{
             RowBox[{"ArcTan", "[", 
              RowBox[{
               SqrtBox["T2OT1eq"], 
               RowBox[{"Tan", "[", 
                RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", 
                 RowBox[{"{", 
                  RowBox[{".5", ",", 
                   RowBox[{"-", ".5"}]}], "}"}]}], "]"}]}], "]"}], "/", 
             RowBox[{"(", 
              RowBox[{"\[Xi]", 
               SqrtBox["T2OT1eq"]}], ")"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Apply", "[", 
           RowBox[{"Subtract", ",", 
            RowBox[{
             RowBox[{"ArcTan", "[", 
              RowBox[{
               SqrtBox["T2OT1eq"], 
               RowBox[{"Tan", "[", 
                RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", 
                 RowBox[{"q1s", "[", 
                  RowBox[{"[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], "]"}]}], 
                "]"}]}], "]"}], "/", 
             RowBox[{"(", 
              RowBox[{"\[Xi]", 
               SqrtBox["T2OT1eq"]}], ")"}]}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}], "//", "CForm"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]s", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{"T2OT1eq", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "T2OT1eq"}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1s"}], "]"}], 
            "^", "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"Join", "@@", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vel", "=", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vel", "=", 
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
            RowBox[{"Divide", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1q1max", ",", 
              RowBox[{"Max", "[", 
               RowBox[{"Abs", "[", "q1lim", "]"}], "]"}]}], "]"}]}], "}"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Compile", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"v", ",", "_Real", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "_Real"}], "}"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\[Eta]", ",", "T2OT1"}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"\[Eta]", "=", 
                RowBox[{"Divide", "[", 
                 RowBox[{"1", ",", 
                  RowBox[{"T2OT1eq", "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "T2OT1eq"}], ")"}], 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
                    "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"T2OT1", "=", 
                RowBox[{"T2OT1eq", " ", "\[Eta]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Divide", "[", 
                RowBox[{"v", ",", 
                 SqrtBox[
                  RowBox[{"\[Beta]1", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "T2OT1", ",", "T2OT1"}], "}"}]}]]}], 
                "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"RuntimeAttributes", "\[Rule]", 
             RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", 
           "]"}]}], "\[IndentingNewLine]", "]"}], "[", 
        RowBox[{"vel", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binpos", ",", "histpos"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"pos", ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"q1lim", "+", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"+", ".5"}], ",", 
              RowBox[{"-", ".5"}]}], "}"}]}], ",", "1"}], "]"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binv1", ",", "histv1"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"vel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3"}], ",", "3", ",", ".2"}], "}"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binv2", ",", "histv2"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"vel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3"}], ",", "3", ",", ".2"}], "}"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binv3", ",", "histv3"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"vel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3"}], ",", "3", ",", ".2"}], "}"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"q1s", ",", "\[Eta]s"}], "}"}], "]"}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binpos", ",", "2"}], "]"}], ",", 
               RowBox[{"histpos", "/", 
                RowBox[{"Max", "[", "histpos", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{"v", "^", "2"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"v", ",", 
              RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binv1", ",", "2"}], "]"}], ",", 
               RowBox[{"histv1", "/", 
                RowBox[{"Max", "[", "histv1", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{"v", "^", "2"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"v", ",", 
              RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binv2", ",", "2"}], "]"}], ",", 
               RowBox[{"histv2", "/", 
                RowBox[{"Max", "[", "histv2", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{"v", "^", "2"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"v", ",", 
              RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binv3", ",", "2"}], "]"}], ",", 
               RowBox[{"histv3", "/", 
                RowBox[{"Max", "[", "histv3", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}]}], "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[3]:=",ExpressionUUID->"f4611cd8-4e7e-46b6-9ab9-dcb45fa32a71"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Beta]1", "=", 
      RowBox[{"1.5", "*", "2.1"}]}], ",", 
     RowBox[{"\[Beta]", "=", ".9"}], ",", 
     RowBox[{"T2OT1", "=", "5.35"}], ",", 
     RowBox[{"q1lim", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "7"}], ",", "15"}], "}"}]}], ",", 
     RowBox[{"\[CapitalDelta]1", "=", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Get", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<~/Downloads\>\"", ",", "\"\<LossconeVDF-homogeneous.m\>\""}], 
         "}"}], "]"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Theta]2O\[Theta]1", ",", "vel", ",", "pos", ",", "q1s", ",", 
       "\[Eta]s", ",", "binpos", ",", "histpos", ",", "binv1", ",", "histv1", 
       ",", "binv2", ",", "histv2", ",", "binv3", ",", "histv3", ",", "vperp",
        ",", "fperp"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       SqrtBox[
        RowBox[{"T2OT1", "/", 
         RowBox[{"(", 
          RowBox[{"1", "+", "\[Beta]"}], ")"}]}]]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1s", "=", 
       RowBox[{"Range", "@@", "q1lim"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]s", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"1.", ",", 
         RowBox[{"Length", "[", "q1s", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vel", "=", 
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ratio", "=", 
            RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Compile", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"v", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Divide", "[", 
             RowBox[{"v", ",", 
              SqrtBox[
               RowBox[{"\[Beta]1", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "ratio", ",", "ratio"}], "}"}]}]]}], "]"}],
             ",", "\[IndentingNewLine]", 
            RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"RuntimeAttributes", "\[Rule]", 
             RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", 
           "]"}]}], "\[IndentingNewLine]", "]"}], "[", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"Join", "@@", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binpos", ",", "histpos"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"pos", ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"q1lim", "+", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"+", ".5"}], ",", 
              RowBox[{"-", ".5"}]}], "}"}]}], ",", "1"}], "]"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binv1", ",", "histv1"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"vel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3"}], ",", "3", ",", ".2"}], "}"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binv2", ",", "histv2"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"vel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3"}], ",", "3", ",", ".2"}], "}"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binv3", ",", "histv3"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"vel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3"}], ",", "3", ",", ".2"}], "}"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vperp", "=", 
       RowBox[{"Array", "[", 
        RowBox[{"N", ",", "301", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fperp", "=", 
       RowBox[{
        RowBox[{"Subtract", "[", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"-", 
            RowBox[{"vperp", "^", "2"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"vperp", "^", "2"}]}], "/", "\[Beta]"}], "]"}], 
           SqrtBox["\[Beta]"]}]}], "]"}], "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Beta]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"fperp", "/=", 
       RowBox[{"Max", "[", "fperp", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"q1s", ",", "\[Eta]s"}], "}"}], "]"}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binpos", ",", "2"}], "]"}], ",", 
               RowBox[{"histpos", "/", 
                RowBox[{"Max", "[", "histpos", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{"v", "^", "2"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"v", ",", 
              RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binv1", ",", "2"}], "]"}], ",", 
               RowBox[{"histv1", "/", 
                RowBox[{"Max", "[", "histv1", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"vperp", ",", "fperp"}], "}"}], "]"}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binv2", ",", "2"}], "]"}], ",", 
               RowBox[{"histv2", "/", 
                RowBox[{"Max", "[", "histv2", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"vperp", ",", "fperp"}], "}"}], "]"}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binv3", ",", "2"}], "]"}], ",", 
               RowBox[{"histv3", "/", 
                RowBox[{"Max", "[", "histv3", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}]}], "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[5]:=",ExpressionUUID->"6ca1c9d6-8628-4b23-90fa-47b77de4ac9d"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Beta]1", "=", 
      RowBox[{"1.5", "*", "2.1"}]}], ",", 
     RowBox[{"\[Beta]", "=", ".9"}], ",", 
     RowBox[{"T2OT1eq", "=", "5.35"}], ",", 
     RowBox[{"\[Xi]", "=", ".876"}], ",", 
     RowBox[{"q1lim", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "7"}], ",", "15"}], "}"}]}], ",", 
     RowBox[{"\[Xi]\[CapitalDelta]1q1max", "=", 
      RowBox[{
       RowBox[{"Pi", "/", "2"}], "*", ".8"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Get", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<~/Downloads\>\"", ",", "\"\<LossconeVDF-inhomogeneous.m\>\""}], 
         "}"}], "]"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Theta]2O\[Theta]1", ",", "\[CapitalDelta]1", ",", "vel", ",", "pos", 
       ",", "q1s", ",", "\[Eta]s", ",", "\[Eta]\[Beta]s", ",", "binpos", ",", 
       "histpos", ",", "binv1", ",", "histv1", ",", "binv2", ",", "vdfv2", 
       ",", "v2s", ",", "fs"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       SqrtBox[
        RowBox[{"T2OT1eq", "/", 
         RowBox[{"(", 
          RowBox[{"1", "+", "\[Beta]"}], ")"}]}]]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]1", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"\[Xi]\[CapitalDelta]1q1max", ",", 
         RowBox[{"\[Xi]", " ", 
          RowBox[{"Max", "[", 
           RowBox[{"Abs", "[", "q1lim", "]"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1s", "=", 
       RowBox[{"Range", "@@", "q1lim"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]s", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1s"}], "]"}], 
            "^", "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]s", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]", " ", 
           RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]", " ", 
              RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1s"}], "]"}], 
            "^", "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vel", "=", 
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ratio", "=", 
            RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Compile", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"v", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Divide", "[", 
             RowBox[{"v", ",", 
              SqrtBox[
               RowBox[{"\[Beta]1", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "ratio", ",", "ratio"}], "}"}]}]]}], "]"}],
             ",", "\[IndentingNewLine]", 
            RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"RuntimeAttributes", "\[Rule]", 
             RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", 
           "]"}]}], "\[IndentingNewLine]", "]"}], "[", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"Join", "@@", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binpos", ",", "histpos"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"pos", ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"q1lim", "+", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"+", ".5"}], ",", 
              RowBox[{"-", ".5"}]}], "}"}]}], ",", "1"}], "]"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binv1", ",", "histv1"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"First", "/@", "vel"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3"}], ",", "3", ",", ".2"}], "}"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binv2", ",", "vdfv2"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Norm", "[", 
            RowBox[{"Rest", "[", "#", "]"}], "]"}], "&"}], "/@", "vel"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "3", ",", ".1"}], "}"}], ",", "\"\<Count\>\""}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vdfv2", "/=", 
       RowBox[{
        RowBox[{"Length", "[", "pos", "]"}], "2", "Pi", " ", 
        RowBox[{"MovingAverage", "[", 
         RowBox[{"binv2", ",", "2"}], "]"}], 
        RowBox[{"Differences", "[", "binv2", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2s", "=", 
       RowBox[{"MovingAverage", "[", 
        RowBox[{
         RowBox[{"Array", "[", 
          RowBox[{"N", ",", "101", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "3"}], "}"}]}], "]"}], ",", "2"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"fs", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"v2", ",", 
          RowBox[{
           RowBox[{"NIntegrate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Function", "[", 
               RowBox[{"q1", ",", "\[IndentingNewLine]", 
                RowBox[{"Module", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"BOB0", ",", "eta", ",", "eta\[Beta]"}], "}"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"BOB0", "=", 
                    RowBox[{
                    RowBox[{"Sec", "[", 
                    RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1"}], 
                    "]"}], "^", "2"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"eta", "=", 
                    RowBox[{"Divide", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"1", "/", "BOB0"}]}], ")"}], 
                    RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}]}], "+", 
                    RowBox[{"1", "/", "BOB0"}]}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"eta\[Beta]", "=", 
                    RowBox[{"Divide", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"1", "/", "BOB0"}]}], ")"}], "\[Beta]", " ", 
                    RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}]}], "+", 
                    RowBox[{"1", "/", "BOB0"}]}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"v2", "^", "2"}]}], "/", "eta"}], "]"}], "-", 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"v2", "^", "2"}]}], "/", "\[Beta]"}], "/", 
                    "eta\[Beta]"}], "]"}]}], ")"}], "/", "Pi"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "\[Beta]"}], ")"}]}]}]}], 
                 "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}],
               "[", "q1", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"q1", ",", 
               RowBox[{"q1lim", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"q1lim", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], "/", 
           "10.552208906945133"}], ",", 
          RowBox[{"{", "Listable", "}"}]}], "]"}], "[", "v2s", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"q1s", ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[Eta]s", "-", 
                  RowBox[{"\[Beta]", " ", "\[Eta]\[Beta]s"}]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "\[Beta]"}], ")"}]}]}], "}"}], "]"}], ",", 
            
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binpos", ",", "2"}], "]"}], ",", 
               RowBox[{"histpos", "/", 
                RowBox[{"Max", "[", "histpos", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{"v", "^", "2"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"v", ",", 
              RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binv1", ",", "2"}], "]"}], ",", 
               RowBox[{"histv1", "/", 
                RowBox[{"Max", "[", "histv1", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"v2s", ",", "fs"}], "}"}], "]"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binv2", ",", "2"}], "]"}], ",", "vdfv2"}], "}"}], 
             "]"}], ",", "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}]}], "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[74]:=",ExpressionUUID->"c7382360-735d-4d71-b542-1b74707f219a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Partial shell velocity distribution", "Subsection",ExpressionUUID->"a79946d6-a6ef-47ab-a449-4289d75f19d7"],

Cell[TextData[{
 Cell[BoxData[{
  FormBox[
   RowBox[{
    SubscriptBox["f", "0"], "(", 
    RowBox[{
     SubscriptBox["v", 
      RowBox[{"\[DoubleVerticalBar]", 
       RowBox[{",", "0"}]}]], ",", 
     SubscriptBox["v", 
      RowBox[{"\[UpTee]", 
       RowBox[{",", "0"}]}]]}], ")"}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     FractionBox[
      SubscriptBox["n", "0"], 
      RowBox[{"2", "\[Pi]", " ", 
       SubsuperscriptBox["\[Theta]", "0", "3"], 
       RowBox[{"\[ScriptCapitalA]", "(", 
        RowBox[{
         SubscriptBox["v", "s"], "/", 
         SubscriptBox["\[Theta]", "0"]}], ")"}], 
       SubscriptBox["\[ScriptCapitalB]", "\[Zeta]"]}]], 
     RowBox[{"Exp", "[", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["v", "0"], "-", 
           SubscriptBox["v", "s"]}], ")"}], "2"], 
        SubsuperscriptBox["\[Theta]", "0", "2"]]}], "]"}], 
     SuperscriptBox["sin", "\[Zeta]"], 
     SubscriptBox["\[Alpha]", "0"]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     FractionBox[
      SubscriptBox["n", "0"], 
      RowBox[{"2", "\[Pi]", " ", 
       SubsuperscriptBox["\[Theta]", "0", "3"], 
       RowBox[{"\[ScriptCapitalA]", "(", 
        RowBox[{
         SubscriptBox["v", "s"], "/", 
         SubscriptBox["\[Theta]", "0"]}], ")"}], 
       SubscriptBox["\[ScriptCapitalB]", "\[Zeta]"]}]], 
     RowBox[{"Exp", "[", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["v", "0"], "-", 
           SubscriptBox["v", "s"]}], ")"}], "2"], 
        SubsuperscriptBox["\[Theta]", "0", "2"]]}], "]"}], 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox[
        SubscriptBox["v", 
         RowBox[{"\[UpTee]", 
          RowBox[{",", "0"}]}]], 
        SubscriptBox["v", "0"]], ")"}], "\[Zeta]"]}]}], TraditionalForm]}],
  ExpressionUUID->"d8d3ebdd-6114-4a7f-a45b-0663fca1492b"],
 ",\nwhere\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[ScriptCapitalA]", "(", "b", ")"}], "=", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"-", 
          SuperscriptBox["b", "2"]}]]}], "+", 
       RowBox[{
        SqrtBox["\[Pi]"], 
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", "2"], "+", 
          SuperscriptBox["b", "2"]}], ")"}], 
        RowBox[{"Erfc", "[", 
         RowBox[{"-", "b"}], "]"}]}]}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"ef4c3a37-f464-4245-9372-254296edd79d"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[ScriptCapitalB]", "\[Zeta]"], "=", 
    RowBox[{
     SqrtBox["\[Pi]"], 
     FractionBox[
      RowBox[{"\[CapitalGamma]", "[", 
       RowBox[{"1", "+", 
        RowBox[{"\[Zeta]", "/", "2"}]}], "]"}], 
      RowBox[{"\[CapitalGamma]", "[", 
       RowBox[{"1.5", "+", 
        RowBox[{"\[Zeta]", "/", "2"}]}], "]"}]]}]}], TraditionalForm]],
  ExpressionUUID->"f34ca6bb-a1a0-4be6-aa14-5b293a8506f4"],
 ".\nSubstitute ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["v", "0"], "=", "v"}], TraditionalForm]],ExpressionUUID->
  "b81de228-4396-4670-9702-4ff0bd120ad5"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["v", 
     RowBox[{"\[UpTee]", 
      RowBox[{",", "0"}]}]], "=", 
    RowBox[{
     SqrtBox[
      RowBox[{
       SubscriptBox["B", "0"], "/", "B"}]], 
     SubscriptBox["v", "\[UpTee]"]}]}], TraditionalForm]],ExpressionUUID->
  "2a8693e6-953a-4cb4-b36e-363f828bd83b"],
 ":\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    RowBox[{"f", "(", 
     RowBox[{
      SubscriptBox["v", "\[DoubleVerticalBar]"], ",", 
      SubscriptBox["v", "\[UpTee]"]}], ")"}], "=", 
    RowBox[{
     FractionBox[
      SubscriptBox["n", "0"], 
      RowBox[{"2", "\[Pi]", " ", 
       SubsuperscriptBox["\[Theta]", "0", "3"], 
       RowBox[{"\[ScriptCapitalA]", "(", 
        RowBox[{
         SubscriptBox["v", "s"], "/", 
         SubscriptBox["\[Theta]", "0"]}], ")"}], 
       SubscriptBox["\[ScriptCapitalB]", "\[Zeta]"]}]], 
     RowBox[{"Exp", "[", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"v", "-", 
           SubscriptBox["v", "s"]}], ")"}], "2"], 
        SubsuperscriptBox["\[Theta]", "0", "2"]]}], "]"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SqrtBox[
         FractionBox[
          SubscriptBox["B", "0"], "B"]], 
        FractionBox[
         SubscriptBox["v", "\[UpTee]"], "v"]}], ")"}], "\[Zeta]"]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     FractionBox[
      SubscriptBox["n", "0"], 
      RowBox[{"2", "\[Pi]", " ", 
       SubsuperscriptBox["\[Theta]", "0", "3"], 
       RowBox[{"\[ScriptCapitalA]", "(", 
        RowBox[{
         SubscriptBox["v", "s"], "/", 
         SubscriptBox["\[Theta]", "0"]}], ")"}], 
       SubscriptBox["\[ScriptCapitalB]", "\[Zeta]"]}]], 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox[
        SubscriptBox["B", "0"], "B"], ")"}], 
      RowBox[{"\[Zeta]", "/", "2"}]], 
     RowBox[{"Exp", "[", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"v", "-", 
           SubscriptBox["v", "s"]}], ")"}], "2"], 
        SubsuperscriptBox["\[Theta]", "0", "2"]]}], "]"}], 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox[
        SubscriptBox["v", "\[UpTee]"], "v"], ")"}], "\[Zeta]"]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     FractionBox["n", 
      RowBox[{"2", "\[Pi]", " ", 
       SuperscriptBox["\[Theta]", "3"], 
       RowBox[{"\[ScriptCapitalA]", "(", 
        RowBox[{
         SubscriptBox["v", "s"], "/", "\[Theta]"}], ")"}], 
       SubscriptBox["\[ScriptCapitalB]", "\[Zeta]"]}]], 
     RowBox[{"Exp", "[", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"v", "-", 
           SubscriptBox["v", "s"]}], ")"}], "2"], 
        SuperscriptBox["\[Theta]", "2"]]}], "]"}], 
     SuperscriptBox["sin", "\[Zeta]"], "\[Alpha]"}]}], TraditionalForm]}],
  ExpressionUUID->"02e6ca21-9e27-446c-b043-13905a731d37"],
 ",\nwhere ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Eta]", "\[Congruent]", 
     FractionBox["n", 
      SubscriptBox["n", "0"]]}], "=", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox[
       SubscriptBox["B", "0"], "B"], ")"}], 
     RowBox[{"\[Zeta]", "/", "2"}]]}], TraditionalForm]],ExpressionUUID->
  "55f4b2b7-1fa5-488f-a316-75c67d83eaec"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Theta]", "=", 
    SubscriptBox["\[Theta]", "0"]}], TraditionalForm]],ExpressionUUID->
  "41b407f0-4f88-43bf-affc-c54081d755f9"],
 "."
}], "Text",ExpressionUUID->"1c016d35-f8cb-48bc-b17e-eb0e1794c348"],

Cell[TextData[{
 "Moments:\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{
     "\[LeftAngleBracket]", "\[DoubleStruckV]\[DoubleStruckV]", 
      "\[RightAngleBracket]"}], "\[DoubleVerticalBar]"], "=", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      SubsuperscriptBox["v", "\[DoubleVerticalBar]", "2"], 
      "\[RightAngleBracket]"}], "=", 
     RowBox[{"\[Integral]", 
      RowBox[{
       SubsuperscriptBox["v", "\[DoubleVerticalBar]", "2"], 
       RowBox[{"f", "(", 
        RowBox[{"v", ",", "\[Alpha]"}], ")"}], "2", "\[Pi]", " ", 
       SuperscriptBox["v", "2"], "sin", "\[VeryThinSpace]", "\[Alpha]", 
       RowBox[{"\[DifferentialD]", "v"}], 
       RowBox[{"\[DifferentialD]", "\[Alpha]"}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{"n", " ", 
     SuperscriptBox["\[Theta]", "2"], 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", "\[Infinity]"], 
      RowBox[{
       SuperscriptBox["x", "2"], 
       FractionBox[
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"x", "-", 
             SubscriptBox["x", "s"]}], ")"}], "2"]}], "]"}], 
        RowBox[{"\[ScriptCapitalA]", "(", 
         RowBox[{
          SubscriptBox["v", "s"], "/", "\[Theta]"}], ")"}]], 
       SuperscriptBox["x", "2"], 
       RowBox[{"\[DifferentialD]", "x"}], 
       RowBox[{
        SubsuperscriptBox["\[Integral]", "0", "\[Pi]"], 
        RowBox[{
         SuperscriptBox["cos", "2"], "\[Alpha]", 
         FractionBox[
          RowBox[{
           SuperscriptBox["sin", 
            RowBox[{"\[Zeta]", "+", "1"}]], "\[Alpha]"}], 
          SubscriptBox["\[ScriptCapitalB]", "\[Zeta]"]], 
         RowBox[{"\[DifferentialD]", "\[Alpha]"}]}]}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{"n", 
     FractionBox[
      SuperscriptBox["\[Theta]", "2"], 
      RowBox[{"3", "+", "\[Zeta]"}]], 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", "\[Infinity]"], 
      RowBox[{
       SuperscriptBox["x", "2"], 
       FractionBox[
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"x", "-", 
             SubscriptBox["x", "s"]}], ")"}], "2"]}], "]"}], 
        RowBox[{"\[ScriptCapitalA]", "(", 
         RowBox[{
          SubscriptBox["v", "s"], "/", "\[Theta]"}], ")"}]], 
       SuperscriptBox["x", "2"], 
       RowBox[{"\[DifferentialD]", "x"}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{"n", 
     FractionBox["T", 
      RowBox[{"3", "+", "\[Zeta]"}]]}]}], TraditionalForm]}],ExpressionUUID->
  "09571a6d-4114-42bf-ab5a-32ab4e62b23e"],
 ";\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{
     "\[LeftAngleBracket]", "\[DoubleStruckV]\[DoubleStruckV]", 
      "\[RightAngleBracket]"}], "\[UpTee]"], "=", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      FractionBox[
       SubsuperscriptBox["v", "\[UpTee]", "2"], "2"], 
      "\[RightAngleBracket]"}], "=", 
     RowBox[{"\[Integral]", 
      RowBox[{
       FractionBox[
        SubsuperscriptBox["v", "\[UpTee]", "2"], "2"], 
       RowBox[{"f", "(", 
        RowBox[{"v", ",", "\[Alpha]"}], ")"}], "2", "\[Pi]", " ", 
       SuperscriptBox["v", "2"], "sin", "\[VeryThinSpace]", "\[Alpha]", 
       RowBox[{"\[DifferentialD]", "v"}], 
       RowBox[{"\[DifferentialD]", "\[Alpha]"}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{"n", 
     FractionBox[
      SuperscriptBox["\[Theta]", "2"], "2"], 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", "\[Infinity]"], 
      RowBox[{
       SuperscriptBox["x", "2"], 
       FractionBox[
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"x", "-", 
             SubscriptBox["x", "s"]}], ")"}], "2"]}], "]"}], 
        RowBox[{"\[ScriptCapitalA]", "(", 
         RowBox[{
          SubscriptBox["v", "s"], "/", "\[Theta]"}], ")"}]], 
       SuperscriptBox["x", "2"], 
       RowBox[{"\[DifferentialD]", "x"}], 
       RowBox[{
        SubsuperscriptBox["\[Integral]", "0", "\[Pi]"], 
        RowBox[{
         SuperscriptBox["sin", "2"], "\[Alpha]", 
         FractionBox[
          RowBox[{
           SuperscriptBox["sin", 
            RowBox[{"\[Zeta]", "+", "1"}]], "\[Alpha]"}], 
          SubscriptBox["\[ScriptCapitalB]", "\[Zeta]"]], 
         RowBox[{"\[DifferentialD]", "\[Alpha]"}]}]}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{"n", 
     FractionBox[
      RowBox[{"2", "+", "\[Zeta]"}], "2"], 
     FractionBox[
      SuperscriptBox["\[Theta]", "2"], 
      RowBox[{"3", "+", "\[Zeta]"}]], 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", "\[Infinity]"], 
      RowBox[{
       SuperscriptBox["x", "2"], 
       FractionBox[
        RowBox[{"Exp", "[", 
         RowBox[{"-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"x", "-", 
             SubscriptBox["x", "s"]}], ")"}], "2"]}], "]"}], 
        RowBox[{"\[ScriptCapitalA]", "(", 
         RowBox[{
          SubscriptBox["v", "s"], "/", "\[Theta]"}], ")"}]], 
       SuperscriptBox["x", "2"], 
       RowBox[{"\[DifferentialD]", "x"}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{"n", 
     FractionBox[
      RowBox[{"2", "+", "\[Zeta]"}], "2"], 
     FractionBox["T", 
      RowBox[{"3", "+", "\[Zeta]"}]]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     FractionBox[
      RowBox[{"2", "+", "\[Zeta]"}], "2"], 
     RowBox[{"\[LeftAngleBracket]", 
      SubsuperscriptBox["v", "\[DoubleVerticalBar]", "2"], 
      "\[RightAngleBracket]"}]}]}], TraditionalForm]}],ExpressionUUID->
  "2cea6b50-46f9-47a5-8be4-4a8fbcb2182e"],
 ",\nwhere\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox["T", 
     SuperscriptBox["\[Theta]", "2"]], "=", 
    RowBox[{
     RowBox[{
      FractionBox["1", "n"], 
      RowBox[{"\[LeftAngleBracket]", 
       FractionBox[
        SuperscriptBox["v", "2"], 
        SuperscriptBox["\[Theta]", "2"]], "\[RightAngleBracket]"}]}], "=", 
     RowBox[{
      RowBox[{
       SubsuperscriptBox["\[Integral]", "0", "\[Infinity]"], 
       RowBox[{
        SuperscriptBox["x", "2"], 
        FractionBox[
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"x", "-", 
              SubscriptBox["x", "s"]}], ")"}], "2"]}], "]"}], 
         RowBox[{"\[ScriptCapitalA]", "(", 
          RowBox[{
           SubscriptBox["v", "s"], "/", "\[Theta]"}], ")"}]], 
        SuperscriptBox["x", "2"], 
        RowBox[{"\[DifferentialD]", "x"}]}]}], "=", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"2", 
         RowBox[{"\[ScriptCapitalA]", "(", 
          SubscriptBox["x", "s"], ")"}]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           SubscriptBox["x", "s"], "(", 
           RowBox[{
            FractionBox["5", "2"], "+", 
            SubsuperscriptBox["x", "s", "2"]}], ")"}], 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            SubsuperscriptBox["x", "s", "2"]}]]}], "+", 
         RowBox[{
          SqrtBox["\[Pi]"], 
          RowBox[{"(", 
           RowBox[{
            FractionBox["3", "4"], "+", 
            RowBox[{
             SubsuperscriptBox["x", "s", "2"], "(", 
             RowBox[{"3", "+", 
              SubsuperscriptBox["x", "s", "2"]}], ")"}]}], ")"}], 
          RowBox[{"Erfc", "[", 
           RowBox[{"-", 
            SubscriptBox["x", "s"]}], "]"}]}]}], ")"}]}]}]}]}], 
   TraditionalForm]],ExpressionUUID->"d3970bd3-028f-4a83-96f1-96f2eb1d9662"],
 ".\nTo summarize,\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "=", 
    RowBox[{
     SubscriptBox["n", "0"], "\[Eta]"}]}], TraditionalForm]],ExpressionUUID->
  "73788e0f-8c04-40ad-adb5-7c3401809751"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Theta]", "=", 
    SubscriptBox["\[Theta]", "0"]}], TraditionalForm]],ExpressionUUID->
  "1fd122e2-85eb-425c-98ec-7150182f19aa"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["v", "s"], "=", 
    SubscriptBox["v", 
     RowBox[{"s", ",", "0"}]]}], TraditionalForm]],ExpressionUUID->
  "fe58b39c-2a10-4eaa-8ebb-557472368489"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     SubscriptBox["T", "\[UpTee]"], 
     SubscriptBox["T", "\[DoubleVerticalBar]"]], "=", 
    RowBox[{
     FractionBox[
      SubscriptBox["T", 
       RowBox[{"\[UpTee]", 
        RowBox[{",", "0"}]}]], 
      SubscriptBox["T", 
       RowBox[{"\[DoubleVerticalBar]", 
        RowBox[{",", "0"}]}]]], "=", 
     FractionBox[
      RowBox[{"2", "+", "\[Zeta]"}], "2"]}]}], TraditionalForm]],
  ExpressionUUID->"c82b0dc4-08ec-4d02-82bf-c62c12ba3f79"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Eta]", "=", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox[
       SubscriptBox["B", "0"], "B"], ")"}], 
     RowBox[{"\[Zeta]", "/", "2"}]]}], TraditionalForm]],ExpressionUUID->
  "43ffc9f5-d6b5-4a0c-8d13-7ac76d322210"],
 ".\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["T", "\[DoubleVerticalBar]"], "=", 
    FractionBox["T", 
     RowBox[{"3", "+", "\[Zeta]"}]]}], TraditionalForm]],ExpressionUUID->
  "cbd5f0ab-44d0-4c74-8439-b1cb8374f2ed"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["T", "\[UpTee]"], "=", 
    RowBox[{
     FractionBox[
      RowBox[{"2", "+", "\[Zeta]"}], "2"], 
     SubscriptBox["T", "\[DoubleVerticalBar]"]}]}], TraditionalForm]],
  ExpressionUUID->"f9430ddd-7e8e-47ec-8380-648c80831904"],
 ", where ",
 Cell[BoxData[
  FormBox[
   RowBox[{"T", "=", 
    FractionBox[
     RowBox[{"\[LeftAngleBracket]", 
      SuperscriptBox["v", "2"], "\[RightAngleBracket]"}], 
     RowBox[{
      SubscriptBox["n", "0"], "\[Eta]"}]]}], TraditionalForm]],ExpressionUUID->
  "7f6275fa-aba3-4e17-b647-1fd9bbeb8d63"],
 ". (Note that for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Zeta]", "=", "0"}], TraditionalForm]],ExpressionUUID->
  "ac7b587f-379c-46f4-9932-498f9a9abdce"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["T", "\[DoubleVerticalBar]"], "=", 
    RowBox[{
     SubscriptBox["T", "\[UpTee]"], "=", 
     FractionBox["T", "3"]}]}], TraditionalForm]],ExpressionUUID->
  "e907e72d-7b29-49e1-ac59-17bba9110bd3"],
 ").\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["P", 
     RowBox[{"\[DoubleVerticalBar]", 
      RowBox[{",", "\[UpTee]"}]}]], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["n", "0"], "\[Eta]", " ", 
      SubscriptBox["T", 
       RowBox[{"\[DoubleVerticalBar]", 
        RowBox[{",", "\[UpTee]"}]}]]}], "=", 
     RowBox[{
      SubscriptBox["n", "0"], "\[Eta]", " ", 
      SubscriptBox["T", 
       RowBox[{"\[DoubleVerticalBar]", 
        RowBox[{",", 
         RowBox[{"\[UpTee]", 
          RowBox[{",", "0"}]}]}]}]]}]}]}], TraditionalForm]],ExpressionUUID->
  "d8faf914-9f3d-4ca7-83d1-8e6a120b81da"],
 "."
}], "Text",ExpressionUUID->"c8619530-cffc-49d9-a414-2b4472980770"],

Cell[TextData[{
 "For simplicity, we will assume ",
 Cell[BoxData[
  FormBox["\[Zeta]", TraditionalForm]],ExpressionUUID->
  "0fd33be4-758d-4d1f-b4af-946e467d8ebb"],
 " is an integer, satisfying ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Zeta]", ">=", "0"}], TraditionalForm]],ExpressionUUID->
  "cae72211-22aa-4f7a-b82d-5128f073e272"],
 ".\nWe may need the following integrals\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["cos", "\[Zeta]"], "(", 
       RowBox[{"a", " ", "x"}], ")"}], 
      RowBox[{"\[DifferentialD]", "x"}]}]}], "=", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{
               SuperscriptBox["cos", 
                RowBox[{"\[Zeta]", "-", "1"}]], "(", 
               RowBox[{"a", " ", "x"}], ")"}], 
              RowBox[{"sin", "(", 
               RowBox[{"a", " ", "x"}], ")"}]}], 
             RowBox[{"\[Zeta]", " ", "a"}]], "+", 
            RowBox[{
             FractionBox[
              RowBox[{"\[Zeta]", "-", "1"}], "\[Zeta]"], 
             RowBox[{"\[Integral]", 
              RowBox[{
               SuperscriptBox["cos", 
                RowBox[{"\[Zeta]", "-", "2"}]], 
               RowBox[{"(", 
                RowBox[{"a", " ", "x"}], ")"}], 
               RowBox[{"\[DifferentialD]", "x"}]}]}]}]}], 
           RowBox[{"\[Zeta]", ">", "0"}]},
          {
           RowBox[{"x", "+", "C"}], 
           RowBox[{"\[Zeta]", "=", "0"}]}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}},
         Selectable->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False,
     StripWrapperBoxes->True]}], TraditionalForm]],ExpressionUUID->
  "f6876d91-6193-4863-80ea-c683c951da90"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["sin", "\[Zeta]"], "(", 
       RowBox[{"a", " ", "x"}], ")"}], 
      RowBox[{"\[DifferentialD]", "x"}]}]}], "=", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {
           RowBox[{
            RowBox[{"-", 
             FractionBox[
              RowBox[{
               RowBox[{
                SuperscriptBox["sin", 
                 RowBox[{"\[Zeta]", "-", "1"}]], "(", 
                RowBox[{"a", " ", "x"}], ")"}], 
               RowBox[{"cos", "(", 
                RowBox[{"a", " ", "x"}], ")"}]}], 
              RowBox[{"\[Zeta]", " ", "a"}]]}], "+", 
            RowBox[{
             FractionBox[
              RowBox[{"\[Zeta]", "-", "1"}], "\[Zeta]"], 
             RowBox[{"\[Integral]", 
              RowBox[{
               RowBox[{
                SuperscriptBox["sin", 
                 RowBox[{"\[Zeta]", "-", "2"}]], "(", 
                RowBox[{"a", " ", "x"}], ")"}], 
               RowBox[{"\[DifferentialD]", "x"}]}]}]}]}], 
           RowBox[{"\[Zeta]", ">", "0"}]},
          {
           RowBox[{"x", "+", "C"}], 
           RowBox[{"\[Zeta]", "=", "0"}]}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}},
         Selectable->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False,
     StripWrapperBoxes->True]}], TraditionalForm]],ExpressionUUID->
  "fb75f3fe-3e00-4312-8bf6-17cf52d80f97"],
 ".\nFor small ",
 Cell[BoxData[
  FormBox["a", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "980dad50-a20a-4101-aa56-cda498872e36"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["cos", "\[Zeta]"], "(", 
       RowBox[{"a", " ", "x"}], ")"}], 
      RowBox[{"\[DifferentialD]", "x"}]}]}], "\[TildeTilde]", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {
           RowBox[{
            RowBox[{
             FractionBox["x", "\[Zeta]"], 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{
                FractionBox[
                 RowBox[{
                  SuperscriptBox["a", "2"], 
                  SuperscriptBox["x", "2"]}], "6"], 
                RowBox[{"(", 
                 RowBox[{"2", "-", 
                  RowBox[{"3", "\[Zeta]"}]}], ")"}]}]}], ")"}]}], "+", 
            RowBox[{
             FractionBox[
              RowBox[{"\[Zeta]", "-", "1"}], "\[Zeta]"], 
             RowBox[{"\[Integral]", 
              RowBox[{
               SuperscriptBox["cos", 
                RowBox[{"\[Zeta]", "-", "2"}]], 
               RowBox[{"(", 
                RowBox[{"a", " ", "x"}], ")"}], 
               RowBox[{"\[DifferentialD]", "x"}]}]}]}]}], 
           RowBox[{"\[Zeta]", ">", "0"}]},
          {
           RowBox[{"x", "+", "C"}], 
           RowBox[{"\[Zeta]", "=", "0"}]}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}},
         Selectable->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False,
     StripWrapperBoxes->True]}], TraditionalForm]],ExpressionUUID->
  "54e9bf22-0599-44ea-9055-87caea8bd9a4"],
 ".\n\nSubstitute ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"B", "(", "x", ")"}], 
     SubscriptBox["B", "0"]], "=", 
    RowBox[{
     FractionBox[
      RowBox[{
       SubscriptBox["B", "x"], "(", "x", ")"}], 
      SubscriptBox["B", "0"]], "=", 
     RowBox[{
      RowBox[{"1", "+", 
       RowBox[{
        SuperscriptBox["\[Xi]", "2"], 
        SuperscriptBox["x", "2"]}]}], "=", 
      RowBox[{
       SuperscriptBox["sec", "2"], "(", 
       RowBox[{"\[Xi]", " ", 
        SubscriptBox["\[CapitalDelta]", "1"], 
        SuperscriptBox["q", "1"]}], ")"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"0fd8a804-59e3-4982-8ad4-33c108de41ff"],
 ", \[Eta] becomes\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Eta]", "=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox[
        SubscriptBox["B", "0"], "B"], ")"}], 
      RowBox[{"\[Zeta]", "/", "2"}]], "=", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["1", 
         RowBox[{"1", "+", 
          RowBox[{
           SuperscriptBox["\[Xi]", "2"], 
           SuperscriptBox["x", "2"]}]}]], ")"}], 
       RowBox[{"\[Zeta]", "/", "2"}]], "=", 
      RowBox[{
       SuperscriptBox["cos", "\[Zeta]"], "(", 
       RowBox[{"\[Xi]", " ", 
        SubscriptBox["\[CapitalDelta]", "1"], 
        SuperscriptBox["q", "1"]}], ")"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"782208d8-7a6f-453e-b9e6-1abaf45550f2"],
 ".\nNote that ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Eta]", "=", "1"}], TraditionalForm]],ExpressionUUID->
  "9f843463-1774-445a-9ced-70e8bc42ea86"],
 " if ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Xi]", "=", "0"}], TraditionalForm]],ExpressionUUID->
  "a40c928e-7c7f-4abc-a3a9-6ffe2589ddda"],
 " or ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Zeta]", "=", "0"}], TraditionalForm]],ExpressionUUID->
  "20f16979-15bc-4393-9e2f-6af621c9f722"],
 ".\nThe number of particles in a differential volume, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[DifferentialD]", "V"}], TraditionalForm]],ExpressionUUID->
  "6a852b1d-bb1b-4a7f-979e-b31c46de98f8"],
 ", is given by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[DifferentialD]", "N"}], "=", 
    RowBox[{"n", 
     RowBox[{"\[DifferentialD]", "V"}]}]}], TraditionalForm]],ExpressionUUID->
  "92eb6d61-fce8-4fa0-af00-69a97ada8d80"],
 ".\nSince ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[DifferentialD]", "V"}], "=", 
    RowBox[{
     SubscriptBox["\[CapitalDelta]", "1"], 
     SubscriptBox["\[CapitalDelta]", "2"], 
     SubscriptBox["\[CapitalDelta]", "3"], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "1"]}], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "2"]}], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "3"]}]}]}], TraditionalForm]],ExpressionUUID->
  "d0127254-27b7-4e6d-9392-beab0a37dfb1"],
 " is constant in terms of curvilinear coordinates, \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[DifferentialD]", "N"}], "\[Proportional]", 
    RowBox[{"\[Eta]", "(", 
     SuperscriptBox["q", "1"], ")"}]}], TraditionalForm]],ExpressionUUID->
  "d6326155-9d7a-4255-887c-5284f16eb79f"],
 ".\nConsidering a flux tube of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[DifferentialD]", 
     SuperscriptBox["q", "2"]}], "\[Times]", 
    RowBox[{"\[DifferentialD]", 
     SuperscriptBox["q", "3"]}]}], TraditionalForm]],ExpressionUUID->
  "4b9f6501-b006-402f-8edb-c9eb1be2c5f1"],
 " wide, the integrated number of particles with respect to ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["q", "1"], TraditionalForm]],ExpressionUUID->
  "d410b53e-962a-4825-b061-d0acc40f2d68"],
 " is given by\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"N", "(", 
      SuperscriptBox["q", "1"], ")"}], 
     SubscriptBox["n", "0"]], "=", 
    RowBox[{
     SubscriptBox["\[CapitalDelta]", "1"], 
     SubscriptBox["\[CapitalDelta]", "2"], 
     SubscriptBox["\[CapitalDelta]", "3"], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "2"]}], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "3"]}], 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", 
       SuperscriptBox["q", "1"]], 
      RowBox[{
       RowBox[{"\[Eta]", "(", 
        SuperscriptBox["q", "1"], ")"}], 
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox["q", "1"]}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     SubscriptBox["\[CapitalDelta]", "1"], 
     SubscriptBox["\[CapitalDelta]", "2"], 
     SubscriptBox["\[CapitalDelta]", "3"], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "2"]}], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "3"]}], 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", 
       SuperscriptBox["q", "1"]], 
      RowBox[{
       RowBox[{
        SuperscriptBox["cos", "\[Zeta]"], "(", 
        RowBox[{"\[Xi]", " ", 
         SubscriptBox["\[CapitalDelta]", "1"], 
         SuperscriptBox["q", "1"]}], ")"}], 
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox["q", "1"]}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     SubscriptBox["\[CapitalDelta]", "1"], 
     SubscriptBox["\[CapitalDelta]", "2"], 
     SubscriptBox["\[CapitalDelta]", "3"], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "2"]}], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "3"]}], 
     FractionBox["1", 
      RowBox[{"\[Xi]", " ", 
       SubscriptBox["\[CapitalDelta]", "1"]}]], 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", 
       RowBox[{"\[Xi]", " ", 
        SubscriptBox["\[CapitalDelta]", "1"], 
        SuperscriptBox["q", "1"]}]], 
      RowBox[{
       RowBox[{
        SuperscriptBox["cos", "\[Zeta]"], "(", "x", ")"}], 
       RowBox[{"\[DifferentialD]", "x"}]}]}]}]}], TraditionalForm]}],
  ExpressionUUID->"3d39f416-2ea4-4b80-9d6a-017dc71c9fc8"],
 ",\nwhere ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"N", "(", "0", ")"}], "=", "0"}], TraditionalForm]],
  ExpressionUUID->"f7951274-679a-4dc0-b0d0-b65aba0caf51"],
 ".\nNote the limiting case ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["lim", 
      RowBox[{"\[Xi]", "\[Rule]", "0"}]], 
     FractionBox[
      RowBox[{"N", "(", 
       SuperscriptBox["q", "1"], ")"}], 
      SubscriptBox["n", "0"]]}], "=", 
    RowBox[{
     SuperscriptBox["q", "1"], 
     SubscriptBox["\[CapitalDelta]", "1"], 
     SubscriptBox["\[CapitalDelta]", "2"], 
     SubscriptBox["\[CapitalDelta]", "3"], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "2"]}], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "3"]}]}]}], TraditionalForm]],ExpressionUUID->
  "98903df1-739f-4b9e-ac90-347fff49b20f"],
 ".\nThe inverse relation ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["q", "1"], "(", "N", ")"}], TraditionalForm]],
  ExpressionUUID->"a72440a2-4cc0-4242-a45c-7ab36ecedc81"],
 " is not straightforward.\n\nFor sampling in pitch angle space,\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["F", "\[Alpha]"], "(", "\[Alpha]", ")"}], "=", 
    RowBox[{
     FractionBox["1", 
      SubscriptBox["\[ScriptCapitalB]", "\[Zeta]"]], 
     RowBox[{
      SuperscriptBox["\[Integral]", "\[Alpha]"], 
      RowBox[{
       SuperscriptBox["sin", 
        RowBox[{"\[Zeta]", "+", "1"}]], "\[Alpha]", 
       RowBox[{"\[DifferentialD]", "\[Alpha]"}]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"db81a247-742f-4433-8e7f-b272a5ea2895"],
 ".\nOr, with ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CurlyPhi]", "=", 
    RowBox[{"\[Alpha]", "-", 
     FractionBox["\[Pi]", "2"]}]}], TraditionalForm]],ExpressionUUID->
  "b145fbd4-1ff4-44ad-91e4-fcdf28dcca3c"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["F", "\[Alpha]"], "(", 
     RowBox[{"\[CurlyPhi]", "+", 
      FractionBox["\[Pi]", "2"]}], ")"}], "=", 
    RowBox[{
     FractionBox["1", 
      SubscriptBox["\[ScriptCapitalB]", "\[Zeta]"]], 
     RowBox[{
      SuperscriptBox["\[Integral]", "\[CurlyPhi]"], 
      RowBox[{
       SuperscriptBox["cos", 
        RowBox[{"\[Zeta]", "+", "1"}]], "\[CurlyPhi]", 
       RowBox[{"\[DifferentialD]", "\[CurlyPhi]"}]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"5946c855-dc19-4bd4-a042-ae7b423d8234"],
 ".\n\nFor sampling in velocity space,\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["F", "v"], "(", "x", ")"}], "=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"\[ScriptCapitalA]", "(", 
       SubscriptBox["x", "s"], ")"}]], 
     RowBox[{
      SuperscriptBox["\[Integral]", "x"], 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"x", "-", 
            SubscriptBox["x", "s"]}], ")"}], "2"]}], "]"}], 
       SuperscriptBox["x", "2"], 
       RowBox[{"\[DifferentialD]", "x"}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     RowBox[{
      FractionBox["1", 
       RowBox[{"\[ScriptCapitalA]", "(", 
        SubscriptBox["x", "s"], ")"}]], 
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"x", "+", 
            SubscriptBox["x", "s"]}], ")"}]}], 
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"x", "-", 
              SubscriptBox["x", "s"]}], ")"}], "2"]}], "]"}]}], "+", 
        RowBox[{
         SqrtBox["\[Pi]"], 
         RowBox[{"(", 
          RowBox[{
           FractionBox["1", "2"], "+", 
           SubsuperscriptBox["x", "s", "2"]}], ")"}], 
         RowBox[{"Erf", "[", 
          RowBox[{"x", "-", 
           SubscriptBox["x", "s"]}], "]"}]}]}], ")"}]}], "+", "C"}]}], 
   TraditionalForm]}],ExpressionUUID->
  "dad50be5-5642-4937-b9a5-58bcd656be4b"],
 ".\nOr, with ",
 Cell[BoxData[
  FormBox[
   RowBox[{"t", "=", 
    RowBox[{"x", "-", 
     SubscriptBox["x", "s"]}]}], TraditionalForm]],ExpressionUUID->
  "b175cd52-08f7-498a-83ee-13689450c569"],
 ",\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["F", "v"], "(", 
     RowBox[{"t", "+", 
      SubscriptBox["x", "s"]}], ")"}], "=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"\[ScriptCapitalA]", "(", 
       SubscriptBox["x", "s"], ")"}]], 
     RowBox[{
      SuperscriptBox["\[Integral]", "t"], 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"-", 
         SuperscriptBox["t", "2"]}], "]"}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"t", "+", 
          SubscriptBox["x", "s"]}], ")"}], "2"], 
       RowBox[{"\[DifferentialD]", "x"}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     RowBox[{
      FractionBox["1", 
       RowBox[{"\[ScriptCapitalA]", "(", 
        SubscriptBox["x", "s"], ")"}]], 
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"t", "+", 
            RowBox[{"2", 
             SubscriptBox["x", "s"]}]}], ")"}]}], 
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           SuperscriptBox["t", "2"]}], "]"}]}], "+", 
        RowBox[{
         SqrtBox["\[Pi]"], 
         RowBox[{"(", 
          RowBox[{
           FractionBox["1", "2"], "+", 
           SubsuperscriptBox["x", "s", "2"]}], ")"}], 
         RowBox[{"Erf", "[", "t", "]"}]}]}], ")"}]}], "+", "C"}]}], 
   TraditionalForm]}],ExpressionUUID->
  "faeee34a-27e2-4b7d-a597-12d9a23080b8"],
 "."
}], "Text",ExpressionUUID->"1838a2fc-860a-45c7-b4dd-ec73ba19c430"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "intSin\[Zeta]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intSin\[Zeta]", "[", "0", "]"}], ":=", 
  RowBox[{"#", "&"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intSin\[Zeta]", "[", "1", "]"}], ":=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"Cos", "[", "#", "]"}]}], "&"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intSin\[Zeta]", "[", 
   RowBox[{"\[Zeta]_Integer", "?", "Positive"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"recursive", "=", 
      RowBox[{"intSin\[Zeta]", "[", 
       RowBox[{"\[Zeta]", "-", "2"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Function", "[", 
     RowBox[{"x", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Power", "[", 
          RowBox[{
           RowBox[{"Sin", "[", "x", "]"}], ",", 
           RowBox[{"\[Zeta]", "-", "1"}]}], "]"}]}], 
        RowBox[{
         RowBox[{"Cos", "[", "x", "]"}], "/", "\[Zeta]"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Zeta]", "-", "1"}], ")"}], "/", "\[Zeta]"}], " ", 
        RowBox[{"recursive", "[", "x", "]"}]}]}], ",", 
      RowBox[{"{", "Listable", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellLabel->"In[42]:=",ExpressionUUID->"021145a4-f188-4d61-94d7-0d4bca61c0a6"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "intCos\[Zeta]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intCos\[Zeta]", "[", "0", "]"}], ":=", 
  RowBox[{"#", "&"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intCos\[Zeta]", "[", "1", "]"}], ":=", 
  "Sin"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intCos\[Zeta]", "[", 
   RowBox[{"\[Zeta]_Integer", "?", "Positive"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"recursive", "=", 
      RowBox[{"intCos\[Zeta]", "[", 
       RowBox[{"\[Zeta]", "-", "2"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Function", "[", 
     RowBox[{"x", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Power", "[", 
         RowBox[{
          RowBox[{"Cos", "[", "x", "]"}], ",", 
          RowBox[{"\[Zeta]", "-", "1"}]}], "]"}], 
        RowBox[{
         RowBox[{"Sin", "[", "x", "]"}], "/", "\[Zeta]"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Zeta]", "-", "1"}], ")"}], "/", "\[Zeta]"}], " ", 
        RowBox[{"recursive", "[", "x", "]"}]}]}], ",", 
      RowBox[{"{", "Listable", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellLabel->"In[46]:=",ExpressionUUID->"3fbebd37-b580-46a8-9b11-5067dcbd1fac"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Zeta]", "=", "5"}], ",", 
     RowBox[{"\[Xi]", "=", ".876"}], ",", 
     RowBox[{"q1lim", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "24"}], ",", "50"}], "}"}]}], ",", 
     RowBox[{"\[Xi]\[CapitalDelta]1q1max", "=", 
      RowBox[{
       RowBox[{"Pi", "/", "2"}], "*", ".8"}]}], ",", 
     RowBox[{"nsamples", "=", "50000"}]}], "}"}], ",", "\[IndentingNewLine]", 
   
   RowBox[{"BlockRandom", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "49038", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[CapitalDelta]1", ",", "q1s", ",", "Bs", ",", "\[Eta]s", ",", "xs", 
         ",", "Nofq1", ",", "tmp", ",", "q1samples", ",", "bins", ",", 
         "hist"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[CapitalDelta]1", "=", 
         RowBox[{"Divide", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1q1max", ",", 
           RowBox[{"\[Xi]", " ", 
            RowBox[{"Max", "[", 
             RowBox[{"Abs", "[", "q1lim", "]"}], "]"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"q1s", "=", 
         RowBox[{"Range", "@@", "q1lim"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xs", "=", 
         RowBox[{
          RowBox[{"Tan", "[", 
           RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1s"}], "]"}], "/",
           "\[Xi]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Bs", "=", 
         RowBox[{
          RowBox[{"Sec", "[", 
           RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1s"}], "]"}], "^",
           "2"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Eta]s", "=", 
         RowBox[{"Power", "[", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1s"}], "]"}], 
           ",", "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"Apply", "[", 
            RowBox[{"And", ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"0", "==", 
               RowBox[{"Chop", "[", 
                RowBox[{"\[Eta]s", "-", 
                 RowBox[{"Power", "[", 
                  RowBox[{"Bs", ",", 
                   RowBox[{
                    RowBox[{"-", "\[Zeta]"}], "/", "2"}]}], "]"}]}], "]"}]}], 
              "]"}]}], "]"}]}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<\[Eta]s incorrect\>\"", "]"}], ";", 
            RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Nofq1", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"intCos\[Zeta]", "[", "\[Zeta]", "]"}], "[", 
           RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1s"}], "]"}], "/", 
          RowBox[{"(", 
           RowBox[{"\[Xi]", " ", "\[CapitalDelta]1"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{"MinMax", "[", "Nofq1", "]"}], "-", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"NIntegrate", "[", 
              RowBox[{
               RowBox[{"Power", "[", 
                RowBox[{
                 RowBox[{"Cos", "[", 
                  RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1"}], 
                  "]"}], ",", "\[Zeta]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"q1", ",", "0", ",", "#"}], "}"}]}], "]"}], "&"}], 
            ",", 
            RowBox[{"MinMax", "[", "q1s", "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"Apply", "[", 
            RowBox[{"And", ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"0", "==", 
               RowBox[{"Chop", "[", "tmp", "]"}]}], "]"}]}], "]"}]}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<N(q1) incorrect\>\"", "]"}], ";", 
            RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"q1samples", "=", 
         RowBox[{
          RowBox[{"Interpolation", "[", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"Nofq1", ",", "q1s"}], "}"}], "]"}], "]"}], "[", 
          RowBox[{"RandomReal", "[", 
           RowBox[{
            RowBox[{"MinMax", "[", "Nofq1", "]"}], ",", "nsamples"}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"bins", ",", "hist"}], "}"}], "=", 
         RowBox[{"N", "@", 
          RowBox[{"HistogramList", "[", 
           RowBox[{"q1samples", ",", 
            RowBox[{"Append", "[", 
             RowBox[{"q1lim", ",", "1"}], "]"}], ",", "\"\<Count\>\""}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bins", "=", 
         RowBox[{"Flatten", "[", "bins", "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{"#", ",", "\[IndentingNewLine]", 
            RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
           "]"}], "&"}], "/@", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1s", ",", "\[Eta]s"}], "}"}], "]"}], ",", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               RowBox[{"AxesLabel", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<\\!\\(\!\(\*SuperscriptBox[\(q\), \(1\)]\)\\)\>\"", 
                  ",", "\"\<\\!\\(\[Eta](\!\(\*SuperscriptBox[\(q\), \
\(1\)]\))\\)\>\""}], "}"}]}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Thread", "[", 
                 RowBox[{"Directive", "[", 
                  RowBox[{"{", 
                   RowBox[{"Black", ",", "Blue"}], "}"}], "]"}], "]"}]}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListStepPlot", "[", 
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"MovingAverage", "[", 
                   RowBox[{"bins", ",", "2"}], "]"}], ",", 
                  RowBox[{"hist", "/", 
                   RowBox[{"Max", "[", "hist", "]"}]}]}], "}"}], "]"}], ",", 
               "Center", ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Red", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"xs", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
                RowBox[{"{", 
                 RowBox[{"\[Eta]s", ",", 
                  RowBox[{"\[Eta]s", "^", "2"}]}], "}"}]}], ",", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               RowBox[{"AxesLabel", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<\\!\\(x\\)\>\"", ",", 
                  "\"\<\\!\\(\[Eta](\!\(\*SuperscriptBox[\(q\), \
\(1\)]\))\\)\>\""}], "}"}]}]}], "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1s", ",", 
                RowBox[{"Nofq1", "-", 
                 RowBox[{"Min", "[", "Nofq1", "]"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"AxesLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<\\!\\(\!\(\*SuperscriptBox[\(q\), \(1\)]\)\\)\>\"", ",", 
                "\"\<\\!\\(N(\!\(\*SuperscriptBox[\(q\), \(1\)]\))\\)\>\""}], 
               "}"}]}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[50]:=",ExpressionUUID->"b2582bcb-60a2-4b53-9b81-9c28ffe0c993"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"xs", "=", "10"}], ",", 
     RowBox[{"nsamples", "=", "50000"}]}], "}"}], ",", "\[IndentingNewLine]", 
   
   RowBox[{"BlockRandom", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "49038", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "ts", ",", "Fv", ",", "xsamples", ",", "xbins", ",", "xhist"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"sample", " ", "in", " ", "velocity", " ", "space"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ts", "=", 
         RowBox[{"Array", "[", 
          RowBox[{"N", ",", "10000", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"xs", "<", "5"}], ",", "xs", ",", "5"}], "]"}]}], ",",
              "5"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Fv", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"ts", "+", 
              RowBox[{"2", "xs"}]}], ")"}]}], 
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{"ts", "^", "2"}]}], "]"}]}], "+", 
          RowBox[{
           SqrtBox["\[Pi]"], 
           RowBox[{"(", 
            RowBox[{".5", "+", 
             RowBox[{"xs", "^", "2"}]}], ")"}], 
           RowBox[{"Erf", "[", "ts", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"xsamples", "=", 
         RowBox[{
          RowBox[{"Interpolation", "[", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"Fv", ",", 
              RowBox[{"ts", "+", "xs"}]}], "}"}], "]"}], "]"}], "[", 
          RowBox[{"RandomReal", "[", 
           RowBox[{
            RowBox[{"MinMax", "[", "Fv", "]"}], ",", "nsamples"}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"xbins", ",", "xhist"}], "}"}], "=", 
         RowBox[{"N", "@", 
          RowBox[{"HistogramList", "[", 
           RowBox[{
            RowBox[{"xsamples", "-", "xs"}], ",", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"xs", "<", "5"}], ",", "xs", ",", "5"}], "]"}]}], 
                ",", "5"}], "}"}], ",", ".1"}], "]"}], ",", "\"\<Count\>\""}],
            "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xbins", "=", 
         RowBox[{"Flatten", "[", "xbins", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xhist", "/=", 
         RowBox[{"nsamples", " ", 
          RowBox[{"Apply", "[", 
           RowBox[{"Subtract", ",", 
            RowBox[{"xbins", "[", 
             RowBox[{"[", 
              RowBox[{"{", 
               RowBox[{"2", ",", "1"}], "}"}], "]"}], "]"}]}], "]"}]}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Divide", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"-", 
                 RowBox[{"t", "^", "2"}]}], "]"}], 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"t", "+", "xs"}], ")"}], "^", "2"}]}], ",", 
              RowBox[{".5", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"xs", " ", 
                  RowBox[{"Exp", "[", 
                   RowBox[{"-", 
                    RowBox[{"xs", "^", "2"}]}], "]"}]}], "+", 
                 RowBox[{
                  SqrtBox["\[Pi]"], 
                  RowBox[{"(", 
                   RowBox[{".5", "+", 
                    RowBox[{"xs", "^", "2"}]}], ")"}], 
                  RowBox[{"Erfc", "[", 
                   RowBox[{"-", "xs"}], "]"}]}]}], ")"}]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", 
              RowBox[{"-", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"xs", "<", "5"}], ",", "xs", ",", "5"}], "]"}]}], 
              ",", "5"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Thread", "[", 
              RowBox[{"Directive", "[", 
               RowBox[{"{", 
                RowBox[{"Black", ",", "Blue"}], "}"}], "]"}], "]"}]}]}], 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"xbins", ",", "2"}], "]"}], ",", "xhist"}], "}"}], 
             "]"}], ",", "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[51]:=",ExpressionUUID->"64ab311a-1d6f-45ee-8161-2c391b217cdb"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Zeta]", "=", "30"}], ",", 
     RowBox[{"accuracyGoal", "=", "10"}], ",", 
     RowBox[{"nsamples", "=", "50000"}]}], "}"}], ",", "\[IndentingNewLine]", 
   
   RowBox[{"BlockRandom", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "49038", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"(*", 
         RowBox[{"\[Alpha]lim", ",", "\[Alpha]s", ",", "F\[Alpha]", ","}], 
         "*)"}], 
        RowBox[{
        "\[CurlyPhi]lim", ",", "\[CurlyPhi]s", ",", "F\[CurlyPhi]", ",", 
         "\[Alpha]samples", ",", "\[Alpha]bins", ",", "\[Alpha]hist"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "sample", " ", "in", " ", "pitch", " ", "angle", " ", "space"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"\[Alpha]lim", "=", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "Pi"}], "}"}], "+", 
           RowBox[{
            RowBox[{"ArcSin", "[", 
             RowBox[{"Power", "[", 
              RowBox[{"10.", ",", 
               RowBox[{
                RowBox[{"-", "accuracyGoal"}], "/", 
                RowBox[{"(", 
                 RowBox[{"\[Zeta]", "+", "1"}], ")"}]}]}], "]"}], "]"}], 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "1"}]}], "}"}]}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Alpha]s", "=", 
          RowBox[{"Array", "[", 
           RowBox[{"N", ",", "10000", ",", "\[Alpha]lim"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"F\[Alpha]", "=", 
          RowBox[{
           RowBox[{"intSin\[Zeta]", "[", 
            RowBox[{"\[Zeta]", "+", "1"}], "]"}], "[", "\[Alpha]s", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"\[Alpha]samples", "=", 
          RowBox[{
           RowBox[{"Interpolation", "[", 
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"F\[Alpha]", ",", "\[Alpha]s"}], "}"}], "]"}], "]"}], 
           "[", 
           RowBox[{"RandomReal", "[", 
            RowBox[{
             RowBox[{"MinMax", "[", "F\[Alpha]", "]"}], ",", "nsamples"}], 
            "]"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[CurlyPhi]lim", "=", 
         RowBox[{
          RowBox[{"ArcCos", "[", 
           RowBox[{"Power", "[", 
            RowBox[{"10.", ",", 
             RowBox[{
              RowBox[{"-", "accuracyGoal"}], "/", 
              RowBox[{"(", 
               RowBox[{"\[Zeta]", "+", "1"}], ")"}]}]}], "]"}], "]"}], 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[CurlyPhi]s", "=", 
         RowBox[{"Array", "[", 
          RowBox[{"N", ",", "10000", ",", "\[CurlyPhi]lim"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"F\[CurlyPhi]", "=", 
         RowBox[{
          RowBox[{"intCos\[Zeta]", "[", 
           RowBox[{"\[Zeta]", "+", "1"}], "]"}], "[", "\[CurlyPhi]s", "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"\[Alpha]samples", "=", 
         RowBox[{
          RowBox[{"Interpolation", "[", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"F\[CurlyPhi]", ",", 
              RowBox[{"\[CurlyPhi]s", "+", 
               RowBox[{"Pi", "/", "2"}]}]}], "}"}], "]"}], "]"}], "[", 
          RowBox[{"RandomReal", "[", 
           RowBox[{
            RowBox[{"MinMax", "[", "F\[CurlyPhi]", "]"}], ",", "nsamples"}], 
           "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Alpha]bins", ",", "\[Alpha]hist"}], "}"}], "=", 
         RowBox[{"N", "@", 
          RowBox[{"HistogramList", "[", 
           RowBox[{"\[Alpha]samples", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "180"}], "}"}], ",", "2"}], "]"}], 
              "Degree"}], "//", "N"}], ",", "\"\<Count\>\""}], "]"}]}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"\[Alpha]bins", "=", 
         RowBox[{"Flatten", "[", "\[Alpha]bins", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Alpha]hist", "/=", 
         RowBox[{"nsamples", " ", 
          RowBox[{"Apply", "[", 
           RowBox[{"Subtract", ",", 
            RowBox[{"\[Alpha]bins", "[", 
             RowBox[{"[", 
              RowBox[{"{", 
               RowBox[{"2", ",", "1"}], "}"}], "]"}], "]"}]}], "]"}]}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Divide", "[", 
             RowBox[{
              RowBox[{"Power", "[", 
               RowBox[{
                RowBox[{"Sin", "[", "\[Alpha]", "]"}], ",", 
                RowBox[{"\[Zeta]", "+", "1"}]}], "]"}], ",", 
              RowBox[{
               SqrtBox["\[Pi]"], 
               RowBox[{
                RowBox[{"Gamma", "[", 
                 RowBox[{"1", "+", 
                  RowBox[{".5", "\[Zeta]"}]}], "]"}], "/", 
                RowBox[{"Gamma", "[", 
                 RowBox[{"1.5", "+", 
                  RowBox[{".5", "\[Zeta]"}]}], "]"}]}]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Alpha]", ",", "0", ",", "Pi"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Thread", "[", 
              RowBox[{"Directive", "[", 
               RowBox[{"{", 
                RowBox[{"Black", ",", "Blue"}], "}"}], "]"}], "]"}]}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"\[Alpha]bins", ",", "2"}], "]"}], ",", 
               "\[Alpha]hist"}], "}"}], "]"}], ",", "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[52]:=",ExpressionUUID->"ead2b353-21bd-411f-9466-c2d97354cb86"],

Cell[CellGroupData[{

Cell["Tests", "Subsubsection",ExpressionUUID->"70841a10-3db4-47b9-b70d-f4a75c68a2f1"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Beta]", "=", 
      RowBox[{"1.5", "*", "2.1"}]}], ",", 
     RowBox[{"q1lim", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "7"}], ",", "15"}], "}"}]}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"data", "=", 
      RowBox[{"Get", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<~/Downloads\>\"", ",", 
          "\"\<PartialShellVDF-maxwellian-homogeneous.m\>\""}], "}"}], "]"}], 
       "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "vel", ",", "pos", ",", "q1s", ",", "\[Eta]s", ",", "binpos", ",", 
       "histpos", ",", "binv1", ",", "histv1", ",", "binv2", ",", "histv2", 
       ",", "binv3", ",", "histv3"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"q1s", "=", 
       RowBox[{"Range", "@@", "q1lim"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]s", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"1.", ",", 
         RowBox[{"Length", "[", "q1s", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vel", "=", 
       RowBox[{
        RowBox[{"Compile", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"v", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Divide", "[", 
           RowBox[{"v", ",", 
            SqrtBox[
             RowBox[{"\[Beta]", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1", ",", "1"}], "}"}]}]]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"RuntimeAttributes", "\[Rule]", 
           RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}], 
        "[", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"Join", "@@", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binpos", ",", "histpos"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"pos", ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"q1lim", "+", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"+", ".5"}], ",", 
              RowBox[{"-", ".5"}]}], "}"}]}], ",", "1"}], "]"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binv1", ",", "histv1"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"vel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3"}], ",", "3", ",", ".2"}], "}"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binv2", ",", "histv2"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"vel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3"}], ",", "3", ",", ".2"}], "}"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binv3", ",", "histv3"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"vel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3"}], ",", "3", ",", ".2"}], "}"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"q1s", ",", "\[Eta]s"}], "}"}], "]"}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binpos", ",", "2"}], "]"}], ",", 
               RowBox[{"histpos", "/", 
                RowBox[{"Max", "[", "histpos", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{"v", "^", "2"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"v", ",", 
              RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binv1", ",", "2"}], "]"}], ",", 
               RowBox[{"histv1", "/", 
                RowBox[{"Max", "[", "histv1", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{"v", "^", "2"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"v", ",", 
              RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binv2", ",", "2"}], "]"}], ",", 
               RowBox[{"histv2", "/", 
                RowBox[{"Max", "[", "histv2", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{"v", "^", "2"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"v", ",", 
              RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binv3", ",", "2"}], "]"}], ",", 
               RowBox[{"histv3", "/", 
                RowBox[{"Max", "[", "histv3", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}]}], "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",ExpressionUUID->"7732ce3e-\
3ea1-460b-b7f8-d976506c3ee8"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Beta]", "=", 
      RowBox[{"1.5", "*", "2.1"}]}], ",", 
     RowBox[{"q1lim", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "7"}], ",", "15"}], "}"}]}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"data", "=", 
      RowBox[{"Get", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<~/Downloads\>\"", ",", 
          "\"\<PartialShellVDF-maxwellian-inhomogeneous.m\>\""}], "}"}], 
        "]"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "vel", ",", "pos", ",", "q1s", ",", "\[Eta]s", ",", "binpos", ",", 
       "histpos", ",", "binv1", ",", "histv1", ",", "binv2", ",", "histv2", 
       ",", "binv3", ",", "histv3"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"q1s", "=", 
       RowBox[{"Range", "@@", "q1lim"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]s", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"1.", ",", 
         RowBox[{"Length", "[", "q1s", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vel", "=", 
       RowBox[{
        RowBox[{"Compile", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"v", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Divide", "[", 
           RowBox[{"v", ",", 
            SqrtBox[
             RowBox[{"\[Beta]", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1", ",", "1"}], "}"}]}]]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"RuntimeAttributes", "\[Rule]", 
           RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}], 
        "[", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"Join", "@@", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binpos", ",", "histpos"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"pos", ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"q1lim", "+", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"+", ".5"}], ",", 
              RowBox[{"-", ".5"}]}], "}"}]}], ",", "1"}], "]"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binv1", ",", "histv1"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"vel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3"}], ",", "3", ",", ".2"}], "}"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binv2", ",", "histv2"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"vel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3"}], ",", "3", ",", ".2"}], "}"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binv3", ",", "histv3"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"vel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3"}], ",", "3", ",", ".2"}], "}"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"q1s", ",", "\[Eta]s"}], "}"}], "]"}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binpos", ",", "2"}], "]"}], ",", 
               RowBox[{"histpos", "/", 
                RowBox[{"Max", "[", "histpos", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{"v", "^", "2"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"v", ",", 
              RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binv1", ",", "2"}], "]"}], ",", 
               RowBox[{"histv1", "/", 
                RowBox[{"Max", "[", "histv1", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{"v", "^", "2"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"v", ",", 
              RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binv2", ",", "2"}], "]"}], ",", 
               RowBox[{"histv2", "/", 
                RowBox[{"Max", "[", "histv2", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{"v", "^", "2"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"v", ",", 
              RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binv3", ",", "2"}], "]"}], ",", 
               RowBox[{"histv3", "/", 
                RowBox[{"Max", "[", "histv3", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}]}], "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",ExpressionUUID->"1c98f360-\
241d-4176-8c56-0eeec0b5b087"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Beta]", "=", 
      RowBox[{"1.5", "*", "2.1"}]}], 
     RowBox[{"(*", 
      RowBox[{"\[Theta]", "^", "2"}], "*)"}], ",", 
     RowBox[{"\[Zeta]", "=", "0"}], ",", 
     RowBox[{"vs", "=", "10"}], ",", 
     RowBox[{"q1lim", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "7"}], ",", "15"}], "}"}]}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"data", "=", 
      RowBox[{"Get", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<~/Downloads\>\"", ",", 
          "\"\<PartialShellVDF-isotropic_shell-homogeneous.m\>\""}], "}"}], 
        "]"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "xs", ",", "vel", ",", "pos", ",", "q1s", ",", "\[Eta]s", ",", "v", ",",
        "\[Alpha]", ",", "\[Phi]", ",", "binpos", ",", "histpos", ",", "binv",
        ",", "histv", ",", "bin\[Alpha]", ",", "hist\[Alpha]", ",", 
       "bin\[Phi]", ",", "hist\[Phi]"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xs", "=", 
       RowBox[{"vs", "/", 
        SqrtBox["\[Beta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"q1s", "=", 
       RowBox[{"Range", "@@", "q1lim"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]s", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"1.", ",", 
         RowBox[{"Length", "[", "q1s", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vel", "=", 
       RowBox[{
        RowBox[{"Compile", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"v", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Divide", "[", 
           RowBox[{"v", ",", 
            SqrtBox[
             RowBox[{"\[Beta]", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1", ",", "1"}], "}"}]}]]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"RuntimeAttributes", "\[Rule]", 
           RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}], 
        "[", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"Join", "@@", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"Norm", "/@", "vel"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Alpha]", "=", 
       RowBox[{"ArcCos", "[", 
        RowBox[{
         RowBox[{"vel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "/", "v"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Phi]", "=", 
       RowBox[{"ArcTan", "@@@", 
        RowBox[{"Map", "[", 
         RowBox[{"Rest", ",", "vel"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binpos", ",", "histpos"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"pos", ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"q1lim", "+", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"+", ".5"}], ",", 
              RowBox[{"-", ".5"}]}], "}"}]}], ",", "1"}], "]"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binv", ",", "histv"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"v", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"xs", "<", "3"}], ",", "0", ",", 
             RowBox[{"xs", "-", "3"}]}], "]"}], ",", 
           RowBox[{"xs", "+", "3"}], ",", ".1"}], "}"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"histv", "/=", 
         RowBox[{
          RowBox[{"MovingAverage", "[", 
           RowBox[{"binv", ",", "2"}], "]"}], "^", "2"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"bin\[Alpha]", ",", "hist\[Alpha]"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"\[Alpha]", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "\[Pi]", ",", 
           RowBox[{"4.", "Degree"}]}], "}"}], ",", "\"\<Count\>\""}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"bin\[Phi]", ",", "hist\[Phi]"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"\[Phi]", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], ",", "\[Pi]", ",", 
           RowBox[{"8.", "Degree"}]}], "}"}], ",", "\"\<Count\>\""}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"q1s", ",", "\[Eta]s"}], "}"}], "]"}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binpos", ",", "2"}], "]"}], ",", 
               RowBox[{"histpos", "/", 
                RowBox[{"Max", "[", "histpos", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Divide", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"x", "-", "xs"}], ")"}], "^", "2"}]}], "]"}], 
               RowBox[{"x", "^", "2"}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"xs", "+", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"4", "+", 
                    RowBox[{"xs", "^", "2"}]}], "]"}]}], ")"}], "^", "2"}], 
               "/", 
               RowBox[{"(", 
                RowBox[{"4", "*", 
                 RowBox[{"E", "^", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"xs", "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"4", "+", 
                    RowBox[{"xs", "^", "2"}]}], "]"}]}], ")"}], "^", "2"}], 
                    "/", "4"}], ")"}]}]}], ")"}]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"xs", "<", "3"}], ",", "0", ",", 
                RowBox[{"xs", "-", "3"}]}], "]"}], ",", 
              RowBox[{"xs", "+", "3"}]}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binv", ",", "2"}], "]"}], ",", 
               RowBox[{"histv", "/", 
                RowBox[{"Max", "[", "histv", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", "x", "]"}], "^", 
             RowBox[{"(", 
              RowBox[{"\[Zeta]", "+", "1"}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"bin\[Alpha]", ",", "2"}], "]"}], ",", 
               RowBox[{"hist\[Alpha]", "/", 
                RowBox[{"Max", "[", "hist\[Alpha]", "]"}]}]}], "}"}], "]"}], 
            ",", "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"bin\[Phi]", ",", "2"}], "]"}], ",", 
               RowBox[{"hist\[Phi]", "/", 
                RowBox[{"Max", "[", "hist\[Phi]", "]"}]}]}], "}"}], "]"}], 
            ",", "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}]}], "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[55]:=",ExpressionUUID->"166719f9-99f8-42f4-821f-b1c5dcbca1a7"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Beta]", "=", 
      RowBox[{"1.5", "*", "2.1"}]}], 
     RowBox[{"(*", 
      RowBox[{"\[Theta]", "^", "2"}], "*)"}], ",", 
     RowBox[{"\[Zeta]", "=", "0"}], ",", 
     RowBox[{"vs", "=", "10"}], ",", 
     RowBox[{"q1lim", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "7"}], ",", "15"}], "}"}]}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"data", "=", 
      RowBox[{"Get", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<~/Downloads\>\"", ",", 
          "\"\<PartialShellVDF-isotropic_shell-inhomogeneous.m\>\""}], "}"}], 
        "]"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "xs", ",", "vel", ",", "pos", ",", "q1s", ",", "\[Eta]s", ",", "v", ",",
        "\[Alpha]", ",", "\[Phi]", ",", "binpos", ",", "histpos", ",", "binv",
        ",", "histv", ",", "bin\[Alpha]", ",", "hist\[Alpha]", ",", 
       "bin\[Phi]", ",", "hist\[Phi]"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xs", "=", 
       RowBox[{"vs", "/", 
        SqrtBox["\[Beta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"q1s", "=", 
       RowBox[{"Range", "@@", "q1lim"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]s", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"1.", ",", 
         RowBox[{"Length", "[", "q1s", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vel", "=", 
       RowBox[{
        RowBox[{"Compile", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"v", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Divide", "[", 
           RowBox[{"v", ",", 
            SqrtBox[
             RowBox[{"\[Beta]", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1", ",", "1"}], "}"}]}]]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"RuntimeAttributes", "\[Rule]", 
           RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}], 
        "[", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"Join", "@@", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"Norm", "/@", "vel"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Alpha]", "=", 
       RowBox[{"ArcCos", "[", 
        RowBox[{
         RowBox[{"vel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "/", "v"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Phi]", "=", 
       RowBox[{"ArcTan", "@@@", 
        RowBox[{"Map", "[", 
         RowBox[{"Rest", ",", "vel"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binpos", ",", "histpos"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"pos", ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"q1lim", "+", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"+", ".5"}], ",", 
              RowBox[{"-", ".5"}]}], "}"}]}], ",", "1"}], "]"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binv", ",", "histv"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"v", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"xs", "<", "3"}], ",", "0", ",", 
             RowBox[{"xs", "-", "3"}]}], "]"}], ",", 
           RowBox[{"xs", "+", "3"}], ",", ".1"}], "}"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"histv", "/=", 
         RowBox[{
          RowBox[{"MovingAverage", "[", 
           RowBox[{"binv", ",", "2"}], "]"}], "^", "2"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"bin\[Alpha]", ",", "hist\[Alpha]"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"\[Alpha]", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "\[Pi]", ",", 
           RowBox[{"4.", "Degree"}]}], "}"}], ",", "\"\<Count\>\""}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"bin\[Phi]", ",", "hist\[Phi]"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"\[Phi]", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], ",", "\[Pi]", ",", 
           RowBox[{"8.", "Degree"}]}], "}"}], ",", "\"\<Count\>\""}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"q1s", ",", "\[Eta]s"}], "}"}], "]"}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binpos", ",", "2"}], "]"}], ",", 
               RowBox[{"histpos", "/", 
                RowBox[{"Max", "[", "histpos", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Divide", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"x", "-", "xs"}], ")"}], "^", "2"}]}], "]"}], 
               RowBox[{"x", "^", "2"}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"xs", "+", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"4", "+", 
                    RowBox[{"xs", "^", "2"}]}], "]"}]}], ")"}], "^", "2"}], 
               "/", 
               RowBox[{"(", 
                RowBox[{"4", "*", 
                 RowBox[{"E", "^", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"xs", "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"4", "+", 
                    RowBox[{"xs", "^", "2"}]}], "]"}]}], ")"}], "^", "2"}], 
                    "/", "4"}], ")"}]}]}], ")"}]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"xs", "<", "3"}], ",", "0", ",", 
                RowBox[{"xs", "-", "3"}]}], "]"}], ",", 
              RowBox[{"xs", "+", "3"}]}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binv", ",", "2"}], "]"}], ",", 
               RowBox[{"histv", "/", 
                RowBox[{"Max", "[", "histv", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", "x", "]"}], "^", 
             RowBox[{"(", 
              RowBox[{"\[Zeta]", "+", "1"}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"bin\[Alpha]", ",", "2"}], "]"}], ",", 
               RowBox[{"hist\[Alpha]", "/", 
                RowBox[{"Max", "[", "hist\[Alpha]", "]"}]}]}], "}"}], "]"}], 
            ",", "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"bin\[Phi]", ",", "2"}], "]"}], ",", 
               RowBox[{"hist\[Phi]", "/", 
                RowBox[{"Max", "[", "hist\[Phi]", "]"}]}]}], "}"}], "]"}], 
            ",", "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}]}], "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[57]:=",ExpressionUUID->"9383b115-aedd-43b7-89d2-cec33ab6cfa4"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Beta]", "=", 
      RowBox[{"1.5", "*", "2.1"}]}], 
     RowBox[{"(*", 
      RowBox[{"\[Theta]", "^", "2"}], "*)"}], ",", 
     RowBox[{"\[Zeta]", "=", "30"}], ",", 
     RowBox[{"vs", "=", "10"}], ",", 
     RowBox[{"q1lim", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "7"}], ",", "15"}], "}"}]}], ",", 
     RowBox[{"\[CapitalDelta]1", "=", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Get", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<~/Downloads\>\"", ",", 
          "\"\<PartialShellVDF-anisotropic_shell-homogeneous.m\>\""}], "}"}], 
        "]"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "xs", ",", "vel", ",", "pos", ",", "q1s", ",", "\[Eta]s", ",", "v", ",",
        "\[Alpha]", ",", "\[Phi]", ",", "binpos", ",", "histpos", ",", "binv",
        ",", "histv", ",", "bin\[Alpha]", ",", "hist\[Alpha]", ",", 
       "bin\[Phi]", ",", "hist\[Phi]"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xs", "=", 
       RowBox[{"vs", "/", 
        SqrtBox["\[Beta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"q1s", "=", 
       RowBox[{"Range", "@@", "q1lim"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]s", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"1.", ",", 
         RowBox[{"Length", "[", "q1s", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vel", "=", 
       RowBox[{
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "/", 
        SqrtBox["\[Beta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"Join", "@@", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"Norm", "/@", "vel"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Alpha]", "=", 
       RowBox[{"ArcCos", "[", 
        RowBox[{
         RowBox[{"vel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "/", "v"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Phi]", "=", 
       RowBox[{"ArcTan", "@@@", 
        RowBox[{"Map", "[", 
         RowBox[{"Rest", ",", "vel"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binpos", ",", "histpos"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"pos", ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"q1lim", "+", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"+", ".5"}], ",", 
              RowBox[{"-", ".5"}]}], "}"}]}], ",", "1"}], "]"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binv", ",", "histv"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"v", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"xs", "<", "3"}], ",", "0", ",", 
             RowBox[{"xs", "-", "3"}]}], "]"}], ",", 
           RowBox[{"xs", "+", "3"}], ",", ".1"}], "}"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"histv", "/=", 
         RowBox[{
          RowBox[{"MovingAverage", "[", 
           RowBox[{"binv", ",", "2"}], "]"}], "^", "2"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"bin\[Alpha]", ",", "hist\[Alpha]"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"\[Alpha]", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "\[Pi]", ",", 
           RowBox[{"4.", "Degree"}]}], "}"}], ",", "\"\<Count\>\""}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"bin\[Phi]", ",", "hist\[Phi]"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"\[Phi]", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], ",", "\[Pi]", ",", 
           RowBox[{"8.", "Degree"}]}], "}"}], ",", "\"\<Count\>\""}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"q1s", ",", "\[Eta]s"}], "}"}], "]"}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binpos", ",", "2"}], "]"}], ",", 
               RowBox[{"histpos", "/", 
                RowBox[{"Max", "[", "histpos", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Divide", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"x", "-", "xs"}], ")"}], "^", "2"}]}], "]"}], 
               RowBox[{"x", "^", "2"}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"xs", "+", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"4", "+", 
                    RowBox[{"xs", "^", "2"}]}], "]"}]}], ")"}], "^", "2"}], 
               "/", 
               RowBox[{"(", 
                RowBox[{"4", "*", 
                 RowBox[{"E", "^", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"xs", "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"4", "+", 
                    RowBox[{"xs", "^", "2"}]}], "]"}]}], ")"}], "^", "2"}], 
                    "/", "4"}], ")"}]}]}], ")"}]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"xs", "<", "3"}], ",", "0", ",", 
                RowBox[{"xs", "-", "3"}]}], "]"}], ",", 
              RowBox[{"xs", "+", "3"}]}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binv", ",", "2"}], "]"}], ",", 
               RowBox[{"histv", "/", 
                RowBox[{"Max", "[", "histv", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", "x", "]"}], "^", 
             RowBox[{"(", 
              RowBox[{"\[Zeta]", "+", "1"}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"bin\[Alpha]", ",", "2"}], "]"}], ",", 
               RowBox[{"hist\[Alpha]", "/", 
                RowBox[{"Max", "[", "hist\[Alpha]", "]"}]}]}], "}"}], "]"}], 
            ",", "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"bin\[Phi]", ",", "2"}], "]"}], ",", 
               RowBox[{"hist\[Phi]", "/", 
                RowBox[{"Max", "[", "hist\[Phi]", "]"}]}]}], "}"}], "]"}], 
            ",", "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}]}], "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[58]:=",ExpressionUUID->"909c1085-f6b8-41fc-89ed-ecc49be7e07c"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Beta]", "=", 
      RowBox[{"1.5", "*", "2.1"}]}], 
     RowBox[{"(*", 
      RowBox[{"\[Theta]", "^", "2"}], "*)"}], ",", 
     RowBox[{"\[Zeta]", "=", "10"}], ",", 
     RowBox[{"vs", "=", "2"}], ",", 
     RowBox[{"q1lim", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "7"}], ",", "15"}], "}"}]}], ",", 
     RowBox[{"\[Xi]", "=", ".876"}], ",", 
     RowBox[{"\[Xi]\[CapitalDelta]1q1max", "=", 
      RowBox[{
       RowBox[{"Pi", "/", "2"}], "*", ".8"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Get", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<~/Downloads\>\"", ",", 
          "\"\<PartialShellVDF-anisotropic_shell-inhomogeneous.m\>\""}], 
         "}"}], "]"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[CapitalDelta]1", ",", "xs", ",", "vel", ",", "pos", ",", "q1s", ",", 
       "\[Eta]s", ",", "v", ",", "\[Alpha]", ",", "\[Phi]", ",", "binpos", 
       ",", "histpos", ",", "binv", ",", "histv", ",", "bin\[Alpha]", ",", 
       "hist\[Alpha]", ",", "bin\[Phi]", ",", "hist\[Phi]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[CapitalDelta]1", "=", 
       RowBox[{"\[Xi]\[CapitalDelta]1q1max", "/", 
        RowBox[{"(", 
         RowBox[{"\[Xi]", " ", 
          RowBox[{"Max", "[", 
           RowBox[{"Abs", "[", "q1lim", "]"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xs", "=", 
       RowBox[{"vs", "/", 
        SqrtBox["\[Beta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"q1s", "=", 
       RowBox[{"Range", "@@", "q1lim"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]s", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1s"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vel", "=", 
       RowBox[{
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "/", 
        SqrtBox["\[Beta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"Join", "@@", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"Norm", "/@", "vel"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Alpha]", "=", 
       RowBox[{"ArcCos", "[", 
        RowBox[{
         RowBox[{"vel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "/", "v"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Phi]", "=", 
       RowBox[{"ArcTan", "@@@", 
        RowBox[{"Map", "[", 
         RowBox[{"Rest", ",", "vel"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binpos", ",", "histpos"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"pos", ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"q1lim", "+", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"+", ".5"}], ",", 
              RowBox[{"-", ".5"}]}], "}"}]}], ",", ".5"}], "]"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binv", ",", "histv"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"v", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"xs", "<", "3"}], ",", "0", ",", 
             RowBox[{"xs", "-", "3"}]}], "]"}], ",", 
           RowBox[{"xs", "+", "3"}], ",", ".1"}], "}"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"histv", "/=", 
         RowBox[{
          RowBox[{"MovingAverage", "[", 
           RowBox[{"binv", ",", "2"}], "]"}], "^", "2"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"bin\[Alpha]", ",", "hist\[Alpha]"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"\[Alpha]", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "\[Pi]", ",", 
           RowBox[{"4.", "Degree"}]}], "}"}], ",", "\"\<Count\>\""}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"bin\[Phi]", ",", "hist\[Phi]"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"\[Phi]", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], ",", "\[Pi]", ",", 
           RowBox[{"8.", "Degree"}]}], "}"}], ",", "\"\<Count\>\""}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"q1s", ",", "\[Eta]s"}], "}"}], "]"}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binpos", ",", "2"}], "]"}], ",", 
               RowBox[{"histpos", "/", 
                RowBox[{"Max", "[", "histpos", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Divide", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"x", "-", "xs"}], ")"}], "^", "2"}]}], "]"}], 
               RowBox[{"x", "^", "2"}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"xs", "+", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"4", "+", 
                    RowBox[{"xs", "^", "2"}]}], "]"}]}], ")"}], "^", "2"}], 
               "/", 
               RowBox[{"(", 
                RowBox[{"4", "*", 
                 RowBox[{"E", "^", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"xs", "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"4", "+", 
                    RowBox[{"xs", "^", "2"}]}], "]"}]}], ")"}], "^", "2"}], 
                    "/", "4"}], ")"}]}]}], ")"}]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"xs", "<", "3"}], ",", "0", ",", 
                RowBox[{"xs", "-", "3"}]}], "]"}], ",", 
              RowBox[{"xs", "+", "3"}]}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binv", ",", "2"}], "]"}], ",", 
               RowBox[{"histv", "/", 
                RowBox[{"Max", "[", "histv", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", "x", "]"}], "^", 
             RowBox[{"(", 
              RowBox[{"\[Zeta]", "+", "1"}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"bin\[Alpha]", ",", "2"}], "]"}], ",", 
               RowBox[{"hist\[Alpha]", "/", 
                RowBox[{"Max", "[", "hist\[Alpha]", "]"}]}]}], "}"}], "]"}], 
            ",", "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"bin\[Phi]", ",", "2"}], "]"}], ",", 
               RowBox[{"hist\[Phi]", "/", 
                RowBox[{"Max", "[", "hist\[Phi]", "]"}]}]}], "}"}], "]"}], 
            ",", "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}]}], "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[59]:=",ExpressionUUID->"6f6cf877-bd9a-421f-b040-b27215548fcf"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Relativistic Particle Loading", "Section",ExpressionUUID->"3a2f3f03-010c-4259-ac9a-57cd6420668a"],

Cell[TextData[{
 "According to Liouville's theorem, the phase space density, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "(", 
    RowBox[{"\[DoubleStruckU]", ",", "\[DoubleStruckR]"}], ")"}], 
   TraditionalForm]],ExpressionUUID->"beb14d0d-756e-48f4-9064-68f46d24dcdc"],
 ", is constant along the characteristic path,\nwhere ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[DoubleStruckU]", "=", 
    RowBox[{"\[Gamma]", " ", "\[DoubleStruckV]"}]}], TraditionalForm]],
  ExpressionUUID->"654ee937-4e43-4207-9666-0b2c8c3fa1ac"],
 " is the relativistic momentum per unit rest mass.\nBy virtue of \
conservation of total energy (",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[CurlyEpsilon]", "\[Proportional]", "\[Gamma]"}], "=", 
    SqrtBox[
     RowBox[{"1", "+", 
      RowBox[{
       SuperscriptBox["u", "2"], "/", 
       SuperscriptBox["c", "2"]}]}]]}], TraditionalForm]],ExpressionUUID->
  "0b0a9e44-092d-485b-bab4-6f6b674cfeab"],
 ") and first adiabatic moment (",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Mu]", "\[Proportional]", 
    FractionBox[
     SubsuperscriptBox["u", "\[UpTee]", "2"], "B"]}], TraditionalForm]],
  ExpressionUUID->"0d62ecba-d3de-46f1-8e39-9d3bdcc0ef02"],
 "), \n",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "(", 
    RowBox[{
     RowBox[{"\[DoubleStruckU]", "(", 
      RowBox[{"\[CurlyEpsilon]", ",", "\[Mu]"}], ")"}], ",", 
     RowBox[{"\[DoubleStruckR]", "(", 
      RowBox[{"\[CurlyEpsilon]", ",", "\[Mu]"}], ")"}]}], ")"}], 
   TraditionalForm]],ExpressionUUID->"f3eafe6e-c5eb-488b-9a34-52cfdbefd121"],
 " is constant of motion, if ",
 Cell[BoxData[
  FormBox["f", TraditionalForm]],ExpressionUUID->
  "e4b91151-be1d-44e7-ad71-332c3252ab6e"],
 " is gyrotropic.\n\nConservation of \[Mu]:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     SubsuperscriptBox["u", "\[UpTee]", "2"], "B"], "=", 
    FractionBox[
     SubsuperscriptBox["u", 
      RowBox[{"\[UpTee]", 
       RowBox[{",", "0"}]}], "2"], 
     SubscriptBox["B", "0"]]}], TraditionalForm]],ExpressionUUID->
  "7c316de3-370a-4ccc-89f4-df247327c505"],
 " \[Rule] ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["u", 
     RowBox[{"\[UpTee]", 
      RowBox[{",", "0"}]}], "2"], "=", 
    RowBox[{
     FractionBox[
      SubscriptBox["B", "0"], "B"], 
     SubsuperscriptBox["u", "\[UpTee]", "2"]}]}], TraditionalForm]],
  ExpressionUUID->"9e55db3c-b21c-443c-9157-18a5fa4ba6f4"],
 ", \nwhere subscript 0 denotes quantities at the origin.\n\nConservation of \
\[CurlyEpsilon] (equivalently, ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["u", "2"], TraditionalForm]],ExpressionUUID->
  "fd82bed0-4a49-404b-9341-95b0bc9914cd"],
 " is conserved):\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubsuperscriptBox["u", "\[DoubleVerticalBar]", "2"], "+", 
     SubsuperscriptBox["u", "\[UpTee]", "2"]}], "=", 
    RowBox[{
     SubsuperscriptBox["u", 
      RowBox[{"\[DoubleVerticalBar]", 
       RowBox[{",", "0"}]}], "2"], "+", 
     SubsuperscriptBox["u", 
      RowBox[{"\[UpTee]", 
       RowBox[{",", "0"}]}], "2"]}]}], TraditionalForm]],ExpressionUUID->
  "6cc9065b-3c77-47ef-8278-a6fb7f84945f"],
 " \[Rule] ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["u", 
     RowBox[{"\[DoubleVerticalBar]", 
      RowBox[{",", "0"}]}], "2"], "=", 
    RowBox[{
     RowBox[{
      SubsuperscriptBox["u", "\[DoubleVerticalBar]", "2"], "+", 
      SubsuperscriptBox["u", "\[UpTee]", "2"], "-", 
      SubsuperscriptBox["u", 
       RowBox[{"\[UpTee]", 
        RowBox[{",", "0"}]}], "2"]}], "=", 
     RowBox[{
      SubsuperscriptBox["u", "\[DoubleVerticalBar]", "2"], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         FractionBox[
          SubscriptBox["B", "0"], "B"]}], ")"}], 
       SubsuperscriptBox["u", "\[UpTee]", "2"]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"ae62aa1c-a3e2-44bc-943b-87dd2aff458e"],
 "."
}], "Text",ExpressionUUID->"41308e1d-057b-4c49-9f5a-b69e8d1c2bf0"],

Cell[CellGroupData[{

Cell["Bi-Maxwellian velocity distribution", "Subsection",ExpressionUUID->"7eb99061-5739-43ef-80df-f5f33625f269"],

Cell[TextData[{
 "Consider a bi-Maxwellian velocity distribution at the origin\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["f", "0"], "[", 
     RowBox[{
      SubscriptBox["u", 
       RowBox[{"\[DoubleVerticalBar]", 
        RowBox[{",", "0"}]}]], ",", 
      SubscriptBox["u", 
       RowBox[{"\[UpTee]", 
        RowBox[{",", "0"}]}]]}], "]"}], "=", 
    RowBox[{
     SubscriptBox["n", "0"], 
     FractionBox[
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         SubsuperscriptBox["u", 
          RowBox[{"\[DoubleVerticalBar]", 
           RowBox[{",", "0"}]}], "2"]}], "/", 
        SubsuperscriptBox["\[Theta]", 
         RowBox[{"\[DoubleVerticalBar]", 
          RowBox[{",", "0"}]}], "2"]}]], 
      RowBox[{
       SqrtBox["\[Pi]"], 
       SubscriptBox["\[Theta]", 
        RowBox[{"\[DoubleVerticalBar]", 
         RowBox[{",", "0"}]}]]}]], 
     FractionBox[
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         SubsuperscriptBox["u", 
          RowBox[{"\[UpTee]", 
           RowBox[{",", "0"}]}], "2"]}], "/", 
        SubsuperscriptBox["\[Theta]", 
         RowBox[{"\[UpTee]", 
          RowBox[{",", "0"}]}], "2"]}]], 
      RowBox[{"\[Pi]", " ", 
       SubsuperscriptBox["\[Theta]", 
        RowBox[{"\[UpTee]", 
         RowBox[{",", "0"}]}], "2"]}]]}]}], TraditionalForm]],ExpressionUUID->
  "dd6d3ded-7a2e-48a8-9c80-9ace19ec7173"],
 ".\nSubstituting ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["u", 
     RowBox[{"\[DoubleVerticalBar]", 
      RowBox[{",", "0"}]}]], "(", 
    RowBox[{
     SubscriptBox["u", "\[DoubleVerticalBar]"], ",", 
     SubscriptBox["u", "\[UpTee]"]}], ")"}], TraditionalForm]],ExpressionUUID->
  "0a24ed64-056b-4e17-b89d-1e85b1f631d2"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["u", 
     RowBox[{"\[UpTee]", 
      RowBox[{",", "0"}]}]], "(", 
    RowBox[{
     SubscriptBox["u", "\[DoubleVerticalBar]"], ",", 
     SubscriptBox["u", "\[UpTee]"]}], ")"}], TraditionalForm]],ExpressionUUID->
  "e8357875-353b-4893-866b-66cd698d5c5c"],
 " from above, the distribution at a given location can be obtained from\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{
      SubscriptBox["u", "\[DoubleVerticalBar]"], ",", 
      SubscriptBox["u", "\[UpTee]"]}], "]"}], "=", 
    RowBox[{
     SubscriptBox["f", "0"], "[", 
     RowBox[{
      SqrtBox[
       RowBox[{
        SubsuperscriptBox["u", "\[DoubleVerticalBar]", "2"], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            SubscriptBox["B", "0"], "B"]}], ")"}], 
         SubsuperscriptBox["u", "\[UpTee]", "2"]}]}]], ",", 
      RowBox[{
       SqrtBox[
        FractionBox[
         SubscriptBox["B", "0"], "B"]], 
       SubscriptBox["u", "\[UpTee]"]}]}], "]"}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     SubscriptBox["n", "0"], 
     FractionBox["1", 
      RowBox[{
       SqrtBox["\[Pi]"], 
       SubscriptBox["\[Theta]", 
        RowBox[{"\[DoubleVerticalBar]", 
         RowBox[{",", "0"}]}]]}]], 
     FractionBox["1", 
      RowBox[{"\[Pi]", " ", 
       SubsuperscriptBox["\[Theta]", 
        RowBox[{"\[UpTee]", 
         RowBox[{",", "0"}]}], "2"]}]], 
     RowBox[{"Exp", "[", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SubsuperscriptBox["u", "\[DoubleVerticalBar]", "2"], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{
             SubscriptBox["B", "0"], "/", "B"}]}], ")"}], 
          SubsuperscriptBox["u", "\[UpTee]", "2"]}]}], 
        SubsuperscriptBox["\[Theta]", 
         RowBox[{"\[DoubleVerticalBar]", 
          RowBox[{",", "0"}]}], "2"]]}], "]"}], 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SubscriptBox["B", "0"], "B"]}], 
       FractionBox[
        SubsuperscriptBox["u", "\[UpTee]", "2"], 
        SubsuperscriptBox["\[Theta]", 
         RowBox[{"\[UpTee]", 
          RowBox[{",", "0"}]}], "2"]]}], "]"}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     SubscriptBox["n", "0"], 
     FractionBox["1", 
      RowBox[{
       SqrtBox["\[Pi]"], 
       SubscriptBox["\[Theta]", 
        RowBox[{"\[DoubleVerticalBar]", 
         RowBox[{",", "0"}]}]]}]], 
     FractionBox["1", 
      RowBox[{"\[Pi]", " ", 
       SubsuperscriptBox["\[Theta]", 
        RowBox[{"\[UpTee]", 
         RowBox[{",", "0"}]}], "2"]}]], 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SubsuperscriptBox["u", "\[DoubleVerticalBar]", "2"], 
         SubsuperscriptBox["\[Theta]", 
          RowBox[{"\[DoubleVerticalBar]", 
           RowBox[{",", "0"}]}], "2"]]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox[
           SubscriptBox["B", "0"], "B"]}], ")"}], 
        FractionBox[
         SubsuperscriptBox["u", "\[UpTee]", "2"], 
         SubsuperscriptBox["\[Theta]", 
          RowBox[{"\[DoubleVerticalBar]", 
           RowBox[{",", "0"}]}], "2"]]}]}], "]"}], 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SubscriptBox["B", "0"], "B"]}], 
       FractionBox[
        SubsuperscriptBox["u", "\[UpTee]", "2"], 
        SubsuperscriptBox["\[Theta]", 
         RowBox[{"\[UpTee]", 
          RowBox[{",", "0"}]}], "2"]]}], "]"}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     SubscriptBox["n", "0"], 
     FractionBox["1", 
      RowBox[{
       SqrtBox["\[Pi]"], 
       SubscriptBox["\[Theta]", 
        RowBox[{"\[DoubleVerticalBar]", 
         RowBox[{",", "0"}]}]]}]], 
     FractionBox["1", 
      RowBox[{"\[Pi]", " ", 
       SubsuperscriptBox["\[Theta]", 
        RowBox[{"\[UpTee]", 
         RowBox[{",", "0"}]}], "2"]}]], 
     RowBox[{"Exp", "[", 
      RowBox[{"-", 
       FractionBox[
        SubsuperscriptBox["u", "\[DoubleVerticalBar]", "2"], 
        SubsuperscriptBox["\[Theta]", 
         RowBox[{"\[DoubleVerticalBar]", 
          RowBox[{",", "0"}]}], "2"]]}], "]"}], 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            SubscriptBox["B", "0"], "B"]}], ")"}]}], 
        FractionBox[
         SubsuperscriptBox["u", "\[UpTee]", "2"], 
         SubsuperscriptBox["\[Theta]", 
          RowBox[{"\[DoubleVerticalBar]", 
           RowBox[{",", "0"}]}], "2"]]}], "-", 
       RowBox[{
        FractionBox[
         SubscriptBox["B", "0"], "B"], 
        FractionBox[
         SubsuperscriptBox["u", "\[UpTee]", "2"], 
         SubsuperscriptBox["\[Theta]", 
          RowBox[{"\[UpTee]", 
           RowBox[{",", "0"}]}], "2"]]}]}], "]"}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     SubscriptBox["n", "0"], 
     FractionBox["1", 
      RowBox[{
       SqrtBox["\[Pi]"], 
       SubscriptBox["\[Theta]", 
        RowBox[{"\[DoubleVerticalBar]", 
         RowBox[{",", "0"}]}]]}]], 
     FractionBox["1", 
      RowBox[{"\[Pi]", " ", 
       SubsuperscriptBox["\[Theta]", 
        RowBox[{"\[UpTee]", 
         RowBox[{",", "0"}]}], "2"]}]], 
     RowBox[{"Exp", "[", 
      RowBox[{"-", 
       FractionBox[
        SubsuperscriptBox["u", "\[DoubleVerticalBar]", "2"], 
        SubsuperscriptBox["\[Theta]", 
         RowBox[{"\[DoubleVerticalBar]", 
          RowBox[{",", "0"}]}], "2"]]}], "]"}], 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             FractionBox[
              SubscriptBox["B", "0"], "B"]}], ")"}], 
           FractionBox[
            SubsuperscriptBox["\[Theta]", 
             RowBox[{"\[UpTee]", 
              RowBox[{",", "0"}]}], "2"], 
            SubsuperscriptBox["\[Theta]", 
             RowBox[{"\[DoubleVerticalBar]", 
              RowBox[{",", "0"}]}], "2"]]}], "+", 
          FractionBox[
           SubscriptBox["B", "0"], "B"]}], ")"}]}], 
       FractionBox[
        SubsuperscriptBox["u", "\[UpTee]", "2"], 
        SubsuperscriptBox["\[Theta]", 
         RowBox[{"\[UpTee]", 
          RowBox[{",", "0"}]}], "2"]]}], "]"}]}]}], TraditionalForm]}],
  ExpressionUUID->"957e7aa8-05ca-4fd3-b430-f7740aedb31a"],
 ".\nExpressing it using new thermal speeds \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["\[Theta]", "\[DoubleVerticalBar]", "2"], "=", 
    SubsuperscriptBox["\[Theta]", 
     RowBox[{"\[DoubleVerticalBar]", 
      RowBox[{",", "0"}]}], "2"]}], TraditionalForm]],ExpressionUUID->
  "710446d3-e434-410d-8932-8f5e69435c7b"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["\[Theta]", "\[UpTee]", "2"], "=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            SubscriptBox["B", "0"], "B"]}], ")"}], 
         FractionBox[
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}], "2"], 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}], "2"]]}], "+", 
        FractionBox[
         SubscriptBox["B", "0"], "B"]}], ")"}], 
      RowBox[{"-", "1"}]], 
     SubsuperscriptBox["\[Theta]", 
      RowBox[{"\[UpTee]", 
       RowBox[{",", "0"}]}], "2"]}]}], TraditionalForm]],ExpressionUUID->
  "0fb31cc2-3481-4627-83b3-88077ada6b95"],
 " \nand a new number density \n",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            SubscriptBox["B", "0"], "B"]}], ")"}], 
         FractionBox[
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}], "2"], 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}], "2"]]}], "+", 
        FractionBox[
         SubscriptBox["B", "0"], "B"]}], ")"}], 
      RowBox[{"-", "1"}]], 
     SubscriptBox["n", "0"]}]}], TraditionalForm]],ExpressionUUID->
  "4e737202-a7e3-46eb-8602-fdbb6c1e55b2"],
 " \nyields\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{
      SubscriptBox["u", "\[DoubleVerticalBar]"], ",", 
      SubscriptBox["u", "\[UpTee]"]}], "]"}], "=", 
    RowBox[{"n", 
     FractionBox["1", 
      RowBox[{
       SqrtBox["\[Pi]"], 
       SubscriptBox["\[Theta]", "\[DoubleVerticalBar]"]}]], 
     FractionBox["1", 
      RowBox[{"\[Pi]", " ", 
       SubsuperscriptBox["\[Theta]", "\[UpTee]", "2"]}]], 
     RowBox[{"Exp", "[", 
      RowBox[{"-", 
       FractionBox[
        SubsuperscriptBox["u", "\[DoubleVerticalBar]", "2"], 
        SubsuperscriptBox["\[Theta]", "\[DoubleVerticalBar]", "2"]]}], "]"}], 
     
     RowBox[{"Exp", "[", 
      RowBox[{"-", 
       FractionBox[
        SubsuperscriptBox["u", "\[UpTee]", "2"], 
        SubsuperscriptBox["\[Theta]", "\[UpTee]", "2"]]}], "]"}]}]}], 
   TraditionalForm]],ExpressionUUID->"ebcd9b93-efa4-4f68-88a5-0b6432510ca2"],
 ".\nHence, the distribution at any location along the field line is a \
bi-Maxwellian with adjusted thermal speeds.\nWe can write the following macro \
variables in terms of the ones at origin:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["T", "\[DoubleVerticalBar]"], "=", 
    SubscriptBox["T", 
     RowBox[{"\[DoubleVerticalBar]", 
      RowBox[{",", "0"}]}]]}], TraditionalForm]],ExpressionUUID->
  "5a0d7488-a632-4fa8-8012-09df413fde6d"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["T", "\[UpTee]"], "=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            SubscriptBox["B", "0"], "B"]}], ")"}], 
         FractionBox[
          SubscriptBox["T", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}]], 
          SubscriptBox["T", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}]]]}], "+", 
        FractionBox[
         SubscriptBox["B", "0"], "B"]}], ")"}], 
      RowBox[{"-", "1"}]], 
     SubscriptBox["T", 
      RowBox[{"\[UpTee]", 
       RowBox[{",", "0"}]}]]}]}], TraditionalForm]],ExpressionUUID->
  "bed6c8df-1dd5-43f2-be61-36c7c872cd5e"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            SubscriptBox["B", "0"], "B"]}], ")"}], 
         FractionBox[
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}], "2"], 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}], "2"]]}], "+", 
        FractionBox[
         SubscriptBox["B", "0"], "B"]}], ")"}], 
      RowBox[{"-", "1"}]], 
     SubscriptBox["n", "0"]}]}], TraditionalForm]],ExpressionUUID->
  "b56908bc-599b-45a0-8a1f-f808a5e56460"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["P", "\[DoubleVerticalBar]"], "=", 
    RowBox[{
     RowBox[{"n", " ", 
      SubscriptBox["T", "\[DoubleVerticalBar]"]}], "=", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             FractionBox[
              SubscriptBox["B", "0"], "B"]}], ")"}], 
           FractionBox[
            SubsuperscriptBox["\[Theta]", 
             RowBox[{"\[UpTee]", 
              RowBox[{",", "0"}]}], "2"], 
            SubsuperscriptBox["\[Theta]", 
             RowBox[{"\[DoubleVerticalBar]", 
              RowBox[{",", "0"}]}], "2"]]}], "+", 
          FractionBox[
           SubscriptBox["B", "0"], "B"]}], ")"}], 
        RowBox[{"-", "1"}]], 
       SubscriptBox["n", "0"], 
       SubscriptBox["T", 
        RowBox[{"\[DoubleVerticalBar]", 
         RowBox[{",", "0"}]}]]}], "=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             FractionBox[
              SubscriptBox["B", "0"], "B"]}], ")"}], 
           FractionBox[
            SubsuperscriptBox["\[Theta]", 
             RowBox[{"\[UpTee]", 
              RowBox[{",", "0"}]}], "2"], 
            SubsuperscriptBox["\[Theta]", 
             RowBox[{"\[DoubleVerticalBar]", 
              RowBox[{",", "0"}]}], "2"]]}], "+", 
          FractionBox[
           SubscriptBox["B", "0"], "B"]}], ")"}], 
        RowBox[{"-", "1"}]], 
       SubscriptBox["P", 
        RowBox[{"\[DoubleVerticalBar]", 
         RowBox[{",", "0"}]}]]}]}]}]}], TraditionalForm]],ExpressionUUID->
  "548c9b06-de5f-4c78-931c-9648532ced15"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["P", "\[UpTee]"], "=", 
    RowBox[{
     RowBox[{"n", " ", 
      SubscriptBox["T", "\[UpTee]"]}], "=", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             FractionBox[
              SubscriptBox["B", "0"], "B"]}], ")"}], 
           FractionBox[
            SubsuperscriptBox["\[Theta]", 
             RowBox[{"\[UpTee]", 
              RowBox[{",", "0"}]}], "2"], 
            SubsuperscriptBox["\[Theta]", 
             RowBox[{"\[DoubleVerticalBar]", 
              RowBox[{",", "0"}]}], "2"]]}], "+", 
          FractionBox[
           SubscriptBox["B", "0"], "B"]}], ")"}], 
        RowBox[{"-", "2"}]], 
       SubscriptBox["n", "0"], 
       SubscriptBox["T", 
        RowBox[{"\[UpTee]", 
         RowBox[{",", "0"}]}]]}], "=", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             FractionBox[
              SubscriptBox["B", "0"], "B"]}], ")"}], 
           FractionBox[
            SubsuperscriptBox["\[Theta]", 
             RowBox[{"\[UpTee]", 
              RowBox[{",", "0"}]}], "2"], 
            SubsuperscriptBox["\[Theta]", 
             RowBox[{"\[DoubleVerticalBar]", 
              RowBox[{",", "0"}]}], "2"]]}], "+", 
          FractionBox[
           SubscriptBox["B", "0"], "B"]}], ")"}], 
        RowBox[{"-", "2"}]], 
       SubscriptBox["P", 
        RowBox[{"\[UpTee]", 
         RowBox[{",", "0"}]}]]}]}]}]}], TraditionalForm]],ExpressionUUID->
  "ec584e8d-3ad9-41ad-b341-06cf06068e6c"],
 "."
}], "Text",ExpressionUUID->"5996d028-bdb2-468b-995d-b5e52731eaba"],

Cell[TextData[{
 "Since we are concerned with the central field line of the mirror magnetic \
field,\nwe can substitute ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"B", "(", "x", ")"}], 
     SubscriptBox["B", "0"]], "=", 
    RowBox[{
     FractionBox[
      RowBox[{
       SubscriptBox["B", "x"], "(", "x", ")"}], 
      SubscriptBox["B", "0"]], "=", 
     RowBox[{
      RowBox[{"1", "+", 
       RowBox[{
        SuperscriptBox["\[Xi]", "2"], 
        SuperscriptBox["x", "2"]}]}], "=", 
      RowBox[{
       SuperscriptBox["sec", "2"], "(", 
       RowBox[{"\[Xi]", " ", 
        SubscriptBox["\[CapitalDelta]", "1"], 
        SuperscriptBox["q", "1"]}], ")"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"0bda8211-9a2c-4bcb-a2a0-32b7b94f1d72"],
 " to the common factor:\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{"\[Eta]", "=", 
    RowBox[{
     FractionBox["n", 
      SubscriptBox["n", "0"]], "=", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            FractionBox[
             SubscriptBox["B", "0"], "B"]}], ")"}], 
          FractionBox[
           SubsuperscriptBox["\[Theta]", 
            RowBox[{"\[UpTee]", 
             RowBox[{",", "0"}]}], "2"], 
           SubsuperscriptBox["\[Theta]", 
            RowBox[{"\[DoubleVerticalBar]", 
             RowBox[{",", "0"}]}], "2"]]}], "+", 
         FractionBox[
          SubscriptBox["B", "0"], "B"]}], ")"}], 
       RowBox[{"-", "1"}]], "=", 
      FractionBox[
       RowBox[{"B", "/", 
        SubscriptBox["B", "0"]}], 
       RowBox[{"1", "-", 
        RowBox[{
         FractionBox[
          SubscriptBox["T", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}]], 
          SubscriptBox["T", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}]]], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox["B", 
            SubscriptBox["B", "0"]]}], ")"}]}]}]]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     FractionBox[
      RowBox[{"1", "+", 
       RowBox[{
        SuperscriptBox["\[Xi]", "2"], 
        SuperscriptBox["x", "2"]}]}], 
      RowBox[{"1", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["T", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}]], "/", 
          SubscriptBox["T", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}]]}], ")"}], 
        SuperscriptBox["\[Xi]", "2"], 
        SuperscriptBox["x", "2"]}]}]], "=", 
     FractionBox[
      RowBox[{"1", "+", 
       RowBox[{
        SuperscriptBox["\[Xi]", "2"], 
        SuperscriptBox["x", "2"]}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          SqrtBox[
           RowBox[{
            SubscriptBox["T", 
             RowBox[{"\[UpTee]", 
              RowBox[{",", "0"}]}]], "/", 
            SubscriptBox["T", 
             RowBox[{"\[DoubleVerticalBar]", 
              RowBox[{",", "0"}]}]]}]], "\[Xi]", " ", "x"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          SqrtBox[
           RowBox[{
            SubscriptBox["T", 
             RowBox[{"\[UpTee]", 
              RowBox[{",", "0"}]}]], "/", 
            SubscriptBox["T", 
             RowBox[{"\[DoubleVerticalBar]", 
              RowBox[{",", "0"}]}]]}]], "\[Xi]", " ", "x"}]}], ")"}]}]]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     FractionBox[
      RowBox[{
       SuperscriptBox["sec", "2"], "(", 
       RowBox[{"\[Xi]", " ", 
        SubscriptBox["\[CapitalDelta]", "1"], 
        SuperscriptBox["q", "1"]}], ")"}], 
      RowBox[{"1", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["T", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}]], "/", 
          SubscriptBox["T", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}]]}], ")"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           SuperscriptBox["sec", "2"], "(", 
           RowBox[{"\[Xi]", " ", 
            SubscriptBox["\[CapitalDelta]", "1"], 
            SuperscriptBox["q", "1"]}], ")"}]}], ")"}]}]}]], "=", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["T", 
          RowBox[{"\[UpTee]", 
           RowBox[{",", "0"}]}]], "/", 
         SubscriptBox["T", 
          RowBox[{"\[DoubleVerticalBar]", 
           RowBox[{",", "0"}]}]]}], ")"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["T", 
             RowBox[{"\[UpTee]", 
              RowBox[{",", "0"}]}]], "/", 
            SubscriptBox["T", 
             RowBox[{"\[DoubleVerticalBar]", 
              RowBox[{",", "0"}]}]]}], ")"}]}], ")"}], 
        RowBox[{
         SuperscriptBox["cos", "2"], "(", 
         RowBox[{"\[Xi]", " ", 
          SubscriptBox["\[CapitalDelta]", "1"], 
          SuperscriptBox["q", "1"]}], ")"}]}]}]]}]}], TraditionalForm]}],
  ExpressionUUID->"7a90e4ae-a693-4cfc-9f86-2110bd3e23e8"],
 ".\nNote that ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Eta]", "=", "1"}], TraditionalForm]],ExpressionUUID->
  "7b18ba68-eed0-4ef8-b492-2d98889679b6"],
 " if ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Xi]", "=", "0"}], TraditionalForm]],ExpressionUUID->
  "c83ab87a-01ad-473f-87c4-fa2bb59e847b"],
 " or ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["T", 
      RowBox[{"\[UpTee]", 
       RowBox[{",", "0"}]}]], "/", 
     SubscriptBox["T", 
      RowBox[{"\[DoubleVerticalBar]", 
       RowBox[{",", "0"}]}]]}], "=", "1"}], TraditionalForm]],ExpressionUUID->
  "0e314a57-09a3-4568-9a9f-2f8511f08746"],
 ".\nThe number of particles in a differential volume, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[DifferentialD]", "V"}], TraditionalForm]],ExpressionUUID->
  "4cb15974-226c-4e2e-94f3-a3c9a042ba33"],
 ", is given by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[DifferentialD]", "N"}], "=", 
    RowBox[{"n", 
     RowBox[{"\[DifferentialD]", "V"}]}]}], TraditionalForm]],ExpressionUUID->
  "554a7c4b-defc-44b8-a4da-b532f1cef0a0"],
 ".\nSince ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[DifferentialD]", "V"}], "=", 
    RowBox[{
     SubscriptBox["\[CapitalDelta]", "1"], 
     SubscriptBox["\[CapitalDelta]", "2"], 
     SubscriptBox["\[CapitalDelta]", "3"], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "1"]}], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "2"]}], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "3"]}]}]}], TraditionalForm]],ExpressionUUID->
  "b765114b-4810-4657-9a91-d6399d57a04c"],
 " is constant in terms of curvilinear coordinates, \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[DifferentialD]", "N"}], "\[Proportional]", 
    RowBox[{"\[Eta]", "(", 
     SuperscriptBox["q", "1"], ")"}]}], TraditionalForm]],ExpressionUUID->
  "3af48f3d-fc9a-498e-9f41-36590213a815"],
 ".\nConsidering a flux tube of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[DifferentialD]", 
     SuperscriptBox["q", "2"]}], "\[Times]", 
    RowBox[{"\[DifferentialD]", 
     SuperscriptBox["q", "3"]}]}], TraditionalForm]],ExpressionUUID->
  "b189aa1f-f99b-4748-b8d0-4a8474d23d15"],
 " wide, the integrated number of particles with respect to ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["q", "1"], TraditionalForm]],ExpressionUUID->
  "47aacd36-b2ba-47f8-9af3-27726162d2d3"],
 " is given by\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"N", "(", 
      SuperscriptBox["q", "1"], ")"}], 
     SubscriptBox["n", "0"]], "=", 
    RowBox[{
     SubscriptBox["\[CapitalDelta]", "1"], 
     SubscriptBox["\[CapitalDelta]", "2"], 
     SubscriptBox["\[CapitalDelta]", "3"], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "2"]}], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "3"]}], 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", 
       SuperscriptBox["q", "1"]], 
      RowBox[{
       RowBox[{"\[Eta]", "(", 
        SuperscriptBox["q", "1"], ")"}], 
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox["q", "1"]}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     SubscriptBox["\[CapitalDelta]", "1"], 
     SubscriptBox["\[CapitalDelta]", "2"], 
     SubscriptBox["\[CapitalDelta]", "3"], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "2"]}], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "3"]}], 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", 
       SuperscriptBox["q", "1"]], 
      FractionBox[
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox["q", "1"]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["T", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}]], "/", 
          SubscriptBox["T", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}]]}], ")"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["T", 
              RowBox[{"\[UpTee]", 
               RowBox[{",", "0"}]}]], "/", 
             SubscriptBox["T", 
              RowBox[{"\[DoubleVerticalBar]", 
               RowBox[{",", "0"}]}]]}], ")"}]}], ")"}], 
         RowBox[{
          SuperscriptBox["cos", "2"], "(", 
          RowBox[{"\[Xi]", " ", 
           SubscriptBox["\[CapitalDelta]", "1"], 
           SuperscriptBox["q", "1"]}], ")"}]}]}]]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     FractionBox[
      RowBox[{
       SubscriptBox["\[CapitalDelta]", "2"], 
       SubscriptBox["\[CapitalDelta]", "3"], 
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox["q", "2"]}], 
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox["q", "3"]}]}], "\[Xi]"], 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", 
       SuperscriptBox["q", "1"]], 
      FractionBox[
       RowBox[{"\[Xi]", " ", 
        SubscriptBox["\[CapitalDelta]", "1"], 
        RowBox[{"\[DifferentialD]", 
         SuperscriptBox["q", "1"]}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["T", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}]], "/", 
          SubscriptBox["T", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}]]}], ")"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["T", 
              RowBox[{"\[UpTee]", 
               RowBox[{",", "0"}]}]], "/", 
             SubscriptBox["T", 
              RowBox[{"\[DoubleVerticalBar]", 
               RowBox[{",", "0"}]}]]}], ")"}]}], ")"}], 
         RowBox[{
          SuperscriptBox["cos", "2"], "(", 
          RowBox[{"\[Xi]", " ", 
           SubscriptBox["\[CapitalDelta]", "1"], 
           SuperscriptBox["q", "1"]}], ")"}]}]}]]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     SubscriptBox["\[CapitalDelta]", "1"], 
     SubscriptBox["\[CapitalDelta]", "2"], 
     SubscriptBox["\[CapitalDelta]", "3"], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "2"]}], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "3"]}], 
     FractionBox[
      RowBox[{
       SuperscriptBox["tan", 
        RowBox[{"-", "1"}]], "(", 
       RowBox[{
        SqrtBox[
         RowBox[{
          SubscriptBox["T", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}]], "/", 
          SubscriptBox["T", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}]]}]], 
        RowBox[{"tan", "(", 
         RowBox[{"\[Xi]", " ", 
          SubscriptBox["\[CapitalDelta]", "1"], 
          SuperscriptBox["q", "1"]}], ")"}]}], ")"}], 
      RowBox[{
       SqrtBox[
        RowBox[{
         SubscriptBox["T", 
          RowBox[{"\[UpTee]", 
           RowBox[{",", "0"}]}]], "/", 
         SubscriptBox["T", 
          RowBox[{"\[DoubleVerticalBar]", 
           RowBox[{",", "0"}]}]]}]], 
       SubscriptBox["\[CapitalDelta]", "1"], "\[Xi]"}]]}]}], 
   TraditionalForm]}],ExpressionUUID->
  "9318e760-94e0-4536-ac39-f70aa2b99ea1"],
 ",\nwhere ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"N", "(", "0", ")"}], "=", "0"}], TraditionalForm]],
  ExpressionUUID->"fb00dde1-cc17-48da-886d-4d6660b854c8"],
 ".\nFor small \[Xi], \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"N", "(", 
      SuperscriptBox["q", "1"], ")"}], 
     SubscriptBox["n", "0"]], "\[TildeTilde]", 
    RowBox[{
     SuperscriptBox["q", "1"], 
     SubscriptBox["\[CapitalDelta]", "1"], 
     SubscriptBox["\[CapitalDelta]", "2"], 
     SubscriptBox["\[CapitalDelta]", "3"], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "2"]}], 
     RowBox[{"\[DifferentialD]", 
      RowBox[{
       SuperscriptBox["q", "3"], "(", 
       RowBox[{"1", "-", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{
            SubscriptBox["T", 
             RowBox[{"\[UpTee]", 
              RowBox[{",", "0"}]}]], "/", 
            SubscriptBox["T", 
             RowBox[{"\[DoubleVerticalBar]", 
              RowBox[{",", "0"}]}]]}], "-", "1"}], "3"], 
         SuperscriptBox[
          RowBox[{
           SuperscriptBox["\[Xi]", "2"], "(", 
           RowBox[{
            SubscriptBox["\[CapitalDelta]", "1"], 
            SuperscriptBox["q", "1"]}], ")"}], "2"]}]}], ")"}]}]}]}], 
   TraditionalForm]],ExpressionUUID->"97c95c80-820b-4417-9232-e790c18fdfc4"],
 ".\nThe inverse relation ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["q", "1"], "(", "N", ")"}], TraditionalForm]],
  ExpressionUUID->"4e944f83-b127-4dcd-a107-780d137496c1"],
 " is given by\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["q", "1"], "(", "N", ")"}], "=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"\[Xi]", " ", 
       SubscriptBox["\[CapitalDelta]", "1"]}]], 
     RowBox[{
      SuperscriptBox["tan", 
       RowBox[{"-", "1"}]], "(", 
      RowBox[{
       FractionBox["1", 
        SqrtBox[
         RowBox[{
          SubscriptBox["T", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}]], "/", 
          SubscriptBox["T", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}]]}]]], 
       RowBox[{"tan", "(", 
        RowBox[{
         FractionBox[
          RowBox[{
           SqrtBox[
            RowBox[{
             SubscriptBox["T", 
              RowBox[{"\[UpTee]", 
               RowBox[{",", "0"}]}]], "/", 
             SubscriptBox["T", 
              RowBox[{"\[DoubleVerticalBar]", 
               RowBox[{",", "0"}]}]]}]], 
           SubscriptBox["\[CapitalDelta]", "1"], "\[Xi]"}], 
          RowBox[{
           SubscriptBox["\[CapitalDelta]", "1"], 
           SubscriptBox["\[CapitalDelta]", "2"], 
           SubscriptBox["\[CapitalDelta]", "3"], 
           RowBox[{"\[DifferentialD]", 
            SuperscriptBox["q", "2"]}], 
           RowBox[{"\[DifferentialD]", 
            SuperscriptBox["q", "3"]}]}]], 
         FractionBox["N", 
          SubscriptBox["n", "0"]]}], ")"}]}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"2ce3f498-ac51-46a8-9cbc-86288db152bb"],
 ".\nFor small \[Xi], \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["q", "1"], "(", "N", ")"}], "\[TildeTilde]", 
    RowBox[{
     FractionBox[
      RowBox[{"N", "/", 
       SubscriptBox["n", "0"]}], 
      RowBox[{
       SubscriptBox["\[CapitalDelta]", "1"], 
       SubscriptBox["\[CapitalDelta]", "2"], 
       SubscriptBox["\[CapitalDelta]", "3"], 
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox["q", "2"]}], 
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox["q", "3"]}]}]], 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{
           SubscriptBox["T", 
            RowBox[{"\[UpTee]", 
             RowBox[{",", "0"}]}]], "/", 
           SubscriptBox["T", 
            RowBox[{"\[DoubleVerticalBar]", 
             RowBox[{",", "0"}]}]]}], "-", "1"}], "3"], 
        SuperscriptBox["\[Xi]", "2"], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["\[CapitalDelta]", "1"], 
           FractionBox["N", 
            SubscriptBox["n", "0"]]}], ")"}], "2"]}]}], ")"}]}]}], 
   TraditionalForm]],ExpressionUUID->"87bf230c-5d8e-49f7-ae8c-3e8a83e8856d"],
 "."
}], "Text",ExpressionUUID->"5547af95-be09-49e0-8f17-2e3caebc813c"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"T2OT1", "=", "5.35"}], ",", 
     RowBox[{"\[Xi]", "=", ".876"}], ",", 
     RowBox[{"q1lim", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "24"}], ",", "50"}], "}"}]}], ",", 
     RowBox[{"\[Xi]\[CapitalDelta]1q1max", "=", 
      RowBox[{
       RowBox[{"Pi", "/", "2"}], "*", ".8"}]}], ",", 
     RowBox[{"nsamples", "=", "50000"}]}], "}"}], ",", "\[IndentingNewLine]", 
   
   RowBox[{"BlockRandom", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "49038", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[CapitalDelta]1", ",", "q1s", ",", "Bs", ",", "\[Eta]s", ",", "xs", 
         ",", "Nofq1", ",", "tmp", ",", "q1ofN", ",", "q1samples", ",", 
         "bins", ",", "hist"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[CapitalDelta]1", "=", 
         RowBox[{"Divide", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1q1max", ",", 
           RowBox[{"\[Xi]", " ", 
            RowBox[{"Max", "[", 
             RowBox[{"Abs", "[", "q1lim", "]"}], "]"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"q1s", "=", 
         RowBox[{"Range", "@@", "q1lim"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xs", "=", 
         RowBox[{
          RowBox[{"Tan", "[", 
           RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1s"}], "]"}], "/",
           "\[Xi]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Bs", "=", 
         RowBox[{
          RowBox[{"Sec", "[", 
           RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1s"}], "]"}], "^",
           "2"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Eta]s", "=", 
         RowBox[{"Divide", "[", 
          RowBox[{"1", ",", 
           RowBox[{"T2OT1", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "T2OT1"}], ")"}], 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1s"}], "]"}], 
              "^", "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"Apply", "[", 
            RowBox[{"And", ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"0", "==", 
               RowBox[{"Chop", "[", 
                RowBox[{"\[Eta]s", "-", 
                 RowBox[{"Power", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"1", "/", "Bs"}]}], ")"}], "T2OT1"}], "+", 
                    RowBox[{"1", "/", "Bs"}]}], ",", 
                   RowBox[{"-", "1"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
          ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<\[Eta]s incorrect\>\"", "]"}], ";", 
            RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Nofq1", "=", 
         RowBox[{
          RowBox[{"ArcTan", "[", 
           RowBox[{
            SqrtBox["T2OT1"], 
            RowBox[{"Tan", "[", 
             RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1s"}], "]"}]}], 
           "]"}], "/", 
          RowBox[{"(", 
           RowBox[{"\[Xi]", 
            SqrtBox["T2OT1"]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{"MinMax", "[", "Nofq1", "]"}], "-", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"NIntegrate", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Power", "[", 
                 RowBox[{
                  RowBox[{"T2OT1", "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "T2OT1"}], ")"}], 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1"}], 
                    "]"}], "^", "2"}]}]}], ",", 
                  RowBox[{"-", "1"}]}], "]"}], "\[CapitalDelta]1"}], ",", 
               RowBox[{"{", 
                RowBox[{"q1", ",", "0", ",", "#"}], "}"}]}], "]"}], "&"}], 
            ",", 
            RowBox[{"MinMax", "[", "q1s", "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"Apply", "[", 
            RowBox[{"And", ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"0", "==", 
               RowBox[{"Chop", "[", "tmp", "]"}]}], "]"}]}], "]"}]}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<N(q1) incorrect\>\"", "]"}], ";", 
            RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"q1ofN", "=", 
         RowBox[{
          RowBox[{"ArcTan", "[", 
           RowBox[{
            RowBox[{"Tan", "[", 
             RowBox[{
              SqrtBox["T2OT1"], "\[Xi]", " ", "Nofq1"}], "]"}], "/", 
            SqrtBox["T2OT1"]}], "]"}], "/", 
          RowBox[{"(", 
           RowBox[{"\[Xi]", " ", "\[CapitalDelta]1"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"Apply", "[", 
            RowBox[{"And", ",", 
             RowBox[{"Thread", "[", 
              RowBox[{
               RowBox[{"Chop", "[", 
                RowBox[{"q1s", "-", "q1ofN"}], "]"}], "==", "0"}], "]"}]}], 
            "]"}]}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<q1(N) incorrect\>\"", "]"}], ";", 
            RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"q1samples", "=", 
         RowBox[{
          RowBox[{"ArcTan", "[", 
           RowBox[{
            RowBox[{"Tan", "[", 
             RowBox[{
              SqrtBox["T2OT1"], "\[Xi]", " ", 
              RowBox[{"RandomReal", "[", 
               RowBox[{
                RowBox[{"MinMax", "[", "Nofq1", "]"}], ",", "nsamples"}], 
               "]"}]}], "]"}], "/", 
            SqrtBox["T2OT1"]}], "]"}], "/", 
          RowBox[{"(", 
           RowBox[{"\[Xi]", " ", "\[CapitalDelta]1"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"bins", ",", "hist"}], "}"}], "=", 
         RowBox[{"N", "@", 
          RowBox[{"HistogramList", "[", 
           RowBox[{"q1samples", ",", 
            RowBox[{"Append", "[", 
             RowBox[{"q1lim", ",", "1"}], "]"}], ",", "\"\<Count\>\""}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bins", "=", 
         RowBox[{"Flatten", "[", "bins", "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{"#", ",", "\[IndentingNewLine]", 
            RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
           "]"}], "&"}], "/@", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"q1s", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
                RowBox[{"{", 
                 RowBox[{"\[Eta]s", ",", 
                  RowBox[{"\[Eta]s", "^", "2"}]}], "}"}]}], ",", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               RowBox[{"AxesLabel", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<\\!\\(\!\(\*SuperscriptBox[\(q\), \(1\)]\)\\)\>\"", 
                  ",", "\"\<\\!\\(\[Eta](\!\(\*SuperscriptBox[\(q\), \
\(1\)]\))\\)\>\""}], "}"}]}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Thread", "[", 
                 RowBox[{"Directive", "[", 
                  RowBox[{"{", 
                   RowBox[{"Black", ",", "Blue"}], "}"}], "]"}], "]"}]}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListStepPlot", "[", 
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"MovingAverage", "[", 
                   RowBox[{"bins", ",", "2"}], "]"}], ",", 
                  RowBox[{"hist", "/", 
                   RowBox[{"Max", "[", "hist", "]"}]}]}], "}"}], "]"}], ",", 
               "Center", ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Red", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"xs", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
                RowBox[{"{", 
                 RowBox[{"\[Eta]s", ",", 
                  RowBox[{"\[Eta]s", "^", "2"}]}], "}"}]}], ",", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               RowBox[{"AxesLabel", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<\\!\\(x\\)\>\"", ",", 
                  
                  "\"\<\\!\\(\[Eta](\!\(\*SuperscriptBox[\(q\), \
\(1\)]\))\\)\>\""}], "}"}]}]}], "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1s", ",", 
                RowBox[{"Nofq1", "-", 
                 RowBox[{"Min", "[", "Nofq1", "]"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"AxesLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<\\!\\(\!\(\*SuperscriptBox[\(q\), \(1\)]\)\\)\>\"", ",", 
                "\"\<\\!\\(N(\!\(\*SuperscriptBox[\(q\), \(1\)]\))\\)\>\""}], 
               "}"}]}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"f58e144f-42ce-4fbf-9954-b67fee102edf"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compileBiMaxwellian", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compileBiMaxwellian", "[", 
   RowBox[{
    RowBox[{"c_", "?", "Positive"}], ",", 
    RowBox[{"\[Beta]1_", "?", "Positive"}], ",", 
    RowBox[{"T2OT1_", "?", "Positive"}], ",", "Vd_Real"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Gamma]d", "=", 
       RowBox[{"N", "[", 
        RowBox[{"c", "/", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"c", "-", "Vd"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"c", "+", "Vd"}], ")"}]}], "]"}]}], "]"}]}], ",", 
      RowBox[{"\[Theta]1", "=", 
       RowBox[{"N", "[", 
        SqrtBox["\[Beta]1"], "]"}]}], ",", 
      RowBox[{"\[Theta]2", "=", 
       RowBox[{"N", "[", 
        RowBox[{
         SqrtBox["\[Beta]1"], 
         SqrtBox["T2OT1"]}], "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"uu", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"n0", "=", 
           RowBox[{"1", "/", "\[Gamma]d"}]}], ",", "u1", ",", "u2", ",", "u3",
           ",", "\[Gamma]u", ",", "x1", ",", "x2", ",", "x3", ",", "f0"}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"u1", ",", "u2", ",", "u3"}], "}"}], "=", "uu"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Gamma]u", "=", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"1", "+", 
            RowBox[{
             RowBox[{"uu", ".", "uu"}], "/", 
             RowBox[{"c", "^", "2"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x3", "=", 
          RowBox[{"u3", "/", "\[Theta]2"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x2", "=", 
          RowBox[{"u2", "/", "\[Theta]2"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x1", "=", 
          RowBox[{"\[Gamma]d", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"u1", "-", 
              RowBox[{"\[Gamma]u", " ", "Vd"}]}], ")"}], "/", 
            "\[Theta]1"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"f0", "=", 
          RowBox[{
           RowBox[{"n0", "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Pi", "^", "1.5"}], "\[Theta]1", " ", 
              RowBox[{"\[Theta]2", "^", "2"}]}], ")"}]}], 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"x1", "^", "2"}]}], "-", 
             RowBox[{"x2", "^", "2"}], "-", 
             RowBox[{"x3", "^", "2"}]}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", "f0"}]}], "\[IndentingNewLine]", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->"In[2]:=",ExpressionUUID->"25186245-ad4f-4e22-b162-c988f29e4fa7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Function", "[", 
   RowBox[{"q1", ",", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"c", "=", "4"}], ",", 
        RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
        RowBox[{"T2OT1eq", "=", "5.35"}], ",", 
        RowBox[{"q1max", "=", "15"}], ",", 
        RowBox[{"\[Xi]\[CapitalDelta]1q1max", "=", 
         RowBox[{
          RowBox[{"Pi", "/", "2"}], "*", ".8"}]}]}], 
       RowBox[{"(*", 
        RowBox[{",", 
         RowBox[{"q1", "=", "0"}]}], "*)"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\[Xi]\[CapitalDelta]1", ",", "\[Eta]", ",", "T2OT1", ",", "ff", ",",
           "u2lim", ",", "u1lim", ",", "u1s", ",", "u2s", ",", "u2u1s", ",", 
          "particleflux", ",", "stressenergy"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
          RowBox[{"Divide", "[", 
           RowBox[{"\[Xi]\[CapitalDelta]1q1max", ",", "q1max"}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"\[Eta]", "=", 
          RowBox[{"Divide", "[", 
           RowBox[{"1", ",", 
            RowBox[{"T2OT1eq", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "T2OT1eq"}], ")"}], 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
               "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"T2OT1", "=", 
          RowBox[{"T2OT1eq", " ", "\[Eta]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ff", "=", 
          RowBox[{"compileBiMaxwellian", "[", 
           RowBox[{"c", ",", "\[Beta]1", ",", "T2OT1", ",", 
            RowBox[{"N", "[", "0", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"u2lim", "=", 
          RowBox[{"4", 
           SqrtBox[
            RowBox[{"\[Beta]1", " ", "T2OT1"}]], 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"u1lim", "=", 
          RowBox[{"4", 
           SqrtBox["\[Beta]1"], 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"u1s", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", "2001", ",", "u1lim"}], "]"}], "~", 
           "MovingAverage", "~", "2"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"u2s", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", "1001", ",", "u2lim"}], "]"}], "~", 
           "MovingAverage", "~", "2"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ff", "=", 
          RowBox[{"\[Eta]", 
           RowBox[{"(", 
            RowBox[{"2", "Pi", " ", "u2s", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"u1s", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "-", 
               RowBox[{"u1s", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"u2s", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "-", 
               RowBox[{"u2s", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], ")"}], 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ff", "[", 
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"u1s", ",", "#", ",", "0"}], "}"}], "]"}], "]"}], 
              "&"}], ",", "u2s"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ff", "=", 
          RowBox[{"Join", "@@", "ff"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"u2u1s", "=", 
          RowBox[{"Tuples", "[", 
           RowBox[{"{", 
            RowBox[{"u2s", ",", "u1s"}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"particleflux", "=", 
          RowBox[{"Total", "/@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"c", " ", "ff"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Last", "/@", "u2u1s"}], ")"}], "/", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"1", "+", 
                 RowBox[{
                  RowBox[{"Map", "[", 
                   RowBox[{"Total", ",", 
                    RowBox[{"u2u1s", "^", "2"}]}], "]"}], "/", 
                  RowBox[{"c", "^", "2"}]}]}], "]"}]}], "ff"}]}], "}"}]}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"stressenergy", "=", 
          RowBox[{"Total", "/@", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Sqrt", "[", 
               RowBox[{"1", "+", 
                RowBox[{
                 RowBox[{"Map", "[", 
                  RowBox[{"Total", ",", 
                   RowBox[{"u2u1s", "^", "2"}]}], "]"}], "/", 
                 RowBox[{"c", "^", "2"}]}]}], "]"}], 
              RowBox[{"c", "^", "2"}], "ff"}], ",", "\[IndentingNewLine]", 
             RowBox[{"c", 
              RowBox[{"(", 
               RowBox[{"Last", "/@", "u2u1s"}], ")"}], "ff"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"Last", "/@", "u2u1s"}], ")"}], "^", "2"}], "/", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"1", "+", 
                 RowBox[{
                  RowBox[{"Map", "[", 
                   RowBox[{"Total", ",", 
                    RowBox[{"u2u1s", "^", "2"}]}], "]"}], "/", 
                  RowBox[{"c", "^", "2"}]}]}], "]"}]}], "ff"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{".5", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"First", "/@", "u2u1s"}], ")"}], "^", "2"}], "/", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"1", "+", 
                 RowBox[{
                  RowBox[{"Map", "[", 
                   RowBox[{"Total", ",", 
                    RowBox[{"u2u1s", "^", "2"}]}], "]"}], "/", 
                  RowBox[{"c", "^", "2"}]}]}], "]"}]}], "ff"}]}], 
            "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"SetPrecision", "[", 
          RowBox[{
           RowBox[{"stressenergy", "//", "Chop"}], ",", "20"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
    RowBox[{"{", "Listable", "}"}]}], "]"}], "[", 
  RowBox[{"Range", "[", 
   RowBox[{
    RowBox[{"-", "7"}], ",", "15"}], "]"}], "]"}]], "Input",
 CellLabel->"In[9]:=",ExpressionUUID->"a2842d75-03fa-4725-b756-f7483ace4b47"],

Cell[CellGroupData[{

Cell["Test", "Subsubsection",ExpressionUUID->"8e3cbe3b-0927-4fbd-ad39-2ee57bb68a15"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]", "=", 
      RowBox[{"0.", "Degree"}]}], ",", 
     RowBox[{"c", "=", "4"}], ",", 
     RowBox[{"\[Beta]1", "=", 
      RowBox[{"1.5", "*", "2.1"}]}], ",", 
     RowBox[{"T2OT1", "=", "5.35"}], ",", 
     RowBox[{"Vd", "=", "0.0"}], ",", 
     RowBox[{"q1lim", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "7"}], ",", "15"}], "}"}]}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"data", "=", 
      RowBox[{"Get", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<~/Downloads\>\"", ",", 
          "\"\<RelativisticMaxwellianVDF-homogeneous.m\>\""}], "}"}], "]"}], 
       "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Gamma]d", ",", "e1", ",", "e3", ",", "e2", ",", "Lcarts2mfa", ",", 
       "uel", ",", "pos", ",", "q1s", ",", "\[Eta]s", ",", "binpos", ",", 
       "histpos", ",", "binu1", ",", "histu1", ",", "binu2", ",", "histu2", 
       ",", "binu3", ",", "histu3", ",", "u1s", ",", "u2s", ",", "u3s", ",", 
       "ff", ",", "f1", ",", "f2", ",", "f3"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Gamma]d", "=", 
       RowBox[{"N", "[", 
        RowBox[{"c", "/", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"c", "-", "Vd"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"c", "+", "Vd"}], ")"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"e1", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}], ",", "0"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"e3", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"e2", "=", 
       RowBox[{"Cross", "[", 
        RowBox[{"e3", ",", "e1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Lcarts2mfa", "=", 
       RowBox[{"{", 
        RowBox[{"e1", ",", "e2", ",", "e3"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1s", "=", 
       RowBox[{"Range", "@@", "q1lim"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]s", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"1.", ",", 
         RowBox[{"Length", "[", "q1s", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"uel", "=", 
       RowBox[{"Dot", "[", 
        RowBox[{
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"Lcarts2mfa", "\[Transpose]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"Mean", "[", 
        RowBox[{"uel", "/", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"1", "+", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Dot", "[", 
                RowBox[{"#", ",", "#"}], "]"}], "&"}], ",", "uel"}], "]"}], 
            "/", 
            RowBox[{"c", "^", "2"}]}]}], "]"}]}], "]"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"Join", "@@", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binpos", ",", "histpos"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"pos", ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"q1lim", "+", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"+", ".5"}], ",", 
              RowBox[{"-", ".5"}]}], "}"}]}], ",", "1"}], "]"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"binu1", "=", 
       RowBox[{"Array", "[", 
        RowBox[{"N", ",", "51", ",", 
         RowBox[{"MinMax", "[", 
          RowBox[{"uel", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binu1", ",", "histu1"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"uel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"MinMax", "[", "binu1", "]"}], ",", 
           RowBox[{
            RowBox[{"binu1", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", 
            RowBox[{"binu1", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ",", "\"\<PDF\>\""}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"binu2", "=", 
       RowBox[{"Array", "[", 
        RowBox[{"N", ",", "51", ",", 
         RowBox[{"MinMax", "[", 
          RowBox[{"uel", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binu2", ",", "histu2"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"uel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"MinMax", "[", "binu2", "]"}], ",", 
           RowBox[{
            RowBox[{"binu2", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", 
            RowBox[{"binu2", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ",", "\"\<PDF\>\""}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"binu3", "=", 
       RowBox[{"Array", "[", 
        RowBox[{"N", ",", "51", ",", 
         RowBox[{"MinMax", "[", 
          RowBox[{"uel", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binu3", ",", "histu3"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"uel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"MinMax", "[", "binu3", "]"}], ",", 
           RowBox[{
            RowBox[{"binu3", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", 
            RowBox[{"binu3", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ",", "\"\<PDF\>\""}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"u1s", "=", 
       RowBox[{
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", "201", ",", 
          RowBox[{"MinMax", "[", "binu1", "]"}]}], "]"}], "~", 
        "MovingAverage", "~", "2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"u2s", "=", 
       RowBox[{
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", "200", ",", 
          RowBox[{"MinMax", "[", "binu2", "]"}]}], "]"}], "~", 
        "MovingAverage", "~", "2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"u3s", "=", 
       RowBox[{
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", "199", ",", 
          RowBox[{"MinMax", "[", "binu3", "]"}]}], "]"}], "~", 
        "MovingAverage", "~", "2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"compileBiMaxwellian", "[", 
        RowBox[{"c", ",", "\[Beta]1", ",", "T2OT1", ",", 
         RowBox[{"N", "[", "Vd", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"ff", "[", 
          RowBox[{"Tuples", "[", 
           RowBox[{"{", 
            RowBox[{"u1s", ",", "u2s", ",", "u3s"}], "}"}], "]"}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"u1s", ",", "u2s", ",", "u3s"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"f1", "=", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{"Flatten", "[", "#", "]"}], "]"}], "&"}], ",", "ff"}], 
         "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"u2s", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"u2s", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"u3s", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"u3s", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"f2", "=", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{"Flatten", "[", "#", "]"}], "]"}], "&"}], ",", 
          RowBox[{"ff", "\[Transpose]"}]}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"u1s", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"u1s", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"u3s", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"u3s", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"f3", "=", 
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{"Join", "@@", "ff"}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"u1s", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"u1s", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"u2s", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"u2s", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"q1s", ",", "\[Eta]s"}], "}"}], "]"}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binpos", ",", "2"}], "]"}], ",", 
               RowBox[{"histpos", "/", 
                RowBox[{"Max", "[", "histpos", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"u1s", ",", "f1"}], "}"}], "]"}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binu1", ",", "2"}], "]"}], ",", "histu1"}], "}"}], 
             "]"}], ",", "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"u2s", ",", "f2"}], "}"}], "]"}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binu2", ",", "2"}], "]"}], ",", "histu2"}], "}"}], 
             "]"}], ",", "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"u3s", ",", "f3"}], "}"}], "]"}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binu3", ",", "2"}], "]"}], ",", "histu3"}], "}"}], 
             "]"}], ",", "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}]}], "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[20]:=",ExpressionUUID->"a4a386eb-cb8b-4d9c-971f-9a31a81d0e81"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"c", "=", "4"}], ",", 
     RowBox[{"\[Beta]1", "=", 
      RowBox[{"1.5", "*", "2.1"}]}], ",", 
     RowBox[{"T2OT1eq", "=", "5.35"}], ",", 
     RowBox[{"\[Xi]", "=", ".876"}], ",", 
     RowBox[{"q1lim", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "7"}], ",", "15"}], "}"}]}], ",", 
     RowBox[{"\[Xi]\[CapitalDelta]1q1max", "=", 
      RowBox[{
       RowBox[{"Pi", "/", "2"}], "*", ".8"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Get", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<~/Downloads\>\"", ",", 
          "\"\<RelativisticMaxwellianVDF-inhomogeneous.m\>\""}], "}"}], "]"}],
        "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "uel", ",", "pos", ",", "gamma", ",", "\[CapitalDelta]1", ",", "q1s", 
       ",", "\[Eta]s", ",", "binpos", ",", "histpos", ",", "binu1", ",", 
       "histu1", ",", "binu2", ",", "histu2", ",", "binu3", ",", "histu3", 
       ",", "u1s", ",", "u2s", ",", "u3s", ",", "ff", ",", "f1", ",", "f2", 
       ",", "f3"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[CapitalDelta]1", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"\[Xi]\[CapitalDelta]1q1max", ",", 
         RowBox[{"\[Xi]", " ", 
          RowBox[{"Max", "[", 
           RowBox[{"Abs", "[", "q1lim", "]"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1s", "=", 
       RowBox[{"Range", "@@", "q1lim"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
        RowBox[{"Divide", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Apply", "[", 
           RowBox[{"Subtract", ",", 
            RowBox[{
             RowBox[{"ArcTan", "[", 
              RowBox[{
               SqrtBox["T2OT1eq"], 
               RowBox[{"Tan", "[", 
                RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", 
                 RowBox[{"{", 
                  RowBox[{".5", ",", 
                   RowBox[{"-", ".5"}]}], "}"}]}], "]"}]}], "]"}], "/", 
             RowBox[{"(", 
              RowBox[{"\[Xi]", 
               SqrtBox["T2OT1eq"]}], ")"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Apply", "[", 
           RowBox[{"Subtract", ",", 
            RowBox[{
             RowBox[{"ArcTan", "[", 
              RowBox[{
               SqrtBox["T2OT1eq"], 
               RowBox[{"Tan", "[", 
                RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", 
                 RowBox[{"q1s", "[", 
                  RowBox[{"[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], "]"}]}], 
                "]"}]}], "]"}], "/", 
             RowBox[{"(", 
              RowBox[{"\[Xi]", 
               SqrtBox["T2OT1eq"]}], ")"}]}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}], "//", "CForm"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]s", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{"T2OT1eq", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "T2OT1eq"}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1s"}], "]"}], 
            "^", "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"Join", "@@", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"uel", "=", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"Mean", "[", 
        RowBox[{"uel", "/", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"1", "+", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Dot", "[", 
                RowBox[{"#", ",", "#"}], "]"}], "&"}], ",", "uel"}], "]"}], 
            "/", 
            RowBox[{"c", "^", "2"}]}]}], "]"}]}], "]"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"uel", "=", 
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
            RowBox[{"Divide", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1q1max", ",", 
              RowBox[{"Max", "[", 
               RowBox[{"Abs", "[", "q1lim", "]"}], "]"}]}], "]"}]}], "}"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Compile", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"u", ",", "_Real", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "_Real"}], "}"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\[Eta]", ",", "T2OT1"}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"\[Eta]", "=", 
                RowBox[{"Divide", "[", 
                 RowBox[{"1", ",", 
                  RowBox[{"T2OT1eq", "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "T2OT1eq"}], ")"}], 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
                    "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"T2OT1", "=", 
                RowBox[{"T2OT1eq", " ", "\[Eta]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Divide", "[", 
                RowBox[{"u", ",", 
                 SqrtBox[
                  RowBox[{"\[Beta]1", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "T2OT1", ",", "T2OT1"}], "}"}]}]]}], 
                "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"RuntimeAttributes", "\[Rule]", 
             RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", 
           "]"}]}], "\[IndentingNewLine]", "]"}], "[", 
        RowBox[{"uel", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binpos", ",", "histpos"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"pos", ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"q1lim", "+", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"+", ".5"}], ",", 
              RowBox[{"-", ".5"}]}], "}"}]}], ",", "1"}], "]"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"binu1", "=", 
       RowBox[{"Array", "[", 
        RowBox[{"N", ",", "51", ",", 
         RowBox[{"MinMax", "[", 
          RowBox[{"uel", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binu1", ",", "histu1"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"uel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"MinMax", "[", "binu1", "]"}], ",", 
           RowBox[{
            RowBox[{"binu1", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", 
            RowBox[{"binu1", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ",", "\"\<PDF\>\""}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"binu2", "=", 
       RowBox[{"Array", "[", 
        RowBox[{"N", ",", "51", ",", 
         RowBox[{"MinMax", "[", 
          RowBox[{"uel", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binu2", ",", "histu2"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"uel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"MinMax", "[", "binu2", "]"}], ",", 
           RowBox[{
            RowBox[{"binu2", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", 
            RowBox[{"binu2", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ",", "\"\<PDF\>\""}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"binu3", "=", 
       RowBox[{"Array", "[", 
        RowBox[{"N", ",", "51", ",", 
         RowBox[{"MinMax", "[", 
          RowBox[{"uel", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binu3", ",", "histu3"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"uel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"MinMax", "[", "binu3", "]"}], ",", 
           RowBox[{
            RowBox[{"binu3", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", 
            RowBox[{"binu3", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ",", "\"\<PDF\>\""}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"u1s", "=", 
       RowBox[{
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", "201", ",", 
          RowBox[{"MinMax", "[", "binu1", "]"}]}], "]"}], "~", 
        "MovingAverage", "~", "2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"u2s", "=", 
       RowBox[{
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", "200", ",", 
          RowBox[{"MinMax", "[", "binu2", "]"}]}], "]"}], "~", 
        "MovingAverage", "~", "2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"u3s", "=", 
       RowBox[{
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", "199", ",", 
          RowBox[{"MinMax", "[", "binu3", "]"}]}], "]"}], "~", 
        "MovingAverage", "~", "2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"compileBiMaxwellian", "[", 
        RowBox[{"c", ",", "1.", ",", "1.", ",", 
         RowBox[{"N", "[", "0", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"ff", "[", 
          RowBox[{"Tuples", "[", 
           RowBox[{"{", 
            RowBox[{"u1s", ",", "u2s", ",", "u3s"}], "}"}], "]"}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"u1s", ",", "u2s", ",", "u3s"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"f1", "=", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{"Flatten", "[", "#", "]"}], "]"}], "&"}], ",", "ff"}], 
         "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"u2s", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"u2s", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"u3s", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"u3s", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"f2", "=", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{"Flatten", "[", "#", "]"}], "]"}], "&"}], ",", 
          RowBox[{"ff", "\[Transpose]"}]}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"u1s", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"u1s", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"u3s", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"u3s", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"f3", "=", 
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{"Join", "@@", "ff"}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"u1s", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"u1s", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"u2s", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"u2s", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"q1s", ",", "\[Eta]s"}], "}"}], "]"}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binpos", ",", "2"}], "]"}], ",", 
               RowBox[{"histpos", "/", 
                RowBox[{"Max", "[", "histpos", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"u1s", ",", "f1"}], "}"}], "]"}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binu1", ",", "2"}], "]"}], ",", "histu1"}], "}"}], 
             "]"}], ",", "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"u2s", ",", "f2"}], "}"}], "]"}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binu2", ",", "2"}], "]"}], ",", "histu2"}], "}"}], 
             "]"}], ",", "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"u3s", ",", "f3"}], "}"}], "]"}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binu3", ",", "2"}], "]"}], ",", "histu3"}], "}"}], 
             "]"}], ",", "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}]}], "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[10]:=",ExpressionUUID->"73fa9a0b-af93-4df2-ad89-3bf4da649ec3"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Loss-cone velocity distribution", "Subsection",ExpressionUUID->"cca306bd-cb81-4c1e-b53a-bfebabd883cd"],

Cell[TextData[{
 "Consider a loss-cone velocity distribution at the origin with ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalDelta]", "=", "0"}], TraditionalForm]],ExpressionUUID->
  "be57e68c-5512-47bf-a26c-2b62274816d8"],
 " \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["f", "0"], "(", 
     RowBox[{
      SubscriptBox["u", 
       RowBox[{"\[DoubleVerticalBar]", 
        RowBox[{",", "0"}]}]], ",", 
      SubscriptBox["u", 
       RowBox[{"\[UpTee]", 
        RowBox[{",", "0"}]}]]}], ")"}], "=", 
    RowBox[{
     FractionBox[
      SubscriptBox["n", "0"], 
      RowBox[{
       SuperscriptBox["\[Pi]", 
        RowBox[{"3", "/", "2"}]], 
       SubscriptBox["\[Theta]", 
        RowBox[{"\[DoubleVerticalBar]", 
         RowBox[{",", "0"}]}]], 
       SubsuperscriptBox["\[Theta]", 
        RowBox[{"\[UpTee]", 
         RowBox[{",", "0"}]}], "2"]}]], 
     FractionBox["1", 
      RowBox[{"1", "-", 
       SubscriptBox["\[Beta]", "0"]}]], 
     RowBox[{"exp", "(", 
      RowBox[{"-", 
       FractionBox[
        SubsuperscriptBox["u", 
         RowBox[{"\[DoubleVerticalBar]", 
          RowBox[{",", "0"}]}], "2"], 
        SubsuperscriptBox["\[Theta]", 
         RowBox[{"\[DoubleVerticalBar]", 
          RowBox[{",", "0"}]}], "2"]]}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"exp", "(", 
        RowBox[{"-", 
         FractionBox[
          SubsuperscriptBox["u", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}], "2"], 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}], "2"]]}], ")"}], "-", 
       RowBox[{"exp", "(", 
        RowBox[{"-", 
         FractionBox[
          SubsuperscriptBox["u", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}], "2"], 
          RowBox[{
           SubscriptBox["\[Beta]", "0"], 
           SubsuperscriptBox["\[Theta]", 
            RowBox[{"\[UpTee]", 
             RowBox[{",", "0"}]}], "2"]}]]}], ")"}]}], ")"}]}]}], 
   TraditionalForm]],ExpressionUUID->"6198d13c-c002-4b66-9d70-bf54d9df299b"],
 ".\nThe choice ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalDelta]", "=", "0"}], TraditionalForm]],ExpressionUUID->
  "8473ad2b-4032-4e62-b6ea-7c03b480350d"],
 " makes the relationship simple.\nThe distribution at a given location is \
given by\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    RowBox[{"f", "(", 
     RowBox[{
      SubscriptBox["u", "\[DoubleVerticalBar]"], ",", 
      SubscriptBox["u", "\[UpTee]"]}], ")"}], "=", 
    RowBox[{
     SubscriptBox["f", "0"], "(", 
     RowBox[{
      RowBox[{
       SubscriptBox["u", 
        RowBox[{"\[DoubleVerticalBar]", 
         RowBox[{",", "0"}]}]], "(", 
       RowBox[{
        SubscriptBox["u", "\[DoubleVerticalBar]"], ",", 
        SubscriptBox["u", "\[UpTee]"]}], ")"}], ",", 
      RowBox[{
       SubscriptBox["u", 
        RowBox[{"\[UpTee]", 
         RowBox[{",", "0"}]}]], "(", 
       RowBox[{
        SubscriptBox["u", "\[DoubleVerticalBar]"], ",", 
        SubscriptBox["u", "\[UpTee]"]}], ")"}]}], ")"}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     FractionBox[
      SubscriptBox["n", "0"], 
      RowBox[{
       SuperscriptBox["\[Pi]", 
        RowBox[{"3", "/", "2"}]], 
       SubscriptBox["\[Theta]", 
        RowBox[{"\[DoubleVerticalBar]", 
         RowBox[{",", "0"}]}]], 
       SubsuperscriptBox["\[Theta]", 
        RowBox[{"\[UpTee]", 
         RowBox[{",", "0"}]}], "2"]}]], 
     FractionBox["1", 
      RowBox[{"1", "-", 
       SubscriptBox["\[Beta]", "0"]}]], 
     RowBox[{"exp", "(", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SubsuperscriptBox["u", "\[DoubleVerticalBar]", "2"], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{
             SubscriptBox["B", "0"], "/", "B"}]}], ")"}], 
          SubsuperscriptBox["u", "\[UpTee]", "2"]}]}], 
        SubsuperscriptBox["\[Theta]", 
         RowBox[{"\[DoubleVerticalBar]", 
          RowBox[{",", "0"}]}], "2"]]}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"exp", "(", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           FractionBox[
            SubscriptBox["B", "0"], "B"], 
           SubsuperscriptBox["u", "\[UpTee]", "2"]}], 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}], "2"]]}], ")"}], "-", 
       RowBox[{"exp", "(", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           FractionBox[
            SubscriptBox["B", "0"], "B"], 
           SubsuperscriptBox["u", "\[UpTee]", "2"]}], 
          RowBox[{
           SubscriptBox["\[Beta]", "0"], 
           SubsuperscriptBox["\[Theta]", 
            RowBox[{"\[UpTee]", 
             RowBox[{",", "0"}]}], "2"]}]]}], ")"}]}], ")"}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     FractionBox[
      SubscriptBox["n", "0"], 
      RowBox[{
       SuperscriptBox["\[Pi]", 
        RowBox[{"3", "/", "2"}]], 
       SubscriptBox["\[Theta]", 
        RowBox[{"\[DoubleVerticalBar]", 
         RowBox[{",", "0"}]}]], 
       SubsuperscriptBox["\[Theta]", 
        RowBox[{"\[UpTee]", 
         RowBox[{",", "0"}]}], "2"]}]], 
     FractionBox["1", 
      RowBox[{"1", "-", 
       SubscriptBox["\[Beta]", "0"]}]], 
     RowBox[{"exp", "(", 
      RowBox[{"-", 
       FractionBox[
        SubsuperscriptBox["u", "\[DoubleVerticalBar]", "2"], 
        SubsuperscriptBox["\[Theta]", 
         RowBox[{"\[DoubleVerticalBar]", 
          RowBox[{",", "0"}]}], "2"]]}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"exp", "(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{
               SubscriptBox["B", "0"], "/", "B"}]}], ")"}], 
            SubsuperscriptBox["u", "\[UpTee]", "2"]}], 
           SubsuperscriptBox["\[Theta]", 
            RowBox[{"\[DoubleVerticalBar]", 
             RowBox[{",", "0"}]}], "2"]]}], "-", 
         FractionBox[
          RowBox[{
           FractionBox[
            SubscriptBox["B", "0"], "B"], 
           SubsuperscriptBox["u", "\[UpTee]", "2"]}], 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}], "2"]]}], ")"}], "-", 
       RowBox[{"exp", "(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{
               SubscriptBox["B", "0"], "/", "B"}]}], ")"}], 
            SubsuperscriptBox["u", "\[UpTee]", "2"]}], 
           SubsuperscriptBox["\[Theta]", 
            RowBox[{"\[DoubleVerticalBar]", 
             RowBox[{",", "0"}]}], "2"]]}], "-", 
         FractionBox[
          RowBox[{
           FractionBox[
            SubscriptBox["B", "0"], "B"], 
           SubsuperscriptBox["u", "\[UpTee]", "2"]}], 
          RowBox[{
           SubscriptBox["\[Beta]", "0"], 
           SubsuperscriptBox["\[Theta]", 
            RowBox[{"\[UpTee]", 
             RowBox[{",", "0"}]}], "2"]}]]}], ")"}]}], ")"}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     FractionBox[
      SubscriptBox["n", "0"], 
      RowBox[{
       SuperscriptBox["\[Pi]", 
        RowBox[{"3", "/", "2"}]], 
       SubscriptBox["\[Theta]", 
        RowBox[{"\[DoubleVerticalBar]", 
         RowBox[{",", "0"}]}]], 
       SubsuperscriptBox["\[Theta]", 
        RowBox[{"\[UpTee]", 
         RowBox[{",", "0"}]}], "2"]}]], 
     FractionBox["1", 
      RowBox[{"1", "-", 
       SubscriptBox["\[Beta]", "0"]}]], 
     RowBox[{"exp", "(", 
      RowBox[{"-", 
       FractionBox[
        SubsuperscriptBox["u", "\[DoubleVerticalBar]", "2"], 
        SubsuperscriptBox["\[Theta]", 
         RowBox[{"\[DoubleVerticalBar]", 
          RowBox[{",", "0"}]}], "2"]]}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"exp", "(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               FractionBox[
                SubscriptBox["B", "0"], "B"]}], ")"}], 
             FractionBox[
              SubsuperscriptBox["\[Theta]", 
               RowBox[{"\[UpTee]", 
                RowBox[{",", "0"}]}], "2"], 
              SubsuperscriptBox["\[Theta]", 
               RowBox[{"\[DoubleVerticalBar]", 
                RowBox[{",", "0"}]}], "2"]]}], "+", 
            FractionBox[
             SubscriptBox["B", "0"], "B"]}], ")"}]}], 
         FractionBox[
          SubsuperscriptBox["u", "\[UpTee]", "2"], 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}], "2"]]}], ")"}], "-", 
       RowBox[{"exp", "(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               FractionBox[
                SubscriptBox["B", "0"], "B"]}], ")"}], 
             FractionBox[
              RowBox[{
               SubscriptBox["\[Beta]", "0"], 
               SubsuperscriptBox["\[Theta]", 
                RowBox[{"\[UpTee]", 
                 RowBox[{",", "0"}]}], "2"]}], 
              SubsuperscriptBox["\[Theta]", 
               RowBox[{"\[DoubleVerticalBar]", 
                RowBox[{",", "0"}]}], "2"]]}], "+", 
            FractionBox[
             SubscriptBox["B", "0"], "B"]}], ")"}]}], 
         FractionBox[
          SubsuperscriptBox["u", "\[UpTee]", "2"], 
          RowBox[{
           SubscriptBox["\[Beta]", "0"], 
           SubsuperscriptBox["\[Theta]", 
            RowBox[{"\[UpTee]", 
             RowBox[{",", "0"}]}], "2"]}]]}], ")"}]}], ")"}]}]}], 
   TraditionalForm]}],ExpressionUUID->
  "fa693d0a-5b72-4667-9325-630abbd2fb72"],
 ".\nTo make it look like a loss-cone, we define\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["\[Theta]", 
     RowBox[{"\[DoubleVerticalBar]", 
      RowBox[{",", "0"}]}], "2"], "=", 
    SubsuperscriptBox["\[Theta]", "\[DoubleVerticalBar]", "2"]}], 
   TraditionalForm]],ExpressionUUID->"02cee88a-5f71-4057-bb7f-50c290fdc0f1"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["\[Theta]", 
     RowBox[{"\[UpTee]", 
      RowBox[{",", "0"}]}], "2"], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox[
           SubscriptBox["B", "0"], "B"]}], ")"}], 
        FractionBox[
         SubsuperscriptBox["\[Theta]", 
          RowBox[{"\[UpTee]", 
           RowBox[{",", "0"}]}], "2"], 
         SubsuperscriptBox["\[Theta]", 
          RowBox[{"\[DoubleVerticalBar]", 
           RowBox[{",", "0"}]}], "2"]]}], "+", 
       FractionBox[
        SubscriptBox["B", "0"], "B"]}], ")"}], 
     SubsuperscriptBox["\[Theta]", "\[UpTee]", "2"]}]}], TraditionalForm]],
  ExpressionUUID->"381946c3-5805-4b9a-b5a8-ba5c1a79923f"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Beta]", "0"], "=", 
    RowBox[{"\[Beta]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox[
           SubscriptBox["B", "0"], "B"]}], ")"}], 
        FractionBox[
         RowBox[{
          SubscriptBox["\[Beta]", "0"], 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}], "2"]}], 
         SubsuperscriptBox["\[Theta]", 
          RowBox[{"\[DoubleVerticalBar]", 
           RowBox[{",", "0"}]}], "2"]]}], "+", 
       FractionBox[
        SubscriptBox["B", "0"], "B"]}], ")"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            SubscriptBox["B", "0"], "B"]}], ")"}], 
         FractionBox[
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}], "2"], 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}], "2"]]}], "+", 
        FractionBox[
         SubscriptBox["B", "0"], "B"]}], ")"}], 
      RowBox[{"-", "1"}]]}]}], TraditionalForm]],ExpressionUUID->
  "f9a2b587-f026-4c9b-854d-fb7b7049a52d"],
 ".\nSubstituting them yields\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{"f", "(", 
    RowBox[{
     SubscriptBox["u", "\[DoubleVerticalBar]"], ",", 
     SubscriptBox["u", "\[UpTee]"]}], ")"}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     FractionBox[
      SubscriptBox["n", "0"], 
      RowBox[{
       SuperscriptBox["\[Pi]", 
        RowBox[{"3", "/", "2"}]], 
       SubscriptBox["\[Theta]", 
        RowBox[{"\[DoubleVerticalBar]", 
         RowBox[{",", "0"}]}]], 
       SubsuperscriptBox["\[Theta]", 
        RowBox[{"\[UpTee]", 
         RowBox[{",", "0"}]}], "2"]}]], 
     FractionBox["1", 
      RowBox[{"1", "-", 
       SubscriptBox["\[Beta]", "0"]}]], 
     RowBox[{"exp", "(", 
      RowBox[{"-", 
       FractionBox[
        SubsuperscriptBox["u", "\[DoubleVerticalBar]", "2"], 
        SubsuperscriptBox["\[Theta]", "\[DoubleVerticalBar]", "2"]]}], ")"}], 
     
     RowBox[{"(", 
      RowBox[{
       RowBox[{"exp", "(", 
        RowBox[{"-", 
         FractionBox[
          SubsuperscriptBox["u", "\[UpTee]", "2"], 
          SubsuperscriptBox["\[Theta]", "\[UpTee]", "2"]]}], ")"}], "-", 
       RowBox[{"exp", "(", 
        RowBox[{"-", 
         FractionBox[
          SubsuperscriptBox["u", "\[UpTee]", "2"], 
          RowBox[{"\[Beta]", " ", 
           SubsuperscriptBox["\[Theta]", "\[UpTee]", "2"]}]]}], ")"}]}], 
      ")"}]}]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     FractionBox[
      RowBox[{"1", "-", "\[Beta]"}], 
      RowBox[{"1", "-", 
       SubscriptBox["\[Beta]", "0"]}]], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            SubscriptBox["B", "0"], "B"]}], ")"}], 
         FractionBox[
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}], "2"], 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}], "2"]]}], "+", 
        FractionBox[
         SubscriptBox["B", "0"], "B"]}], ")"}], 
      RowBox[{"-", "1"}]], 
     FractionBox[
      SubscriptBox["n", "0"], 
      RowBox[{
       SuperscriptBox["\[Pi]", 
        RowBox[{"3", "/", "2"}]], 
       SubscriptBox["\[Theta]", "\[DoubleVerticalBar]"], 
       SubsuperscriptBox["\[Theta]", "\[UpTee]", "2"]}]], 
     FractionBox["1", 
      RowBox[{"1", "-", "\[Beta]"}]], 
     RowBox[{"exp", "(", 
      RowBox[{"-", 
       FractionBox[
        SubsuperscriptBox["u", "\[DoubleVerticalBar]", "2"], 
        SubsuperscriptBox["\[Theta]", "\[DoubleVerticalBar]", "2"]]}], ")"}], 
     
     RowBox[{"(", 
      RowBox[{
       RowBox[{"exp", "(", 
        RowBox[{"-", 
         FractionBox[
          SubsuperscriptBox["u", "\[UpTee]", "2"], 
          SubsuperscriptBox["\[Theta]", "\[UpTee]", "2"]]}], ")"}], "-", 
       RowBox[{"exp", "(", 
        RowBox[{"-", 
         FractionBox[
          SubsuperscriptBox["u", "\[UpTee]", "2"], 
          RowBox[{"\[Beta]", " ", 
           SubsuperscriptBox["\[Theta]", "\[UpTee]", "2"]}]]}], ")"}]}], 
      ")"}]}]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     FractionBox["n", 
      RowBox[{
       SuperscriptBox["\[Pi]", 
        RowBox[{"3", "/", "2"}]], 
       SubscriptBox["\[Theta]", "\[DoubleVerticalBar]"], 
       SubsuperscriptBox["\[Theta]", "\[UpTee]", "2"]}]], 
     FractionBox["1", 
      RowBox[{"1", "-", "\[Beta]"}]], 
     RowBox[{"exp", "(", 
      RowBox[{"-", 
       FractionBox[
        SubsuperscriptBox["u", "\[DoubleVerticalBar]", "2"], 
        SubsuperscriptBox["\[Theta]", "\[DoubleVerticalBar]", "2"]]}], ")"}], 
     
     RowBox[{"(", 
      RowBox[{
       RowBox[{"exp", "(", 
        RowBox[{"-", 
         FractionBox[
          SubsuperscriptBox["u", "\[UpTee]", "2"], 
          SubsuperscriptBox["\[Theta]", "\[UpTee]", "2"]]}], ")"}], "-", 
       RowBox[{"exp", "(", 
        RowBox[{"-", 
         FractionBox[
          SubsuperscriptBox["u", "\[UpTee]", "2"], 
          RowBox[{"\[Beta]", " ", 
           SubsuperscriptBox["\[Theta]", "\[UpTee]", "2"]}]]}], ")"}]}], 
      ")"}]}]}], TraditionalForm]}],ExpressionUUID->
  "f971c9dc-deaf-464b-a954-f36e82803c3c"],
 ",\nwhere we have defined a new density\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "=", 
    RowBox[{
     FractionBox[
      RowBox[{"1", "-", "\[Beta]"}], 
      RowBox[{"1", "-", 
       SubscriptBox["\[Beta]", "0"]}]], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            SubscriptBox["B", "0"], "B"]}], ")"}], 
         FractionBox[
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}], "2"], 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}], "2"]]}], "+", 
        FractionBox[
         SubscriptBox["B", "0"], "B"]}], ")"}], 
      RowBox[{"-", "1"}]], 
     SubscriptBox["n", "0"]}]}], TraditionalForm]],ExpressionUUID->
  "d39434bb-d899-4e51-bb0e-2a956e6b7257"],
 ".\nIn summary, we can write the following macro variables in terms of the \
ones at origin:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["\[Theta]", "\[DoubleVerticalBar]", "2"], "=", 
    SubsuperscriptBox["\[Theta]", 
     RowBox[{"\[DoubleVerticalBar]", 
      RowBox[{",", "0"}]}], "2"]}], TraditionalForm]],ExpressionUUID->
  "60d9e040-d8d2-4413-889c-553ceba5da32"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["\[Theta]", "\[UpTee]", "2"], "=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            SubscriptBox["B", "0"], "B"]}], ")"}], 
         FractionBox[
          SubscriptBox["T", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}]], 
          SubscriptBox["T", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}]]]}], "+", 
        FractionBox[
         SubscriptBox["B", "0"], "B"]}], ")"}], 
      RowBox[{"-", "1"}]], 
     SubsuperscriptBox["\[Theta]", 
      RowBox[{"\[UpTee]", 
       RowBox[{",", "0"}]}], "2"]}]}], TraditionalForm]],ExpressionUUID->
  "9398ccd1-8c3a-4f8b-bb90-88506f59b6ee"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Beta]", "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Beta]", "0"], "(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox[
           SubscriptBox["B", "0"], "B"]}], ")"}], 
        FractionBox[
         SubsuperscriptBox["\[Theta]", 
          RowBox[{"\[UpTee]", 
           RowBox[{",", "0"}]}], "2"], 
         SubsuperscriptBox["\[Theta]", 
          RowBox[{"\[DoubleVerticalBar]", 
           RowBox[{",", "0"}]}], "2"]]}], "+", 
       FractionBox[
        SubscriptBox["B", "0"], "B"]}], ")"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            SubscriptBox["B", "0"], "B"]}], ")"}], 
         FractionBox[
          RowBox[{
           SubscriptBox["\[Beta]", "0"], 
           SubsuperscriptBox["\[Theta]", 
            RowBox[{"\[UpTee]", 
             RowBox[{",", "0"}]}], "2"]}], 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}], "2"]]}], "+", 
        FractionBox[
         SubscriptBox["B", "0"], "B"]}], ")"}], 
      RowBox[{"-", "1"}]]}]}], TraditionalForm]],ExpressionUUID->
  "a8066f62-10b1-4c24-8dd5-df9efdbcdf4a"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "=", 
    RowBox[{
     FractionBox[
      RowBox[{"1", "-", "\[Beta]"}], 
      RowBox[{"1", "-", 
       SubscriptBox["\[Beta]", "0"]}]], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            SubscriptBox["B", "0"], "B"]}], ")"}], 
         FractionBox[
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}], "2"], 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}], "2"]]}], "+", 
        FractionBox[
         SubscriptBox["B", "0"], "B"]}], ")"}], 
      RowBox[{"-", "1"}]], 
     SubscriptBox["n", "0"]}]}], TraditionalForm]],ExpressionUUID->
  "91fbce48-d107-4b22-9563-110e00aa2302"],
 "."
}], "Text",ExpressionUUID->"1eaf0274-070c-489e-ac6e-8f10f918948f"],

Cell[TextData[{
 "Since we are concerned with the central field line of the mirror magnetic \
field,\nwe can substitute ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"B", "(", "x", ")"}], 
     SubscriptBox["B", "0"]], "=", 
    RowBox[{
     FractionBox[
      RowBox[{
       SubscriptBox["B", "x"], "(", "x", ")"}], 
      SubscriptBox["B", "0"]], "=", 
     RowBox[{
      RowBox[{"1", "+", 
       RowBox[{
        SuperscriptBox["\[Xi]", "2"], 
        SuperscriptBox["x", "2"]}]}], "=", 
      RowBox[{
       SuperscriptBox["sec", "2"], "(", 
       RowBox[{"\[Xi]", " ", 
        SubscriptBox["\[CapitalDelta]", "1"], 
        SuperscriptBox["q", "1"]}], ")"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"86688bf7-3242-479f-8571-3bc1e5d587a2"],
 ".\nAs before, define\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{"\[Eta]", "=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            SubscriptBox["B", "0"], "B"]}], ")"}], 
         FractionBox[
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}], "2"], 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}], "2"]]}], "+", 
        FractionBox[
         SubscriptBox["B", "0"], "B"]}], ")"}], 
      RowBox[{"-", "1"}]], "=", 
     FractionBox[
      RowBox[{"B", "/", 
       SubscriptBox["B", "0"]}], 
      RowBox[{"1", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}], "2"], "/", 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}], "2"]}], ")"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox["B", 
           SubscriptBox["B", "0"]]}], ")"}]}]}]]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     FractionBox[
      RowBox[{"1", "+", 
       RowBox[{
        SuperscriptBox["\[Xi]", "2"], 
        SuperscriptBox["x", "2"]}]}], 
      RowBox[{"1", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}], "2"], "/", 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}], "2"]}], ")"}], 
        SuperscriptBox["\[Xi]", "2"], 
        SuperscriptBox["x", "2"]}]}]], "=", 
     FractionBox[
      RowBox[{"1", "+", 
       RowBox[{
        SuperscriptBox["\[Xi]", "2"], 
        SuperscriptBox["x", "2"]}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["\[Theta]", 
             RowBox[{"\[UpTee]", 
              RowBox[{",", "0"}]}]], "/", 
            SubscriptBox["\[Theta]", 
             RowBox[{"\[DoubleVerticalBar]", 
              RowBox[{",", "0"}]}]]}], ")"}], "\[Xi]", " ", "x"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["\[Theta]", 
             RowBox[{"\[UpTee]", 
              RowBox[{",", "0"}]}]], "/", 
            SubscriptBox["\[Theta]", 
             RowBox[{"\[DoubleVerticalBar]", 
              RowBox[{",", "0"}]}]]}], ")"}], "\[Xi]", " ", "x"}]}], 
        ")"}]}]]}]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     FractionBox[
      RowBox[{
       SuperscriptBox["sec", "2"], "(", 
       RowBox[{"\[Xi]", " ", 
        SubscriptBox["\[CapitalDelta]", "1"], 
        SuperscriptBox["q", "1"]}], ")"}], 
      RowBox[{"1", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}], "2"], "/", 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}], "2"]}], ")"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{
           SuperscriptBox["sec", "2"], "(", 
           RowBox[{"\[Xi]", " ", 
            SubscriptBox["\[CapitalDelta]", "1"], 
            SuperscriptBox["q", "1"]}], ")"}]}], ")"}]}]}]], "=", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubsuperscriptBox["\[Theta]", 
          RowBox[{"\[UpTee]", 
           RowBox[{",", "0"}]}], "2"], "/", 
         SubsuperscriptBox["\[Theta]", 
          RowBox[{"\[DoubleVerticalBar]", 
           RowBox[{",", "0"}]}], "2"]}], ")"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           RowBox[{
            SubsuperscriptBox["\[Theta]", 
             RowBox[{"\[UpTee]", 
              RowBox[{",", "0"}]}], "2"], "/", 
            SubsuperscriptBox["\[Theta]", 
             RowBox[{"\[DoubleVerticalBar]", 
              RowBox[{",", "0"}]}], "2"]}], ")"}]}], ")"}], 
        RowBox[{
         SuperscriptBox["cos", "2"], "(", 
         RowBox[{"\[Xi]", " ", 
          SubscriptBox["\[CapitalDelta]", "1"], 
          SuperscriptBox["q", "1"]}], ")"}]}]}]]}]}], TraditionalForm]}],
  ExpressionUUID->"f2035663-d0f4-4578-a5c6-e36ff621d6b0"],
 ".\nSimilarly, define\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Eta]", "\[Beta]"], "=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            SubscriptBox["B", "0"], "B"]}], ")"}], 
         FractionBox[
          RowBox[{
           SubscriptBox["\[Beta]", "0"], 
           SubsuperscriptBox["\[Theta]", 
            RowBox[{"\[UpTee]", 
             RowBox[{",", "0"}]}], "2"]}], 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}], "2"]]}], "+", 
        FractionBox[
         SubscriptBox["B", "0"], "B"]}], ")"}], 
      RowBox[{"-", "1"}]], "=", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[Beta]", "0"], 
         RowBox[{
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}], "2"], "/", 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}], "2"]}]}], ")"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["\[Beta]", "0"], 
            RowBox[{
             SubsuperscriptBox["\[Theta]", 
              RowBox[{"\[UpTee]", 
               RowBox[{",", "0"}]}], "2"], "/", 
             SubsuperscriptBox["\[Theta]", 
              RowBox[{"\[DoubleVerticalBar]", 
               RowBox[{",", "0"}]}], "2"]}]}], ")"}]}], ")"}], 
        RowBox[{
         SuperscriptBox["cos", "2"], "(", 
         RowBox[{"\[Xi]", " ", 
          SubscriptBox["\[CapitalDelta]", "1"], 
          SuperscriptBox["q", "1"]}], ")"}]}]}]]}]}], TraditionalForm]],
  ExpressionUUID->"791752e9-7381-409f-af06-55db569e5682"],
 ".\nThen,\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{"\[Beta]", "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Beta]", "0"], "(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          FractionBox[
           SubscriptBox["B", "0"], "B"]}], ")"}], 
        FractionBox[
         SubsuperscriptBox["\[Theta]", 
          RowBox[{"\[UpTee]", 
           RowBox[{",", "0"}]}], "2"], 
         SubsuperscriptBox["\[Theta]", 
          RowBox[{"\[DoubleVerticalBar]", 
           RowBox[{",", "0"}]}], "2"]]}], "+", 
       FractionBox[
        SubscriptBox["B", "0"], "B"]}], ")"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            SubscriptBox["B", "0"], "B"]}], ")"}], 
         FractionBox[
          RowBox[{
           SubscriptBox["\[Beta]", "0"], 
           SubsuperscriptBox["\[Theta]", 
            RowBox[{"\[UpTee]", 
             RowBox[{",", "0"}]}], "2"]}], 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}], "2"]]}], "+", 
        FractionBox[
         SubscriptBox["B", "0"], "B"]}], ")"}], 
      RowBox[{"-", "1"}]]}]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     SubscriptBox["\[Beta]", "0"], 
     FractionBox[
      SubscriptBox["\[Eta]", "\[Beta]"], "\[Eta]"]}]}], TraditionalForm]}],
  ExpressionUUID->"df8b6683-23d4-4760-b228-bdd0883b09d3"],
 ";\nand\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{"n", "=", 
    RowBox[{
     FractionBox[
      RowBox[{"1", "-", "\[Beta]"}], 
      RowBox[{"1", "-", 
       SubscriptBox["\[Beta]", "0"]}]], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            SubscriptBox["B", "0"], "B"]}], ")"}], 
         FractionBox[
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}], "2"], 
          SubsuperscriptBox["\[Theta]", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}], "2"]]}], "+", 
        FractionBox[
         SubscriptBox["B", "0"], "B"]}], ")"}], 
      RowBox[{"-", "1"}]], 
     SubscriptBox["n", "0"]}]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Beta]", "0"]}]], "-", 
       FractionBox["\[Beta]", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Beta]", "0"]}]]}], ")"}], "\[Eta]", " ", 
     SubscriptBox["n", "0"]}]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     FractionBox[
      SubscriptBox["n", "0"], 
      RowBox[{"1", "-", 
       SubscriptBox["\[Beta]", "0"]}]], 
     RowBox[{"(", 
      RowBox[{"\[Eta]", "-", 
       RowBox[{
        SubscriptBox["\[Beta]", "0"], 
        SubscriptBox["\[Eta]", "\[Beta]"]}]}], ")"}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     FractionBox[
      RowBox[{
       SubscriptBox["n", "0"], "\[Eta]"}], 
      RowBox[{"1", "-", 
       SubscriptBox["\[Beta]", "0"]}]], 
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Beta]"}], ")"}]}]}], TraditionalForm]}],
  ExpressionUUID->"f85e571a-83bc-4828-9de4-c88be0da1823"],
 ".\nNote that ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Eta]", "=", 
    RowBox[{
     SubscriptBox["\[Eta]", "\[Beta]"], "=", "1"}]}], TraditionalForm]],
  ExpressionUUID->"ae227144-19b3-4234-83a5-327bb32dee8c"],
 " if ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Xi]", "=", "0"}], TraditionalForm]],ExpressionUUID->
  "c3d6985c-2eb2-446b-a335-925bc5c28922"],
 ".\nThe number of particles in a differential volume, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[DifferentialD]", "V"}], TraditionalForm]],ExpressionUUID->
  "ba19e980-3372-4916-b30a-f4c76b789c44"],
 ", is given by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[DifferentialD]", "N"}], "=", 
    RowBox[{"n", 
     RowBox[{"\[DifferentialD]", "V"}]}]}], TraditionalForm]],ExpressionUUID->
  "99bbbeb4-1067-4a40-924f-96473d9749f5"],
 ".\nSince ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[DifferentialD]", "V"}], "=", 
    RowBox[{
     SubscriptBox["\[CapitalDelta]", "1"], 
     SubscriptBox["\[CapitalDelta]", "2"], 
     SubscriptBox["\[CapitalDelta]", "3"], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "1"]}], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "2"]}], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "3"]}]}]}], TraditionalForm]],ExpressionUUID->
  "c5a4874a-f248-4407-9cb8-f6f858a4c4f5"],
 " is constant in terms of curvilinear coordinates, \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[DifferentialD]", "N"}], "\[Proportional]", 
    RowBox[{"n", "(", 
     SuperscriptBox["q", "1"], ")"}]}], TraditionalForm]],ExpressionUUID->
  "791a31aa-767b-4805-938b-0dac4def99c1"],
 ".\nFrom the bi-Maxwellian case, we have\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubsuperscriptBox["\[Integral]", "0", 
      SuperscriptBox["q", "1"]], 
     RowBox[{
      RowBox[{"\[Eta]", "(", 
       SuperscriptBox["q", "1"], ")"}], 
      RowBox[{"\[DifferentialD]", 
       SuperscriptBox["q", "1"]}]}]}], "=", 
    FractionBox[
     RowBox[{
      SuperscriptBox["tan", 
       RowBox[{"-", "1"}]], "(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[Theta]", 
          RowBox[{"\[UpTee]", 
           RowBox[{",", "0"}]}]], "/", 
         SubscriptBox["\[Theta]", 
          RowBox[{"\[DoubleVerticalBar]", 
           RowBox[{",", "0"}]}]]}], ")"}], 
       RowBox[{"tan", "(", 
        RowBox[{"\[Xi]", " ", 
         SubscriptBox["\[CapitalDelta]", "1"], 
         SuperscriptBox["q", "1"]}], ")"}]}], ")"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["\[Theta]", 
         RowBox[{"\[UpTee]", 
          RowBox[{",", "0"}]}]], "/", 
        SubscriptBox["\[Theta]", 
         RowBox[{"\[DoubleVerticalBar]", 
          RowBox[{",", "0"}]}]]}], ")"}], 
      SubscriptBox["\[CapitalDelta]", "1"], "\[Xi]"}]]}], TraditionalForm]],
  ExpressionUUID->"8be52a3a-9f17-431e-9322-485235413a4c"],
 ",\nand likewise\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubsuperscriptBox["\[Integral]", "0", 
      SuperscriptBox["q", "1"]], 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Eta]", "\[Beta]"], "(", 
       SuperscriptBox["q", "1"], ")"}], 
      RowBox[{"\[DifferentialD]", 
       SuperscriptBox["q", "1"]}]}]}], "=", 
    FractionBox[
     RowBox[{
      SuperscriptBox["tan", 
       RowBox[{"-", "1"}]], "(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SqrtBox[
          SubscriptBox["\[Beta]", "0"]], 
         RowBox[{
          SubscriptBox["\[Theta]", 
           RowBox[{"\[UpTee]", 
            RowBox[{",", "0"}]}]], "/", 
          SubscriptBox["\[Theta]", 
           RowBox[{"\[DoubleVerticalBar]", 
            RowBox[{",", "0"}]}]]}]}], ")"}], 
       RowBox[{"tan", "(", 
        RowBox[{"\[Xi]", " ", 
         SubscriptBox["\[CapitalDelta]", "1"], 
         SuperscriptBox["q", "1"]}], ")"}]}], ")"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SqrtBox[
         SubscriptBox["\[Beta]", "0"]], 
        RowBox[{
         SubscriptBox["\[Theta]", 
          RowBox[{"\[UpTee]", 
           RowBox[{",", "0"}]}]], "/", 
         SubscriptBox["\[Theta]", 
          RowBox[{"\[DoubleVerticalBar]", 
           RowBox[{",", "0"}]}]]}]}], ")"}], 
      SubscriptBox["\[CapitalDelta]", "1"], "\[Xi]"}]]}], TraditionalForm]],
  ExpressionUUID->"08614fbe-5173-4661-8d4b-fd104c987deb"],
 ".\nConsidering a flux tube of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[DifferentialD]", 
     SuperscriptBox["q", "2"]}], "\[Times]", 
    RowBox[{"\[DifferentialD]", 
     SuperscriptBox["q", "3"]}]}], TraditionalForm]],ExpressionUUID->
  "fcde7ef5-a838-44af-996e-410cb5a2caf0"],
 " wide, the integrated number of particles with respect to ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["q", "1"], TraditionalForm]],ExpressionUUID->
  "5da16fac-1087-45e7-adf4-039e7a374f1f"],
 " is given by\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"N", "(", 
      SuperscriptBox["q", "1"], ")"}], 
     SubscriptBox["n", "0"]], "=", 
    RowBox[{
     SubscriptBox["\[CapitalDelta]", "1"], 
     SubscriptBox["\[CapitalDelta]", "2"], 
     SubscriptBox["\[CapitalDelta]", "3"], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "2"]}], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "3"]}], 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", 
       SuperscriptBox["q", "1"]], 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Beta]", "0"]}]], 
       RowBox[{"(", 
        RowBox[{"\[Eta]", "-", 
         RowBox[{
          SubscriptBox["\[Beta]", "0"], 
          SubscriptBox["\[Eta]", "\[Beta]"]}]}], ")"}], 
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox["q", "1"]}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     SubscriptBox["\[CapitalDelta]", "1"], 
     SubscriptBox["\[CapitalDelta]", "2"], 
     SubscriptBox["\[CapitalDelta]", "3"], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "2"]}], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "3"]}], 
     FractionBox["1", 
      RowBox[{"1", "-", 
       SubscriptBox["\[Beta]", "0"]}]], 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{
         SuperscriptBox["tan", 
          RowBox[{"-", "1"}]], "(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["\[Theta]", 
             RowBox[{"\[UpTee]", 
              RowBox[{",", "0"}]}]], "/", 
            SubscriptBox["\[Theta]", 
             RowBox[{"\[DoubleVerticalBar]", 
              RowBox[{",", "0"}]}]]}], ")"}], 
          RowBox[{"tan", "(", 
           RowBox[{"\[Xi]", " ", 
            SubscriptBox["\[CapitalDelta]", "1"], 
            SuperscriptBox["q", "1"]}], ")"}]}], ")"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["\[Theta]", 
            RowBox[{"\[UpTee]", 
             RowBox[{",", "0"}]}]], "/", 
           SubscriptBox["\[Theta]", 
            RowBox[{"\[DoubleVerticalBar]", 
             RowBox[{",", "0"}]}]]}], ")"}], 
         SubscriptBox["\[CapitalDelta]", "1"], "\[Xi]"}]], "-", 
       RowBox[{
        SubscriptBox["\[Beta]", "0"], 
        FractionBox[
         RowBox[{
          SuperscriptBox["tan", 
           RowBox[{"-", "1"}]], "(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SqrtBox[
              SubscriptBox["\[Beta]", "0"]], 
             RowBox[{
              SubscriptBox["\[Theta]", 
               RowBox[{"\[UpTee]", 
                RowBox[{",", "0"}]}]], "/", 
              SubscriptBox["\[Theta]", 
               RowBox[{"\[DoubleVerticalBar]", 
                RowBox[{",", "0"}]}]]}]}], ")"}], 
           RowBox[{"tan", "(", 
            RowBox[{"\[Xi]", " ", 
             SubscriptBox["\[CapitalDelta]", "1"], 
             SuperscriptBox["q", "1"]}], ")"}]}], ")"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SqrtBox[
             SubscriptBox["\[Beta]", "0"]], 
            RowBox[{
             SubscriptBox["\[Theta]", 
              RowBox[{"\[UpTee]", 
               RowBox[{",", "0"}]}]], "/", 
             SubscriptBox["\[Theta]", 
              RowBox[{"\[DoubleVerticalBar]", 
               RowBox[{",", "0"}]}]]}]}], ")"}], 
          SubscriptBox["\[CapitalDelta]", "1"], "\[Xi]"}]]}]}], ")"}]}]}], 
   TraditionalForm]}],ExpressionUUID->
  "53235c44-6d6c-4543-b6f5-9790e5132846"],
 ",\nwhere ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"N", "(", "0", ")"}], "=", "0"}], TraditionalForm]],
  ExpressionUUID->"33f0c583-11ef-419d-98a3-40ad0a3a5737"],
 ".\nFor small \[Xi],\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"N", "(", 
      SuperscriptBox["q", "1"], ")"}], 
     SubscriptBox["n", "0"]], "\[TildeTilde]", 
    RowBox[{
     SubscriptBox["\[CapitalDelta]", "1"], 
     SubscriptBox["\[CapitalDelta]", "2"], 
     SubscriptBox["\[CapitalDelta]", "3"], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "2"]}], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "3"]}], 
     FractionBox[
      SuperscriptBox["q", "1"], 
      RowBox[{"1", "-", 
       SubscriptBox["\[Beta]", "0"]}]], 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{
        FractionBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["\[Theta]", 
              RowBox[{"\[UpTee]", 
               RowBox[{",", "0"}]}]], "/", 
             SubscriptBox["\[Theta]", 
              RowBox[{"\[DoubleVerticalBar]", 
               RowBox[{",", "0"}]}]]}], ")"}], "2"], "-", "1"}], "3"], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"\[Xi]", " ", 
           SubscriptBox["\[CapitalDelta]", "1"], 
           SuperscriptBox["q", "1"]}], ")"}], "2"]}], "-", 
       RowBox[{
        SubscriptBox["\[Beta]", "0"], "(", 
        RowBox[{"1", "-", 
         RowBox[{
          FractionBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{
              SubscriptBox["\[Beta]", "0"], "(", 
              RowBox[{
               SubscriptBox["\[Theta]", 
                RowBox[{"\[UpTee]", 
                 RowBox[{",", "0"}]}]], "/", 
               SubscriptBox["\[Theta]", 
                RowBox[{"\[DoubleVerticalBar]", 
                 RowBox[{",", "0"}]}]]}], ")"}], "2"], "-", "1"}], "3"], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"\[Xi]", " ", 
             SubscriptBox["\[CapitalDelta]", "1"], 
             SuperscriptBox["q", "1"]}], ")"}], "2"]}]}], ")"}]}], ")"}]}]}], 
   TraditionalForm]],ExpressionUUID->"e102a06f-62cf-4a39-8f56-ce1579b6aba1"],
 ".\nThe inverse relation ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["q", "1"], "(", "N", ")"}], TraditionalForm]],
  ExpressionUUID->"98c2f26a-9caa-4854-88fc-3f26cf29cd59"],
 " is not straightforward."
}], "Text",ExpressionUUID->"c1d88d36-6e67-4984-9c06-d3caad2e1bbe"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]2O\[Theta]1", "=", "3.35"}], ",", 
     RowBox[{"\[Beta]0", "=", "1.7"}], ",", 
     RowBox[{"\[Xi]", "=", ".876"}], ",", 
     RowBox[{"q1lim", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "24"}], ",", "50"}], "}"}]}], ",", 
     RowBox[{"\[Xi]\[CapitalDelta]1q1max", "=", 
      RowBox[{
       RowBox[{"Pi", "/", "2"}], "*", ".8"}]}], ",", 
     RowBox[{"nsamples", "=", "50000"}]}], "}"}], ",", "\[IndentingNewLine]", 
   
   RowBox[{"BlockRandom", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "49038", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[CapitalDelta]1", ",", "q1s", ",", "Bs", ",", "xs", ",", "\[Eta]s", 
         ",", "\[Eta]\[Beta]s", ",", "tmp", ",", "int\[Eta]s", ",", 
         "int\[Eta]\[Beta]s", ",", "Nofq1", ",", "q1samples", ",", "bins", 
         ",", "hist"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[CapitalDelta]1", "=", 
         RowBox[{"Divide", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1q1max", ",", 
           RowBox[{"\[Xi]", " ", 
            RowBox[{"Max", "[", 
             RowBox[{"Abs", "[", "q1lim", "]"}], "]"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"q1s", "=", 
         RowBox[{"Range", "@@", "q1lim"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xs", "=", 
         RowBox[{
          RowBox[{"Tan", "[", 
           RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1s"}], "]"}], "/",
           "\[Xi]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Bs", "=", 
         RowBox[{
          RowBox[{"Sec", "[", 
           RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1s"}], "]"}], "^",
           "2"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Eta]s", "=", 
         RowBox[{"Divide", "[", 
          RowBox[{"1", ",", 
           RowBox[{
            RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}]}], ")"}], 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1s"}], "]"}], 
              "^", "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"Apply", "[", 
            RowBox[{"And", ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"0", "==", 
               RowBox[{"Chop", "[", 
                RowBox[{"\[Eta]s", "-", 
                 RowBox[{"Power", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"1", "/", "Bs"}]}], ")"}], 
                    RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}]}], "+", 
                    RowBox[{"1", "/", "Bs"}]}], ",", 
                   RowBox[{"-", "1"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
          ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<\[Eta]s incorrect\>\"", "]"}], ";", 
            RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Eta]\[Beta]s", "=", 
         RowBox[{"Divide", "[", 
          RowBox[{"1", ",", 
           RowBox[{
            RowBox[{"\[Beta]0", " ", 
             RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"\[Beta]0", " ", 
                RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}]}]}], ")"}], 
             RowBox[{
              RowBox[{"Cos", "[", 
               RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1s"}], "]"}], 
              "^", "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"Apply", "[", 
            RowBox[{"And", ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"0", "==", 
               RowBox[{"Chop", "[", 
                RowBox[{"\[Eta]\[Beta]s", "-", 
                 RowBox[{"Power", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"1", "/", "Bs"}]}], ")"}], "\[Beta]0", " ", 
                    RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}]}], "+", 
                    RowBox[{"1", "/", "Bs"}]}], ",", 
                   RowBox[{"-", "1"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}]}], 
          ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<\[Eta]s incorrect\>\"", "]"}], ";", 
            RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"int\[Eta]s", "=", 
         RowBox[{
          RowBox[{"ArcTan", "[", 
           RowBox[{"\[Theta]2O\[Theta]1", " ", 
            RowBox[{"Tan", "[", 
             RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1s"}], "]"}]}], 
           "]"}], "/", 
          RowBox[{"(", 
           RowBox[{
           "\[CapitalDelta]1", " ", "\[Xi]", " ", "\[Theta]2O\[Theta]1"}], 
           ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{"MinMax", "[", "int\[Eta]s", "]"}], "-", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"NIntegrate", "[", 
              RowBox[{
               RowBox[{"Divide", "[", 
                RowBox[{"1", ",", 
                 RowBox[{
                  RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}]}], ")"}], 
                   RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1"}], 
                    "]"}], "^", "2"}]}]}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"q1", ",", "0", ",", "#"}], "}"}]}], "]"}], "&"}], 
            ",", 
            RowBox[{"MinMax", "[", "q1s", "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"Apply", "[", 
            RowBox[{"And", ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"0", "==", 
               RowBox[{"Chop", "[", "tmp", "]"}]}], "]"}]}], "]"}]}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<int\[Eta](q1) incorrect\>\"", "]"}], 
            ";", 
            RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"int\[Eta]\[Beta]s", "=", 
         RowBox[{
          RowBox[{"ArcTan", "[", 
           RowBox[{
            SqrtBox["\[Beta]0"], "\[Theta]2O\[Theta]1", " ", 
            RowBox[{"Tan", "[", 
             RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1s"}], "]"}]}], 
           "]"}], "/", 
          RowBox[{"(", 
           RowBox[{"\[CapitalDelta]1", " ", "\[Xi]", " ", 
            SqrtBox["\[Beta]0"], "\[Theta]2O\[Theta]1"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{"MinMax", "[", "int\[Eta]\[Beta]s", "]"}], "-", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"NIntegrate", "[", 
              RowBox[{
               RowBox[{"Divide", "[", 
                RowBox[{"1", ",", 
                 RowBox[{
                  RowBox[{"\[Beta]0", " ", 
                   RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"\[Beta]0", " ", 
                    RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}]}]}], ")"}], 
                   RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1"}], 
                    "]"}], "^", "2"}]}]}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"q1", ",", "0", ",", "#"}], "}"}]}], "]"}], "&"}], 
            ",", 
            RowBox[{"MinMax", "[", "q1s", "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"Apply", "[", 
            RowBox[{"And", ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"0", "==", 
               RowBox[{"Chop", "[", "tmp", "]"}]}], "]"}]}], "]"}]}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
            "Print", "[", "\"\<int\[Eta]\[Beta](q1) incorrect\>\"", "]"}], 
            ";", 
            RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Nofq1", "=", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Beta]0"}], ")"}]}], 
          RowBox[{"(", 
           RowBox[{"int\[Eta]s", "-", 
            RowBox[{"\[Beta]0", " ", "int\[Eta]\[Beta]s"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Beta]0"}], ")"}]}], 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"NIntegrate", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Divide", "[", 
                 RowBox[{"1", ",", 
                  RowBox[{
                   RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}]}], ")"}], 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1"}], 
                    "]"}], "^", "2"}]}]}]}], "]"}], "-", 
                RowBox[{"\[Beta]0", " ", 
                 RowBox[{"Divide", "[", 
                  RowBox[{"1", ",", 
                   RowBox[{
                    RowBox[{"\[Beta]0", " ", 
                    RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"\[Beta]0", " ", 
                    RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}]}]}], ")"}], 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1"}], 
                    "]"}], "^", "2"}]}]}]}], "]"}]}]}], ",", 
               RowBox[{"{", 
                RowBox[{"q1", ",", "0", ",", "#"}], "}"}]}], "]"}], "&"}], 
            ",", 
            RowBox[{"MinMax", "[", "q1s", "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"Apply", "[", 
            RowBox[{"And", ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"0", "==", 
               RowBox[{"Chop", "[", 
                RowBox[{
                 RowBox[{"MinMax", "[", "Nofq1", "]"}], "-", "tmp"}], "]"}]}],
               "]"}]}], "]"}]}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<N(q1) incorrect\>\"", "]"}], ";", 
            RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"q1samples", "=", 
         RowBox[{
          RowBox[{"Interpolation", "[", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"Nofq1", ",", "q1s"}], "}"}], "]"}], "]"}], "[", 
          RowBox[{"RandomReal", "[", 
           RowBox[{
            RowBox[{"MinMax", "[", "Nofq1", "]"}], ",", "nsamples"}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"bins", ",", "hist"}], "}"}], "=", 
         RowBox[{"N", "@", 
          RowBox[{"HistogramList", "[", 
           RowBox[{"q1samples", ",", 
            RowBox[{"Append", "[", 
             RowBox[{"q1lim", ",", "1"}], "]"}], ",", "\"\<Count\>\""}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bins", "=", 
         RowBox[{"Flatten", "[", "bins", "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{"#", ",", "\[IndentingNewLine]", 
            RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
           "]"}], "&"}], "/@", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"q1s", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
                RowBox[{"{", 
                 RowBox[{"\[Eta]s", ",", "\[Eta]\[Beta]s", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"\[Eta]s", "-", 
                    RowBox[{"\[Beta]0", " ", "\[Eta]\[Beta]s"}]}], ")"}], "/", 
                   RowBox[{"(", 
                    RowBox[{"1", "-", "\[Beta]0"}], ")"}]}]}], "}"}]}], ",", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               RowBox[{"AxesLabel", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<\\!\\(\!\(\*SuperscriptBox[\(q\), \(1\)]\)\\)\>\"", 
                  ",", "\"\<\\!\\(\[Eta](\!\(\*SuperscriptBox[\(q\), \
\(1\)]\))\\)\>\""}], "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListStepPlot", "[", 
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"MovingAverage", "[", 
                   RowBox[{"bins", ",", "2"}], "]"}], ",", 
                  RowBox[{"hist", "/", 
                   RowBox[{"Max", "[", "hist", "]"}]}]}], "}"}], "]"}], ",", 
               "Center", ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Red", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1s", ",", 
                  RowBox[{"Nofq1", "-", 
                   RowBox[{"Min", "[", "Nofq1", "]"}]}]}], "}"}], "]"}], ",", 
               
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1s", ",", 
                  RowBox[{"int\[Eta]s", "-", 
                   RowBox[{"Min", "[", "int\[Eta]s", "]"}]}]}], "}"}], "]"}], 
               ",", 
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1s", ",", 
                  RowBox[{"int\[Eta]\[Beta]s", "-", 
                   RowBox[{"Min", "[", "int\[Eta]\[Beta]s", "]"}]}]}], "}"}], 
                "]"}]}], "}"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"AxesLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<\\!\\(\!\(\*SuperscriptBox[\(q\), \(1\)]\)\\)\>\"", ",", 
                "\"\<\\!\\(N(\!\(\*SuperscriptBox[\(q\), \(1\)]\))\\)\>\""}], 
               "}"}]}], ",", 
             RowBox[{"GridLines", "\[Rule]", "All"}]}], "]"}]}], 
          "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"972536e8-0b73-4bea-92a4-c3b84d0e35be"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "compileLosscone", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"compileLosscone", "[", 
   RowBox[{
    RowBox[{"c_", "?", "Positive"}], ",", 
    RowBox[{"\[Beta]1_", "?", "Positive"}], ",", 
    RowBox[{"T2OT1_", "?", "Positive"}], ",", "Vd_Real", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[CapitalDelta]_Real", "/;", 
       RowBox[{"0", "<=", "\[CapitalDelta]", "<=", "1"}]}], ",", 
      RowBox[{"\[Beta]_Real", "?", "Positive"}]}], "}"}]}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Gamma]d", "=", 
       RowBox[{"N", "[", 
        RowBox[{"c", "/", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"c", "-", "Vd"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"c", "+", "Vd"}], ")"}]}], "]"}]}], "]"}]}], ",", 
      RowBox[{"\[Theta]1", "=", 
       RowBox[{"N", "[", 
        SqrtBox["\[Beta]1"], "]"}]}], ",", 
      RowBox[{"\[Theta]2", "=", 
       RowBox[{"N", "[", 
        RowBox[{
         SqrtBox["\[Beta]1"], 
         SqrtBox[
          RowBox[{"T2OT1", "/", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "\[CapitalDelta]"}], ")"}], "\[Beta]"}]}], 
            ")"}]}]]}], "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"uu", ",", "_Real", ",", "1"}], "}"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"n0", "=", 
           RowBox[{"1", "/", "\[Gamma]d"}]}], ",", "u1", ",", "u2", ",", "u3",
           ",", "\[Gamma]u", ",", "x1", ",", "x2", ",", "f0"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"u1", ",", "u2", ",", "u3"}], "}"}], "=", "uu"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Gamma]u", "=", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"1", "+", 
            RowBox[{
             RowBox[{"uu", ".", "uu"}], "/", 
             RowBox[{"c", "^", "2"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"x2", "=", 
          RowBox[{
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{"u2", "^", "2"}], "+", 
             RowBox[{"u3", "^", "2"}]}], "]"}], "/", "\[Theta]2"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"x1", "=", 
          RowBox[{"\[Gamma]d", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"u1", "-", 
              RowBox[{"\[Gamma]u", " ", "Vd"}]}], ")"}], "/", 
            "\[Theta]1"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"f0", "=", 
          RowBox[{
           RowBox[{"n0", "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Pi", "^", "1.5"}], "\[Theta]1", " ", 
              RowBox[{"\[Theta]2", "^", "2"}]}], ")"}]}], 
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{"x1", "^", "2"}]}], "]"}], 
           RowBox[{"Divide", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"\[CapitalDelta]", " ", "\[Beta]"}]}], ")"}], 
               RowBox[{"Exp", "[", 
                RowBox[{"-", 
                 RowBox[{"x2", "^", "2"}]}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "\[CapitalDelta]"}], ")"}], 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"x2", "^", "2"}]}], "/", "\[Beta]"}], "]"}]}]}], 
             ",", 
             RowBox[{"1", "-", "\[Beta]"}]}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", "f0"}]}], "\[IndentingNewLine]", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"RuntimeAttributes", "\[Rule]", 
       RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellLabel->"In[2]:=",ExpressionUUID->"f5bdbbae-9dd1-4913-bfb3-f8eaf0131458"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Function", "[", 
   RowBox[{"q1", ",", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"c", "=", "4"}], ",", 
        RowBox[{"\[Beta]1", "=", "1.5"}], ",", 
        RowBox[{"T2OT1eq", "=", "5.35"}], ",", 
        RowBox[{"\[CapitalDelta]", "=", "0"}], ",", 
        RowBox[{"\[Beta]eq", "=", ".9"}], ",", 
        RowBox[{"Vd", "=", "0."}], ",", 
        RowBox[{"q1max", "=", "15"}], ",", 
        RowBox[{"\[Xi]\[CapitalDelta]1q1max", "=", 
         RowBox[{
          RowBox[{"Pi", "/", "2"}], "*", ".8"}]}]}], 
       RowBox[{"(*", 
        RowBox[{",", 
         RowBox[{"q1", "=", "0"}]}], "*)"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\[Xi]\[CapitalDelta]1", ",", "\[Theta]2O\[Theta]1eq", ",", "\[Eta]",
           ",", "\[Eta]\[Beta]", ",", "\[Theta]2O\[Theta]1", ",", "\[Beta]", 
          ",", "T2OT1", ",", "ff", ",", "u2lim", ",", "\[Gamma]d", ",", 
          "u1lim", ",", "u1s", ",", "u2s", ",", "u2u1s", ",", "particleflux", 
          ",", "stressenergy"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
          RowBox[{"Divide", "[", 
           RowBox[{"\[Xi]\[CapitalDelta]1q1max", ",", "q1max"}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"\[Theta]2O\[Theta]1eq", "=", 
          SqrtBox[
           RowBox[{"T2OT1eq", "/", 
            RowBox[{"(", 
             RowBox[{"1", "+", "\[Beta]eq"}], ")"}]}]]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Eta]", "=", 
          RowBox[{"Divide", "[", 
           RowBox[{"1", ",", 
            RowBox[{
             RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], ")"}], 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
               "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Eta]\[Beta]", "=", 
          RowBox[{"Divide", "[", 
           RowBox[{"1", ",", 
            RowBox[{
             RowBox[{"\[Beta]eq", " ", 
              RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"\[Beta]eq", " ", 
                 RowBox[{"\[Theta]2O\[Theta]1eq", "^", "2"}]}]}], ")"}], 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
               "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Theta]2O\[Theta]1", "=", 
          RowBox[{"\[Theta]2O\[Theta]1eq", 
           SqrtBox["\[Eta]"]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Beta]", "=", 
          RowBox[{"\[Beta]eq", " ", 
           RowBox[{"\[Eta]\[Beta]", "/", "\[Eta]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"T2OT1", "=", 
          RowBox[{
           RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], 
           RowBox[{"(", 
            RowBox[{"1", "+", "\[Beta]"}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ff", "=", 
          RowBox[{"compileLosscone", "[", 
           RowBox[{"c", ",", "\[Beta]1", ",", "T2OT1", ",", "Vd", ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[CapitalDelta]", ",", "\[Beta]"}], "}"}], "//", 
             "N"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"u2lim", "=", 
          RowBox[{"4.2", 
           SqrtBox[
            RowBox[{"\[Beta]1", " ", "T2OT1", " ", 
             RowBox[{"Max", "[", 
              RowBox[{"1", ",", "\[Beta]"}], "]"}]}]], 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Gamma]d", "=", 
          RowBox[{"N", "[", 
           RowBox[{"c", "/", 
            RowBox[{"Sqrt", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"c", "-", "Vd"}], ")"}], 
              RowBox[{"(", 
               RowBox[{"c", "+", "Vd"}], ")"}]}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"u1lim", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{"Function", "[", 
             RowBox[{"u1", ",", 
              RowBox[{"\[Gamma]d", 
               RowBox[{"(", 
                RowBox[{"u1", "+", 
                 RowBox[{
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"1", "+", 
                    RowBox[{
                    RowBox[{"u1", "^", "2"}], "/", 
                    RowBox[{"c", "^", "2"}]}]}], "]"}], "Vd"}]}], ")"}]}]}], 
             "]"}], ",", 
            RowBox[{"4", 
             SqrtBox["\[Beta]1"], 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"u1s", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", "2001", ",", "u1lim"}], "]"}], "~", 
           "MovingAverage", "~", "2"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"u2s", "=", 
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"N", ",", "1001", ",", "u2lim"}], "]"}], "~", 
           "MovingAverage", "~", "2"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ff", "=", 
          RowBox[{"\[Eta]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Beta]"}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Beta]eq"}], ")"}]}], 
           RowBox[{"(", 
            RowBox[{"2", "Pi", " ", "u2s", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"u1s", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "-", 
               RowBox[{"u1s", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"u2s", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "-", 
               RowBox[{"u2s", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], ")"}], 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ff", "[", 
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"u1s", ",", "#", ",", "0"}], "}"}], "]"}], "]"}], 
              "&"}], ",", "u2s"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ff", "=", 
          RowBox[{"Join", "@@", "ff"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"u2u1s", "=", 
          RowBox[{"Tuples", "[", 
           RowBox[{"{", 
            RowBox[{"u2s", ",", "u1s"}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"particleflux", "=", 
          RowBox[{"Total", "/@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"c", " ", "ff"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Last", "/@", "u2u1s"}], ")"}], "/", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"1", "+", 
                 RowBox[{
                  RowBox[{"Map", "[", 
                   RowBox[{"Total", ",", 
                    RowBox[{"u2u1s", "^", "2"}]}], "]"}], "/", 
                  RowBox[{"c", "^", "2"}]}]}], "]"}]}], "ff"}]}], "}"}]}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"stressenergy", "=", 
          RowBox[{"Total", "/@", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Sqrt", "[", 
               RowBox[{"1", "+", 
                RowBox[{
                 RowBox[{"Map", "[", 
                  RowBox[{"Total", ",", 
                   RowBox[{"u2u1s", "^", "2"}]}], "]"}], "/", 
                 RowBox[{"c", "^", "2"}]}]}], "]"}], 
              RowBox[{"c", "^", "2"}], "ff"}], ",", "\[IndentingNewLine]", 
             RowBox[{"c", 
              RowBox[{"(", 
               RowBox[{"Last", "/@", "u2u1s"}], ")"}], "ff"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"Last", "/@", "u2u1s"}], ")"}], "^", "2"}], "/", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"1", "+", 
                 RowBox[{
                  RowBox[{"Map", "[", 
                   RowBox[{"Total", ",", 
                    RowBox[{"u2u1s", "^", "2"}]}], "]"}], "/", 
                  RowBox[{"c", "^", "2"}]}]}], "]"}]}], "ff"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{".5", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"First", "/@", "u2u1s"}], ")"}], "^", "2"}], "/", 
               RowBox[{"Sqrt", "[", 
                RowBox[{"1", "+", 
                 RowBox[{
                  RowBox[{"Map", "[", 
                   RowBox[{"Total", ",", 
                    RowBox[{"u2u1s", "^", "2"}]}], "]"}], "/", 
                  RowBox[{"c", "^", "2"}]}]}], "]"}]}], "ff"}]}], 
            "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"SetPrecision", "[", 
          RowBox[{
           RowBox[{"stressenergy", "//", "Chop"}], ",", "20"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
    RowBox[{"{", "Listable", "}"}]}], "]"}], "[", 
  RowBox[{"Range", "[", 
   RowBox[{
    RowBox[{"-", "7"}], ",", "15"}], "]"}], "]"}]], "Input",
 CellLabel->"In[24]:=",ExpressionUUID->"aea04e1b-4560-4e82-a7f0-e0765fac9eb0"],

Cell[CellGroupData[{

Cell["Test", "Subsubsection",ExpressionUUID->"5e4091a0-ac76-4799-a069-0bbf92fd7f0d"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Theta]", "=", 
      RowBox[{"0.", "Degree"}]}], ",", 
     RowBox[{"c", "=", "4"}], ",", 
     RowBox[{"\[Beta]1", "=", 
      RowBox[{"1.5", "*", "2.1"}]}], ",", 
     RowBox[{"T2OT1", "=", "2.35"}], ",", 
     RowBox[{"Vd", "=", "0"}], ",", 
     RowBox[{"\[CapitalDelta]", "=", "0"}], ",", 
     RowBox[{"\[Beta]", "=", "1*^-10"}], ",", 
     RowBox[{"q1lim", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "7"}], ",", "15"}], "}"}]}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"data", "=", 
      RowBox[{"Get", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<~/Downloads\>\"", ",", 
          "\"\<RelativisticLossconeVDF-bi_max-homogeneous.m\>\""}], "}"}], 
        "]"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Gamma]d", ",", "e1", ",", "e3", ",", "e2", ",", "Lcarts2mfa", ",", 
       "uel", ",", "pos", ",", "q1s", ",", "\[Eta]s", ",", "binpos", ",", 
       "histpos", ",", "binu1", ",", "histu1", ",", "binu2", ",", "histu2", 
       ",", "binu3", ",", "histu3", ",", "u1s", ",", "u2s", ",", "u3s", ",", 
       "ff", ",", "f1", ",", "f2", ",", "f3"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Gamma]d", "=", 
       RowBox[{"N", "[", 
        RowBox[{"c", "/", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"c", "-", "Vd"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"c", "+", "Vd"}], ")"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"e1", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
         RowBox[{"Sin", "[", "\[Theta]", "]"}], ",", "0"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"e3", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"e2", "=", 
       RowBox[{"Cross", "[", 
        RowBox[{"e3", ",", "e1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Lcarts2mfa", "=", 
       RowBox[{"{", 
        RowBox[{"e1", ",", "e2", ",", "e3"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1s", "=", 
       RowBox[{"Range", "@@", "q1lim"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]s", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"1.", ",", 
         RowBox[{"Length", "[", "q1s", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"uel", "=", 
       RowBox[{"Dot", "[", 
        RowBox[{
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"Lcarts2mfa", "\[Transpose]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"Mean", "[", 
        RowBox[{"uel", "/", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"1", "+", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Dot", "[", 
                RowBox[{"#", ",", "#"}], "]"}], "&"}], ",", "uel"}], "]"}], 
            "/", 
            RowBox[{"c", "^", "2"}]}]}], "]"}]}], "]"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"Join", "@@", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binpos", ",", "histpos"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"pos", ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"q1lim", "+", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"+", ".5"}], ",", 
              RowBox[{"-", ".5"}]}], "}"}]}], ",", "1"}], "]"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"binu1", "=", 
       RowBox[{"Array", "[", 
        RowBox[{"N", ",", "51", ",", 
         RowBox[{"MinMax", "[", 
          RowBox[{"uel", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binu1", ",", "histu1"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"uel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"MinMax", "[", "binu1", "]"}], ",", 
           RowBox[{
            RowBox[{"binu1", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", 
            RowBox[{"binu1", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ",", "\"\<PDF\>\""}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"binu2", "=", 
       RowBox[{"Array", "[", 
        RowBox[{"N", ",", "51", ",", 
         RowBox[{"MinMax", "[", 
          RowBox[{"uel", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binu2", ",", "histu2"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"uel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"MinMax", "[", "binu2", "]"}], ",", 
           RowBox[{
            RowBox[{"binu2", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", 
            RowBox[{"binu2", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ",", "\"\<PDF\>\""}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"binu3", "=", 
       RowBox[{"Array", "[", 
        RowBox[{"N", ",", "51", ",", 
         RowBox[{"MinMax", "[", 
          RowBox[{"uel", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binu3", ",", "histu3"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"uel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"MinMax", "[", "binu3", "]"}], ",", 
           RowBox[{
            RowBox[{"binu3", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", 
            RowBox[{"binu3", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ",", "\"\<PDF\>\""}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"u1s", "=", 
       RowBox[{
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", "201", ",", 
          RowBox[{"MinMax", "[", "binu1", "]"}]}], "]"}], "~", 
        "MovingAverage", "~", "2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"u2s", "=", 
       RowBox[{
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", "200", ",", 
          RowBox[{"MinMax", "[", "binu2", "]"}]}], "]"}], "~", 
        "MovingAverage", "~", "2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"u3s", "=", 
       RowBox[{
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", "199", ",", 
          RowBox[{"MinMax", "[", "binu3", "]"}]}], "]"}], "~", 
        "MovingAverage", "~", "2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"compileLosscone", "[", 
        RowBox[{"c", ",", "\[Beta]1", ",", "T2OT1", ",", 
         RowBox[{"N", "[", "Vd", "]"}], ",", 
         RowBox[{"N", "[", 
          RowBox[{"{", 
           RowBox[{"\[CapitalDelta]", ",", "\[Beta]"}], "}"}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"ff", "[", 
          RowBox[{"Tuples", "[", 
           RowBox[{"{", 
            RowBox[{"u1s", ",", "u2s", ",", "u3s"}], "}"}], "]"}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"u1s", ",", "u2s", ",", "u3s"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"f1", "=", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{"Flatten", "[", "#", "]"}], "]"}], "&"}], ",", "ff"}], 
         "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"u2s", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"u2s", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"u3s", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"u3s", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"f2", "=", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{"Flatten", "[", "#", "]"}], "]"}], "&"}], ",", 
          RowBox[{"ff", "\[Transpose]"}]}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"u1s", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"u1s", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"u3s", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"u3s", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"f3", "=", 
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{"Join", "@@", "ff"}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"u1s", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"u1s", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"u2s", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"u2s", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"q1s", ",", "\[Eta]s"}], "}"}], "]"}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binpos", ",", "2"}], "]"}], ",", 
               RowBox[{"histpos", "/", 
                RowBox[{"Max", "[", "histpos", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"u1s", ",", "f1"}], "}"}], "]"}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binu1", ",", "2"}], "]"}], ",", "histu1"}], "}"}], 
             "]"}], ",", "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"u2s", ",", "f2"}], "}"}], "]"}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binu2", ",", "2"}], "]"}], ",", "histu2"}], "}"}], 
             "]"}], ",", "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"u3s", ",", "f3"}], "}"}], "]"}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binu3", ",", "2"}], "]"}], ",", "histu3"}], "}"}], 
             "]"}], ",", "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}]}], "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[8]:=",ExpressionUUID->"50d6a75a-7c5f-427c-9ee1-7c51cd2443cb"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"c", "=", "4"}], ",", 
     RowBox[{"\[Beta]1", "=", 
      RowBox[{"1.5", "*", "2.1"}]}], ",", 
     RowBox[{"T2OT1eq", "=", "5.35"}], ",", 
     RowBox[{"\[Xi]", "=", ".876"}], ",", 
     RowBox[{"q1lim", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "7"}], ",", "15"}], "}"}]}], ",", 
     RowBox[{"\[Xi]\[CapitalDelta]1q1max", "=", 
      RowBox[{
       RowBox[{"Pi", "/", "2"}], "*", ".8"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Get", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<~/Downloads\>\"", ",", 
          "\"\<RelativisticLossconeVDF-bi_max-inhomogeneous.m\>\""}], "}"}], 
        "]"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "uel", ",", "pos", ",", "gamma", ",", "\[CapitalDelta]1", ",", "q1s", 
       ",", "\[Eta]s", ",", "binpos", ",", "histpos", ",", "binu1", ",", 
       "histu1", ",", "binu2", ",", "histu2", ",", "binu3", ",", "histu3", 
       ",", "u1s", ",", "u2s", ",", "u3s", ",", "ff", ",", "f1", ",", "f2", 
       ",", "f3"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[CapitalDelta]1", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"\[Xi]\[CapitalDelta]1q1max", ",", 
         RowBox[{"\[Xi]", " ", 
          RowBox[{"Max", "[", 
           RowBox[{"Abs", "[", "q1lim", "]"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1s", "=", 
       RowBox[{"Range", "@@", "q1lim"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
        RowBox[{"Divide", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Apply", "[", 
           RowBox[{"Subtract", ",", 
            RowBox[{
             RowBox[{"ArcTan", "[", 
              RowBox[{
               SqrtBox["T2OT1eq"], 
               RowBox[{"Tan", "[", 
                RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", 
                 RowBox[{"{", 
                  RowBox[{".5", ",", 
                   RowBox[{"-", ".5"}]}], "}"}]}], "]"}]}], "]"}], "/", 
             RowBox[{"(", 
              RowBox[{"\[Xi]", 
               SqrtBox["T2OT1eq"]}], ")"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Apply", "[", 
           RowBox[{"Subtract", ",", 
            RowBox[{
             RowBox[{"ArcTan", "[", 
              RowBox[{
               SqrtBox["T2OT1eq"], 
               RowBox[{"Tan", "[", 
                RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", 
                 RowBox[{"q1s", "[", 
                  RowBox[{"[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], "]"}]}], 
                "]"}]}], "]"}], "/", 
             RowBox[{"(", 
              RowBox[{"\[Xi]", 
               SqrtBox["T2OT1eq"]}], ")"}]}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}], "//", "CForm"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Eta]s", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{"T2OT1eq", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "T2OT1eq"}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1s"}], "]"}], 
            "^", "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"Join", "@@", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"uel", "=", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"Mean", "[", 
        RowBox[{"uel", "/", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"1", "+", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Dot", "[", 
                RowBox[{"#", ",", "#"}], "]"}], "&"}], ",", "uel"}], "]"}], 
            "/", 
            RowBox[{"c", "^", "2"}]}]}], "]"}]}], "]"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"uel", "=", 
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Xi]\[CapitalDelta]1", "=", 
            RowBox[{"Divide", "[", 
             RowBox[{"\[Xi]\[CapitalDelta]1q1max", ",", 
              RowBox[{"Max", "[", 
               RowBox[{"Abs", "[", "q1lim", "]"}], "]"}]}], "]"}]}], "}"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Compile", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"u", ",", "_Real", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"q1", ",", "_Real"}], "}"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\[Eta]", ",", "T2OT1"}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"\[Eta]", "=", 
                RowBox[{"Divide", "[", 
                 RowBox[{"1", ",", 
                  RowBox[{"T2OT1eq", "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "T2OT1eq"}], ")"}], 
                    RowBox[{
                    RowBox[{"Cos", "[", 
                    RowBox[{"\[Xi]\[CapitalDelta]1", " ", "q1"}], "]"}], "^", 
                    "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"T2OT1", "=", 
                RowBox[{"T2OT1eq", " ", "\[Eta]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Divide", "[", 
                RowBox[{"u", ",", 
                 SqrtBox[
                  RowBox[{"\[Beta]1", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "T2OT1", ",", "T2OT1"}], "}"}]}]]}], 
                "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Parallelization", "\[Rule]", "True"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"RuntimeAttributes", "\[Rule]", 
             RowBox[{"{", "Listable", "}"}]}]}], "\[IndentingNewLine]", 
           "]"}]}], "\[IndentingNewLine]", "]"}], "[", 
        RowBox[{"uel", ",", "pos"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binpos", ",", "histpos"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"pos", ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"q1lim", "+", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"+", ".5"}], ",", 
              RowBox[{"-", ".5"}]}], "}"}]}], ",", "1"}], "]"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"binu1", "=", 
       RowBox[{"Array", "[", 
        RowBox[{"N", ",", "51", ",", 
         RowBox[{"MinMax", "[", 
          RowBox[{"uel", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binu1", ",", "histu1"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"uel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"MinMax", "[", "binu1", "]"}], ",", 
           RowBox[{
            RowBox[{"binu1", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", 
            RowBox[{"binu1", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ",", "\"\<PDF\>\""}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"binu2", "=", 
       RowBox[{"Array", "[", 
        RowBox[{"N", ",", "51", ",", 
         RowBox[{"MinMax", "[", 
          RowBox[{"uel", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binu2", ",", "histu2"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"uel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"MinMax", "[", "binu2", "]"}], ",", 
           RowBox[{
            RowBox[{"binu2", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", 
            RowBox[{"binu2", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ",", "\"\<PDF\>\""}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"binu3", "=", 
       RowBox[{"Array", "[", 
        RowBox[{"N", ",", "51", ",", 
         RowBox[{"MinMax", "[", 
          RowBox[{"uel", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binu3", ",", "histu3"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"uel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"MinMax", "[", "binu3", "]"}], ",", 
           RowBox[{
            RowBox[{"binu3", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", 
            RowBox[{"binu3", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ",", "\"\<PDF\>\""}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"u1s", "=", 
       RowBox[{
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", "201", ",", 
          RowBox[{"MinMax", "[", "binu1", "]"}]}], "]"}], "~", 
        "MovingAverage", "~", "2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"u2s", "=", 
       RowBox[{
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", "200", ",", 
          RowBox[{"MinMax", "[", "binu2", "]"}]}], "]"}], "~", 
        "MovingAverage", "~", "2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"u3s", "=", 
       RowBox[{
        RowBox[{"Array", "[", 
         RowBox[{"N", ",", "199", ",", 
          RowBox[{"MinMax", "[", "binu3", "]"}]}], "]"}], "~", 
        "MovingAverage", "~", "2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"compileLosscone", "[", 
        RowBox[{"c", ",", "1.", ",", "1.", ",", "0.", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.", ",", "1*^-10"}], "}"}], "//", "N"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ff", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{
         RowBox[{"ff", "[", 
          RowBox[{"Tuples", "[", 
           RowBox[{"{", 
            RowBox[{"u1s", ",", "u2s", ",", "u3s"}], "}"}], "]"}], "]"}], ",", 
         RowBox[{"Length", "/@", 
          RowBox[{"{", 
           RowBox[{"u1s", ",", "u2s", ",", "u3s"}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"f1", "=", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{"Flatten", "[", "#", "]"}], "]"}], "&"}], ",", "ff"}], 
         "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"u2s", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"u2s", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"u3s", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"u3s", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"f2", "=", 
       RowBox[{
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{"Flatten", "[", "#", "]"}], "]"}], "&"}], ",", 
          RowBox[{"ff", "\[Transpose]"}]}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"u1s", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"u1s", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"u3s", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"u3s", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"f3", "=", 
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{"Join", "@@", "ff"}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"u1s", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"u1s", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"u2s", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"u2s", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"q1s", ",", "\[Eta]s"}], "}"}], "]"}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binpos", ",", "2"}], "]"}], ",", 
               RowBox[{"histpos", "/", 
                RowBox[{"Max", "[", "histpos", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"u1s", ",", "f1"}], "}"}], "]"}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binu1", ",", "2"}], "]"}], ",", "histu1"}], "}"}], 
             "]"}], ",", "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"u2s", ",", "f2"}], "}"}], "]"}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binu2", ",", "2"}], "]"}], ",", "histu2"}], "}"}], 
             "]"}], ",", "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"u3s", ",", "f3"}], "}"}], "]"}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binu3", ",", "2"}], "]"}], ",", "histu3"}], "}"}], 
             "]"}], ",", "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}]}], "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[18]:=",ExpressionUUID->"a164e8e1-4371-4c55-a3af-45fc66d6e682"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Beta]1", "=", 
      RowBox[{"1.5", "*", "2.1"}]}], ",", 
     RowBox[{"\[Beta]", "=", ".9"}], ",", 
     RowBox[{"T2OT1eq", "=", "5.35"}], ",", 
     RowBox[{"q1lim", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "7"}], ",", "15"}], "}"}]}], ",", 
     RowBox[{"\[CapitalDelta]1", "=", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Get", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<~/Downloads\>\"", ",", 
          "\"\<RelativisticLossconeVDF-homogeneous.m\>\""}], "}"}], "]"}], 
       "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Theta]2O\[Theta]1", ",", "vel", ",", "pos", ",", "gamma", ",", "q1s",
        ",", "\[Eta]s", ",", "binpos", ",", "histpos", ",", "binv1", ",", 
       "histv1", ",", "binv2", ",", "vdfv2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       SqrtBox[
        RowBox[{"T2OT1eq", "/", 
         RowBox[{"(", 
          RowBox[{"1", "+", "\[Beta]"}], ")"}]}]]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1s", "=", 
       RowBox[{"Range", "@@", "q1lim"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]s", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"1.", ",", 
         RowBox[{"Length", "[", "q1s", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vel", "=", 
       RowBox[{
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "/", 
        SqrtBox["\[Beta]1"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"Join", "@@", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gamma", "=", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "4"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vel", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Divide", "[", 
           RowBox[{"#1", ",", 
            RowBox[{"{", 
             RowBox[{
             "1", ",", "\[Theta]2O\[Theta]1", ",", "\[Theta]2O\[Theta]1"}], 
             "}"}]}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"vel", ",", "pos"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binpos", ",", "histpos"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"pos", ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"q1lim", "+", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"+", ".5"}], ",", 
              RowBox[{"-", ".5"}]}], "}"}]}], ",", "1"}], "]"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binv1", ",", "histv1"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"First", "/@", "vel"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3"}], ",", "3", ",", ".2"}], "}"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binv2", ",", "vdfv2"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Norm", "[", 
            RowBox[{"Rest", "[", "#", "]"}], "]"}], "&"}], "/@", "vel"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "3", ",", ".1"}], "}"}], ",", "\"\<Count\>\""}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vdfv2", "/=", 
       RowBox[{
        RowBox[{"Length", "[", "pos", "]"}], "2", "Pi", " ", 
        RowBox[{"MovingAverage", "[", 
         RowBox[{"binv2", ",", "2"}], "]"}], 
        RowBox[{"Differences", "[", "binv2", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"q1s", ",", "\[Eta]s"}], "}"}], "]"}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binpos", ",", "2"}], "]"}], ",", 
               RowBox[{"histpos", "/", 
                RowBox[{"Max", "[", "histpos", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{"v", "^", "2"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"v", ",", 
              RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binv1", ",", "2"}], "]"}], ",", 
               RowBox[{"histv1", "/", 
                RowBox[{"Max", "[", "histv1", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Exp", "[", 
                 RowBox[{"-", 
                  RowBox[{"v", "^", "2"}]}], "]"}], "-", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"v", "^", "2"}]}], "/", "\[Beta]"}], "]"}]}], 
               ")"}], "/", "Pi"}], "/", 
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Beta]"}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"v", ",", "0", ",", "3"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binv2", ",", "2"}], "]"}], ",", "vdfv2"}], "}"}], 
             "]"}], ",", "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}]}], "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[22]:=",ExpressionUUID->"56bfef82-88e5-46c5-9e60-77f177feccb0"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Beta]1", "=", 
      RowBox[{"1.5", "*", "2.1"}]}], ",", 
     RowBox[{"\[Beta]", "=", ".9"}], ",", 
     RowBox[{"T2OT1eq", "=", "5.35"}], ",", 
     RowBox[{"\[Xi]", "=", ".876"}], ",", 
     RowBox[{"q1lim", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "7"}], ",", "15"}], "}"}]}], ",", 
     RowBox[{"\[Xi]\[CapitalDelta]1q1max", "=", 
      RowBox[{
       RowBox[{"Pi", "/", "2"}], "*", ".8"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Get", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<~/Downloads\>\"", ",", 
          "\"\<RelativisticLossconeVDF-inhomogeneous.m\>\""}], "}"}], "]"}], 
       "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[Theta]2O\[Theta]1", ",", "\[CapitalDelta]1", ",", "vel", ",", "pos", 
       ",", "gamma", ",", "q1s", ",", "\[Eta]s", ",", "\[Eta]\[Beta]s", ",", 
       "binpos", ",", "histpos", ",", "binv1", ",", "histv1", ",", "binv2", 
       ",", "vdfv2", ",", "v2s", ",", "fs"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Theta]2O\[Theta]1", "=", 
       SqrtBox[
        RowBox[{"T2OT1eq", "/", 
         RowBox[{"(", 
          RowBox[{"1", "+", "\[Beta]"}], ")"}]}]]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]1", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"\[Xi]\[CapitalDelta]1q1max", ",", 
         RowBox[{"\[Xi]", " ", 
          RowBox[{"Max", "[", 
           RowBox[{"Abs", "[", "q1lim", "]"}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"q1s", "=", 
       RowBox[{"Range", "@@", "q1lim"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]s", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1s"}], "]"}], 
            "^", "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]\[Beta]s", "=", 
       RowBox[{"Divide", "[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"\[Beta]", " ", 
           RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Beta]", " ", 
              RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}]}]}], ")"}], 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1s"}], "]"}], 
            "^", "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vel", "=", 
       RowBox[{
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "/", 
        SqrtBox["\[Beta]1"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"Join", "@@", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gamma", "=", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "4"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vel", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Divide", "[", 
           RowBox[{"#1", ",", 
            RowBox[{"{", 
             RowBox[{
             "1", ",", "\[Theta]2O\[Theta]1", ",", "\[Theta]2O\[Theta]1"}], 
             "}"}]}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"vel", ",", "pos"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binpos", ",", "histpos"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"pos", ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"q1lim", "+", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"+", ".5"}], ",", 
              RowBox[{"-", ".5"}]}], "}"}]}], ",", "1"}], "]"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binv1", ",", "histv1"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"First", "/@", "vel"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3"}], ",", "3", ",", ".2"}], "}"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binv2", ",", "vdfv2"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Norm", "[", 
            RowBox[{"Rest", "[", "#", "]"}], "]"}], "&"}], "/@", "vel"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "3", ",", ".1"}], "}"}], ",", "\"\<Count\>\""}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vdfv2", "/=", 
       RowBox[{
        RowBox[{"Length", "[", "pos", "]"}], "2", "Pi", " ", 
        RowBox[{"MovingAverage", "[", 
         RowBox[{"binv2", ",", "2"}], "]"}], 
        RowBox[{"Differences", "[", "binv2", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v2s", "=", 
       RowBox[{"MovingAverage", "[", 
        RowBox[{
         RowBox[{"Array", "[", 
          RowBox[{"N", ",", "101", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "3"}], "}"}]}], "]"}], ",", "2"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"fs", "=", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"v2", ",", 
          RowBox[{
           RowBox[{"NIntegrate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Function", "[", 
               RowBox[{"q1", ",", "\[IndentingNewLine]", 
                RowBox[{"Module", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"BOB0", ",", "eta", ",", "eta\[Beta]"}], "}"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"BOB0", "=", 
                    RowBox[{
                    RowBox[{"Sec", "[", 
                    RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1"}], 
                    "]"}], "^", "2"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"eta", "=", 
                    RowBox[{"Divide", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"1", "/", "BOB0"}]}], ")"}], 
                    RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}]}], "+", 
                    RowBox[{"1", "/", "BOB0"}]}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"eta\[Beta]", "=", 
                    RowBox[{"Divide", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"1", "/", "BOB0"}]}], ")"}], "\[Beta]", " ", 
                    RowBox[{"\[Theta]2O\[Theta]1", "^", "2"}]}], "+", 
                    RowBox[{"1", "/", "BOB0"}]}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"v2", "^", "2"}]}], "/", "eta"}], "]"}], "-", 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"v2", "^", "2"}]}], "/", "\[Beta]"}], "/", 
                    "eta\[Beta]"}], "]"}]}], ")"}], "/", "Pi"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "\[Beta]"}], ")"}]}]}]}], 
                 "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}],
               "[", "q1", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"q1", ",", 
               RowBox[{"q1lim", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"q1lim", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], "/", 
           "10.552208906945133"}], ",", 
          RowBox[{"{", "Listable", "}"}]}], "]"}], "[", "v2s", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"q1s", ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[Eta]s", "-", 
                  RowBox[{"\[Beta]", " ", "\[Eta]\[Beta]s"}]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "\[Beta]"}], ")"}]}]}], "}"}], "]"}], ",", 
            
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binpos", ",", "2"}], "]"}], ",", 
               RowBox[{"histpos", "/", 
                RowBox[{"Max", "[", "histpos", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{"v", "^", "2"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"v", ",", 
              RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binv1", ",", "2"}], "]"}], ",", 
               RowBox[{"histv1", "/", 
                RowBox[{"Max", "[", "histv1", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"v2s", ",", "fs"}], "}"}], "]"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binv2", ",", "2"}], "]"}], ",", "vdfv2"}], "}"}], 
             "]"}], ",", "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}]}], "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[25]:=",ExpressionUUID->"e09997f8-8de3-4130-b74e-7ad02f6de643"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Partial shell velocity distribution", "Subsection",ExpressionUUID->"686f3a9f-3478-42d1-80c9-544f05ccde4f"],

Cell[TextData[{
 Cell[BoxData[{
  FormBox[
   RowBox[{
    SubscriptBox["f", "0"], "(", 
    RowBox[{
     SubscriptBox["u", 
      RowBox[{"\[DoubleVerticalBar]", 
       RowBox[{",", "0"}]}]], ",", 
     SubscriptBox["u", 
      RowBox[{"\[UpTee]", 
       RowBox[{",", "0"}]}]]}], ")"}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     FractionBox[
      SubscriptBox["n", "0"], 
      RowBox[{"2", "\[Pi]", " ", 
       SubsuperscriptBox["\[Theta]", "0", "3"], 
       RowBox[{"\[ScriptCapitalA]", "(", 
        RowBox[{
         SubscriptBox["u", "s"], "/", 
         SubscriptBox["\[Theta]", "0"]}], ")"}], 
       SubscriptBox["\[ScriptCapitalB]", "\[Zeta]"]}]], 
     RowBox[{"exp", "(", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["u", "0"], "-", 
           SubscriptBox["u", "s"]}], ")"}], "2"], 
        SubsuperscriptBox["\[Theta]", "0", "2"]]}], ")"}], 
     SuperscriptBox["sin", "\[Zeta]"], 
     SubscriptBox["\[Alpha]", "0"]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     FractionBox[
      SubscriptBox["n", "0"], 
      RowBox[{"2", "\[Pi]", " ", 
       SubsuperscriptBox["\[Theta]", "0", "3"], 
       RowBox[{"\[ScriptCapitalA]", "(", 
        RowBox[{
         SubscriptBox["u", "s"], "/", 
         SubscriptBox["\[Theta]", "0"]}], ")"}], 
       SubscriptBox["\[ScriptCapitalB]", "\[Zeta]"]}]], 
     RowBox[{"exp", "(", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["u", "0"], "-", 
           SubscriptBox["u", "s"]}], ")"}], "2"], 
        SubsuperscriptBox["\[Theta]", "0", "2"]]}], ")"}], 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox[
        SubscriptBox["u", 
         RowBox[{"\[UpTee]", 
          RowBox[{",", "0"}]}]], 
        SubscriptBox["u", "0"]], ")"}], "\[Zeta]"]}]}], TraditionalForm]}],
  ExpressionUUID->"457fb85c-aa19-48fd-960a-59b3ad956fe0"],
 ",\nwhere\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[ScriptCapitalA]", "(", "b", ")"}], "=", 
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"-", 
          SuperscriptBox["b", "2"]}]]}], "+", 
       RowBox[{
        SqrtBox["\[Pi]"], 
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", "2"], "+", 
          SuperscriptBox["b", "2"]}], ")"}], 
        RowBox[{"Erfc", "[", 
         RowBox[{"-", "b"}], "]"}]}]}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"774d4de4-f6cb-48dc-bba9-0d364dfb3084"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[ScriptCapitalB]", "\[Zeta]"], "=", 
    RowBox[{
     SqrtBox["\[Pi]"], 
     FractionBox[
      RowBox[{"\[CapitalGamma]", "[", 
       RowBox[{"1", "+", 
        RowBox[{"\[Zeta]", "/", "2"}]}], "]"}], 
      RowBox[{"\[CapitalGamma]", "[", 
       RowBox[{"1.5", "+", 
        RowBox[{"\[Zeta]", "/", "2"}]}], "]"}]]}]}], TraditionalForm]],
  ExpressionUUID->"8a89ab57-6fcf-49ea-99c0-f0c8fd912807"],
 ".\nSubstitute ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["u", "0"], "=", "u"}], TraditionalForm]],ExpressionUUID->
  "47959eff-a470-42c5-befb-743ad4dff733"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["u", 
     RowBox[{"\[UpTee]", 
      RowBox[{",", "0"}]}]], "=", 
    RowBox[{
     SqrtBox[
      RowBox[{
       SubscriptBox["B", "0"], "/", "B"}]], 
     SubscriptBox["u", "\[UpTee]"]}]}], TraditionalForm]],ExpressionUUID->
  "43ab5fb0-f572-422c-80f1-acc488ad62a6"],
 ":\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    RowBox[{"f", "(", 
     RowBox[{
      SubscriptBox["u", "\[DoubleVerticalBar]"], ",", 
      SubscriptBox["u", "\[UpTee]"]}], ")"}], "=", 
    RowBox[{
     FractionBox[
      SubscriptBox["n", "0"], 
      RowBox[{"2", "\[Pi]", " ", 
       SubsuperscriptBox["\[Theta]", "0", "3"], 
       RowBox[{"\[ScriptCapitalA]", "(", 
        RowBox[{
         SubscriptBox["u", "s"], "/", 
         SubscriptBox["\[Theta]", "0"]}], ")"}], 
       SubscriptBox["\[ScriptCapitalB]", "\[Zeta]"]}]], 
     RowBox[{"exp", "(", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"u", "-", 
           SubscriptBox["u", "s"]}], ")"}], "2"], 
        SubsuperscriptBox["\[Theta]", "0", "2"]]}], ")"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SqrtBox[
         FractionBox[
          SubscriptBox["B", "0"], "B"]], 
        FractionBox[
         SubscriptBox["u", "\[UpTee]"], "u"]}], ")"}], "\[Zeta]"]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     FractionBox[
      SubscriptBox["n", "0"], 
      RowBox[{"2", "\[Pi]", " ", 
       SubsuperscriptBox["\[Theta]", "0", "3"], 
       RowBox[{"\[ScriptCapitalA]", "(", 
        RowBox[{
         SubscriptBox["u", "s"], "/", 
         SubscriptBox["\[Theta]", "0"]}], ")"}], 
       SubscriptBox["\[ScriptCapitalB]", "\[Zeta]"]}]], 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox[
        SubscriptBox["B", "0"], "B"], ")"}], 
      RowBox[{"\[Zeta]", "/", "2"}]], 
     RowBox[{"exp", "(", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"u", "-", 
           SubscriptBox["u", "s"]}], ")"}], "2"], 
        SubsuperscriptBox["\[Theta]", "0", "2"]]}], ")"}], 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox[
        SubscriptBox["u", "\[UpTee]"], "u"], ")"}], "\[Zeta]"]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     FractionBox["n", 
      RowBox[{"2", "\[Pi]", " ", 
       SuperscriptBox["\[Theta]", "3"], 
       RowBox[{"\[ScriptCapitalA]", "(", 
        RowBox[{
         SubscriptBox["u", "s"], "/", "\[Theta]"}], ")"}], 
       SubscriptBox["\[ScriptCapitalB]", "\[Zeta]"]}]], 
     RowBox[{"exp", "(", 
      RowBox[{"-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"u", "-", 
           SubscriptBox["u", "s"]}], ")"}], "2"], 
        SuperscriptBox["\[Theta]", "2"]]}], ")"}], 
     SuperscriptBox["sin", "\[Zeta]"], "\[Alpha]"}]}], TraditionalForm]}],
  ExpressionUUID->"e43cebb2-a1c9-4e03-8db6-ac1baf0b4ae6"],
 ",\nwhere ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Eta]", "\[Congruent]", 
     FractionBox["n", 
      SubscriptBox["n", "0"]]}], "=", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox[
       SubscriptBox["B", "0"], "B"], ")"}], 
     RowBox[{"\[Zeta]", "/", "2"}]]}], TraditionalForm]],ExpressionUUID->
  "2ce8aaca-7526-4591-a2f7-a83737e5cf29"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Theta]", "=", 
    SubscriptBox["\[Theta]", "0"]}], TraditionalForm]],ExpressionUUID->
  "2c862a26-5550-40a6-abac-ea4ae5ce5511"],
 ".\nTo summarize,\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", "=", 
    RowBox[{
     SubscriptBox["n", "0"], "\[Eta]"}]}], TraditionalForm]],ExpressionUUID->
  "4cc45f39-900a-4832-bf64-1a68c6fcf2d6"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Theta]", "=", 
    SubscriptBox["\[Theta]", "0"]}], TraditionalForm]],ExpressionUUID->
  "5ec077be-f5dc-4e5b-861f-6599060ae5b2"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["u", "s"], "=", 
    SubscriptBox["u", 
     RowBox[{"s", ",", "0"}]]}], TraditionalForm]],ExpressionUUID->
  "90950389-f637-4b25-b5e5-7cd64172c9a3"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Eta]", "=", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox[
       SubscriptBox["B", "0"], "B"], ")"}], 
     RowBox[{"\[Zeta]", "/", "2"}]]}], TraditionalForm]],ExpressionUUID->
  "e3f7d4cd-dfb7-4f66-8804-1b24e50959dd"],
 "."
}], "Text",ExpressionUUID->"6dffd9a3-950c-498f-abea-fc58de7fa60f"],

Cell[TextData[{
 "For simplicity, we will assume ",
 Cell[BoxData[
  FormBox["\[Zeta]", TraditionalForm]],ExpressionUUID->
  "13a12a72-9dfd-4642-a351-d690010d4d77"],
 " is an integer, satisfying ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Zeta]", ">=", "0"}], TraditionalForm]],ExpressionUUID->
  "7af5bc86-e2d2-435f-a960-662160b94277"],
 ".\nWe may need the following integrals\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["cos", "\[Zeta]"], "(", 
       RowBox[{"a", " ", "x"}], ")"}], 
      RowBox[{"\[DifferentialD]", "x"}]}]}], "=", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {
           RowBox[{
            FractionBox[
             RowBox[{
              RowBox[{
               SuperscriptBox["cos", 
                RowBox[{"\[Zeta]", "-", "1"}]], "(", 
               RowBox[{"a", " ", "x"}], ")"}], 
              RowBox[{"sin", "(", 
               RowBox[{"a", " ", "x"}], ")"}]}], 
             RowBox[{"\[Zeta]", " ", "a"}]], "+", 
            RowBox[{
             FractionBox[
              RowBox[{"\[Zeta]", "-", "1"}], "\[Zeta]"], 
             RowBox[{"\[Integral]", 
              RowBox[{
               SuperscriptBox["cos", 
                RowBox[{"\[Zeta]", "-", "2"}]], 
               RowBox[{"(", 
                RowBox[{"a", " ", "x"}], ")"}], 
               RowBox[{"\[DifferentialD]", "x"}]}]}]}]}], 
           RowBox[{"\[Zeta]", ">", "0"}]},
          {
           RowBox[{"x", "+", "C"}], 
           RowBox[{"\[Zeta]", "=", "0"}]}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}},
         Selectable->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False,
     StripWrapperBoxes->True]}], TraditionalForm]],ExpressionUUID->
  "de89fc47-ce35-4f16-8761-819d8ae4c815"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["sin", "\[Zeta]"], "(", 
       RowBox[{"a", " ", "x"}], ")"}], 
      RowBox[{"\[DifferentialD]", "x"}]}]}], "=", 
    TagBox[GridBox[{
       {"\[Piecewise]", GridBox[{
          {
           RowBox[{
            RowBox[{"-", 
             FractionBox[
              RowBox[{
               RowBox[{
                SuperscriptBox["sin", 
                 RowBox[{"\[Zeta]", "-", "1"}]], "(", 
                RowBox[{"a", " ", "x"}], ")"}], 
               RowBox[{"cos", "(", 
                RowBox[{"a", " ", "x"}], ")"}]}], 
              RowBox[{"\[Zeta]", " ", "a"}]]}], "+", 
            RowBox[{
             FractionBox[
              RowBox[{"\[Zeta]", "-", "1"}], "\[Zeta]"], 
             RowBox[{"\[Integral]", 
              RowBox[{
               RowBox[{
                SuperscriptBox["sin", 
                 RowBox[{"\[Zeta]", "-", "2"}]], "(", 
                RowBox[{"a", " ", "x"}], ")"}], 
               RowBox[{"\[DifferentialD]", "x"}]}]}]}]}], 
           RowBox[{"\[Zeta]", ">", "0"}]},
          {
           RowBox[{"x", "+", "C"}], 
           RowBox[{"\[Zeta]", "=", "0"}]}
         },
         AllowedDimensions->{2, Automatic},
         Editable->True,
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxItemSize->{
          "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{1.}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[0.84]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}},
         Selectable->True]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.35]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     "Piecewise",
     DeleteWithContents->True,
     Editable->False,
     SelectWithContents->True,
     Selectable->False,
     StripWrapperBoxes->True]}], TraditionalForm]],ExpressionUUID->
  "e2749225-c852-436a-8bd7-e4b3a188d6ba"],
 ".\n\nSubstitute ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"B", "(", "x", ")"}], 
     SubscriptBox["B", "0"]], "=", 
    RowBox[{
     FractionBox[
      RowBox[{
       SubscriptBox["B", "x"], "(", "x", ")"}], 
      SubscriptBox["B", "0"]], "=", 
     RowBox[{
      RowBox[{"1", "+", 
       RowBox[{
        SuperscriptBox["\[Xi]", "2"], 
        SuperscriptBox["x", "2"]}]}], "=", 
      RowBox[{
       SuperscriptBox["sec", "2"], "(", 
       RowBox[{"\[Xi]", " ", 
        SubscriptBox["\[CapitalDelta]", "1"], 
        SuperscriptBox["q", "1"]}], ")"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"d0687d4a-be25-4331-9b59-d9288591d69a"],
 ", \[Eta] becomes\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Eta]", "=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox[
        SubscriptBox["B", "0"], "B"], ")"}], 
      RowBox[{"\[Zeta]", "/", "2"}]], "=", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["1", 
         RowBox[{"1", "+", 
          RowBox[{
           SuperscriptBox["\[Xi]", "2"], 
           SuperscriptBox["x", "2"]}]}]], ")"}], 
       RowBox[{"\[Zeta]", "/", "2"}]], "=", 
      RowBox[{
       SuperscriptBox["cos", "\[Zeta]"], "(", 
       RowBox[{"\[Xi]", " ", 
        SubscriptBox["\[CapitalDelta]", "1"], 
        SuperscriptBox["q", "1"]}], ")"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"0052a1e3-8feb-4d71-97c0-1ac499bed346"],
 ".\nNote that ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Eta]", "=", "1"}], TraditionalForm]],ExpressionUUID->
  "172c8412-e280-4569-87a1-c89939ca3aa1"],
 " if ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Xi]", "=", "0"}], TraditionalForm]],ExpressionUUID->
  "363af9cd-aa6b-491b-ac8c-b3cf11962382"],
 " or ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Zeta]", "=", "0"}], TraditionalForm]],ExpressionUUID->
  "d5f3c3ea-17f3-4df3-91c5-8cefdf336b1d"],
 ".\nThe number of particles in a differential volume, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[DifferentialD]", "V"}], TraditionalForm]],ExpressionUUID->
  "5c1ed00f-89e4-411b-b003-52b0359b9067"],
 ", is given by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[DifferentialD]", "N"}], "=", 
    RowBox[{"n", 
     RowBox[{"\[DifferentialD]", "V"}]}]}], TraditionalForm]],ExpressionUUID->
  "dcc59545-1ce1-407a-9633-db5949f5c9f0"],
 ".\nSince ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[DifferentialD]", "V"}], "=", 
    RowBox[{
     SubscriptBox["\[CapitalDelta]", "1"], 
     SubscriptBox["\[CapitalDelta]", "2"], 
     SubscriptBox["\[CapitalDelta]", "3"], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "1"]}], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "2"]}], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "3"]}]}]}], TraditionalForm]],ExpressionUUID->
  "a9c47c5a-9326-42ea-9bb4-60473dd360c2"],
 " is constant in terms of curvilinear coordinates, \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[DifferentialD]", "N"}], "\[Proportional]", 
    RowBox[{"\[Eta]", "(", 
     SuperscriptBox["q", "1"], ")"}]}], TraditionalForm]],ExpressionUUID->
  "63e64fec-47d9-415d-b499-b0493fc02da1"],
 ".\nConsidering a flux tube of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[DifferentialD]", 
     SuperscriptBox["q", "2"]}], "\[Times]", 
    RowBox[{"\[DifferentialD]", 
     SuperscriptBox["q", "3"]}]}], TraditionalForm]],ExpressionUUID->
  "e2b254ef-ea47-47d6-94aa-4b96da737db5"],
 " wide, the integrated number of particles with respect to ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["q", "1"], TraditionalForm]],ExpressionUUID->
  "344d5ac7-6a5f-4c43-b425-45e2398fc4f0"],
 " is given by\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"N", "(", 
      SuperscriptBox["q", "1"], ")"}], 
     SubscriptBox["n", "0"]], "=", 
    RowBox[{
     SubscriptBox["\[CapitalDelta]", "1"], 
     SubscriptBox["\[CapitalDelta]", "2"], 
     SubscriptBox["\[CapitalDelta]", "3"], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "2"]}], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "3"]}], 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", 
       SuperscriptBox["q", "1"]], 
      RowBox[{
       RowBox[{"\[Eta]", "(", 
        SuperscriptBox["q", "1"], ")"}], 
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox["q", "1"]}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     SubscriptBox["\[CapitalDelta]", "1"], 
     SubscriptBox["\[CapitalDelta]", "2"], 
     SubscriptBox["\[CapitalDelta]", "3"], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "2"]}], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "3"]}], 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", 
       SuperscriptBox["q", "1"]], 
      RowBox[{
       RowBox[{
        SuperscriptBox["cos", "\[Zeta]"], "(", 
        RowBox[{"\[Xi]", " ", 
         SubscriptBox["\[CapitalDelta]", "1"], 
         SuperscriptBox["q", "1"]}], ")"}], 
       RowBox[{"\[DifferentialD]", 
        SuperscriptBox["q", "1"]}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     SubscriptBox["\[CapitalDelta]", "1"], 
     SubscriptBox["\[CapitalDelta]", "2"], 
     SubscriptBox["\[CapitalDelta]", "3"], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "2"]}], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "3"]}], 
     FractionBox["1", 
      RowBox[{"\[Xi]", " ", 
       SubscriptBox["\[CapitalDelta]", "1"]}]], 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", 
       RowBox[{"\[Xi]", " ", 
        SubscriptBox["\[CapitalDelta]", "1"], 
        SuperscriptBox["q", "1"]}]], 
      RowBox[{
       RowBox[{
        SuperscriptBox["cos", "\[Zeta]"], "(", "x", ")"}], 
       RowBox[{"\[DifferentialD]", "x"}]}]}]}]}], TraditionalForm]}],
  ExpressionUUID->"79b6e243-44bc-45b3-88d5-0c7196393019"],
 ",\nwhere ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"N", "(", "0", ")"}], "=", "0"}], TraditionalForm]],
  ExpressionUUID->"bcad519c-49bf-4dd1-947a-e6632144d960"],
 ".\nNote the limiting case ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["lim", 
      RowBox[{"\[Xi]", "\[Rule]", "0"}]], 
     FractionBox[
      RowBox[{"N", "(", 
       SuperscriptBox["q", "1"], ")"}], 
      SubscriptBox["n", "0"]]}], "=", 
    RowBox[{
     SuperscriptBox["q", "1"], 
     SubscriptBox["\[CapitalDelta]", "1"], 
     SubscriptBox["\[CapitalDelta]", "2"], 
     SubscriptBox["\[CapitalDelta]", "3"], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "2"]}], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["q", "3"]}]}]}], TraditionalForm]],ExpressionUUID->
  "cc3901db-1b79-48fc-89cd-98bdc5816679"],
 ".\nThe inverse relation ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["q", "1"], "(", "N", ")"}], TraditionalForm]],
  ExpressionUUID->"4d1be238-1a59-428a-80d6-95524e38c82c"],
 " is not straightforward.\n\nFor sampling in pitch angle space,\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["F", "\[Alpha]"], "(", "\[Alpha]", ")"}], "=", 
    RowBox[{
     FractionBox["1", 
      SubscriptBox["\[ScriptCapitalB]", "\[Zeta]"]], 
     RowBox[{
      SuperscriptBox["\[Integral]", "\[Alpha]"], 
      RowBox[{
       SuperscriptBox["sin", 
        RowBox[{"\[Zeta]", "+", "1"}]], "\[Alpha]", 
       RowBox[{"\[DifferentialD]", "\[Alpha]"}]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"6600d7e3-6ea7-409c-ab9a-1debe64d6720"],
 ".\nOr, with ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CurlyPhi]", "=", 
    RowBox[{"\[Alpha]", "-", 
     FractionBox["\[Pi]", "2"]}]}], TraditionalForm]],ExpressionUUID->
  "67426d6f-0c96-4a6e-a015-0ab7f4be220d"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["F", "\[Alpha]"], "(", 
     RowBox[{"\[CurlyPhi]", "+", 
      FractionBox["\[Pi]", "2"]}], ")"}], "=", 
    RowBox[{
     FractionBox["1", 
      SubscriptBox["\[ScriptCapitalB]", "\[Zeta]"]], 
     RowBox[{
      SuperscriptBox["\[Integral]", "\[CurlyPhi]"], 
      RowBox[{
       SuperscriptBox["cos", 
        RowBox[{"\[Zeta]", "+", "1"}]], "\[CurlyPhi]", 
       RowBox[{"\[DifferentialD]", "\[CurlyPhi]"}]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"36f0cb19-a450-4754-beae-1a176925d4e0"],
 ".\n\nFor sampling in velocity space,\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["F", "v"], "(", "x", ")"}], "=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"\[ScriptCapitalA]", "(", 
       SubscriptBox["x", "s"], ")"}]], 
     RowBox[{
      SuperscriptBox["\[Integral]", "x"], 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"x", "-", 
            SubscriptBox["x", "s"]}], ")"}], "2"]}], "]"}], 
       SuperscriptBox["x", "2"], 
       RowBox[{"\[DifferentialD]", "x"}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     RowBox[{
      FractionBox["1", 
       RowBox[{"\[ScriptCapitalA]", "(", 
        SubscriptBox["x", "s"], ")"}]], 
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"x", "+", 
            SubscriptBox["x", "s"]}], ")"}]}], 
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"x", "-", 
              SubscriptBox["x", "s"]}], ")"}], "2"]}], "]"}]}], "+", 
        RowBox[{
         SqrtBox["\[Pi]"], 
         RowBox[{"(", 
          RowBox[{
           FractionBox["1", "2"], "+", 
           SubsuperscriptBox["x", "s", "2"]}], ")"}], 
         RowBox[{"Erf", "[", 
          RowBox[{"x", "-", 
           SubscriptBox["x", "s"]}], "]"}]}]}], ")"}]}], "+", "C"}]}], 
   TraditionalForm]}],ExpressionUUID->
  "85ba2ea1-674d-49bd-a928-d15ecad1bc3f"],
 ".\nOr, with ",
 Cell[BoxData[
  FormBox[
   RowBox[{"t", "=", 
    RowBox[{"x", "-", 
     SubscriptBox["x", "s"]}]}], TraditionalForm]],ExpressionUUID->
  "7bb262be-f0c7-410b-983d-db16b266c69b"],
 ",\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["F", "v"], "(", 
     RowBox[{"t", "+", 
      SubscriptBox["x", "s"]}], ")"}], "=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"\[ScriptCapitalA]", "(", 
       SubscriptBox["x", "s"], ")"}]], 
     RowBox[{
      SuperscriptBox["\[Integral]", "t"], 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"-", 
         SuperscriptBox["t", "2"]}], "]"}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"t", "+", 
          SubscriptBox["x", "s"]}], ")"}], "2"], 
       RowBox[{"\[DifferentialD]", "x"}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     RowBox[{
      FractionBox["1", 
       RowBox[{"\[ScriptCapitalA]", "(", 
        SubscriptBox["x", "s"], ")"}]], 
      FractionBox["1", "2"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"t", "+", 
            RowBox[{"2", 
             SubscriptBox["x", "s"]}]}], ")"}]}], 
         RowBox[{"Exp", "[", 
          RowBox[{"-", 
           SuperscriptBox["t", "2"]}], "]"}]}], "+", 
        RowBox[{
         SqrtBox["\[Pi]"], 
         RowBox[{"(", 
          RowBox[{
           FractionBox["1", "2"], "+", 
           SubsuperscriptBox["x", "s", "2"]}], ")"}], 
         RowBox[{"Erf", "[", "t", "]"}]}]}], ")"}]}], "+", "C"}]}], 
   TraditionalForm]}],ExpressionUUID->
  "7f598bc2-3357-41b9-9799-cdb91b452084"],
 "."
}], "Text",ExpressionUUID->"ef49d603-be53-4cb6-8baf-cd0c6e93b258"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "intSin\[Zeta]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intSin\[Zeta]", "[", "0", "]"}], ":=", 
  RowBox[{"#", "&"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intSin\[Zeta]", "[", "1", "]"}], ":=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"Cos", "[", "#", "]"}]}], "&"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intSin\[Zeta]", "[", 
   RowBox[{"\[Zeta]_Integer", "?", "Positive"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"recursive", "=", 
      RowBox[{"intSin\[Zeta]", "[", 
       RowBox[{"\[Zeta]", "-", "2"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Function", "[", 
     RowBox[{"x", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Power", "[", 
          RowBox[{
           RowBox[{"Sin", "[", "x", "]"}], ",", 
           RowBox[{"\[Zeta]", "-", "1"}]}], "]"}]}], 
        RowBox[{
         RowBox[{"Cos", "[", "x", "]"}], "/", "\[Zeta]"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Zeta]", "-", "1"}], ")"}], "/", "\[Zeta]"}], " ", 
        RowBox[{"recursive", "[", "x", "]"}]}]}], ",", 
      RowBox[{"{", "Listable", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellLabel->
  "In[296]:=",ExpressionUUID->"1a2e99cc-0f31-429a-a4ee-fcccefe032d5"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "intCos\[Zeta]", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intCos\[Zeta]", "[", "0", "]"}], ":=", 
  RowBox[{"#", "&"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intCos\[Zeta]", "[", "1", "]"}], ":=", 
  "Sin"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intCos\[Zeta]", "[", 
   RowBox[{"\[Zeta]_Integer", "?", "Positive"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"recursive", "=", 
      RowBox[{"intCos\[Zeta]", "[", 
       RowBox[{"\[Zeta]", "-", "2"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Function", "[", 
     RowBox[{"x", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Power", "[", 
         RowBox[{
          RowBox[{"Cos", "[", "x", "]"}], ",", 
          RowBox[{"\[Zeta]", "-", "1"}]}], "]"}], 
        RowBox[{
         RowBox[{"Sin", "[", "x", "]"}], "/", "\[Zeta]"}]}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Zeta]", "-", "1"}], ")"}], "/", "\[Zeta]"}], " ", 
        RowBox[{"recursive", "[", "x", "]"}]}]}], ",", 
      RowBox[{"{", "Listable", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellLabel->"In[14]:=",ExpressionUUID->"43335b99-b3aa-4fe3-9378-74d0b58af4ae"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Zeta]", "=", "5"}], ",", 
     RowBox[{"\[Xi]", "=", ".876"}], ",", 
     RowBox[{"q1lim", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "24"}], ",", "50"}], "}"}]}], ",", 
     RowBox[{"\[Xi]\[CapitalDelta]1q1max", "=", 
      RowBox[{
       RowBox[{"Pi", "/", "2"}], "*", ".8"}]}], ",", 
     RowBox[{"nsamples", "=", "50000"}]}], "}"}], ",", "\[IndentingNewLine]", 
   
   RowBox[{"BlockRandom", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "49038", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[CapitalDelta]1", ",", "q1s", ",", "Bs", ",", "\[Eta]s", ",", "xs", 
         ",", "Nofq1", ",", "tmp", ",", "q1samples", ",", "bins", ",", 
         "hist"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[CapitalDelta]1", "=", 
         RowBox[{"Divide", "[", 
          RowBox[{"\[Xi]\[CapitalDelta]1q1max", ",", 
           RowBox[{"\[Xi]", " ", 
            RowBox[{"Max", "[", 
             RowBox[{"Abs", "[", "q1lim", "]"}], "]"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"q1s", "=", 
         RowBox[{"Range", "@@", "q1lim"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xs", "=", 
         RowBox[{
          RowBox[{"Tan", "[", 
           RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1s"}], "]"}], "/",
           "\[Xi]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Bs", "=", 
         RowBox[{
          RowBox[{"Sec", "[", 
           RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1s"}], "]"}], "^",
           "2"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Eta]s", "=", 
         RowBox[{"Power", "[", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1s"}], "]"}], 
           ",", "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"Apply", "[", 
            RowBox[{"And", ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"0", "==", 
               RowBox[{"Chop", "[", 
                RowBox[{"\[Eta]s", "-", 
                 RowBox[{"Power", "[", 
                  RowBox[{"Bs", ",", 
                   RowBox[{
                    RowBox[{"-", "\[Zeta]"}], "/", "2"}]}], "]"}]}], "]"}]}], 
              "]"}]}], "]"}]}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<\[Eta]s incorrect\>\"", "]"}], ";", 
            RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Nofq1", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"intCos\[Zeta]", "[", "\[Zeta]", "]"}], "[", 
           RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1s"}], "]"}], "/", 
          RowBox[{"(", 
           RowBox[{"\[Xi]", " ", "\[CapitalDelta]1"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{"MinMax", "[", "Nofq1", "]"}], "-", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"NIntegrate", "[", 
              RowBox[{
               RowBox[{"Power", "[", 
                RowBox[{
                 RowBox[{"Cos", "[", 
                  RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1"}], 
                  "]"}], ",", "\[Zeta]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"q1", ",", "0", ",", "#"}], "}"}]}], "]"}], "&"}], 
            ",", 
            RowBox[{"MinMax", "[", "q1s", "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"Apply", "[", 
            RowBox[{"And", ",", 
             RowBox[{"Thread", "[", 
              RowBox[{"0", "==", 
               RowBox[{"Chop", "[", "tmp", "]"}]}], "]"}]}], "]"}]}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<N(q1) incorrect\>\"", "]"}], ";", 
            RowBox[{"Abort", "[", "]"}]}], ")"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"q1samples", "=", 
         RowBox[{
          RowBox[{"Interpolation", "[", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"Nofq1", ",", "q1s"}], "}"}], "]"}], "]"}], "[", 
          RowBox[{"RandomReal", "[", 
           RowBox[{
            RowBox[{"MinMax", "[", "Nofq1", "]"}], ",", "nsamples"}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"bins", ",", "hist"}], "}"}], "=", 
         RowBox[{"N", "@", 
          RowBox[{"HistogramList", "[", 
           RowBox[{"q1samples", ",", 
            RowBox[{"Append", "[", 
             RowBox[{"q1lim", ",", "1"}], "]"}], ",", "\"\<Count\>\""}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bins", "=", 
         RowBox[{"Flatten", "[", "bins", "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{
         RowBox[{
          RowBox[{"Show", "[", 
           RowBox[{"#", ",", "\[IndentingNewLine]", 
            RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
           "]"}], "&"}], "/@", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{"q1s", ",", "\[Eta]s"}], "}"}], "]"}], ",", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               RowBox[{"AxesLabel", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<\\!\\(\!\(\*SuperscriptBox[\(q\), \(1\)]\)\\)\>\"", 
                  ",", "\"\<\\!\\(\[Eta](\!\(\*SuperscriptBox[\(q\), \
\(1\)]\))\\)\>\""}], "}"}]}], ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Thread", "[", 
                 RowBox[{"Directive", "[", 
                  RowBox[{"{", 
                   RowBox[{"Black", ",", "Blue"}], "}"}], "]"}], "]"}]}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListStepPlot", "[", 
              RowBox[{
               RowBox[{"Thread", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"MovingAverage", "[", 
                   RowBox[{"bins", ",", "2"}], "]"}], ",", 
                  RowBox[{"hist", "/", 
                   RowBox[{"Max", "[", "hist", "]"}]}]}], "}"}], "]"}], ",", 
               "Center", ",", 
               RowBox[{"PlotStyle", "\[Rule]", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Red", ",", 
                  RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], 
              "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"ListPlot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Thread", "[", 
                  RowBox[{"{", 
                   RowBox[{"xs", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
                RowBox[{"{", 
                 RowBox[{"\[Eta]s", ",", 
                  RowBox[{"\[Eta]s", "^", "2"}]}], "}"}]}], ",", 
               RowBox[{"Joined", "\[Rule]", "True"}], ",", 
               RowBox[{"AxesLabel", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<\\!\\(x\\)\>\"", ",", 
                  "\"\<\\!\\(\[Eta](\!\(\*SuperscriptBox[\(q\), \
\(1\)]\))\\)\>\""}], "}"}]}]}], "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{"q1s", ",", 
                RowBox[{"Nofq1", "-", 
                 RowBox[{"Min", "[", "Nofq1", "]"}]}]}], "}"}], "]"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"AxesLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<\\!\\(\!\(\*SuperscriptBox[\(q\), \(1\)]\)\\)\>\"", ",", 
                "\"\<\\!\\(N(\!\(\*SuperscriptBox[\(q\), \(1\)]\))\\)\>\""}], 
               "}"}]}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[18]:=",ExpressionUUID->"6170488c-ab21-42a7-80b1-9a11433b8c0d"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"xs", "=", "10"}], ",", 
     RowBox[{"nsamples", "=", "50000"}]}], "}"}], ",", "\[IndentingNewLine]", 
   
   RowBox[{"BlockRandom", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "49038", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "ts", ",", "Fv", ",", "xsamples", ",", "xbins", ",", "xhist"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"sample", " ", "in", " ", "velocity", " ", "space"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ts", "=", 
         RowBox[{"Array", "[", 
          RowBox[{"N", ",", "10000", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"xs", "<", "5"}], ",", "xs", ",", "5"}], "]"}]}], ",",
              "5"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Fv", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"ts", "+", 
              RowBox[{"2", "xs"}]}], ")"}]}], 
           RowBox[{"Exp", "[", 
            RowBox[{"-", 
             RowBox[{"ts", "^", "2"}]}], "]"}]}], "+", 
          RowBox[{
           SqrtBox["\[Pi]"], 
           RowBox[{"(", 
            RowBox[{".5", "+", 
             RowBox[{"xs", "^", "2"}]}], ")"}], 
           RowBox[{"Erf", "[", "ts", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"xsamples", "=", 
         RowBox[{
          RowBox[{"Interpolation", "[", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"Fv", ",", 
              RowBox[{"ts", "+", "xs"}]}], "}"}], "]"}], "]"}], "[", 
          RowBox[{"RandomReal", "[", 
           RowBox[{
            RowBox[{"MinMax", "[", "Fv", "]"}], ",", "nsamples"}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"xbins", ",", "xhist"}], "}"}], "=", 
         RowBox[{"N", "@", 
          RowBox[{"HistogramList", "[", 
           RowBox[{
            RowBox[{"xsamples", "-", "xs"}], ",", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"xs", "<", "5"}], ",", "xs", ",", "5"}], "]"}]}], 
                ",", "5"}], "}"}], ",", ".1"}], "]"}], ",", "\"\<Count\>\""}],
            "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xbins", "=", 
         RowBox[{"Flatten", "[", "xbins", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xhist", "/=", 
         RowBox[{"nsamples", " ", 
          RowBox[{"Apply", "[", 
           RowBox[{"Subtract", ",", 
            RowBox[{"xbins", "[", 
             RowBox[{"[", 
              RowBox[{"{", 
               RowBox[{"2", ",", "1"}], "}"}], "]"}], "]"}]}], "]"}]}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Divide", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"-", 
                 RowBox[{"t", "^", "2"}]}], "]"}], 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"t", "+", "xs"}], ")"}], "^", "2"}]}], ",", 
              RowBox[{".5", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"xs", " ", 
                  RowBox[{"Exp", "[", 
                   RowBox[{"-", 
                    RowBox[{"xs", "^", "2"}]}], "]"}]}], "+", 
                 RowBox[{
                  SqrtBox["\[Pi]"], 
                  RowBox[{"(", 
                   RowBox[{".5", "+", 
                    RowBox[{"xs", "^", "2"}]}], ")"}], 
                  RowBox[{"Erfc", "[", 
                   RowBox[{"-", "xs"}], "]"}]}]}], ")"}]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", 
              RowBox[{"-", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"xs", "<", "5"}], ",", "xs", ",", "5"}], "]"}]}], 
              ",", "5"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Thread", "[", 
              RowBox[{"Directive", "[", 
               RowBox[{"{", 
                RowBox[{"Black", ",", "Blue"}], "}"}], "]"}], "]"}]}]}], 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"xbins", ",", "2"}], "]"}], ",", "xhist"}], "}"}], 
             "]"}], ",", "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[19]:=",ExpressionUUID->"d3fdccbe-6b5b-40c4-b66b-ed8b88ac6f3d"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Zeta]", "=", "30"}], ",", 
     RowBox[{"accuracyGoal", "=", "10"}], ",", 
     RowBox[{"nsamples", "=", "50000"}]}], "}"}], ",", "\[IndentingNewLine]", 
   
   RowBox[{"BlockRandom", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SeedRandom", "[", "49038", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"(*", 
         RowBox[{"\[Alpha]lim", ",", "\[Alpha]s", ",", "F\[Alpha]", ","}], 
         "*)"}], 
        RowBox[{
        "\[CurlyPhi]lim", ",", "\[CurlyPhi]s", ",", "F\[CurlyPhi]", ",", 
         "\[Alpha]samples", ",", "\[Alpha]bins", ",", "\[Alpha]hist"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "sample", " ", "in", " ", "pitch", " ", "angle", " ", "space"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"\[Alpha]lim", "=", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "Pi"}], "}"}], "+", 
           RowBox[{
            RowBox[{"ArcSin", "[", 
             RowBox[{"Power", "[", 
              RowBox[{"10.", ",", 
               RowBox[{
                RowBox[{"-", "accuracyGoal"}], "/", 
                RowBox[{"(", 
                 RowBox[{"\[Zeta]", "+", "1"}], ")"}]}]}], "]"}], "]"}], 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "1"}]}], "}"}]}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Alpha]s", "=", 
          RowBox[{"Array", "[", 
           RowBox[{"N", ",", "10000", ",", "\[Alpha]lim"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"F\[Alpha]", "=", 
          RowBox[{
           RowBox[{"intSin\[Zeta]", "[", 
            RowBox[{"\[Zeta]", "+", "1"}], "]"}], "[", "\[Alpha]s", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"\[Alpha]samples", "=", 
          RowBox[{
           RowBox[{"Interpolation", "[", 
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"F\[Alpha]", ",", "\[Alpha]s"}], "}"}], "]"}], "]"}], 
           "[", 
           RowBox[{"RandomReal", "[", 
            RowBox[{
             RowBox[{"MinMax", "[", "F\[Alpha]", "]"}], ",", "nsamples"}], 
            "]"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[CurlyPhi]lim", "=", 
         RowBox[{
          RowBox[{"ArcCos", "[", 
           RowBox[{"Power", "[", 
            RowBox[{"10.", ",", 
             RowBox[{
              RowBox[{"-", "accuracyGoal"}], "/", 
              RowBox[{"(", 
               RowBox[{"\[Zeta]", "+", "1"}], ")"}]}]}], "]"}], "]"}], 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[CurlyPhi]s", "=", 
         RowBox[{"Array", "[", 
          RowBox[{"N", ",", "10000", ",", "\[CurlyPhi]lim"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"F\[CurlyPhi]", "=", 
         RowBox[{
          RowBox[{"intCos\[Zeta]", "[", 
           RowBox[{"\[Zeta]", "+", "1"}], "]"}], "[", "\[CurlyPhi]s", "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"\[Alpha]samples", "=", 
         RowBox[{
          RowBox[{"Interpolation", "[", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"F\[CurlyPhi]", ",", 
              RowBox[{"\[CurlyPhi]s", "+", 
               RowBox[{"Pi", "/", "2"}]}]}], "}"}], "]"}], "]"}], "[", 
          RowBox[{"RandomReal", "[", 
           RowBox[{
            RowBox[{"MinMax", "[", "F\[CurlyPhi]", "]"}], ",", "nsamples"}], 
           "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Alpha]bins", ",", "\[Alpha]hist"}], "}"}], "=", 
         RowBox[{"N", "@", 
          RowBox[{"HistogramList", "[", 
           RowBox[{"\[Alpha]samples", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "180"}], "}"}], ",", "2"}], "]"}], 
              "Degree"}], "//", "N"}], ",", "\"\<Count\>\""}], "]"}]}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"\[Alpha]bins", "=", 
         RowBox[{"Flatten", "[", "\[Alpha]bins", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Alpha]hist", "/=", 
         RowBox[{"nsamples", " ", 
          RowBox[{"Apply", "[", 
           RowBox[{"Subtract", ",", 
            RowBox[{"\[Alpha]bins", "[", 
             RowBox[{"[", 
              RowBox[{"{", 
               RowBox[{"2", ",", "1"}], "}"}], "]"}], "]"}]}], "]"}]}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Divide", "[", 
             RowBox[{
              RowBox[{"Power", "[", 
               RowBox[{
                RowBox[{"Sin", "[", "\[Alpha]", "]"}], ",", 
                RowBox[{"\[Zeta]", "+", "1"}]}], "]"}], ",", 
              RowBox[{
               SqrtBox["\[Pi]"], 
               RowBox[{
                RowBox[{"Gamma", "[", 
                 RowBox[{"1", "+", 
                  RowBox[{".5", "\[Zeta]"}]}], "]"}], "/", 
                RowBox[{"Gamma", "[", 
                 RowBox[{"1.5", "+", 
                  RowBox[{".5", "\[Zeta]"}]}], "]"}]}]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Alpha]", ",", "0", ",", "Pi"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Thread", "[", 
              RowBox[{"Directive", "[", 
               RowBox[{"{", 
                RowBox[{"Black", ",", "Blue"}], "}"}], "]"}], "]"}]}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"\[Alpha]bins", ",", "2"}], "]"}], ",", 
               "\[Alpha]hist"}], "}"}], "]"}], ",", "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellLabel->"In[20]:=",ExpressionUUID->"e1975498-8e3a-4210-8980-2defcf9276af"],

Cell[CellGroupData[{

Cell["Tests", "Subsubsection",ExpressionUUID->"9d21d2a4-ae89-4a87-81c9-e16091ae4ba7"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Beta]", "=", ".1"}], 
     RowBox[{"(*", 
      RowBox[{"\[Theta]", "^", "2"}], "*)"}], ",", 
     RowBox[{"q1lim", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "7"}], ",", "15"}], "}"}]}], ",", 
     RowBox[{"\[CapitalDelta]1", "=", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Get", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<~/Downloads\>\"", ",", 
          "\"\<RelativisticPartialShellVDF-homogeneous-maxwellian.m\>\""}], 
         "}"}], "]"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "vel", ",", "pos", ",", "q1s", ",", "\[Eta]s", ",", "binpos", ",", 
       "histpos", ",", "binv1", ",", "histv1", ",", "binv2", ",", "histv2", 
       ",", "binv3", ",", "histv3"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"q1s", "=", 
       RowBox[{"Range", "@@", "q1lim"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]s", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"1.", ",", 
         RowBox[{"Length", "[", "q1s", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vel", "=", 
       RowBox[{
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "/", 
        SqrtBox["\[Beta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"Join", "@@", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binpos", ",", "histpos"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"pos", ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"q1lim", "+", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"+", ".5"}], ",", 
              RowBox[{"-", ".5"}]}], "}"}]}], ",", "1"}], "]"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binv1", ",", "histv1"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"vel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3"}], ",", "3", ",", ".1"}], "}"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binv2", ",", "histv2"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"vel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3"}], ",", "3", ",", ".1"}], "}"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binv3", ",", "histv3"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"vel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3"}], ",", "3", ",", ".1"}], "}"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"q1s", ",", "\[Eta]s"}], "}"}], "]"}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binpos", ",", "2"}], "]"}], ",", 
               RowBox[{"histpos", "/", 
                RowBox[{"Max", "[", "histpos", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{"v", "^", "2"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"v", ",", 
              RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binv1", ",", "2"}], "]"}], ",", 
               RowBox[{"histv1", "/", 
                RowBox[{"Max", "[", "histv1", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{"v", "^", "2"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"v", ",", 
              RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binv2", ",", "2"}], "]"}], ",", 
               RowBox[{"histv2", "/", 
                RowBox[{"Max", "[", "histv2", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{"v", "^", "2"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"v", ",", 
              RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binv3", ",", "2"}], "]"}], ",", 
               RowBox[{"histv3", "/", 
                RowBox[{"Max", "[", "histv3", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}]}], "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",ExpressionUUID->"21197dfb-\
7f49-451c-bee8-e5b6181d7b9c"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Beta]", "=", 
      RowBox[{".1", "*", "2.1"}]}], 
     RowBox[{"(*", 
      RowBox[{"\[Theta]", "^", "2"}], "*)"}], ",", 
     RowBox[{"\[Zeta]", "=", "0"}], ",", 
     RowBox[{"vs", "=", "10"}], ",", 
     RowBox[{"q1lim", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "7"}], ",", "15"}], "}"}]}], ",", 
     RowBox[{"\[CapitalDelta]1", "=", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Get", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<~/Downloads\>\"", ",", 
          "\"\<RelativisticPartialShellVDF-homogeneous-isotropic_shell.m\>\""}\
], "}"}], "]"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "xs", ",", "vel", ",", "pos", ",", "q1s", ",", "\[Eta]s", ",", "v", ",",
        "\[Alpha]", ",", "\[Phi]", ",", "binpos", ",", "histpos", ",", "binv",
        ",", "histv", ",", "bin\[Alpha]", ",", "hist\[Alpha]", ",", 
       "bin\[Phi]", ",", "hist\[Phi]"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xs", "=", 
       RowBox[{"vs", "/", 
        SqrtBox["\[Beta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"q1s", "=", 
       RowBox[{"Range", "@@", "q1lim"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]s", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"1.", ",", 
         RowBox[{"Length", "[", "q1s", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vel", "=", 
       RowBox[{
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "/", 
        SqrtBox["\[Beta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"Join", "@@", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"Norm", "/@", "vel"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Alpha]", "=", 
       RowBox[{"ArcCos", "[", 
        RowBox[{
         RowBox[{"vel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "/", "v"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Phi]", "=", 
       RowBox[{"ArcTan", "@@@", 
        RowBox[{"Map", "[", 
         RowBox[{"Rest", ",", "vel"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binpos", ",", "histpos"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"pos", ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"q1lim", "+", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"+", ".5"}], ",", 
              RowBox[{"-", ".5"}]}], "}"}]}], ",", "1"}], "]"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binv", ",", "histv"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"v", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"xs", "<", "3"}], ",", "0", ",", 
             RowBox[{"xs", "-", "3"}]}], "]"}], ",", 
           RowBox[{"xs", "+", "3"}], ",", ".1"}], "}"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"histv", "/=", 
         RowBox[{
          RowBox[{"MovingAverage", "[", 
           RowBox[{"binv", ",", "2"}], "]"}], "^", "2"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"bin\[Alpha]", ",", "hist\[Alpha]"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"\[Alpha]", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "\[Pi]", ",", 
           RowBox[{"4.", "Degree"}]}], "}"}], ",", "\"\<Count\>\""}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"bin\[Phi]", ",", "hist\[Phi]"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"\[Phi]", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], ",", "\[Pi]", ",", 
           RowBox[{"8.", "Degree"}]}], "}"}], ",", "\"\<Count\>\""}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"q1s", ",", "\[Eta]s"}], "}"}], "]"}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binpos", ",", "2"}], "]"}], ",", 
               RowBox[{"histpos", "/", 
                RowBox[{"Max", "[", "histpos", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Divide", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"x", "-", "xs"}], ")"}], "^", "2"}]}], "]"}], 
               RowBox[{"x", "^", "2"}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"xs", "+", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"4", "+", 
                    RowBox[{"xs", "^", "2"}]}], "]"}]}], ")"}], "^", "2"}], 
               "/", 
               RowBox[{"(", 
                RowBox[{"4", "*", 
                 RowBox[{"E", "^", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"xs", "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"4", "+", 
                    RowBox[{"xs", "^", "2"}]}], "]"}]}], ")"}], "^", "2"}], 
                    "/", "4"}], ")"}]}]}], ")"}]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"xs", "<", "3"}], ",", "0", ",", 
                RowBox[{"xs", "-", "3"}]}], "]"}], ",", 
              RowBox[{"xs", "+", "3"}]}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binv", ",", "2"}], "]"}], ",", 
               RowBox[{"histv", "/", 
                RowBox[{"Max", "[", "histv", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", "x", "]"}], "^", 
             RowBox[{"(", 
              RowBox[{"\[Zeta]", "+", "1"}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"bin\[Alpha]", ",", "2"}], "]"}], ",", 
               RowBox[{"hist\[Alpha]", "/", 
                RowBox[{"Max", "[", "hist\[Alpha]", "]"}]}]}], "}"}], "]"}], 
            ",", "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"bin\[Phi]", ",", "2"}], "]"}], ",", 
               RowBox[{"hist\[Phi]", "/", 
                RowBox[{"Max", "[", "hist\[Phi]", "]"}]}]}], "}"}], "]"}], 
            ",", "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}]}], "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",ExpressionUUID->"283690ef-\
b8ba-418b-8363-2ec7b132ee70"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Beta]", "=", 
      RowBox[{".1", "*", "2.1"}]}], 
     RowBox[{"(*", 
      RowBox[{"\[Theta]", "^", "2"}], "*)"}], ",", 
     RowBox[{"\[Zeta]", "=", "30"}], ",", 
     RowBox[{"vs", "=", "10"}], ",", 
     RowBox[{"q1lim", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "7"}], ",", "15"}], "}"}]}], ",", 
     RowBox[{"\[CapitalDelta]1", "=", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Get", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<~/Downloads\>\"", ",", 
          "\"\<RelativisticPartialShellVDF-homogeneous-anisotropic_shell.m\>\"\
"}], "}"}], "]"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "xs", ",", "vel", ",", "pos", ",", "q1s", ",", "\[Eta]s", ",", "v", ",",
        "\[Alpha]", ",", "\[Phi]", ",", "binpos", ",", "histpos", ",", "binv",
        ",", "histv", ",", "bin\[Alpha]", ",", "hist\[Alpha]", ",", 
       "bin\[Phi]", ",", "hist\[Phi]"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xs", "=", 
       RowBox[{"vs", "/", 
        SqrtBox["\[Beta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"q1s", "=", 
       RowBox[{"Range", "@@", "q1lim"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]s", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"1.", ",", 
         RowBox[{"Length", "[", "q1s", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vel", "=", 
       RowBox[{
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "/", 
        SqrtBox["\[Beta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"Join", "@@", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"Norm", "/@", "vel"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Alpha]", "=", 
       RowBox[{"ArcCos", "[", 
        RowBox[{
         RowBox[{"vel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "/", "v"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Phi]", "=", 
       RowBox[{"ArcTan", "@@@", 
        RowBox[{"Map", "[", 
         RowBox[{"Rest", ",", "vel"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binpos", ",", "histpos"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"pos", ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"q1lim", "+", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"+", ".5"}], ",", 
              RowBox[{"-", ".5"}]}], "}"}]}], ",", "1"}], "]"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binv", ",", "histv"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"v", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"xs", "<", "3"}], ",", "0", ",", 
             RowBox[{"xs", "-", "3"}]}], "]"}], ",", 
           RowBox[{"xs", "+", "3"}], ",", ".1"}], "}"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"histv", "/=", 
         RowBox[{
          RowBox[{"MovingAverage", "[", 
           RowBox[{"binv", ",", "2"}], "]"}], "^", "2"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"bin\[Alpha]", ",", "hist\[Alpha]"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"\[Alpha]", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "\[Pi]", ",", 
           RowBox[{"4.", "Degree"}]}], "}"}], ",", "\"\<Count\>\""}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"bin\[Phi]", ",", "hist\[Phi]"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"\[Phi]", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], ",", "\[Pi]", ",", 
           RowBox[{"8.", "Degree"}]}], "}"}], ",", "\"\<Count\>\""}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"q1s", ",", "\[Eta]s"}], "}"}], "]"}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binpos", ",", "2"}], "]"}], ",", 
               RowBox[{"histpos", "/", 
                RowBox[{"Max", "[", "histpos", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Divide", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"x", "-", "xs"}], ")"}], "^", "2"}]}], "]"}], 
               RowBox[{"x", "^", "2"}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"xs", "+", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"4", "+", 
                    RowBox[{"xs", "^", "2"}]}], "]"}]}], ")"}], "^", "2"}], 
               "/", 
               RowBox[{"(", 
                RowBox[{"4", "*", 
                 RowBox[{"E", "^", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"xs", "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"4", "+", 
                    RowBox[{"xs", "^", "2"}]}], "]"}]}], ")"}], "^", "2"}], 
                    "/", "4"}], ")"}]}]}], ")"}]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"xs", "<", "3"}], ",", "0", ",", 
                RowBox[{"xs", "-", "3"}]}], "]"}], ",", 
              RowBox[{"xs", "+", "3"}]}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binv", ",", "2"}], "]"}], ",", 
               RowBox[{"histv", "/", 
                RowBox[{"Max", "[", "histv", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", "x", "]"}], "^", 
             RowBox[{"(", 
              RowBox[{"\[Zeta]", "+", "1"}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"bin\[Alpha]", ",", "2"}], "]"}], ",", 
               RowBox[{"hist\[Alpha]", "/", 
                RowBox[{"Max", "[", "hist\[Alpha]", "]"}]}]}], "}"}], "]"}], 
            ",", "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"bin\[Phi]", ",", "2"}], "]"}], ",", 
               RowBox[{"hist\[Phi]", "/", 
                RowBox[{"Max", "[", "hist\[Phi]", "]"}]}]}], "}"}], "]"}], 
            ",", "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}]}], "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",ExpressionUUID->"5a481b24-\
319e-4478-818d-f6f1d0cf10a6"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Beta]", "=", ".1"}], 
     RowBox[{"(*", 
      RowBox[{"\[Theta]", "^", "2"}], "*)"}], ",", 
     RowBox[{"q1lim", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "7"}], ",", "15"}], "}"}]}], ",", 
     RowBox[{"\[CapitalDelta]1", "=", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Get", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<~/Downloads\>\"", ",", 
          "\"\<RelativisticPartialShellVDF-inhomogeneous-maxwellian.m\>\""}], 
         "}"}], "]"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "vel", ",", "pos", ",", "q1s", ",", "\[Eta]s", ",", "binpos", ",", 
       "histpos", ",", "binv1", ",", "histv1", ",", "binv2", ",", "histv2", 
       ",", "binv3", ",", "histv3"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"q1s", "=", 
       RowBox[{"Range", "@@", "q1lim"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]s", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"1.", ",", 
         RowBox[{"Length", "[", "q1s", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vel", "=", 
       RowBox[{
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "/", 
        SqrtBox["\[Beta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"Join", "@@", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binpos", ",", "histpos"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"pos", ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"q1lim", "+", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"+", ".5"}], ",", 
              RowBox[{"-", ".5"}]}], "}"}]}], ",", "1"}], "]"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binv1", ",", "histv1"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"vel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3"}], ",", "3", ",", ".1"}], "}"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binv2", ",", "histv2"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"vel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3"}], ",", "3", ",", ".1"}], "}"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binv3", ",", "histv3"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{
         RowBox[{"vel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "3"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3"}], ",", "3", ",", ".1"}], "}"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"q1s", ",", "\[Eta]s"}], "}"}], "]"}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binpos", ",", "2"}], "]"}], ",", 
               RowBox[{"histpos", "/", 
                RowBox[{"Max", "[", "histpos", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{"v", "^", "2"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"v", ",", 
              RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binv1", ",", "2"}], "]"}], ",", 
               RowBox[{"histv1", "/", 
                RowBox[{"Max", "[", "histv1", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{"v", "^", "2"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"v", ",", 
              RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binv2", ",", "2"}], "]"}], ",", 
               RowBox[{"histv2", "/", 
                RowBox[{"Max", "[", "histv2", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{"v", "^", "2"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"v", ",", 
              RowBox[{"-", "3"}], ",", "3"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binv3", ",", "2"}], "]"}], ",", 
               RowBox[{"histv3", "/", 
                RowBox[{"Max", "[", "histv3", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}]}], "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",ExpressionUUID->"2d8bf62b-\
2234-4851-9a31-d51978660bae"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Beta]", "=", 
      RowBox[{".1", "*", "2.1"}]}], 
     RowBox[{"(*", 
      RowBox[{"\[Theta]", "^", "2"}], "*)"}], ",", 
     RowBox[{"\[Zeta]", "=", "10"}], ",", 
     RowBox[{"vs", "=", "2"}], ",", 
     RowBox[{"q1lim", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "7"}], ",", "15"}], "}"}]}], ",", 
     RowBox[{"\[Xi]", "=", ".876"}], ",", 
     RowBox[{"\[Xi]\[CapitalDelta]1q1max", "=", 
      RowBox[{
       RowBox[{"Pi", "/", "2"}], "*", ".8"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Get", "[", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<~/Downloads\>\"", ",", 
          "\"\<RelativisticPartialShellVDF-inhomogeneous-anisotropic_shell.m\>\
\""}], "}"}], "]"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[CapitalDelta]1", ",", "xs", ",", "vel", ",", "pos", ",", "q1s", ",", 
       "\[Eta]s", ",", "v", ",", "\[Alpha]", ",", "\[Phi]", ",", "binpos", 
       ",", "histpos", ",", "binv", ",", "histv", ",", "bin\[Alpha]", ",", 
       "hist\[Alpha]", ",", "bin\[Phi]", ",", "hist\[Phi]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[CapitalDelta]1", "=", 
       RowBox[{"\[Xi]\[CapitalDelta]1q1max", "/", 
        RowBox[{"(", 
         RowBox[{"\[Xi]", " ", 
          RowBox[{"Max", "[", 
           RowBox[{"Abs", "[", "q1lim", "]"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xs", "=", 
       RowBox[{"vs", "/", 
        SqrtBox["\[Beta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"q1s", "=", 
       RowBox[{"Range", "@@", "q1lim"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Eta]s", "=", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1s"}], "]"}], ",", 
         "\[Zeta]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vel", "=", 
       RowBox[{
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], "/", 
        SqrtBox["\[Beta]"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pos", "=", 
       RowBox[{"Join", "@@", 
        RowBox[{"data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"Norm", "/@", "vel"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Alpha]", "=", 
       RowBox[{"ArcCos", "[", 
        RowBox[{
         RowBox[{"vel", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "/", "v"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Phi]", "=", 
       RowBox[{"ArcTan", "@@@", 
        RowBox[{"Map", "[", 
         RowBox[{"Rest", ",", "vel"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binpos", ",", "histpos"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"pos", ",", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"q1lim", "+", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"+", ".5"}], ",", 
              RowBox[{"-", ".5"}]}], "}"}]}], ",", ".5"}], "]"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"binv", ",", "histv"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"v", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"xs", "<", "3"}], ",", "0", ",", 
             RowBox[{"xs", "-", "3"}]}], "]"}], ",", 
           RowBox[{"xs", "+", "3"}], ",", ".1"}], "}"}], ",", 
         "\"\<Count\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"histv", "/=", 
         RowBox[{
          RowBox[{"MovingAverage", "[", 
           RowBox[{"binv", ",", "2"}], "]"}], "^", "2"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"bin\[Alpha]", ",", "hist\[Alpha]"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"\[Alpha]", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "\[Pi]", ",", 
           RowBox[{"4.", "Degree"}]}], "}"}], ",", "\"\<Count\>\""}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"bin\[Phi]", ",", "hist\[Phi]"}], "}"}], "=", 
       RowBox[{"HistogramList", "[", 
        RowBox[{"\[Phi]", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "\[Pi]"}], ",", "\[Pi]", ",", 
           RowBox[{"8.", "Degree"}]}], "}"}], ",", "\"\<Count\>\""}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"q1s", ",", "\[Eta]s"}], "}"}], "]"}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binpos", ",", "2"}], "]"}], ",", 
               RowBox[{"histpos", "/", 
                RowBox[{"Max", "[", "histpos", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"Divide", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Exp", "[", 
                RowBox[{"-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"x", "-", "xs"}], ")"}], "^", "2"}]}], "]"}], 
               RowBox[{"x", "^", "2"}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"xs", "+", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"4", "+", 
                    RowBox[{"xs", "^", "2"}]}], "]"}]}], ")"}], "^", "2"}], 
               "/", 
               RowBox[{"(", 
                RowBox[{"4", "*", 
                 RowBox[{"E", "^", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"xs", "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"4", "+", 
                    RowBox[{"xs", "^", "2"}]}], "]"}]}], ")"}], "^", "2"}], 
                    "/", "4"}], ")"}]}]}], ")"}]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"xs", "<", "3"}], ",", "0", ",", 
                RowBox[{"xs", "-", "3"}]}], "]"}], ",", 
              RowBox[{"xs", "+", "3"}]}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"binv", ",", "2"}], "]"}], ",", 
               RowBox[{"histv", "/", 
                RowBox[{"Max", "[", "histv", "]"}]}]}], "}"}], "]"}], ",", 
            "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sin", "[", "x", "]"}], "^", 
             RowBox[{"(", 
              RowBox[{"\[Zeta]", "+", "1"}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"bin\[Alpha]", ",", "2"}], "]"}], ",", 
               RowBox[{"hist\[Alpha]", "/", 
                RowBox[{"Max", "[", "hist\[Alpha]", "]"}]}]}], "}"}], "]"}], 
            ",", "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", "Black", "]"}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ListStepPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{"bin\[Phi]", ",", "2"}], "]"}], ",", 
               RowBox[{"hist\[Phi]", "/", 
                RowBox[{"Max", "[", "hist\[Phi]", "]"}]}]}], "}"}], "]"}], 
            ",", "Center", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"Red", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}]}], "]"}]}]}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "\[IndentingNewLine]", 
         "]"}]}], "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",ExpressionUUID->"29faedd3-\
642d-4316-86c9-6cff0c108c88"]
}, Open  ]]
}, Closed]]
}, Closed]]
},
WindowSize->{1303, 1080},
WindowMargins->{{600, Automatic}, {Automatic, 40}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
FrontEndVersion->"13.0 for Mac OS X x86 (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"e8ddc0c6-636d-4b5e-aeb3-842be453f1fc"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[400, 13, 174, 3, 35, "Text",ExpressionUUID->"ea49810a-19a0-408a-9574-e6115b0b72c3"],
Cell[CellGroupData[{
Cell[599, 20, 107, 0, 67, "Section",ExpressionUUID->"aed77aa3-6cc7-4cce-92c0-733cd30fbc93"],
Cell[709, 22, 3481, 103, 276, "Text",ExpressionUUID->"cd9f94c7-844a-4993-9c99-897580e19880"],
Cell[CellGroupData[{
Cell[4215, 129, 112, 0, 54, "Subsection",ExpressionUUID->"c8f5f4e6-12a3-4acf-9719-fb5d95658b0a"],
Cell[4330, 131, 17030, 534, 800, "Text",ExpressionUUID->"db1d95a5-d8b6-41cc-9071-21953d181309"],
Cell[21363, 667, 16931, 528, 720, "Text",ExpressionUUID->"145932c4-25a7-4a16-8bcc-38d7898d5314"],
Cell[38297, 1197, 10777, 268, 737, "Input",ExpressionUUID->"126a70e9-55b4-470a-be84-76d6e335a719"],
Cell[49077, 1467, 10447, 265, 961, "Input",ExpressionUUID->"0546f177-4ef3-4eef-83c3-bd089f300fc9"],
Cell[59527, 1734, 13003, 326, 1186, "Input",ExpressionUUID->"03315541-ef4a-452b-bb88-58f740724e46"]
}, Closed]],
Cell[CellGroupData[{
Cell[72567, 2065, 108, 0, 38, "Subsection",ExpressionUUID->"bcafc670-df21-4216-80de-00b62fb5c091"],
Cell[72678, 2067, 21231, 654, 891, "Text",ExpressionUUID->"eca842dc-7fb9-4f5b-bdd2-096c455c68bf"],
Cell[93912, 2723, 21852, 672, 1017, "Text",ExpressionUUID->"48b9b2b4-dc90-4208-8b92-d3a2f8504f03"],
Cell[115767, 3397, 16387, 400, 870, "Input",ExpressionUUID->"00fd0186-4b7a-46cf-91ce-a7b00623ed4c"],
Cell[132157, 3799, 9370, 236, 877, "Input",ExpressionUUID->"fb36ed3c-9923-4026-ab72-299f5e035ccb"],
Cell[141530, 4037, 13033, 326, 1186, "Input",ExpressionUUID->"f4611cd8-4e7e-46b6-9ab9-dcb45fa32a71"],
Cell[154566, 4365, 10732, 269, 1027, "Input",ExpressionUUID->"6ca1c9d6-8628-4b23-90fa-47b77de4ac9d"],
Cell[165301, 4636, 13251, 326, 1083, "Input",ExpressionUUID->"c7382360-735d-4d71-b542-1b74707f219a"]
}, Closed]],
Cell[CellGroupData[{
Cell[178589, 4967, 112, 0, 38, "Subsection",ExpressionUUID->"a79946d6-a6ef-47ab-a449-4289d75f19d7"],
Cell[178704, 4969, 7046, 227, 404, "Text",ExpressionUUID->"1c016d35-f8cb-48bc-b17e-eb0e1794c348"],
Cell[185753, 5198, 11309, 351, 648, "Text",ExpressionUUID->"c8619530-cffc-49d9-a414-2b4472980770"],
Cell[197065, 5551, 20537, 616, 989, "Text",ExpressionUUID->"1838a2fc-860a-45c7-b4dd-ec73ba19c430"],
Cell[217605, 6169, 1375, 38, 136, "Input",ExpressionUUID->"021145a4-f188-4d61-94d7-0d4bca61c0a6"],
Cell[218983, 6209, 1283, 35, 136, "Input",ExpressionUUID->"3fbebd37-b580-46a8-9b11-5067dcbd1fac"],
Cell[220269, 6246, 8733, 211, 645, "Input",ExpressionUUID->"b2582bcb-60a2-4b53-9b81-9c28ffe0c993"],
Cell[229005, 6459, 5530, 143, 500, "Input",ExpressionUUID->"64ab311a-1d6f-45ee-8161-2c391b217cdb"],
Cell[234538, 6604, 6887, 169, 577, "Input",ExpressionUUID->"ead2b353-21bd-411f-9466-c2d97354cb86"],
Cell[CellGroupData[{
Cell[241450, 6777, 85, 0, 45, "Subsubsection",ExpressionUUID->"70841a10-3db4-47b9-b70d-f4a75c68a2f1"],
Cell[241538, 6779, 9259, 235, 877, "Input",ExpressionUUID->"7732ce3e-3ea1-460b-b7f8-d976506c3ee8"],
Cell[250800, 7016, 9262, 235, 877, "Input",ExpressionUUID->"1c98f360-241d-4176-8c56-0eeec0b5b087"],
Cell[260065, 7253, 11410, 287, 1010, "Input",ExpressionUUID->"166719f9-99f8-42f4-821f-b1c5dcbca1a7"],
Cell[271478, 7542, 11412, 287, 1010, "Input",ExpressionUUID->"9383b115-aedd-43b7-89d2-cec33ab6cfa4"],
Cell[282893, 7831, 10779, 269, 912, "Input",ExpressionUUID->"909c1085-f6b8-41fc-89ed-ecc49be7e07c"],
Cell[293675, 8102, 11259, 281, 933, "Input",ExpressionUUID->"6f6cf877-bd9a-421f-b040-b27215548fcf"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[304995, 8390, 103, 0, 67, "Section",ExpressionUUID->"3a2f3f03-010c-4259-ac9a-57cd6420668a"],
Cell[305101, 8392, 3965, 115, 300, "Text",ExpressionUUID->"41308e1d-057b-4c49-9f5a-b69e8d1c2bf0"],
Cell[CellGroupData[{
Cell[309091, 8511, 112, 0, 54, "Subsection",ExpressionUUID->"7eb99061-5739-43ef-80df-f5f33625f269"],
Cell[309206, 8513, 17032, 534, 796, "Text",ExpressionUUID->"5996d028-bdb2-468b-995d-b5e52731eaba"],
Cell[326241, 9049, 16931, 528, 720, "Text",ExpressionUUID->"5547af95-be09-49e0-8f17-2e3caebc813c"],
Cell[343175, 9579, 10776, 268, 737, "Input",ExpressionUUID->"f58e144f-42ce-4fbf-9954-b67fee102edf"],
Cell[353954, 9849, 3330, 86, 415, "Input",ExpressionUUID->"25186245-ad4f-4e22-b162-c988f29e4fa7"],
Cell[357287, 9937, 6907, 172, 522, "Input",ExpressionUUID->"a2842d75-03fa-4725-b756-f7483ace4b47"],
Cell[CellGroupData[{
Cell[364219, 10113, 84, 0, 45, "Subsubsection",ExpressionUUID->"8e3cbe3b-0927-4fbd-ad39-2ee57bb68a15"],
Cell[364306, 10115, 14879, 387, 1102, "Input",ExpressionUUID->"a4a386eb-cb8b-4d9c-971f-9a31a81d0e81"],
Cell[379188, 10504, 18061, 462, 1438, "Input",ExpressionUUID->"73fa9a0b-af93-4df2-ad89-3bf4da649ec3"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[397298, 10972, 108, 0, 38, "Subsection",ExpressionUUID->"cca306bd-cb81-4c1e-b53a-bfebabd883cd"],
Cell[397409, 10974, 21238, 654, 887, "Text",ExpressionUUID->"1eaf0274-070c-489e-ac6e-8f10f918948f"],
Cell[418650, 11630, 21852, 672, 1017, "Text",ExpressionUUID->"c1d88d36-6e67-4984-9c06-d3caad2e1bbe"],
Cell[440505, 12304, 16388, 400, 870, "Input",ExpressionUUID->"972536e8-0b73-4bea-92a4-c3b84d0e35be"],
Cell[456896, 12706, 4398, 117, 394, "Input",ExpressionUUID->"f5bdbbae-9dd1-4913-bfb3-f8eaf0131458"],
Cell[461297, 12825, 9839, 243, 638, "Input",ExpressionUUID->"aea04e1b-4560-4e82-a7f0-e0765fac9eb0"],
Cell[CellGroupData[{
Cell[471161, 13072, 84, 0, 45, "Subsubsection",ExpressionUUID->"5e4091a0-ac76-4799-a069-0bbf92fd7f0d"],
Cell[471248, 13074, 15112, 393, 1102, "Input",ExpressionUUID->"50d6a75a-7c5f-427c-9ee1-7c51cd2443cb"],
Cell[486363, 13469, 18139, 464, 1438, "Input",ExpressionUUID->"a164e8e1-4371-4c55-a3af-45fc66d6e682"],
Cell[504505, 13935, 8396, 215, 740, "Input",ExpressionUUID->"56bfef82-88e5-46c5-9e60-77f177feccb0"],
Cell[512904, 14152, 12938, 322, 971, "Input",ExpressionUUID->"e09997f8-8de3-4130-b74e-7ad02f6de643"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[525891, 14480, 112, 0, 54, "Subsection",ExpressionUUID->"686f3a9f-3478-42d1-80c9-544f05ccde4f"],
Cell[526006, 14482, 7924, 258, 529, "Text",ExpressionUUID->"6dffd9a3-950c-498f-abea-fc58de7fa60f"],
Cell[533933, 14742, 17583, 533, 902, "Text",ExpressionUUID->"ef49d603-be53-4cb6-8baf-cd0c6e93b258"],
Cell[551519, 15277, 1379, 39, 136, "Input",ExpressionUUID->"1a2e99cc-0f31-429a-a4ee-fcccefe032d5"],
Cell[552901, 15318, 1283, 35, 136, "Input",ExpressionUUID->"43335b99-b3aa-4fe3-9378-74d0b58af4ae"],
Cell[554187, 15355, 8733, 211, 645, "Input",ExpressionUUID->"6170488c-ab21-42a7-80b1-9a11433b8c0d"],
Cell[562923, 15568, 5530, 143, 500, "Input",ExpressionUUID->"d3fdccbe-6b5b-40c4-b66b-ed8b88ac6f3d"],
Cell[568456, 15713, 6887, 169, 577, "Input",ExpressionUUID->"e1975498-8e3a-4210-8980-2defcf9276af"],
Cell[CellGroupData[{
Cell[575368, 15886, 85, 0, 45, "Subsubsection",ExpressionUUID->"9d21d2a4-ae89-4a87-81c9-e16091ae4ba7"],
Cell[575456, 15888, 8676, 218, 779, "Input",ExpressionUUID->"21197dfb-7f49-451c-bee8-e5b6181d7b9c"],
Cell[584135, 16108, 10758, 269, 912, "Input",ExpressionUUID->"283690ef-b8ba-418b-8363-2ec7b132ee70"],
Cell[594896, 16379, 10761, 269, 912, "Input",ExpressionUUID->"5a481b24-319e-4478-818d-f6f1d0cf10a6"],
Cell[605660, 16650, 8678, 218, 779, "Input",ExpressionUUID->"2d8bf62b-2234-4851-9a31-d51978660bae"],
Cell[614341, 16870, 11240, 281, 933, "Input",ExpressionUUID->"29faedd3-642d-4316-86c9-6cff0c108c88"]
}, Open  ]]
}, Closed]]
}, Closed]]
}
]
*)

