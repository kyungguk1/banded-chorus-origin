(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    718963,      19753]
NotebookOptionsPosition[    702999,      19504]
NotebookOutlinePosition[    703448,      19522]
CellTagsIndexPosition[    703405,      19519]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Basic Equations", "Section",ExpressionUUID->"98f60438-238c-49f7-a2be-78fd60abd294"],

Cell[CellGroupData[{

Cell["In cgs unit system", "Subsection",ExpressionUUID->"60be49ab-8d81-409d-8bc9-7546a121a65e"],

Cell[TextData[{
 "Maxwell's equations:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[PartialD]", "\[DoubleStruckCapitalE]"}], "/", 
     RowBox[{"\[PartialD]", "t"}]}], "=", 
    RowBox[{
     RowBox[{"c", 
      RowBox[{"\[Del]", "\[Times]", "\[DoubleStruckCapitalB]"}]}], "-", 
     RowBox[{"4", "\[Pi]", 
      RowBox[{"\[Sum]", "\[DoubleStruckJ]"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"1f97031b-2d12-4686-9ae5-0d44827febfc"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[PartialD]", "\[DoubleStruckCapitalB]"}], "/", 
     RowBox[{"\[PartialD]", "t"}]}], "=", 
    RowBox[{
     RowBox[{"-", "c"}], 
     RowBox[{"\[Del]", "\[Times]", "\[DoubleStruckCapitalE]"}]}]}], 
   TraditionalForm]],ExpressionUUID->"88c25ca6-708c-4d7d-bad6-b9ea0b27f4a8"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Del]", "\[CenterDot]", "\[DoubleStruckCapitalE]"}], "=", 
    RowBox[{"4", "\[Pi]", " ", "\[Rho]"}]}], TraditionalForm]],ExpressionUUID->
  "0472f8d2-72b0-41a8-96ff-78cbe797e2e3"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Del]", "\[CenterDot]", "\[DoubleStruckCapitalB]"}], "=", "0"}],
    TraditionalForm]],ExpressionUUID->
  "6c8d9788-0766-4dd8-91aa-eb5bb4550adb"],
 ",\nwhere ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[DoubleStruckJ]", "=", 
    RowBox[{
     SubscriptBox["\[Sum]", "s"], 
     SubscriptBox["\[DoubleStruckJ]", "s"]}]}], TraditionalForm]],
  ExpressionUUID->"251f4995-21c4-4b5c-8983-f658eb3a604a"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Rho]", "=", 
    RowBox[{
     SubscriptBox["\[Sum]", "s"], 
     SubscriptBox["\[Rho]", "s"]}]}], TraditionalForm]],ExpressionUUID->
  "f33fbd5b-e9f5-4668-91d9-776fe15476a0"],
 "."
}], "Text",ExpressionUUID->"1dd6616b-e8f8-4544-b951-5a3556ea34ed"],

Cell[TextData[{
 "Continuity equation:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[Del]", "\[CenterDot]", 
      SubscriptBox["\[DoubleStruckJ]", "s"]}], "+", 
     RowBox[{
      RowBox[{"\[PartialD]", 
       SubscriptBox["\[Rho]", "s"]}], "/", 
      RowBox[{"\[PartialD]", "t"}]}]}], "=", "0"}], TraditionalForm]],
  ExpressionUUID->"9f8f385b-4bb0-4ec5-ac00-2a3223404ea6"],
 "."
}], "Text",ExpressionUUID->"ea9a4192-2aec-4b1d-9375-1e75ca196da4"],

Cell[TextData[{
 "Equations of motion (non-relativistic):\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[PartialD]", 
      SubscriptBox["\[DoubleStruckX]", "p"]}], "/", 
     RowBox[{"\[PartialD]", "t"}]}], "=", 
    SubscriptBox["\[DoubleStruckV]", "p"]}], TraditionalForm]],ExpressionUUID->
  "a08b66d6-62d5-494f-80f2-2fed880c43c1"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[PartialD]", 
      SubscriptBox["\[DoubleStruckV]", "p"]}], "/", 
     RowBox[{"\[PartialD]", "t"}]}], "=", 
    RowBox[{
     FractionBox[
      SubscriptBox["q", "s"], 
      RowBox[{
       SubscriptBox["m", "s"], "c"}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", "\[DoubleStruckCapitalE]"}], "+", 
       RowBox[{
        SubscriptBox["\[DoubleStruckV]", "p"], "\[Cross]", 
        "\[DoubleStruckCapitalB]"}]}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"873e64f8-4346-440f-8ea4-13994f415d2c"],
 ",\nwhere ",
 Cell[BoxData[
  FormBox["p", TraditionalForm]],ExpressionUUID->
  "8206badf-4989-4ef8-8115-c0b1a267b901"],
 " runs through the particles."
}], "Text",ExpressionUUID->"e928ad21-de0c-4bba-a819-0bfb41a39a27"],

Cell[TextData[{
 "Equations of motion (relativistic):\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[PartialD]", 
      SubscriptBox["\[DoubleStruckX]", "p"]}], "/", 
     RowBox[{"\[PartialD]", "t"}]}], "=", 
    SubscriptBox["\[DoubleStruckV]", "p"]}], TraditionalForm]],ExpressionUUID->
  "fedb157c-077c-432b-ae97-bb2e5dbb3be6"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[PartialD]", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["\[Gamma]", "p"], 
        SubscriptBox["\[DoubleStruckV]", "p"]}], ")"}]}], "/", 
     RowBox[{"\[PartialD]", "t"}]}], "=", 
    RowBox[{
     FractionBox[
      SubscriptBox["q", "s"], 
      RowBox[{
       SubscriptBox["m", "s"], "c"}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", "\[DoubleStruckCapitalE]"}], "+", 
       RowBox[{
        SubscriptBox["\[DoubleStruckV]", "p"], "\[Times]", 
        "\[DoubleStruckCapitalB]"}]}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"33f496f5-fdde-4011-89a8-9aee386c3ecf"],
 ",\nwhere ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["m", "s"], TraditionalForm]],ExpressionUUID->
  "6d43cb9e-8b4b-40fe-a509-739cf54493f9"],
 " is the rest mass of species and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Gamma]", "p"], TraditionalForm]],ExpressionUUID->
  "304018ff-bd7a-4161-94ca-be159ee33b2d"],
 " is the Lorentz factor given by\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Gamma]", "p"], "=", 
    RowBox[{"1", "/", 
     SqrtBox[
      RowBox[{"1", "-", 
       RowBox[{
        SubscriptBox["\[DoubleStruckV]", "p"], "\[CenterDot]", 
        RowBox[{
         SubscriptBox["\[DoubleStruckV]", "p"], "/", 
         SuperscriptBox["c", "2"]}]}]}]]}]}], TraditionalForm]],
  ExpressionUUID->"75f439b3-2fc5-4dcf-8dec-de4bd8fd246d"],
 ".\nDefine ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[DoubleStruckU]", "p"], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Gamma]", "p"], 
      SubscriptBox["\[DoubleStruckV]", "p"]}], "=", 
     RowBox[{
      RowBox[{"c", "/", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["c", "2"], "-", 
         RowBox[{
          SubscriptBox["\[DoubleStruckV]", "p"], "\[CenterDot]", 
          SubscriptBox["\[DoubleStruckV]", "p"]}]}]]}], 
      SubscriptBox["\[DoubleStruckV]", "p"]}]}]}], TraditionalForm]],
  ExpressionUUID->"5eced062-fbf7-4400-8896-11de7a467a04"],
 ", then ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[DoubleStruckV]", "p"], "=", 
    RowBox[{
     RowBox[{"c", "/", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["c", "2"], "+", 
        RowBox[{
         SubscriptBox["\[DoubleStruckU]", "p"], "\[CenterDot]", 
         SubscriptBox["\[DoubleStruckU]", "p"]}]}]]}], 
     SubscriptBox["\[DoubleStruckU]", "p"]}]}], TraditionalForm]],
  ExpressionUUID->"7cd4ccbf-4fd5-4136-bf2d-b4e420bbbb58"],
 ".\nTherefore, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Gamma]", "p"], "=", 
    SqrtBox[
     RowBox[{"1", "+", 
      RowBox[{
       SubscriptBox["\[DoubleStruckU]", "p"], "\[CenterDot]", 
       RowBox[{
        SubscriptBox["\[DoubleStruckU]", "p"], "/", 
        SuperscriptBox["c", "2"]}]}]}]]}], TraditionalForm]],ExpressionUUID->
  "a4668b4c-f62a-4d14-837a-c6e9aa721166"],
 ".\nRewriting the Lorentz force,\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[PartialD]", 
      SubscriptBox["\[DoubleStruckU]", "p"]}], "/", 
     RowBox[{"\[PartialD]", "t"}]}], "=", 
    RowBox[{
     RowBox[{
      FractionBox[
       SubscriptBox["q", "s"], 
       SubscriptBox["m", "s"]], 
      RowBox[{"(", 
       RowBox[{"\[DoubleStruckCapitalE]", "+", 
        RowBox[{
         SubscriptBox["\[DoubleStruckU]", "p"], "\[Times]", 
         RowBox[{"\[DoubleStruckCapitalB]", "/", 
          SubscriptBox["\[Gamma]", "p"]}]}]}], ")"}]}], "=", 
     RowBox[{
      FractionBox[
       SubscriptBox["q", "s"], 
       RowBox[{
        SubscriptBox["m", "s"], "c"}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", " ", "\[DoubleStruckCapitalE]"}], "+", 
        RowBox[{
         SubscriptBox["\[DoubleStruckU]", "p"], "\[Times]", 
         SubscriptBox["\[DoubleStruckCapitalB]", "p"]}]}], ")"}]}]}]}], 
   TraditionalForm]],ExpressionUUID->"67a6b5a2-006e-4fa2-bfad-5e0cd878a8ab"],
 ",\nwhere ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[DoubleStruckCapitalB]", "p"], "=", 
    RowBox[{"\[DoubleStruckCapitalB]", "/", 
     SubscriptBox["\[Gamma]", "p"]}]}], TraditionalForm]],ExpressionUUID->
  "c3b48520-b507-41f1-ae21-fa09cbdc09fa"],
 "."
}], "Text",ExpressionUUID->"10531d08-595c-4099-b84b-0cc8da1a8ca6"],

Cell[TextData[{
 "Energy density of fields:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"u", "=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"4", "\[Pi]"}]], 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        SuperscriptBox["\[DoubleStruckCapitalE]", "2"], "2"], "+", 
       FractionBox[
        SuperscriptBox["\[DoubleStruckCapitalB]", "2"], "2"]}], ")"}]}]}], 
   TraditionalForm]],ExpressionUUID->"571e4457-7727-4316-9d20-a294bda4dd0f"],
 ".\nKinetic energy density of particles of species, ",
 Cell[BoxData[
  FormBox["s", TraditionalForm]],ExpressionUUID->
  "f46c3cb9-7fcd-4dd9-a51d-25c0b977975e"],
 ":\nConsider there are ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["N", "s"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "42d5a078-691b-4d9a-90ea-b19191eb8c63"],
 " particles of species ",
 Cell[BoxData[
  FormBox["s", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "305ad988-761b-49ab-aed3-4517a5d07cd1"],
 " in a volume ",
 Cell[BoxData[
  FormBox["V", TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "6d66bfdf-1375-4ef8-bf82-7cae859360f9"],
 ".\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["w", "s"], "=", 
    RowBox[{
     RowBox[{
      FractionBox["1", "V"], 
      RowBox[{
       SubsuperscriptBox["\[Sum]", 
        RowBox[{"p", "=", "1"}], 
        SubscriptBox["N", "s"]], 
       FractionBox[
        RowBox[{
         SubscriptBox["m", "s"], 
         SubsuperscriptBox["\[DoubleStruckV]", "p", "2"]}], "2"]}]}], "=", 
     RowBox[{
      FractionBox[
       SubscriptBox["m", "s"], "2"], 
      FractionBox["1", "V"], 
      RowBox[{
       SubsuperscriptBox["\[Sum]", 
        RowBox[{"p", "=", "1"}], 
        SubscriptBox["N", "s"]], 
       SubsuperscriptBox["\[DoubleStruckV]", "p", "2"]}]}]}]}], 
   TraditionalForm]],ExpressionUUID->"e8d57656-4c9c-4d72-94a0-2f47488f0fd4"],
 ".\nFor a given velocity distribution ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["f", "s"], "(", 
    RowBox[{"\[DoubleStruckV]", ",", "\[DoubleStruckX]"}], ")"}], 
   TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "ae811d89-5943-409c-8865-4b73c40abc8d"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox["1", "V"], 
     RowBox[{
      SubsuperscriptBox["\[Sum]", 
       RowBox[{"p", "=", "1"}], 
       SubscriptBox["N", "s"]], 
      SubsuperscriptBox["\[DoubleStruckV]", "p", "2"]}]}], "=", 
    RowBox[{
     RowBox[{"\[Integral]", 
      RowBox[{
       SuperscriptBox["\[DoubleStruckV]", "2"], 
       RowBox[{
        SubscriptBox["f", "s"], "(", 
        RowBox[{"\[DoubleStruckV]", ",", "\[DoubleStruckX]"}], ")"}], 
       RowBox[{"\[DifferentialD]", "\[DoubleStruckV]"}]}]}], "=", 
     RowBox[{"\[LeftAngleBracket]", 
      SubsuperscriptBox["\[DoubleStruckV]", "s", "2"], 
      "\[RightAngleBracket]"}]}]}], TraditionalForm]],ExpressionUUID->
  "effbe52f-7ef0-4adf-b92a-64cce47003a9"],
 ".\nTotal particle kinetic energy density:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"w", "=", 
    RowBox[{
     SubscriptBox["\[Sum]", "s"], 
     SubscriptBox["w", "s"]}]}], TraditionalForm]],ExpressionUUID->
  "1ec37c13-70c0-4bbc-b217-bf99a6dc7518"],
 ".\nThen the total energy in the system is\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", "=", 
    RowBox[{
     SubscriptBox["\[Integral]", "V"], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"u", "+", "w"}], ")"}], 
      RowBox[{"\[DifferentialD]", "V"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"69e015ef-d5a5-4e28-9777-690dd6e8df34"],
 ".\n\nFor the relativistic case, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["E", "p", "2"], "=", 
    RowBox[{
     RowBox[{
      SubsuperscriptBox["\[Gamma]", "p", "2"], 
      SubsuperscriptBox["m", "s", "2"], 
      SuperscriptBox["c", "4"]}], "=", 
     RowBox[{
      RowBox[{
       SubsuperscriptBox["m", "s", "2"], 
       SuperscriptBox["c", "4"]}], "+", 
      RowBox[{
       SubsuperscriptBox["m", "s", "2"], 
       SubsuperscriptBox["\[DoubleStruckU]", "p", "2"], 
       SuperscriptBox["c", "2"]}]}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "dd45ccc1-23df-4e15-b8f6-fe562e36b68b"],
 ".\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[DoubleStruckP]", "s"], "=", 
    RowBox[{
     SubscriptBox["m", "s"], 
     FractionBox["1", "V"], 
     RowBox[{
      SubsuperscriptBox["\[Sum]", 
       RowBox[{"p", "=", "1"}], 
       SubscriptBox["N", "s"]], 
      SubscriptBox["\[DoubleStruckU]", "p"]}]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "6960c1e1-9632-4079-8449-f6a187228a5c"],
 ". ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Gamma]", "s"], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "68b79514-082c-4044-a1e5-7de7dab80acd"],
 "\nsince ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["KE", "p"], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["\[Gamma]", "p"], "-", "1"}], ")"}], 
     SubscriptBox["m", "s"], 
     SuperscriptBox["c", "2"]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "73577a75-3650-4fee-971b-2c36ebafc46a"],
 ",\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    SubscriptBox["w", "s"], "=", 
    RowBox[{
     FractionBox["1", "V"], 
     RowBox[{
      SubsuperscriptBox["\[Sum]", 
       RowBox[{"p", "=", "1"}], 
       SubscriptBox["N", "s"]], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[Gamma]", "p"], "-", "1"}], ")"}], 
       SubscriptBox["m", "s"], 
       SuperscriptBox["c", "2"]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     SubscriptBox["m", "s"], 
     SuperscriptBox["c", "2"], 
     FractionBox["1", "V"], 
     RowBox[{
      SubsuperscriptBox["\[Sum]", 
       RowBox[{"p", "=", "1"}], 
       SubscriptBox["N", "s"]], 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["\[Gamma]", "p"], "-", "1"}], ")"}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     RowBox[{
      SubscriptBox["m", "s"], 
      SuperscriptBox["c", "2"], 
      FractionBox["1", "V"], 
      RowBox[{
       SubsuperscriptBox["\[Sum]", 
        RowBox[{"p", "=", "1"}], 
        SubscriptBox["N", "s"]], 
       SubscriptBox["\[Gamma]", "p"]}]}], "-", 
     RowBox[{
      SubscriptBox["m", "s"], 
      SuperscriptBox["c", "2"], 
      FractionBox["1", "V"], 
      RowBox[{
       SubsuperscriptBox["\[Sum]", 
        RowBox[{"p", "=", "1"}], 
        SubscriptBox["N", "s"]], "1"}]}]}]}], TraditionalForm]}],
  FormatType->TraditionalForm,ExpressionUUID->
  "fb9c85d1-f935-44e8-a1d9-ab47edad218e"],
 ".\nFor a given velocity distribution ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["f", "s"], "(", 
    RowBox[{"\[DoubleStruckV]", ",", "\[DoubleStruckX]"}], ")"}], 
   TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "0a996172-d6f8-4d50-be38-c24dbbed94c6"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox["1", "V"], 
     RowBox[{
      SubsuperscriptBox["\[Sum]", 
       RowBox[{"p", "=", "1"}], 
       SubscriptBox["N", "s"]], 
      SubscriptBox["\[Gamma]", "p"]}]}], "=", 
    RowBox[{
     RowBox[{"\[Integral]", 
      RowBox[{
       RowBox[{"\[Gamma]", "(", "u", ")"}], 
       RowBox[{
        SubscriptBox["f", "s"], "(", 
        RowBox[{"\[DoubleStruckU]", ",", "\[DoubleStruckX]"}], ")"}], 
       RowBox[{"\[DifferentialD]", "\[DoubleStruckU]"}]}]}], "=", 
     RowBox[{"\[Integral]", 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "+", 
         RowBox[{
          SuperscriptBox["u", "2"], "/", 
          SuperscriptBox["c", "2"]}]}]], 
       RowBox[{
        SubscriptBox["f", "s"], "(", 
        RowBox[{"\[DoubleStruckU]", ",", "\[DoubleStruckX]"}], ")"}], 
       RowBox[{"\[DifferentialD]", "\[DoubleStruckU]"}]}]}]}]}], 
   TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "2227de2d-d687-442b-a84b-8a797c176b05"],
 "."
}], "Text",ExpressionUUID->"3de990f7-fe78-4ab8-b34d-c60118674253"],

Cell[TextData[{
 "Poynting theorem:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      FractionBox["1", 
       RowBox[{"8", "\[Pi]"}]], 
      FractionBox[
       RowBox[{"\[PartialD]", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[DoubleStruckCapitalE]", "2"], "+", 
          SuperscriptBox["\[DoubleStruckCapitalB]", "2"]}], ")"}]}], 
       RowBox[{"\[PartialD]", "t"}]]}], "+", 
     RowBox[{"\[Del]", "\[CenterDot]", "\[DoubleStruckCapitalS]"}]}], "=", 
    RowBox[{
     RowBox[{"-", "\[DoubleStruckJ]"}], "\[CenterDot]", 
     "\[DoubleStruckCapitalE]"}]}], TraditionalForm]],ExpressionUUID->
  "d506a5fe-b03e-45b5-a659-d4d0a8e73587"],
 ", where ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[DoubleStruckCapitalS]", "=", 
    RowBox[{
     FractionBox["c", 
      RowBox[{"4", "\[Pi]"}]], "\[DoubleStruckCapitalE]", "\[Times]", 
     "\[DoubleStruckCapitalB]"}]}], TraditionalForm]],ExpressionUUID->
  "0f776f43-aa39-4527-ae96-2cd3b7ce5b20"],
 ".\nThe first term is the electromagnetic field energy density, and the \
third term is the mechanical energy."
}], "Text",ExpressionUUID->"1ead1ffe-99f7-483d-b7ad-d2eb1efebd58"],

Cell[TextData[{
 "Cold Fluid (Tao, 2014): where ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Nu]", "\[GreaterEqual]", "0"}], TraditionalForm]],
  ExpressionUUID->"fdae83ee-ca08-4eb9-88e0-538fca91f23f"],
 ".\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"\[PartialD]", 
       SubscriptBox["\[DoubleStruckCapitalV]", "f"]}], 
      RowBox[{"\[PartialD]", "t"}]], "+", 
     RowBox[{"\[Nu]", "\[VeryThinSpace]", 
      SubscriptBox["\[DoubleStruckCapitalV]", "f"]}]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[DoubleStruckCapitalV]", "f"], "\[CenterDot]", 
         "\[Del]"}], ")"}]}], 
      SubscriptBox["\[DoubleStruckCapitalV]", "f"]}], "+", 
     RowBox[{
      FractionBox[
       SubscriptBox["q", "f"], 
       SubscriptBox["m", "f"]], 
      RowBox[{"(", 
       RowBox[{"\[DoubleStruckCapitalE]", "+", 
        RowBox[{
         FractionBox[
          SubscriptBox["\[DoubleStruckCapitalV]", "f"], "c"], "\[Times]", 
         "\[DoubleStruckCapitalB]"}]}], ")"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"bfad132c-84be-4516-88bc-3adc0860ce25"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"\[PartialD]", 
      SubscriptBox["n", "f"]}], 
     RowBox[{"\[PartialD]", "t"}]], "=", 
    RowBox[{"-", 
     RowBox[{"\[Del]", "\[CenterDot]", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["n", "f"], 
        SubscriptBox["\[DoubleStruckCapitalV]", "f"]}], ")"}]}]}]}], 
   TraditionalForm]],ExpressionUUID->"08011b5d-473e-4a42-8665-71b2923477ac"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[DoubleStruckCapitalJ]", "f"], "=", 
    RowBox[{
     SubscriptBox["q", "f"], 
     SubscriptBox["n", "f"], 
     SubscriptBox["\[DoubleStruckCapitalV]", "f"]}]}], TraditionalForm]],
  ExpressionUUID->"8df0cbf1-e797-4dad-86d5-1cf713209fef"],
 ".\nAssuming that the nonlinear effect of cold species is not essential to \
the dynamics, use linearized equations:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"\[PartialD]", 
       SubscriptBox["\[DoubleStruckCapitalV]", "f"]}], 
      RowBox[{"\[PartialD]", "t"}]], "+", 
     RowBox[{"\[Nu]", "\[VeryThinSpace]", 
      SubscriptBox["\[DoubleStruckCapitalV]", "f"]}]}], "=", 
    RowBox[{
     FractionBox[
      SubscriptBox["q", "f"], 
      SubscriptBox["m", "f"]], 
     RowBox[{"(", 
      RowBox[{"\[DoubleStruckCapitalE]", "+", 
       RowBox[{
        FractionBox[
         SubscriptBox["\[DoubleStruckCapitalV]", "f"], "c"], "\[Times]", 
        SubscriptBox["\[DoubleStruckCapitalB]", "0"]}]}], ")"}]}]}], 
   TraditionalForm]],ExpressionUUID->"b7133557-5edd-47cb-a05e-e624fa480e3b"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"\[PartialD]", 
      SubscriptBox["\[Delta]n", "f"]}], 
     RowBox[{"\[PartialD]", "t"}]], "=", 
    RowBox[{
     RowBox[{"-", 
      SubscriptBox["n", 
       RowBox[{"f", ",", "0"}]]}], 
     RowBox[{"\[Del]", "\[CenterDot]", 
      SubscriptBox["\[DoubleStruckCapitalV]", "f"]}]}]}], TraditionalForm]],
  ExpressionUUID->"8977feb2-bec4-4c32-95b4-5c27ed6277d6"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[DoubleStruckCapitalJ]", "f"], "=", 
    RowBox[{
     SubscriptBox["q", "f"], 
     SubscriptBox["n", 
      RowBox[{"f", ",", "0"}]], 
     SubscriptBox["\[DoubleStruckCapitalV]", "f"]}]}], TraditionalForm]],
  ExpressionUUID->"0a45ec56-1600-4e6e-9410-b229a9df1ea4"],
 ",\nwhere ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["n", "f"], "=", 
    RowBox[{
     SubscriptBox["n", 
      RowBox[{"f", ",", "0"}]], "+", 
     SubscriptBox["\[Delta]n", "f"]}]}], TraditionalForm]],ExpressionUUID->
  "f54c7258-5071-4ddb-944e-4bf0187d8fb0"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", 
    RowBox[{"f", ",", "0"}]], TraditionalForm]],ExpressionUUID->
  "679de866-3775-4266-97fb-0183b0b20f79"],
 " is the equilibrium number density."
}], "Text",ExpressionUUID->"18c9f654-f3f0-4e24-928a-48ada1cbef30"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Normalized", "Subsection",ExpressionUUID->"5593d14d-ab98-4ecd-b232-518d25807eeb"],

Cell[TextData[{
 "Normalized field quantities:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox[
      SubscriptBox["q", "0"], 
      RowBox[{
       SubscriptBox["m", "0"], "c"}]], "E"}], "=", "\[CapitalXi]"}], 
   TraditionalForm]],ExpressionUUID->"bf8c42ac-e07f-4d68-8531-afc81b1b18c4"],
 " (frequency unit),\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox[
      SubscriptBox["q", "0"], 
      RowBox[{
       SubscriptBox["m", "0"], "c"}]], "B"}], "=", "\[CapitalOmega]"}], 
   TraditionalForm]],ExpressionUUID->"c6ad2475-7bc2-4f0a-8107-4473d2936041"],
 " (frequency unit),\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"4", "\[Pi]", " ", 
       SubscriptBox["q", "0"]}], 
      RowBox[{
       SubscriptBox["m", "0"], "c"}]], 
     SubscriptBox["J", "s"]}], "=", 
    SubscriptBox["\[ScriptCapitalJ]", "s"]}], TraditionalForm]],
  ExpressionUUID->"e3922eeb-61d6-465a-a5be-6ec046f8cf2c"],
 " (frequency squared unit),\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"4", "\[Pi]", " ", 
       SubscriptBox["q", "0"]}], 
      SubscriptBox["m", "0"]], 
     SubscriptBox["\[Rho]", "s"]}], "=", 
    SubscriptBox["\[CapitalPi]", "s"]}], TraditionalForm]],ExpressionUUID->
  "021f92c9-f5d0-4725-9927-230544b4373c"],
 " (frequency squared unit),\nwhere ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[CapitalOmega]", "0"], TraditionalForm]],ExpressionUUID->
  "ba4c1135-61b8-4f1c-a632-98eaef1899f5"],
 " is magnitude of the background magnetid field, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[CapitalOmega]", "s"], TraditionalForm]],ExpressionUUID->
  "7880f88d-29a4-4255-bc9e-626c7e58711b"],
 " is the species cyclotron frequency and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Omega]", "s"], TraditionalForm]],ExpressionUUID->
  "1188f7a0-ee8d-4a0c-933e-1d228d64fe01"],
 " is the (initial) species plasma frequency.\nHere ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["\[Omega]", "s", "2"], "=", 
    RowBox[{
     FractionBox[
      SubscriptBox["\[CapitalOmega]", "s"], 
      SubscriptBox["\[CapitalOmega]", "0"]], 
     SubscriptBox["\[CapitalPi]", "s"]}]}], TraditionalForm]],ExpressionUUID->
  "a4221057-16b1-4ebf-820e-c92653838246"],
 "."
}], "Text",ExpressionUUID->"1d55d8c6-05c5-496e-826e-e1177ab9951c"],

Cell[TextData[{
 "Maxwells equations:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[PartialD]", 
      OverscriptBox["\[CapitalXi]", "\[RightVector]"]}], "/", 
     RowBox[{"\[PartialD]", "t"}]}], "=", 
    RowBox[{
     RowBox[{"c", 
      RowBox[{"\[Del]", "\[Cross]", 
       OverscriptBox["\[CapitalOmega]", "\[RightVector]"]}]}], "-", 
     OverscriptBox["\[ScriptCapitalJ]", "\[RightVector]"]}]}], 
   TraditionalForm]],ExpressionUUID->"304d2d98-429f-4a76-acc6-c5f03f200253"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[PartialD]", 
      OverscriptBox["\[CapitalOmega]", "\[RightVector]"]}], "/", 
     RowBox[{"\[PartialD]", "t"}]}], "=", 
    RowBox[{
     RowBox[{"-", "c"}], 
     RowBox[{"\[Del]", "\[Cross]", 
      OverscriptBox["\[CapitalXi]", "\[RightVector]"]}]}]}], 
   TraditionalForm]],ExpressionUUID->"134328a2-25c0-4ac4-9837-c87f27adcac7"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"c", 
     RowBox[{"\[Del]", "\[CenterDot]", 
      OverscriptBox["\[CapitalXi]", "\[RightVector]"]}]}], "=", 
    "\[CapitalPi]"}], TraditionalForm]],ExpressionUUID->
  "8a281d9b-ad9f-48e9-9120-7e2f3e6283cc"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"c", 
     RowBox[{"\[Del]", "\[CenterDot]", 
      OverscriptBox["\[CapitalOmega]", "\[RightVector]"]}]}], "=", "0"}], 
   TraditionalForm]],ExpressionUUID->"26c19f42-687b-407f-9a57-d493a6be6e09"],
 ",\nwhere ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox["\[ScriptCapitalJ]", "\[RightVector]"], "=", 
    RowBox[{
     SubscriptBox["\[Sum]", "s"], 
     OverscriptBox[
      SubscriptBox["\[ScriptCapitalJ]", "s"], "\[RightVector]"]}]}], 
   TraditionalForm]],ExpressionUUID->"1e6ad028-812a-4d96-8c88-66ae43d1c049"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalPi]", "=", 
    RowBox[{
     SubscriptBox["\[Sum]", "s"], 
     SubscriptBox["\[CapitalPi]", "s"]}]}], TraditionalForm]],ExpressionUUID->
  "639061d8-9ca0-4ed4-867d-dbf8e5ed0f11"],
 " of the species ",
 Cell[BoxData[
  FormBox["s", TraditionalForm]],ExpressionUUID->
  "e0a16cb1-4967-4d03-94f1-83de67b1f747"],
 "."
}], "Text",ExpressionUUID->"e9b742c7-f260-4742-ad46-d525c2ba769d"],

Cell[TextData[{
 "Continuity equation:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"c", 
      RowBox[{"\[Del]", "\[CenterDot]", 
       OverscriptBox[
        SubscriptBox["\[ScriptCapitalJ]", "s"], "\[RightVector]"]}]}], "+", 
     RowBox[{
      RowBox[{"\[PartialD]", 
       SubscriptBox["\[CapitalPi]", "s"]}], "/", 
      RowBox[{"\[PartialD]", "t"}]}]}], "=", "0"}], TraditionalForm]],
  ExpressionUUID->"85576618-e0f0-4c90-ac4b-47a23dd1ee14"],
 "."
}], "Text",ExpressionUUID->"f86f895a-40f7-4d01-bfd3-cd70821d3cc6"],

Cell[TextData[{
 "Equations of motion (non-relativistic):\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[PartialD]", 
      SubscriptBox["\[DoubleStruckX]", "p"]}], "/", 
     RowBox[{"\[PartialD]", "t"}]}], "=", 
    SubscriptBox["\[DoubleStruckV]", "p"]}], TraditionalForm]],ExpressionUUID->
  "328b484f-9147-4c5a-8065-e549300b3e06"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[PartialD]", 
      SubscriptBox["\[DoubleStruckV]", "p"]}], "/", 
     RowBox[{"\[PartialD]", "t"}]}], "=", 
    RowBox[{
     FractionBox[
      SubscriptBox["\[CapitalOmega]", "s"], 
      SubscriptBox["\[CapitalOmega]", "0"]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", 
        OverscriptBox["\[CapitalXi]", "\[RightVector]"]}], "+", 
       RowBox[{
        SubscriptBox["\[DoubleStruckV]", "p"], "\[Cross]", 
        OverscriptBox["\[CapitalOmega]", "\[RightVector]"]}]}], ")"}]}]}], 
   TraditionalForm]],ExpressionUUID->"e0b7bc7d-fa05-49b0-b296-879bd2958989"],
 "."
}], "Text",ExpressionUUID->"2e76a4f2-0040-4ba3-944c-44be0134b9f1"],

Cell[TextData[{
 "Equations of motion (relativistic):\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[PartialD]", 
      SubscriptBox["\[DoubleStruckX]", "p"]}], "/", 
     RowBox[{"\[PartialD]", "t"}]}], "=", 
    SubscriptBox["\[DoubleStruckV]", "p"]}], TraditionalForm]],ExpressionUUID->
  "ca83c5f1-284e-4850-a42a-88e624a3f255"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[PartialD]", 
      SubscriptBox["\[DoubleStruckU]", "p"]}], "/", 
     RowBox[{"\[PartialD]", "t"}]}], "=", 
    RowBox[{
     FractionBox[
      SubscriptBox["\[CapitalOmega]", "s"], 
      SubscriptBox["\[CapitalOmega]", "0"]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", 
        OverscriptBox["\[CapitalXi]", "\[RightVector]"]}], "+", 
       RowBox[{
        SubscriptBox["\[DoubleStruckU]", "p"], "\[Cross]", 
        SubscriptBox[
         OverscriptBox["\[CapitalOmega]", "\[RightVector]"], "p"]}]}], 
      ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "39e9dc4f-724b-43e4-b087-4dd5cc9ad92e"],
 ",\nwhere ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     OverscriptBox["\[CapitalOmega]", "\[RightVector]"], "p"], "=", 
    RowBox[{
     RowBox[{"c", 
      RowBox[{
       OverscriptBox["\[CapitalOmega]", "\[RightVector]"], "/", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["c", "2"], "+", 
         RowBox[{
          SubscriptBox["\[DoubleStruckU]", "p"], "\[CenterDot]", 
          SubscriptBox["\[DoubleStruckU]", "p"]}]}]]}]}], "=", 
     RowBox[{
      OverscriptBox["\[CapitalOmega]", "\[RightVector]"], "/", 
      SubscriptBox["\[Gamma]", "p"]}]}]}], TraditionalForm]],ExpressionUUID->
  "b38b5bbd-be20-495c-afe7-416ab12dc458"],
 "."
}], "Text",ExpressionUUID->"f030f6e9-193f-45c5-b50c-c8c165382755"],

Cell[TextData[{
 "Energy density of fields:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[CurlyEpsilon]", "EM"], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[CapitalXi]", "2"], "+", 
       SuperscriptBox["\[CapitalOmega]", "2"]}], ")"}], "/", "2"}]}], 
   TraditionalForm]],ExpressionUUID->"ce5e03fb-573c-4548-90a4-bb1940ee98d1"],
 ", where ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[CurlyEpsilon]", "EM"], "=", 
    RowBox[{
     FractionBox[
      RowBox[{"4", "\[Pi]", " ", 
       SubsuperscriptBox["q", "0", "2"]}], 
      RowBox[{
       SubsuperscriptBox["m", "0", "2"], 
       SuperscriptBox["c", "2"]}]], "u"}]}], TraditionalForm]],ExpressionUUID->
  "9aba7dd6-ef9f-4266-9952-091ed898bad3"],
 " (frequency squared).\nLikewise, we define kinetic energy density of \
particles of species, ",
 Cell[BoxData[
  FormBox["s", TraditionalForm]],ExpressionUUID->
  "ec10a617-74a3-4476-96ef-ba8bf7de613d"],
 ":\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[CurlyEpsilon]", "KE"], "=", 
    RowBox[{
     SubscriptBox["\[Sum]", "s"], 
     SubscriptBox["\[CurlyEpsilon]", "s"]}]}], TraditionalForm]],
  ExpressionUUID->"e65aec5f-4263-429f-bb03-30b1a0c77cf0"],
 " (frequency squared unit), where ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[CurlyEpsilon]", "s"], "=", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"4", "\[Pi]", " ", 
        SubsuperscriptBox["q", "0", "2"]}], 
       RowBox[{
        SubsuperscriptBox["m", "0", "2"], 
        SuperscriptBox["c", "2"]}]], 
      SubscriptBox["w", "s"]}], "=", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{"4", "\[Pi]", " ", 
         SubsuperscriptBox["q", "0", "2"]}], 
        RowBox[{
         SubsuperscriptBox["m", "0", "2"], 
         SuperscriptBox["c", "2"]}]], 
       RowBox[{"\[LeftAngleBracket]", 
        FractionBox[
         RowBox[{
          SubscriptBox["m", "s"], 
          SubsuperscriptBox["\[DoubleStruckV]", "p", "2"]}], "2"], 
        "\[RightAngleBracket]"}]}], "=", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"4", "\[Pi]", " ", 
          SubsuperscriptBox["q", "s", "2"]}], 
         RowBox[{
          SubscriptBox["m", "s"], 
          SuperscriptBox["c", "2"]}]], 
        FractionBox[
         SubsuperscriptBox["\[CapitalOmega]", "0", "2"], 
         SubsuperscriptBox["\[CapitalOmega]", "s", "2"]], 
        RowBox[{"\[LeftAngleBracket]", 
         FractionBox[
          SubsuperscriptBox["\[DoubleStruckV]", "p", "2"], "2"], 
         "\[RightAngleBracket]"}]}], "=", 
       RowBox[{
        FractionBox[
         SubsuperscriptBox["\[CapitalOmega]", "0", "2"], 
         SubsuperscriptBox["\[CapitalOmega]", "s", "2"]], 
        FractionBox[
         SubsuperscriptBox["\[Omega]", "s", "2"], 
         SuperscriptBox["c", "2"]], 
        FractionBox[
         RowBox[{
          SubsuperscriptBox["\[Sum]", "p", 
           SuperscriptBox["N", "t"]], 
          RowBox[{
           SubsuperscriptBox["\[DoubleStruckV]", "p", "2"], "/", "2"}]}], 
         SuperscriptBox["N", "0"]]}]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"603ed1b1-4304-4e29-ba80-c325e9ec9874"],
 ".\nThen the total energy in the system is\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[ScriptCapitalE]", "=", 
    RowBox[{
     SubscriptBox["\[Integral]", "V"], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["\[CurlyEpsilon]", "EM"], "+", 
        SubscriptBox["\[CurlyEpsilon]", "KE"]}], ")"}], 
      RowBox[{"\[DifferentialD]", "V"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"706bf737-d8ed-4c4f-8898-067c2beda9d2"],
 "."
}], "Text",ExpressionUUID->"dd318524-e19a-4180-a048-ecf72f601003"],

Cell[TextData[{
 "Poynting theorem:\nDefine the normalized Poynting vector: ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"4", "\[Pi]", " ", 
       SubsuperscriptBox["q", "0", "2"]}], 
      RowBox[{
       SubsuperscriptBox["m", "0", "2"], 
       SuperscriptBox["c", "2"]}]], "S"}], "=", "\[ScriptCapitalS]"}], 
   TraditionalForm]],ExpressionUUID->"a88ad649-318f-41ec-8f3c-a7f39346c12e"],
 ".\nThen ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox["\[ScriptCapitalS]", "\[RightVector]"], "=", 
    RowBox[{"c", " ", 
     OverscriptBox["\[CapitalXi]", "\[RightVector]"], "\[Times]", 
     OverscriptBox["\[CapitalOmega]", "\[RightVector]"]}]}], 
   TraditionalForm]],ExpressionUUID->"8dbeca68-46d5-4081-90f0-3c96fafe29cc"],
 ", and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], 
      FractionBox[
       RowBox[{"\[PartialD]", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[CapitalXi]", "2"], "+", 
          SuperscriptBox["\[CapitalOmega]", "2"]}], ")"}]}], 
       RowBox[{"\[PartialD]", "t"}]]}], "+", 
     RowBox[{"\[Del]", "\[CenterDot]", 
      OverscriptBox["\[ScriptCapitalS]", "\[RightVector]"]}]}], "=", 
    RowBox[{
     RowBox[{"-", 
      OverscriptBox["\[ScriptCapitalJ]", "\[RightVector]"]}], "\[CenterDot]", 
     
     OverscriptBox["\[CapitalXi]", "\[RightVector]"]}]}], TraditionalForm]],
  ExpressionUUID->"691c5dfb-fcb9-4139-9b45-bd81ac825512"],
 "."
}], "Text",ExpressionUUID->"661cd1e9-44aa-4fdb-a829-31ad6568d022"],

Cell[TextData[{
 "Cold Fluid;\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"\[PartialD]", 
       SubscriptBox["\[DoubleStruckCapitalV]", "f"]}], 
      RowBox[{"\[PartialD]", "t"}]], "+", 
     RowBox[{"\[Nu]", "\[VeryThinSpace]", 
      SubscriptBox["\[DoubleStruckCapitalV]", "f"]}]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[DoubleStruckCapitalV]", "f"], "\[CenterDot]", 
         "\[Del]"}], ")"}]}], 
      SubscriptBox["\[DoubleStruckCapitalV]", "f"]}], "+", 
     RowBox[{
      FractionBox[
       SubscriptBox["\[CapitalOmega]", "f"], 
       SubscriptBox["\[CapitalOmega]", "0"]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", " ", 
         OverscriptBox["\[CapitalXi]", "\[RightVector]"]}], "+", 
        RowBox[{
         SubscriptBox["\[DoubleStruckCapitalV]", "f"], "\[Times]", 
         OverscriptBox["\[CapitalOmega]", "\[RightVector]"]}]}], ")"}]}]}]}], 
   TraditionalForm]],ExpressionUUID->"981ea67d-2f89-4c38-860a-debf26b69851"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"\[PartialD]", 
      SubscriptBox["n", "f"]}], 
     RowBox[{"\[PartialD]", "t"}]], "=", 
    RowBox[{"-", 
     RowBox[{"\[Del]", "\[CenterDot]", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["n", "f"], 
        SubscriptBox["\[DoubleStruckCapitalV]", "f"]}], ")"}]}]}]}], 
   TraditionalForm]],ExpressionUUID->"a7376188-a6b1-423b-836b-53b6e56cf533"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox[
     SubscriptBox["\[ScriptCapitalJ]", "f"], "\[RightVector]"], "=", 
    RowBox[{
     SubscriptBox["\[CapitalPi]", "f"], 
     FractionBox[
      SubscriptBox["\[DoubleStruckCapitalV]", "f"], "c"]}]}], 
   TraditionalForm]],ExpressionUUID->"a7e9d47a-9d6c-4532-b2f9-2b15596ddbf3"],
 ".\nAssuming that the nonlinear effect of cold species is not essential to \
the dynamics, use linearized equations:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"\[PartialD]", 
       SubscriptBox["\[DoubleStruckCapitalV]", "f"]}], 
      RowBox[{"\[PartialD]", "t"}]], "+", 
     RowBox[{"\[Nu]", "\[VeryThinSpace]", 
      SubscriptBox["\[DoubleStruckCapitalV]", "f"]}]}], "=", 
    RowBox[{
     FractionBox[
      SubscriptBox["\[CapitalOmega]", 
       RowBox[{"f", ",", "0"}]], 
      SubscriptBox["\[CapitalOmega]", "0"]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", 
        OverscriptBox["\[CapitalXi]", "\[RightVector]"]}], "+", 
       RowBox[{
        SubscriptBox["\[DoubleStruckCapitalV]", "f"], "\[Times]", 
        SubscriptBox[
         OverscriptBox["\[CapitalOmega]", "\[RightVector]"], "0"]}]}], 
      ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "f5a6cf4d-baa6-495a-b0c1-31ddff4d4477"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"\[PartialD]", 
      SubscriptBox["\[Delta]n", "f"]}], 
     RowBox[{"\[PartialD]", "t"}]], "=", 
    RowBox[{
     RowBox[{"-", 
      SubscriptBox["n", 
       RowBox[{"f", ",", "0"}]]}], 
     RowBox[{"\[Del]", "\[CenterDot]", 
      SubscriptBox["\[DoubleStruckCapitalV]", "f"]}]}]}], TraditionalForm]],
  ExpressionUUID->"4d8efb10-878b-4273-b3cc-a6ba9c2c2112"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     OverscriptBox["\[ScriptCapitalJ]", "\[RightVector]"], "f"], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[CapitalPi]", 
       RowBox[{"f", ",", "0"}]], 
      FractionBox[
       SubscriptBox["\[DoubleStruckCapitalV]", "f"], "c"]}], "=", 
     RowBox[{
      SubsuperscriptBox["\[Omega]", "f", "2"], 
      FractionBox[
       SubscriptBox["\[CapitalOmega]", "0"], 
       SubscriptBox["\[CapitalOmega]", 
        RowBox[{"f", ",", "0"}]]], 
      FractionBox[
       SubscriptBox["\[DoubleStruckCapitalV]", "f"], "c"]}]}]}], 
   TraditionalForm]],ExpressionUUID->"9bc07c94-7285-44fc-84d5-a7a08ed93623"],
 ",\nwhere ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[Omega]", "f", "2"], TraditionalForm]],ExpressionUUID->
  "aeb005cd-f4fd-475a-ac04-4fdc1036b325"],
 " is the plasma frequency corresponding to the equibrium density, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", 
    RowBox[{"f", ",", "0"}]], TraditionalForm]],ExpressionUUID->
  "2a34d469-deaa-416b-ae0f-07172896bc81"],
 ", not the reference value.\nHalf translation:\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{
       SubsuperscriptBox["\[DoubleStruckCapitalV]", "f", "i"], "-", 
       SubsuperscriptBox["\[DoubleStruckCapitalV]", "f", 
        RowBox[{"i", "-", 
         RowBox[{"1", "/", "2"}]}]]}], 
      RowBox[{"\[CapitalDelta]t", "/", "2"}]], "+", 
     RowBox[{
      FractionBox["\[Nu]", "2"], 
      RowBox[{"(", 
       RowBox[{
        SubsuperscriptBox["\[DoubleStruckCapitalV]", "f", "i"], "+", 
        SubsuperscriptBox["\[DoubleStruckCapitalV]", "f", 
         RowBox[{"i", "-", 
          RowBox[{"1", "/", "2"}]}]]}], ")"}]}]}], "=", 
    RowBox[{
     FractionBox[
      SubscriptBox["\[CapitalOmega]", 
       RowBox[{"f", ",", "0"}]], 
      SubscriptBox["\[CapitalOmega]", "0"]], "c", " ", 
     OverscriptBox["\[CapitalXi]", "\[RightVector]"]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{
     SubsuperscriptBox["\[DoubleStruckCapitalV]", "f", "i"], "-", 
     SubsuperscriptBox["\[DoubleStruckCapitalV]", "f", 
      RowBox[{"i", "-", 
       RowBox[{"1", "/", "2"}]}]], "+", 
     RowBox[{
      FractionBox["\[CapitalDelta]t", "2"], 
      FractionBox["\[Nu]", "2"], 
      SubsuperscriptBox["\[DoubleStruckCapitalV]", "f", "i"]}], "+", 
     RowBox[{
      FractionBox["\[CapitalDelta]t", "2"], 
      FractionBox["\[Nu]", "2"], 
      SubsuperscriptBox["\[DoubleStruckCapitalV]", "f", 
       RowBox[{"i", "-", 
        RowBox[{"1", "/", "2"}]}]]}]}], "=", 
    RowBox[{
     FractionBox["\[CapitalDelta]t", "2"], 
     FractionBox[
      SubscriptBox["\[CapitalOmega]", 
       RowBox[{"f", ",", "0"}]], 
      SubscriptBox["\[CapitalOmega]", "0"]], "c", " ", 
     OverscriptBox["\[CapitalXi]", "\[RightVector]"]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         FractionBox["\[CapitalDelta]t", "2"], 
         FractionBox["\[Nu]", "2"]}]}], ")"}], 
      SubsuperscriptBox["\[DoubleStruckCapitalV]", "f", "i"]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         FractionBox["\[CapitalDelta]t", "2"], 
         FractionBox["\[Nu]", "2"]}]}], ")"}], 
      SubsuperscriptBox["\[DoubleStruckCapitalV]", "f", 
       RowBox[{"i", "-", 
        RowBox[{"1", "/", "2"}]}]]}], "+", 
     RowBox[{"2", 
      FractionBox["\[CapitalDelta]t", "2"], 
      FractionBox["\[Nu]", "2"], 
      SubsuperscriptBox["\[DoubleStruckCapitalV]", "f", 
       RowBox[{"i", "-", 
        RowBox[{"1", "/", "2"}]}]]}]}], "=", 
    RowBox[{
     FractionBox["\[CapitalDelta]t", "2"], 
     FractionBox[
      SubscriptBox["\[CapitalOmega]", 
       RowBox[{"f", ",", "0"}]], 
      SubscriptBox["\[CapitalOmega]", "0"]], "c", " ", 
     OverscriptBox["\[CapitalXi]", "\[RightVector]"]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         FractionBox["\[CapitalDelta]t", "2"], 
         FractionBox["\[Nu]", "2"]}]}], ")"}], 
      SubsuperscriptBox["\[DoubleStruckCapitalV]", "f", "i"]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         FractionBox["\[CapitalDelta]t", "2"], 
         FractionBox["\[Nu]", "2"]}]}], ")"}], 
      SubsuperscriptBox["\[DoubleStruckCapitalV]", "f", 
       RowBox[{"i", "-", 
        RowBox[{"1", "/", "2"}]}]]}]}], "=", 
    RowBox[{
     RowBox[{
      FractionBox["\[CapitalDelta]t", "2"], 
      FractionBox[
       SubscriptBox["\[CapitalOmega]", 
        RowBox[{"f", ",", "0"}]], 
       SubscriptBox["\[CapitalOmega]", "0"]], "c", " ", 
      OverscriptBox["\[CapitalXi]", "\[RightVector]"]}], "-", 
     RowBox[{
      FractionBox["\[CapitalDelta]t", "2"], "\[Nu]", " ", 
      SubsuperscriptBox["\[DoubleStruckCapitalV]", "f", 
       RowBox[{"i", "-", 
        RowBox[{"1", "/", "2"}]}]]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{
     SubsuperscriptBox["\[DoubleStruckCapitalV]", "f", "i"], "-", 
     SubsuperscriptBox["\[DoubleStruckCapitalV]", "f", 
      RowBox[{"i", "-", 
       RowBox[{"1", "/", "2"}]}]]}], "=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"1", "+", 
       RowBox[{
        FractionBox["\[CapitalDelta]t", "2"], 
        FractionBox["\[Nu]", "2"]}]}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox["\[CapitalDelta]t", "2"], 
        FractionBox[
         SubscriptBox["\[CapitalOmega]", 
          RowBox[{"f", ",", "0"}]], 
         SubscriptBox["\[CapitalOmega]", "0"]], "c", " ", 
        OverscriptBox["\[CapitalXi]", "\[RightVector]"]}], "-", 
       RowBox[{
        FractionBox["\[CapitalDelta]t", "2"], "\[Nu]", " ", 
        SubsuperscriptBox["\[DoubleStruckCapitalV]", "f", 
         RowBox[{"i", "-", 
          RowBox[{"1", "/", "2"}]}]]}]}], ")"}]}]}], TraditionalForm]}],
  ExpressionUUID->"6943c03d-3e6a-48c4-bd95-38b18829b1d1"],
 ";"
}], "Text",ExpressionUUID->"d672e2e5-c36d-47b5-be7a-f804f3394e79"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tensor form", "Subsection",ExpressionUUID->"6a963e5d-0959-4a3a-868c-45bf1604788d"],

Cell[TextData[{
 "Maxwells equations:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"\[PartialD]", 
      SuperscriptBox["\[CapitalXi]", "i"]}], 
     RowBox[{"\[PartialD]", "t"}]], "=", 
    RowBox[{
     RowBox[{"c", " ", 
      SuperscriptBox["e", 
       RowBox[{"i", "\[VeryThinSpace]", "j", "\[VeryThinSpace]", "k"}]], 
      FractionBox[
       RowBox[{"\[PartialD]", 
        SubscriptBox["\[CapitalOmega]", "k"]}], 
       RowBox[{"\[PartialD]", 
        SuperscriptBox["x", "j"]}]]}], "-", 
     SuperscriptBox["\[ScriptCapitalJ]", "i"]}]}], TraditionalForm]],
  ExpressionUUID->"e2476ba7-9140-4ff4-8a17-04d36cef9c7c"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"\[PartialD]", 
      SuperscriptBox["\[CapitalOmega]", "i"]}], 
     RowBox[{"\[PartialD]", "t"}]], "=", 
    RowBox[{
     RowBox[{"-", "c"}], " ", 
     SuperscriptBox["e", 
      RowBox[{"i", "\[VeryThinSpace]", "j", "\[VeryThinSpace]", "k"}]], 
     FractionBox[
      RowBox[{"\[PartialD]", 
       SubscriptBox["\[CapitalXi]", "k"]}], 
      RowBox[{"\[PartialD]", 
       SuperscriptBox["x", "j"]}]]}]}], TraditionalForm]],ExpressionUUID->
  "38583d67-b693-460b-951f-0be3df926dfa"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"c", 
     FractionBox["1", 
      SqrtBox["g"]], 
     RowBox[{
      FractionBox["\[PartialD]", 
       RowBox[{"\[PartialD]", 
        SuperscriptBox["x", "i"]}]], 
      SqrtBox["g"]}], 
     SuperscriptBox["\[CapitalXi]", "i"]}], "=", "\[CapitalPi]"}], 
   TraditionalForm]],ExpressionUUID->"d92a8813-81dd-4f20-9ee2-3c3023c5cafd"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"c", 
     FractionBox["1", 
      SqrtBox["g"]], 
     RowBox[{
      FractionBox["\[PartialD]", 
       RowBox[{"\[PartialD]", 
        SuperscriptBox["x", "i"]}]], 
      SqrtBox["g"]}], 
     SuperscriptBox["\[CapitalOmega]", "i"]}], "=", "0"}], TraditionalForm]],
  ExpressionUUID->"b2de9054-8e7c-47e3-a2fd-56e217a86272"],
 ",\nwhere ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[ScriptCapitalJ]", "i"], "=", 
    RowBox[{
     SubscriptBox["\[Sum]", "s"], 
     SuperscriptBox[
      SubscriptBox["\[ScriptCapitalJ]", "s"], "i"]}]}], TraditionalForm]],
  ExpressionUUID->"141cd5ff-677d-4099-bf43-c86a5ef12167"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalPi]", "=", 
    RowBox[{
     SubscriptBox["\[Sum]", "s"], 
     SubscriptBox["\[CapitalPi]", "s"]}]}], TraditionalForm]],ExpressionUUID->
  "3ba90224-397f-446c-81bb-b66145cda145"],
 " of the species ",
 Cell[BoxData[
  FormBox["s", TraditionalForm]],ExpressionUUID->
  "ccf4173b-10a9-437d-9d24-65a25829c88c"],
 ", and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["e", 
     RowBox[{"i", "\[VeryThinSpace]", "j", "\[VeryThinSpace]", "k"}]], "=", 
    RowBox[{
     SuperscriptBox["\[Epsilon]", 
      RowBox[{"i", "\[VeryThinSpace]", "j", "\[VeryThinSpace]", "k"}]], "/", 
     SqrtBox["g"]}]}], TraditionalForm]],ExpressionUUID->
  "954be811-b38b-4f29-aaaa-53e3db21fdbf"],
 "."
}], "Text",ExpressionUUID->"f3a02e4a-0eb5-4ec4-b469-b1d92045ef38"],

Cell[TextData[{
 "Continuity equation:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"c", 
      FractionBox["1", 
       SqrtBox["g"]], 
      RowBox[{
       FractionBox["\[PartialD]", 
        RowBox[{"\[PartialD]", 
         SuperscriptBox["x", "i"]}]], 
       SqrtBox["g"]}], 
      SuperscriptBox[
       SubscriptBox["\[ScriptCapitalJ]", "s"], "i"]}], "+", 
     FractionBox[
      RowBox[{"\[PartialD]", 
       SubscriptBox["\[CapitalPi]", "s"]}], 
      RowBox[{"\[PartialD]", "t"}]]}], "=", "0"}], TraditionalForm]],
  ExpressionUUID->"1c4ff8b7-5665-4ef2-90b1-c4735127faff"],
 "."
}], "Text",ExpressionUUID->"db8fc41e-20bb-4548-837a-de969032a7f4"],

Cell[TextData[{
 "Equations of motion (non-relativistic):\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"\[PartialD]", 
      SuperscriptBox["x", "i"]}], 
     RowBox[{"\[PartialD]", "t"}]], "=", 
    SuperscriptBox["v", "i"]}], TraditionalForm]],ExpressionUUID->
  "cecacc3f-3055-4e76-940b-3f7b0da62a1a"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[PartialD]", 
      SubscriptBox["\[DoubleStruckV]", "p"]}], "/", 
     RowBox[{"\[PartialD]", "t"}]}], "=", 
    RowBox[{
     FractionBox[
      SubscriptBox["\[CapitalOmega]", "s"], 
      SubscriptBox["\[CapitalOmega]", "0"]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", 
        OverscriptBox["\[CapitalXi]", "\[RightVector]"]}], "+", 
       RowBox[{
        SubscriptBox["\[DoubleStruckV]", "p"], "\[Cross]", 
        OverscriptBox["\[CapitalOmega]", "\[RightVector]"]}]}], ")"}]}]}], 
   TraditionalForm]],ExpressionUUID->"e707d38e-0000-4ca3-b58c-341c5fe4f1cd"],
 "."
}], "Text",ExpressionUUID->"8e8d5028-b4c7-4bf5-8d0d-3f5df7bba8b0"],

Cell[TextData[{
 "Energy density of fields:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[CurlyEpsilon]", "EM"], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[CapitalXi]", "2"], "+", 
        SuperscriptBox["\[CapitalOmega]", "2"]}], ")"}], "/", "2"}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[CapitalXi]", "i"], 
         SubscriptBox["\[CapitalXi]", "i"]}], "+", 
        RowBox[{
         SuperscriptBox["\[CapitalOmega]", "i"], 
         SubscriptBox["\[CapitalOmega]", "i"]}]}], ")"}], "/", "2"}]}]}], 
   TraditionalForm]],ExpressionUUID->"0a25a4be-4389-44a8-b56d-0657fac4c6a6"],
 ", where ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[CurlyEpsilon]", "EM"], "=", 
    RowBox[{
     FractionBox[
      RowBox[{"4", "\[Pi]", " ", 
       SubsuperscriptBox["q", "0", "2"]}], 
      RowBox[{
       SubsuperscriptBox["m", "0", "2"], 
       SuperscriptBox["c", "2"]}]], "u"}]}], TraditionalForm]],ExpressionUUID->
  "5c752c99-9b39-44e7-8cfc-d0b4caefbbd2"],
 " (frequency squared).\nLikewise, we define kinetic energy density of \
particles of species, ",
 Cell[BoxData[
  FormBox["s", TraditionalForm]],ExpressionUUID->
  "965b8668-82b9-48ce-9031-c5a6e5885686"],
 ":\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[CurlyEpsilon]", "KE"], "=", 
    RowBox[{
     SubscriptBox["\[Sum]", "s"], 
     SubscriptBox["\[CurlyEpsilon]", "s"]}]}], TraditionalForm]],
  ExpressionUUID->"1daa398c-fb1d-4bd2-b916-0360b49baa12"],
 " (frequency squared unit), where ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[CurlyEpsilon]", "s"], "=", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"4", "\[Pi]", " ", 
        SubsuperscriptBox["q", "0", "2"]}], 
       RowBox[{
        SubsuperscriptBox["m", "0", "2"], 
        SuperscriptBox["c", "2"]}]], 
      SubscriptBox["w", "s"]}], "=", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{"4", "\[Pi]", " ", 
         SubsuperscriptBox["q", "0", "2"]}], 
        RowBox[{
         SubsuperscriptBox["m", "0", "2"], 
         SuperscriptBox["c", "2"]}]], 
       RowBox[{"\[LeftAngleBracket]", 
        FractionBox[
         RowBox[{
          SubscriptBox["m", "s"], 
          SubsuperscriptBox["\[DoubleStruckV]", "p", "2"]}], "2"], 
        "\[RightAngleBracket]"}]}], "=", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"4", "\[Pi]", " ", 
          SubsuperscriptBox["q", "s", "2"]}], 
         RowBox[{
          SubscriptBox["m", "s"], 
          SuperscriptBox["c", "2"]}]], 
        FractionBox[
         SubsuperscriptBox["\[CapitalOmega]", "0", "2"], 
         SubsuperscriptBox["\[CapitalOmega]", "s", "2"]], 
        RowBox[{"\[LeftAngleBracket]", 
         FractionBox[
          SubsuperscriptBox["\[DoubleStruckV]", "p", "2"], "2"], 
         "\[RightAngleBracket]"}]}], "=", 
       RowBox[{
        FractionBox[
         SubsuperscriptBox["\[CapitalOmega]", "0", "2"], 
         SubsuperscriptBox["\[CapitalOmega]", "s", "2"]], 
        FractionBox[
         SubsuperscriptBox["\[Omega]", "s", "2"], 
         SuperscriptBox["c", "2"]], 
        FractionBox[
         RowBox[{
          SubsuperscriptBox["\[Sum]", "p", 
           SuperscriptBox["N", "t"]], 
          RowBox[{
           SubsuperscriptBox["\[DoubleStruckV]", "p", "2"], "/", "2"}]}], 
         SuperscriptBox["N", "0"]]}]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"3c06decf-e467-4f7d-92ae-575905391ae1"],
 ".\nThen the total energy in the system is\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[ScriptCapitalE]", "=", 
    RowBox[{
     SubscriptBox["\[Integral]", "V"], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["\[CurlyEpsilon]", "EM"], "+", 
        SubscriptBox["\[CurlyEpsilon]", "KE"]}], ")"}], 
      RowBox[{"\[DifferentialD]", "V"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"ffa841bc-e864-41a1-bf7d-fcc73434faa1"],
 "."
}], "Text",ExpressionUUID->"59dae126-f10e-4ef6-bdaf-20485f8adbf5"],

Cell[TextData[{
 "Cold Fluid:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"\[PartialD]", 
      SubscriptBox["\[DoubleStruckCapitalV]", "f"]}], 
     RowBox[{"\[PartialD]", "t"}]], "=", 
    RowBox[{
     FractionBox[
      SubscriptBox["\[CapitalOmega]", 
       RowBox[{"f", ",", "0"}]], 
      SubscriptBox["\[CapitalOmega]", "0"]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", 
        OverscriptBox["\[CapitalXi]", "\[RightVector]"]}], "+", 
       RowBox[{
        SubscriptBox["\[DoubleStruckCapitalV]", "f"], "\[Times]", 
        SubscriptBox[
         OverscriptBox["\[CapitalOmega]", "\[RightVector]"], "0"]}]}], 
      ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "6a6f4b78-1561-4786-8910-a218412ffcf5"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"\[PartialD]", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["\[Delta]n", "f"], "/", 
        SubscriptBox["n", 
         RowBox[{"f", ",", "0"}]]}], ")"}]}], 
     RowBox[{"\[PartialD]", "t"}]], "=", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       SqrtBox["g"]]}], 
     RowBox[{
      FractionBox["\[PartialD]", 
       RowBox[{"\[PartialD]", 
        SuperscriptBox["x", "i"]}]], 
      SqrtBox["g"]}], 
     SuperscriptBox[
      SubscriptBox["V", "f"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "36a42ebe-88ef-4e8a-966d-f7c060e30c57"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     SubscriptBox["\[ScriptCapitalJ]", "f"], "i"], "=", 
    RowBox[{
     SubsuperscriptBox["\[Omega]", "f", "2"], 
     FractionBox[
      SubscriptBox["\[CapitalOmega]", "0"], 
      SubscriptBox["\[CapitalOmega]", 
       RowBox[{"f", ",", "0"}]]], 
     FractionBox[
      SuperscriptBox[
       SubscriptBox["V", "f"], "i"], "c"]}]}], TraditionalForm]],
  ExpressionUUID->"0619b8d9-6b82-4d74-88cc-cb47a2463dfa"],
 ",\nwhere ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[Omega]", "f", "2"], TraditionalForm]],ExpressionUUID->
  "fa9fc69d-e89d-41e4-a3b7-970a37188762"],
 " is the plasma frequency corresponding to the equibrium density, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", 
    RowBox[{"f", ",", "0"}]], TraditionalForm]],ExpressionUUID->
  "fe97c977-69ed-49d4-ae7f-e5809d286a7c"],
 ", not the reference value.\nIntegrating density perturbation is trivial \
because no other quantities depend on it.\nTreat the flow velocity as \
updating particle velocity (same time scheme); and collocate with \
\[CapitalXi] (same as moments).\nTreat the density perturbation as updating \
particle position.\n\nTo make the interface consistent with particles, \
weighted moments are updated:\nmom0 - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox["\[PartialD]", 
      RowBox[{"\[PartialD]", "t"}]], 
     RowBox[{"(", 
      FractionBox[
       RowBox[{
        SubscriptBox["n", 
         RowBox[{"f", ",", "0"}]], "+", 
        SubscriptBox["\[Delta]n", "f"]}], 
       SubscriptBox["n", 
        RowBox[{"f", ",", "ref"}]]], ")"}]}], "=", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       SqrtBox["g"]]}], 
     RowBox[{
      FractionBox["\[PartialD]", 
       RowBox[{"\[PartialD]", 
        SuperscriptBox["x", "i"]}]], 
      SqrtBox["g"]}], 
     SuperscriptBox[
      SubscriptBox["V", "f"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "e1926f76-e6db-40e6-8f66-236f7e347081"],
 ";\nmom1 - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox[
      SubscriptBox["n", 
       RowBox[{"f", ",", "0"}]], 
      SubscriptBox["n", 
       RowBox[{"f", ",", "ref"}]]], 
     FractionBox[
      RowBox[{"\[PartialD]", 
       SubscriptBox["\[DoubleStruckCapitalV]", "f"]}], 
      RowBox[{"\[PartialD]", "t"}]]}], "=", 
    RowBox[{
     FractionBox[
      SubscriptBox["\[CapitalOmega]", 
       RowBox[{"f", ",", "0"}]], 
      SubscriptBox["\[CapitalOmega]", "0"]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", 
        FractionBox[
         SubscriptBox["n", 
          RowBox[{"f", ",", "0"}]], 
         SubscriptBox["n", 
          RowBox[{"f", ",", "ref"}]]], 
        OverscriptBox["\[CapitalXi]", "\[RightVector]"]}], "+", 
       RowBox[{
        FractionBox[
         SubscriptBox["n", 
          RowBox[{"f", ",", "0"}]], 
         SubscriptBox["n", 
          RowBox[{"f", ",", "ref"}]]], 
        SubscriptBox["\[DoubleStruckCapitalV]", "f"], "\[Times]", 
        SubscriptBox[
         OverscriptBox["\[CapitalOmega]", "\[RightVector]"], "0"]}]}], 
      ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "a6bc7457-6ca2-43dd-86f7-90b1de3a551c"],
 ";\nmom2 - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox[
      SubscriptBox["n", 
       RowBox[{"f", ",", "0"}]], 
      SubscriptBox["n", 
       RowBox[{"f", ",", "ref"}]]], 
     SubscriptBox["\[DoubleStruckV]", "f"], 
     SubscriptBox["\[DoubleStruckV]", "f"]}], "=", 
    RowBox[{
     FractionBox[
      SubscriptBox["n", 
       RowBox[{"f", ",", "0"}]], 
      SubscriptBox["n", 
       RowBox[{"f", ",", "ref"}]]], 
     SubscriptBox["\[DoubleStruckCapitalV]", "f"], 
     SubscriptBox["\[DoubleStruckCapitalV]", "f"]}]}], TraditionalForm]],
  ExpressionUUID->"3fbc9192-f4a1-4491-8cf0-c5c5b4045999"],
 "."
}], "Text",ExpressionUUID->"cec5d88b-531b-43c0-aa28-51756645b720"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cycling (Original Kaijun\[CloseCurlyQuote]s PIC)", "Subsection",ExpressionUUID->"df5d4812-b343-47b6-abcc-5ef8bb1677b0"],

Cell[TextData[{
 "1. Advance ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalOmega]", 
    RowBox[{"t", "-", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"3cd646b8-aa86-451b-8c61-98bb7ee09901"],
 " by ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalDelta]t", "/", "2"}], TraditionalForm]],ExpressionUUID->
  "17fa050d-f754-425c-ba94-89b797577846"],
 " to ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalOmega]", "t"], TraditionalForm]],ExpressionUUID->
  "83430538-b0a3-417b-95d8-832780df4aff"],
 " using ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalXi]", "t"], TraditionalForm]],ExpressionUUID->
  "4f676efb-b14a-4892-9b81-ecb2bea933e7"],
 ".\n2. Advance ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckV]", 
    RowBox[{"t", "-", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"4d332d65-1f6a-4fb4-a103-7e5394a19fb0"],
 " to ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckV]", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"5a31ca3d-516e-46ad-abca-0ed52d392353"],
 " using ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckX]", "t"], TraditionalForm]],ExpressionUUID->
  "dc7797f3-c863-4fe3-b5a9-b5382a9c2f11"],
 ", ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalOmega]", "t"], TraditionalForm]],ExpressionUUID->
  "284e80df-0b0b-4eeb-81f3-fc332cf27f4e"],
 ", and ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalXi]", "t"], TraditionalForm]],ExpressionUUID->
  "21dba77a-757c-4bfc-a2ce-fc8020f037dc"],
 ".\n2.1 Advance ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[DoubleStruckCapitalV]", "f", 
    RowBox[{"t", "-", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"73e18b0c-51a4-47f4-ad51-50450e75f18d"],
 " to ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[DoubleStruckCapitalV]", "f", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"eca78e71-d72f-4301-a741-2973d5dcb4a8"],
 " using ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalOmega]", "t"], TraditionalForm]],ExpressionUUID->
  "61c573f0-1186-499b-b1d4-9708e5596ffd"],
 " and ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalXi]", "t"], TraditionalForm]],ExpressionUUID->
  "f5468e15-62c1-4c04-a393-87134dc24337"],
 ".\n2.2 Advance ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[Delta]n", "f", "t"], TraditionalForm]],ExpressionUUID->
  "ab404d6e-a040-491b-ba9f-7905ab306b68"],
 " to ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[Delta]n", "f", 
    RowBox[{"t", "+", "\[CapitalDelta]t"}]], TraditionalForm]],ExpressionUUID->
  "ce06dfe5-dd2a-4cf6-839c-9c4b28423f98"],
 " using ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[DoubleStruckCapitalV]", "f", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"f5917abc-509f-4095-b04b-17314b5409e3"],
 ".\n3. Advance ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalOmega]", "t"], TraditionalForm]],ExpressionUUID->
  "877c60fd-a591-4646-ae8e-07a57578b4c1"],
 " by another ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalDelta]t", "/", "2"}], TraditionalForm]],ExpressionUUID->
  "c6c9db8b-0e52-46ef-b572-2e407210c357"],
 " to ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalOmega]", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"d4a41a2f-332e-43c7-9292-a5aa4a255fef"],
 " using ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalXi]", "t"], TraditionalForm]],ExpressionUUID->
  "730f7a05-433e-4dc0-bd50-2ddb6fd53565"],
 ".\n4. Advance ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckX]", "t"], TraditionalForm]],ExpressionUUID->
  "56be2e57-0223-4082-90d9-cb953caaef9b"],
 " by ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalDelta]t", "/", "2"}], TraditionalForm]],ExpressionUUID->
  "7e72b279-211f-4a11-b984-558f704d2bb4"],
 " to ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckX]", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"316f3641-9d2f-459a-b53c-6e93010f5cd0"],
 " using ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckV]", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"4b444911-f50c-4137-98ce-bd70cea4e853"],
 ".\n5. Collect ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ScriptCapitalJ]", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"c5c14d01-2309-4439-b730-9e7be1a6d452"],
 " from the particle positions ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckX]", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"6a28fc77-a81f-4a0e-bc27-2ae161381f31"],
 " and velocities ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckV]", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"db6d896b-544e-4d25-b9a1-51f3ffd1c587"],
 ". \n5.1 Collect ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ScriptCapitalJ]", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"9802e233-d4be-4fef-91e6-8b762f137b84"],
 " from ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[DoubleStruckCapitalV]", "f", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"267948c1-8bd5-4403-8844-3a8f85aa705d"],
 ".\n6. Advance ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckX]", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"0ade8d7b-3120-429b-a8ed-6736b0ae14a4"],
 " by another ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalDelta]t", "/", "2"}], TraditionalForm]],ExpressionUUID->
  "9a8c99e2-f027-40e0-b15c-7801d85140fe"],
 " to ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["x", 
    RowBox[{"t", "+", "\[CapitalDelta]t"}]], TraditionalForm]],ExpressionUUID->
  "5a9e3df2-b0e7-4829-a9b8-a04b5fc052ed"],
 " using ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckV]", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"2468a115-cbbf-4ce5-9637-cf34fc53efba"],
 ". \n7. Advance ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalXi]", "t"], TraditionalForm]],ExpressionUUID->
  "8a416130-f3c1-40a6-a780-a88eacfa8b9d"],
 " to ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalXi]", 
    RowBox[{"t", "+", "\[CapitalDelta]t"}]], TraditionalForm]],ExpressionUUID->
  "bf556ec6-e721-40b7-92bf-a4e682601b8d"],
 " using ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalOmega]", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"67a5fcd9-b3d4-4de7-90da-5c0cb38b4225"],
 " and ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ScriptCapitalJ]", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"f552f83e-7b41-4c11-8dda-989731784e4c"],
 "."
}], "Text",ExpressionUUID->"72a699aa-bea1-4ecc-8f67-f6289b35b09b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", "}"}], ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Text", "[", 
          RowBox[{"#2", ",", 
           RowBox[{"{", 
            RowBox[{"#", ",", "1.5"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "&"}], "@@@", 
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "1"}], "/", "2"}], ",", 
             RowBox[{"3", "/", "2"}], ",", 
             RowBox[{"1", "/", "2"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SuperscriptBox[\(\[CapitalOmega]\), \(t - \
\[CapitalDelta]t/2\)]\)\\n\!\(\*SuperscriptBox[\(\[DoubleStruckV]\), \(t - \
\[CapitalDelta]t/2\)]\)\\n\!\(\*SuperscriptBox[\(\[ScriptCapitalJ]\), \(t - \
\[CapitalDelta]t/2\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[CapitalOmega]\), \(t\)]\)\>\"", 
             ",", "\"\<\!\(\*SuperscriptBox[\(\[CapitalOmega]\), \(t + \
\[CapitalDelta]t/2\)]\)\\n\!\(\*SuperscriptBox[\(\[DoubleStruckV]\), \(t + \
\[CapitalDelta]t/2\)]\)\\n\!\(\*SuperscriptBox[\(\[ScriptCapitalJ]\), \(t + \
\[CapitalDelta]t/2\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[CapitalOmega]\), \(t + \
\[CapitalDelta]t\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[CapitalOmega]\), \(t + 3  \
\[CapitalDelta]t/2\)]\)\\n\!\(\*SuperscriptBox[\(\[DoubleStruckV]\), \(t + 3  \
\[CapitalDelta]t/2\)]\)\\n\!\(\*SuperscriptBox[\(\[ScriptCapitalJ]\), \(t + 3 \
 \[CapitalDelta]t/2\)]\)\>\""}], "}"}]}], "}"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Text", "[", 
          RowBox[{"#2", ",", 
           RowBox[{"{", 
            RowBox[{"#", ",", ".5"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "&"}], "@@@", 
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"1", "/", "2"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SuperscriptBox[\(\[DoubleStruckX]\), \(t - \
\[CapitalDelta]t\)]\)\\n\!\(\*SuperscriptBox[\(\[CapitalXi]\), \(t - \
\[CapitalDelta]t\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[DoubleStruckX]\), \(t - \
\[CapitalDelta]t/2\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[DoubleStruckX]\), \
\(t\)]\)\\n\!\(\*SuperscriptBox[\(\[CapitalXi]\), \(t\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[DoubleStruckX]\), \(t + \
\[CapitalDelta]t/2\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[DoubleStruckX]\), \(t + \
\[CapitalDelta]t\)]\)\\n\!\(\*SuperscriptBox[\(\[CapitalXi]\), \(t + \
\[CapitalDelta]t\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[DoubleStruckX]\), \(t + 3  \
\[CapitalDelta]t/2\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[DoubleStruckX]\), \(t + 2  \
\[CapitalDelta]t\)]\)\\n\!\(\*SuperscriptBox[\(\[CapitalXi]\), \(t + 2  \
\[CapitalDelta]t\)]\)\>\""}], "}"}]}], "}"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Arrowheads", "[", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"Medium", ",", ".55"}], "}"}], "}"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Arrow", "@", 
            RowBox[{"BezierCurve", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#", ",", "1.5"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "+", ".5"}], ",", "2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "+", "1"}], ",", "1.5"}], "}"}]}], "}"}], 
             "]"}]}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "2"}], "]"}], "-", ".5"}], ")"}]}], 
         ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Arrow", "@", 
            RowBox[{"BezierCurve", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#", ",", ".5"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "+", ".5"}], ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "+", "1"}], ",", ".5"}], "}"}]}], "}"}], 
             "]"}]}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Dashed", ",", 
         RowBox[{"Arrowheads", "[", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"Medium", ",", ".55"}], "}"}], "}"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Arrow", "@", 
            RowBox[{"BezierCurve", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#", ",", "1.5"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "+", ".25"}], ",", "1.75"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "+", ".5"}], ",", "1.5"}], "}"}]}], "}"}], 
             "]"}]}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"-", "1"}], ",", 
             RowBox[{"3", "/", "2"}], ",", 
             RowBox[{"1", "/", "2"}]}], "]"}], ")"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Arrow", "@", 
            RowBox[{"BezierCurve", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#", ",", ".5"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "+", ".25"}], ",", ".75"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "+", ".5"}], ",", ".5"}], "}"}]}], "}"}], 
             "]"}]}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            RowBox[{"3", "/", "2"}], ",", 
            RowBox[{"1", "/", "2"}]}], "]"}]}]}], "}"}]}], 
      "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "2"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{".5", ",", "\"\<\[DoubleStruckX],\[CapitalXi]\>\""}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "1.5", ",", 
              "\"\<\[DoubleStruckV],\[ScriptCapitalJ],\[CapitalOmega]\>\""}], 
             "}"}]}], "}"}], ",", "None"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "\"\<t-\[CapitalDelta]t\>\""}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "1"}], "/", "2"}], ",", 
              "\"\<t-\[CapitalDelta]t/2\>\""}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "\"\<t\>\""}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1", "/", "2"}], ",", "\"\<t+\[CapitalDelta]t/2\>\""}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "\"\<t+\[CapitalDelta]t\>\""}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"3", "/", "2"}], ",", "\"\<t+3\[CapitalDelta]t/2\>\""}],
              "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "\"\<t+2\[CapitalDelta]t\>\""}], "}"}]}], 
           "}"}], ",", "None"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", 
     RowBox[{"GridLines", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "2", ",", 
          RowBox[{"1", "/", "2"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{".5", ",", "1.5"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"GridLinesStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Dotted", ",", "Gray"}], "]"}]}], ",", 
     RowBox[{"PlotRangePadding", "\[Rule]", 
      RowBox[{"Scaled", "[", ".04", "]"}]}], ",", 
     RowBox[{"PlotRangeClipping", "\[Rule]", "True"}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", "15"}]}], "]"}]}], "]"}]], "Input",
 Editable->False,
 CellOpen->False,ExpressionUUID->"7063d1bc-e7bb-4976-8aac-764234e1fca9"],

Cell[BoxData[
 GraphicsBox[{{
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[CapitalOmega]\\), \\(t - \
\[CapitalDelta]t/2\\)]\\)\\n\\!\\(\\*SuperscriptBox[\\(\[DoubleStruckV]\\), \
\\(t - \[CapitalDelta]t/2\\)]\\)\\n\\!\\(\\*SuperscriptBox[\\(\
\[ScriptCapitalJ]\\), \\(t - \[CapitalDelta]t/2\\)]\\)\"\>", 
     NCache[{Rational[-1, 2], 1.5}, {-0.5, 1.5}], {0, 1}], 
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[CapitalOmega]\\), \
\\(t\\)]\\)\"\>", {0, 1.5}, {0, 1}], 
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[CapitalOmega]\\), \\(t + \
\[CapitalDelta]t/2\\)]\\)\\n\\!\\(\\*SuperscriptBox[\\(\[DoubleStruckV]\\), \
\\(t + \[CapitalDelta]t/2\\)]\\)\\n\\!\\(\\*SuperscriptBox[\\(\
\[ScriptCapitalJ]\\), \\(t + \[CapitalDelta]t/2\\)]\\)\"\>", 
     NCache[{Rational[1, 2], 1.5}, {0.5, 1.5}], {0, 1}], 
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[CapitalOmega]\\), \\(t + \
\[CapitalDelta]t\\)]\\)\"\>", {1, 1.5}, {0, 1}], 
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[CapitalOmega]\\), \\(t + 3  \
\[CapitalDelta]t/2\\)]\\)\\n\\!\\(\\*SuperscriptBox[\\(\[DoubleStruckV]\\), \
\\(t + 3  \[CapitalDelta]t/2\\)]\\)\\n\\!\\(\\*SuperscriptBox[\\(\
\[ScriptCapitalJ]\\), \\(t + 3  \[CapitalDelta]t/2\\)]\\)\"\>", 
     NCache[{Rational[3, 2], 1.5}, {1.5, 1.5}], {0, 1}]}, {
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[DoubleStruckX]\\), \\(t - \
\[CapitalDelta]t\\)]\\)\\n\\!\\(\\*SuperscriptBox[\\(\[CapitalXi]\\), \\(t - \
\[CapitalDelta]t\\)]\\)\"\>", {-1, 0.5}, {0, 1}], 
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[DoubleStruckX]\\), \\(t - \
\[CapitalDelta]t/2\\)]\\)\"\>", 
     NCache[{Rational[-1, 2], 0.5}, {-0.5, 0.5}], {0, 1}], 
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[DoubleStruckX]\\), \\(t\\)]\\)\
\\n\\!\\(\\*SuperscriptBox[\\(\[CapitalXi]\\), \\(t\\)]\\)\"\>", {0, 0.5}, \
{0, 1}], InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[DoubleStruckX]\\), \\(t + \
\[CapitalDelta]t/2\\)]\\)\"\>", 
     NCache[{Rational[1, 2], 0.5}, {0.5, 0.5}], {0, 1}], 
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[DoubleStruckX]\\), \\(t + \
\[CapitalDelta]t\\)]\\)\\n\\!\\(\\*SuperscriptBox[\\(\[CapitalXi]\\), \\(t + \
\[CapitalDelta]t\\)]\\)\"\>", {1, 0.5}, {0, 1}], 
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[DoubleStruckX]\\), \\(t + 3  \
\[CapitalDelta]t/2\\)]\\)\"\>", 
     NCache[{Rational[3, 2], 0.5}, {1.5, 0.5}], {0, 1}], 
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[DoubleStruckX]\\), \\(t + 2  \
\[CapitalDelta]t\\)]\\)\\n\\!\\(\\*SuperscriptBox[\\(\[CapitalXi]\\), \\(t + \
2  \[CapitalDelta]t\\)]\\)\"\>", {2, 0.5}, {0, 1}]}, 
   {Arrowheads[{{Medium, 0.55}}], {
     ArrowBox[BezierCurveBox[{{-1.5, 1.5}, {-1., 2}, {-0.5, 1.5}}]], 
     ArrowBox[BezierCurveBox[{{-0.5, 1.5}, {0., 2}, {0.5, 1.5}}]], 
     ArrowBox[BezierCurveBox[{{0.5, 1.5}, {1., 2}, {1.5, 1.5}}]], 
     ArrowBox[BezierCurveBox[{{1.5, 1.5}, {2., 2}, {2.5, 1.5}}]]}, {
     ArrowBox[BezierCurveBox[{{-1, 0.5}, {-0.5, 1}, {0, 0.5}}]], 
     ArrowBox[BezierCurveBox[{{0, 0.5}, {0.5, 1}, {1, 0.5}}]], 
     ArrowBox[BezierCurveBox[{{1, 0.5}, {1.5, 1}, {2, 0.5}}]]}}, 
   {Dashing[{Small, Small}], 
    Arrowheads[{{Medium, 0.55}}], {
     ArrowBox[BezierCurveBox[{{-1, 1.5}, {-0.75, 1.75}, {-0.5, 1.5}}]], 
     ArrowBox[BezierCurveBox[
      NCache[{{Rational[-1, 2], 1.5}, {-0.25, 1.75}, {0., 1.5}}, {{-0.5, 
       1.5}, {-0.25, 1.75}, {0., 1.5}}]]], 
     ArrowBox[BezierCurveBox[{{0, 1.5}, {0.25, 1.75}, {0.5, 1.5}}]], 
     ArrowBox[BezierCurveBox[
      NCache[{{Rational[1, 2], 1.5}, {0.75, 1.75}, {1., 1.5}}, {{0.5, 1.5}, {
       0.75, 1.75}, {1., 1.5}}]]], 
     ArrowBox[BezierCurveBox[{{1, 1.5}, {1.25, 1.75}, {1.5, 1.5}}]], 
     ArrowBox[BezierCurveBox[
      NCache[{{Rational[3, 2], 1.5}, {1.75, 1.75}, {2., 1.5}}, {{1.5, 1.5}, {
       1.75, 1.75}, {2., 1.5}}]]]}, {
     ArrowBox[BezierCurveBox[{{-1, 0.5}, {-0.75, 0.75}, {-0.5, 0.5}}]], 
     ArrowBox[BezierCurveBox[
      NCache[{{Rational[-1, 2], 0.5}, {-0.25, 0.75}, {0., 0.5}}, {{-0.5, 
       0.5}, {-0.25, 0.75}, {0., 0.5}}]]], 
     ArrowBox[BezierCurveBox[{{0, 0.5}, {0.25, 0.75}, {0.5, 0.5}}]], 
     ArrowBox[BezierCurveBox[
      NCache[{{Rational[1, 2], 0.5}, {0.75, 0.75}, {1., 0.5}}, {{0.5, 0.5}, {
       0.75, 0.75}, {1., 0.5}}]]], 
     ArrowBox[BezierCurveBox[{{1, 0.5}, {1.25, 0.75}, {1.5, 0.5}}]], 
     ArrowBox[BezierCurveBox[
      NCache[{{Rational[3, 2], 0.5}, {1.75, 0.75}, {2., 0.5}}, {{1.5, 0.5}, {
       1.75, 0.75}, {2., 0.5}}]]]}}},
  AspectRatio->NCache[
    Rational[1, 2], 0.5],
  BaseStyle->15,
  Frame->{{True, False}, {True, False}},
  FrameTicks->{{{{0.5, 
       FormBox["\"\[DoubleStruckX],\[CapitalXi]\"", TraditionalForm]}, {1.5, 
       FormBox[
       "\"\[DoubleStruckV],\[ScriptCapitalJ],\[CapitalOmega]\"", 
        TraditionalForm]}}, None}, {{{-1, 
       FormBox["\"t-\[CapitalDelta]t\"", TraditionalForm]}, {
       NCache[
        Rational[-1, 2], -0.5], 
       FormBox["\"t-\[CapitalDelta]t/2\"", TraditionalForm]}, {0, 
       FormBox["\"t\"", TraditionalForm]}, {
       NCache[
        Rational[1, 2], 0.5], 
       FormBox["\"t+\[CapitalDelta]t/2\"", TraditionalForm]}, {1, 
       FormBox["\"t+\[CapitalDelta]t\"", TraditionalForm]}, {
       NCache[
        Rational[3, 2], 1.5], 
       FormBox["\"t+3\[CapitalDelta]t/2\"", TraditionalForm]}, {2, 
       FormBox["\"t+2\[CapitalDelta]t\"", TraditionalForm]}}, None}},
  GridLines->NCache[{{-1, 
      Rational[-1, 2], 0, 
      Rational[1, 2], 1, 
      Rational[3, 2], 2}, {0.5, 1.5}}, {{-1, -0.5, 0, 0.5, 1, 1.5, 2}, {0.5, 
     1.5}}],
  GridLinesStyle->Directive[
    Dashing[{0, Small}], 
    GrayLevel[0.5]],
  ImageSize->Large,
  PlotRange->{{-1, 2}, {0, 2}},
  PlotRangeClipping->True,
  PlotRangePadding->Scaled[0.04]]], "Output",ExpressionUUID->"987154df-fe5e-\
4d49-84ef-58e2a6c496ad"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cycling (Modified)", "Subsection",ExpressionUUID->"71d8df89-8dc7-43a7-9bbb-27460bfeaee1"],

Cell[TextData[{
 "1. Advance ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalOmega]", 
    RowBox[{"t", "-", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"75a50ca0-07a9-4a7f-8c3a-848b04f39387"],
 " by ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalDelta]t", "/", "2"}], TraditionalForm]],ExpressionUUID->
  "5a714b6b-c040-4fda-bd6f-d26cf1ac8cf7"],
 " to ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalOmega]", "t"], TraditionalForm]],ExpressionUUID->
  "79046d2d-1f02-4f67-a395-c873253f01bd"],
 " using ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalXi]", "t"], TraditionalForm]],ExpressionUUID->
  "805ea1f4-5c24-4697-b2fe-71847414656b"],
 ".\n2. Advance ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckV]", 
    RowBox[{"t", "-", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"605fd04f-c3e0-44a9-9f7e-041b09a3b4b2"],
 " to ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckV]", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"bec5ce1d-399f-4b47-a36a-4ffa53444c8a"],
 " using ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckX]", "t"], TraditionalForm]],ExpressionUUID->
  "4b8a74aa-1ccc-46b5-89d5-e1f3bb387ed2"],
 ", ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalOmega]", "t"], TraditionalForm]],ExpressionUUID->
  "0ae5cff1-a276-4227-a620-989057e0dc1e"],
 ", and ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalXi]", "t"], TraditionalForm]],ExpressionUUID->
  "24fb2b0a-63ce-4d6d-9218-14a3b9666847"],
 ". \n2.1 Advance ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[DoubleStruckCapitalV]", "f", 
    RowBox[{"t", "-", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"94dac478-2dae-45c7-b081-27142f12b185"],
 " to ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[DoubleStruckCapitalV]", "f", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"7e93de7d-6a9d-4d92-ab17-b966b7f565c4"],
 " using ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalOmega]", "t"], TraditionalForm]],ExpressionUUID->
  "4c586e97-dbaa-48c7-9e8a-80dcb412863e"],
 " and ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalXi]", "t"], TraditionalForm]],ExpressionUUID->
  "b373a1b6-3e98-43a9-a84b-720b2d2cfcaa"],
 ".\n2.2 Advance ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[Delta]n", "f", "t"], TraditionalForm]],ExpressionUUID->
  "b0f672c3-7bb0-4f17-9bc5-dbe87590ec49"],
 " to ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[Delta]n", "f", 
    RowBox[{"t", "+", "\[CapitalDelta]t"}]], TraditionalForm]],ExpressionUUID->
  "cddfe032-e477-4666-b86b-4255f85c6a97"],
 " using ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[DoubleStruckCapitalV]", "f", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"68211b0d-6a90-4ce6-a5d3-28fea6a3094b"],
 ".\n3. Advance ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalOmega]", "t"], TraditionalForm]],ExpressionUUID->
  "bb040a56-d5cb-43d4-b659-7db072c3742c"],
 " by another ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalDelta]t", "/", "2"}], TraditionalForm]],ExpressionUUID->
  "a6c5d4cd-d029-482b-8abb-c05a642b55d7"],
 " to ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalOmega]", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"5429e067-770e-4636-83f8-c6a805b6e235"],
 " using ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalXi]", "t"], TraditionalForm]],ExpressionUUID->
  "e98a7a2c-304d-46e7-922b-27ecb6b1ce10"],
 ".\n4. Collect ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ScriptCapitalJ]", "-"], TraditionalForm]],ExpressionUUID->
  "a285b756-8725-4263-9446-2de33a16ba5e"],
 " from the particle positions ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckX]", "t"], TraditionalForm]],ExpressionUUID->
  "96eac3f3-bc0b-4760-84b8-c0afabde5dd3"],
 " and velocities ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckV]", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"3af42a80-4c7d-4e8e-990f-f5ad7d918b12"],
 ".\n5. Advance ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckX]", "t"], TraditionalForm]],ExpressionUUID->
  "ee8705eb-f7c3-4d26-a251-38e8681bbea9"],
 " by ",
 Cell[BoxData[
  FormBox["\[CapitalDelta]t", TraditionalForm]],ExpressionUUID->
  "5417a6e7-f144-4384-ad02-a54d8dc451a0"],
 " to ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckX]", 
    RowBox[{"t", "+", "\[CapitalDelta]t"}]], TraditionalForm]],ExpressionUUID->
  "cec1208a-6042-4b0c-bacb-7fbe7020b442"],
 " using ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckV]", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"5f725bc8-939f-4fbd-9e9c-8ec03c0d58c7"],
 ".\n6. Collect ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ScriptCapitalJ]", "+"], TraditionalForm]],ExpressionUUID->
  "7ffeb00e-5ef5-4ab5-8355-92b9cb0bbc0b"],
 " from the particle positions ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckX]", 
    RowBox[{"t", "+", "\[CapitalDelta]t"}]], TraditionalForm]],ExpressionUUID->
  "1cb91399-9064-46a6-95c6-42a49d795e41"],
 " and velocities ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckV]", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"7c676a4c-e3ff-46a9-acd7-066de101169f"],
 ", and calculate ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[ScriptCapitalJ]", 
     RowBox[{"t", "+", 
      RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ScriptCapitalJ]", "-"], "+", 
       SuperscriptBox["\[ScriptCapitalJ]", "+"]}], ")"}], "/", "2"}]}], 
   TraditionalForm]],ExpressionUUID->"5c00857f-93b1-4a76-b46d-79ad9c82c4c4"],
 ".\n6.1 Collect ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ScriptCapitalJ]", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"5618ad57-8406-4160-9c08-9135479957c8"],
 " from ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[DoubleStruckCapitalV]", "f", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"d94bdf24-7c9b-4470-84e0-f58b16aa81a6"],
 ".\n7. Advance ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalXi]", "t"], TraditionalForm]],ExpressionUUID->
  "5ea1c025-912f-4643-a615-ddbe7db3083f"],
 " to ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalXi]", 
    RowBox[{"t", "+", "\[CapitalDelta]t"}]], TraditionalForm]],ExpressionUUID->
  "c9ae8f86-c3c6-4ae8-be45-7aac6c309725"],
 " using ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalOmega]", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"1dd76fbf-0e73-458d-87b4-099148b9a556"],
 " and ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ScriptCapitalJ]", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"7ab53fe1-6810-4e5e-b4c3-3a63a49bb17d"],
 "."
}], "Text",ExpressionUUID->"47cb1a90-c3b6-494c-86c1-f829b47b5941"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", "}"}], ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Text", "[", 
          RowBox[{"#2", ",", 
           RowBox[{"{", 
            RowBox[{"#", ",", "1.5"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "&"}], "@@@", 
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "1"}], "/", "2"}], ",", 
             RowBox[{"3", "/", "2"}], ",", 
             RowBox[{"1", "/", "2"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SuperscriptBox[\(\[CapitalOmega]\), \(t - \
\[CapitalDelta]t/2\)]\)\\n\!\(\*SuperscriptBox[\(\[DoubleStruckV]\), \(t - \
\[CapitalDelta]t/2\)]\)\\n\!\(\*SuperscriptBox[\(\[ScriptCapitalJ]\), \(t - \
\[CapitalDelta]t/2\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[CapitalOmega]\), \(t\)]\)\>\"", 
             ",", "\"\<\!\(\*SuperscriptBox[\(\[CapitalOmega]\), \(t + \
\[CapitalDelta]t/2\)]\)\\n\!\(\*SuperscriptBox[\(\[DoubleStruckV]\), \(t + \
\[CapitalDelta]t/2\)]\)\\n\!\(\*SuperscriptBox[\(\[ScriptCapitalJ]\), \(t + \
\[CapitalDelta]t/2\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[CapitalOmega]\), \(t + \
\[CapitalDelta]t\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[CapitalOmega]\), \(t + 3  \
\[CapitalDelta]t/2\)]\)\\n\!\(\*SuperscriptBox[\(\[DoubleStruckV]\), \(t + 3  \
\[CapitalDelta]t/2\)]\)\\n\!\(\*SuperscriptBox[\(\[ScriptCapitalJ]\), \(t + 3 \
 \[CapitalDelta]t/2\)]\)\>\""}], "}"}]}], "}"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Text", "[", 
          RowBox[{"#2", ",", 
           RowBox[{"{", 
            RowBox[{"#", ",", ".5"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "&"}], "@@@", 
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"1", "/", "2"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SuperscriptBox[\(\[DoubleStruckX]\), \(t - \
\[CapitalDelta]t\)]\)\\n\!\(\*SuperscriptBox[\(\[CapitalXi]\), \(t - \
\[CapitalDelta]t\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[DoubleStruckX]\), \(t - \
\[CapitalDelta]t/2\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[DoubleStruckX]\), \
\(t\)]\)\\n\!\(\*SuperscriptBox[\(\[CapitalXi]\), \(t\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[DoubleStruckX]\), \(t + \
\[CapitalDelta]t/2\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[DoubleStruckX]\), \(t + \
\[CapitalDelta]t\)]\)\\n\!\(\*SuperscriptBox[\(\[CapitalXi]\), \(t + \
\[CapitalDelta]t\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[DoubleStruckX]\), \(t + 3  \
\[CapitalDelta]t/2\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[DoubleStruckX]\), \(t + 2  \
\[CapitalDelta]t\)]\)\\n\!\(\*SuperscriptBox[\(\[CapitalXi]\), \(t + 2  \
\[CapitalDelta]t\)]\)\>\""}], "}"}]}], "}"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Arrowheads", "[", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"Medium", ",", ".55"}], "}"}], "}"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Arrow", "@", 
            RowBox[{"BezierCurve", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#", ",", "1.5"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "+", ".5"}], ",", "2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "+", "1"}], ",", "1.5"}], "}"}]}], "}"}], 
             "]"}]}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "2"}], "]"}], "-", ".5"}], ")"}]}], 
         ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Arrow", "@", 
            RowBox[{"BezierCurve", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#", ",", ".5"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "+", ".5"}], ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "+", "1"}], ",", ".5"}], "}"}]}], "}"}], 
             "]"}]}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Dashed", ",", 
         RowBox[{"Arrowheads", "[", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"Medium", ",", ".55"}], "}"}], "}"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Arrow", "@", 
            RowBox[{"BezierCurve", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#", ",", "1.5"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "+", ".25"}], ",", "1.75"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "+", ".5"}], ",", "1.5"}], "}"}]}], "}"}], 
             "]"}]}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"-", "1"}], ",", 
             RowBox[{"3", "/", "2"}], ",", 
             RowBox[{"1", "/", "2"}]}], "]"}], ")"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Arrow", "@", 
            RowBox[{"BezierCurve", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#", ",", ".5"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "+", ".25"}], ",", ".75"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "+", ".5"}], ",", ".5"}], "}"}]}], "}"}], 
             "]"}]}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            RowBox[{"3", "/", "2"}], ",", 
            RowBox[{"1", "/", "2"}]}], "]"}]}]}], "}"}]}], 
      "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "2"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{".5", ",", "\"\<\[DoubleStruckX],\[CapitalXi]\>\""}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "1.5", ",", 
              "\"\<\[DoubleStruckV],\[ScriptCapitalJ],\[CapitalOmega]\>\""}], 
             "}"}]}], "}"}], ",", "None"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "\"\<t-\[CapitalDelta]t\>\""}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "1"}], "/", "2"}], ",", 
              "\"\<t-\[CapitalDelta]t/2\>\""}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "\"\<t\>\""}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1", "/", "2"}], ",", "\"\<t+\[CapitalDelta]t/2\>\""}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "\"\<t+\[CapitalDelta]t\>\""}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"3", "/", "2"}], ",", "\"\<t+3\[CapitalDelta]t/2\>\""}],
              "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "\"\<t+2\[CapitalDelta]t\>\""}], "}"}]}], 
           "}"}], ",", "None"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", 
     RowBox[{"GridLines", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "2", ",", 
          RowBox[{"1", "/", "2"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{".5", ",", "1.5"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"GridLinesStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Dotted", ",", "Gray"}], "]"}]}], ",", 
     RowBox[{"PlotRangePadding", "\[Rule]", 
      RowBox[{"Scaled", "[", ".04", "]"}]}], ",", 
     RowBox[{"PlotRangeClipping", "\[Rule]", "True"}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", "15"}]}], "]"}]}], "]"}]], "Input",
 Editable->False,
 CellOpen->False,ExpressionUUID->"24ececd0-d501-46c2-9a01-d07868be0773"],

Cell[BoxData[
 GraphicsBox[{{
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[CapitalOmega]\\), \\(t - \
\[CapitalDelta]t/2\\)]\\)\\n\\!\\(\\*SuperscriptBox[\\(\[DoubleStruckV]\\), \
\\(t - \[CapitalDelta]t/2\\)]\\)\\n\\!\\(\\*SuperscriptBox[\\(\
\[ScriptCapitalJ]\\), \\(t - \[CapitalDelta]t/2\\)]\\)\"\>", 
     NCache[{Rational[-1, 2], 1.5}, {-0.5, 1.5}], {0, 1}], 
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[CapitalOmega]\\), \
\\(t\\)]\\)\"\>", {0, 1.5}, {0, 1}], 
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[CapitalOmega]\\), \\(t + \
\[CapitalDelta]t/2\\)]\\)\\n\\!\\(\\*SuperscriptBox[\\(\[DoubleStruckV]\\), \
\\(t + \[CapitalDelta]t/2\\)]\\)\\n\\!\\(\\*SuperscriptBox[\\(\
\[ScriptCapitalJ]\\), \\(t + \[CapitalDelta]t/2\\)]\\)\"\>", 
     NCache[{Rational[1, 2], 1.5}, {0.5, 1.5}], {0, 1}], 
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[CapitalOmega]\\), \\(t + \
\[CapitalDelta]t\\)]\\)\"\>", {1, 1.5}, {0, 1}], 
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[CapitalOmega]\\), \\(t + 3  \
\[CapitalDelta]t/2\\)]\\)\\n\\!\\(\\*SuperscriptBox[\\(\[DoubleStruckV]\\), \
\\(t + 3  \[CapitalDelta]t/2\\)]\\)\\n\\!\\(\\*SuperscriptBox[\\(\
\[ScriptCapitalJ]\\), \\(t + 3  \[CapitalDelta]t/2\\)]\\)\"\>", 
     NCache[{Rational[3, 2], 1.5}, {1.5, 1.5}], {0, 1}]}, {
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[DoubleStruckX]\\), \\(t - \
\[CapitalDelta]t\\)]\\)\\n\\!\\(\\*SuperscriptBox[\\(\[CapitalXi]\\), \\(t - \
\[CapitalDelta]t\\)]\\)\"\>", {-1, 0.5}, {0, 1}], 
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[DoubleStruckX]\\), \\(t - \
\[CapitalDelta]t/2\\)]\\)\"\>", 
     NCache[{Rational[-1, 2], 0.5}, {-0.5, 0.5}], {0, 1}], 
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[DoubleStruckX]\\), \\(t\\)]\\)\
\\n\\!\\(\\*SuperscriptBox[\\(\[CapitalXi]\\), \\(t\\)]\\)\"\>", {0, 0.5}, \
{0, 1}], InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[DoubleStruckX]\\), \\(t + \
\[CapitalDelta]t/2\\)]\\)\"\>", 
     NCache[{Rational[1, 2], 0.5}, {0.5, 0.5}], {0, 1}], 
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[DoubleStruckX]\\), \\(t + \
\[CapitalDelta]t\\)]\\)\\n\\!\\(\\*SuperscriptBox[\\(\[CapitalXi]\\), \\(t + \
\[CapitalDelta]t\\)]\\)\"\>", {1, 0.5}, {0, 1}], 
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[DoubleStruckX]\\), \\(t + 3  \
\[CapitalDelta]t/2\\)]\\)\"\>", 
     NCache[{Rational[3, 2], 0.5}, {1.5, 0.5}], {0, 1}], 
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[DoubleStruckX]\\), \\(t + 2  \
\[CapitalDelta]t\\)]\\)\\n\\!\\(\\*SuperscriptBox[\\(\[CapitalXi]\\), \\(t + \
2  \[CapitalDelta]t\\)]\\)\"\>", {2, 0.5}, {0, 1}]}, 
   {Arrowheads[{{Medium, 0.55}}], {
     ArrowBox[BezierCurveBox[{{-1.5, 1.5}, {-1., 2}, {-0.5, 1.5}}]], 
     ArrowBox[BezierCurveBox[{{-0.5, 1.5}, {0., 2}, {0.5, 1.5}}]], 
     ArrowBox[BezierCurveBox[{{0.5, 1.5}, {1., 2}, {1.5, 1.5}}]], 
     ArrowBox[BezierCurveBox[{{1.5, 1.5}, {2., 2}, {2.5, 1.5}}]]}, {
     ArrowBox[BezierCurveBox[{{-1, 0.5}, {-0.5, 1}, {0, 0.5}}]], 
     ArrowBox[BezierCurveBox[{{0, 0.5}, {0.5, 1}, {1, 0.5}}]], 
     ArrowBox[BezierCurveBox[{{1, 0.5}, {1.5, 1}, {2, 0.5}}]]}}, 
   {Dashing[{Small, Small}], 
    Arrowheads[{{Medium, 0.55}}], {
     ArrowBox[BezierCurveBox[{{-1, 1.5}, {-0.75, 1.75}, {-0.5, 1.5}}]], 
     ArrowBox[BezierCurveBox[
      NCache[{{Rational[-1, 2], 1.5}, {-0.25, 1.75}, {0., 1.5}}, {{-0.5, 
       1.5}, {-0.25, 1.75}, {0., 1.5}}]]], 
     ArrowBox[BezierCurveBox[{{0, 1.5}, {0.25, 1.75}, {0.5, 1.5}}]], 
     ArrowBox[BezierCurveBox[
      NCache[{{Rational[1, 2], 1.5}, {0.75, 1.75}, {1., 1.5}}, {{0.5, 1.5}, {
       0.75, 1.75}, {1., 1.5}}]]], 
     ArrowBox[BezierCurveBox[{{1, 1.5}, {1.25, 1.75}, {1.5, 1.5}}]], 
     ArrowBox[BezierCurveBox[
      NCache[{{Rational[3, 2], 1.5}, {1.75, 1.75}, {2., 1.5}}, {{1.5, 1.5}, {
       1.75, 1.75}, {2., 1.5}}]]]}, {
     ArrowBox[BezierCurveBox[{{-1, 0.5}, {-0.75, 0.75}, {-0.5, 0.5}}]], 
     ArrowBox[BezierCurveBox[
      NCache[{{Rational[-1, 2], 0.5}, {-0.25, 0.75}, {0., 0.5}}, {{-0.5, 
       0.5}, {-0.25, 0.75}, {0., 0.5}}]]], 
     ArrowBox[BezierCurveBox[{{0, 0.5}, {0.25, 0.75}, {0.5, 0.5}}]], 
     ArrowBox[BezierCurveBox[
      NCache[{{Rational[1, 2], 0.5}, {0.75, 0.75}, {1., 0.5}}, {{0.5, 0.5}, {
       0.75, 0.75}, {1., 0.5}}]]], 
     ArrowBox[BezierCurveBox[{{1, 0.5}, {1.25, 0.75}, {1.5, 0.5}}]], 
     ArrowBox[BezierCurveBox[
      NCache[{{Rational[3, 2], 0.5}, {1.75, 0.75}, {2., 0.5}}, {{1.5, 0.5}, {
       1.75, 0.75}, {2., 0.5}}]]]}}},
  AspectRatio->NCache[
    Rational[1, 2], 0.5],
  BaseStyle->15,
  Frame->{{True, False}, {True, False}},
  FrameTicks->{{{{0.5, 
       FormBox["\"\[DoubleStruckX],\[CapitalXi]\"", TraditionalForm]}, {1.5, 
       FormBox[
       "\"\[DoubleStruckV],\[ScriptCapitalJ],\[CapitalOmega]\"", 
        TraditionalForm]}}, None}, {{{-1, 
       FormBox["\"t-\[CapitalDelta]t\"", TraditionalForm]}, {
       NCache[
        Rational[-1, 2], -0.5], 
       FormBox["\"t-\[CapitalDelta]t/2\"", TraditionalForm]}, {0, 
       FormBox["\"t\"", TraditionalForm]}, {
       NCache[
        Rational[1, 2], 0.5], 
       FormBox["\"t+\[CapitalDelta]t/2\"", TraditionalForm]}, {1, 
       FormBox["\"t+\[CapitalDelta]t\"", TraditionalForm]}, {
       NCache[
        Rational[3, 2], 1.5], 
       FormBox["\"t+3\[CapitalDelta]t/2\"", TraditionalForm]}, {2, 
       FormBox["\"t+2\[CapitalDelta]t\"", TraditionalForm]}}, None}},
  GridLines->NCache[{{-1, 
      Rational[-1, 2], 0, 
      Rational[1, 2], 1, 
      Rational[3, 2], 2}, {0.5, 1.5}}, {{-1, -0.5, 0, 0.5, 1, 1.5, 2}, {0.5, 
     1.5}}],
  GridLinesStyle->Directive[
    Dashing[{0, Small}], 
    GrayLevel[0.5]],
  ImageSize->Large,
  PlotRange->{{-1, 2}, {0, 2}},
  PlotRangeClipping->True,
  PlotRangePadding->Scaled[0.04]]], "Output",ExpressionUUID->"0f7a4f9f-9606-\
4e71-aa67-4315e7203019"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Discretization", "Section",ExpressionUUID->"735867a3-e5a7-485e-b7a9-2fffb01620a9"],

Cell[TextData[{
 "Maxwells equations:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         RowBox[{"\[PartialD]", 
          SuperscriptBox["\[CapitalXi]", "1"]}], "/", 
         RowBox[{"\[PartialD]", "t"}]}]},
       {
        RowBox[{
         RowBox[{"\[PartialD]", 
          SuperscriptBox["\[CapitalXi]", "2"]}], "/", 
         RowBox[{"\[PartialD]", "t"}]}]},
       {
        RowBox[{
         RowBox[{"\[PartialD]", 
          SuperscriptBox["\[CapitalXi]", "3"]}], "/", 
         RowBox[{"\[PartialD]", "t"}]}]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{
      FractionBox["c", 
       SqrtBox["g"]], 
      RowBox[{"(", GridBox[{
         {
          RowBox[{
           RowBox[{
            RowBox[{"\[PartialD]", 
             SubscriptBox["\[CapitalOmega]", "3"]}], "/", 
            RowBox[{"\[PartialD]", 
             SuperscriptBox["x", "2"]}]}], "-", 
           RowBox[{
            RowBox[{"\[PartialD]", 
             SubscriptBox["\[CapitalOmega]", "2"]}], "/", 
            RowBox[{"\[PartialD]", 
             SuperscriptBox["x", "3"]}]}]}]},
         {
          RowBox[{
           RowBox[{
            RowBox[{"\[PartialD]", 
             SubscriptBox["\[CapitalOmega]", "1"]}], "/", 
            RowBox[{"\[PartialD]", 
             SuperscriptBox["x", "3"]}]}], "-", 
           RowBox[{
            RowBox[{"\[PartialD]", 
             SubscriptBox["\[CapitalOmega]", "3"]}], "/", 
            RowBox[{"\[PartialD]", 
             SuperscriptBox["x", "1"]}]}]}]},
         {
          RowBox[{
           RowBox[{
            RowBox[{"\[PartialD]", 
             SubscriptBox["\[CapitalOmega]", "2"]}], "/", 
            RowBox[{"\[PartialD]", 
             SuperscriptBox["x", "1"]}]}], "-", 
           RowBox[{
            RowBox[{"\[PartialD]", 
             SubscriptBox["\[CapitalOmega]", "1"]}], "/", 
            RowBox[{"\[PartialD]", 
             SuperscriptBox["x", "2"]}]}]}]}
        }], ")"}]}], "-", 
     RowBox[{"(", GridBox[{
        {
         SuperscriptBox["\[ScriptCapitalJ]", "1"]},
        {
         SuperscriptBox["\[ScriptCapitalJ]", "2"]},
        {
         SuperscriptBox["\[ScriptCapitalJ]", "3"]}
       }], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "53b3bc64-2498-4d05-8e44-43faaefcd2e4"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         RowBox[{"\[PartialD]", 
          SuperscriptBox["\[CapitalOmega]", "1"]}], "/", 
         RowBox[{"\[PartialD]", "t"}]}]},
       {
        RowBox[{
         RowBox[{"\[PartialD]", 
          SuperscriptBox["\[CapitalOmega]", "2"]}], "/", 
         RowBox[{"\[PartialD]", "t"}]}]},
       {
        RowBox[{
         RowBox[{"\[PartialD]", 
          SuperscriptBox["\[CapitalOmega]", "3"]}], "/", 
         RowBox[{"\[PartialD]", "t"}]}]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["c", 
       SqrtBox["g"]]}], 
     RowBox[{"(", GridBox[{
        {
         RowBox[{
          RowBox[{
           RowBox[{"\[PartialD]", 
            SubscriptBox["\[CapitalXi]", "3"]}], "/", 
           RowBox[{"\[PartialD]", 
            SuperscriptBox["x", "2"]}]}], "-", 
          RowBox[{
           RowBox[{"\[PartialD]", 
            SubscriptBox["\[CapitalXi]", "2"]}], "/", 
           RowBox[{"\[PartialD]", 
            SuperscriptBox["x", "3"]}]}]}]},
        {
         RowBox[{
          RowBox[{
           RowBox[{"\[PartialD]", 
            SubscriptBox["\[CapitalXi]", "1"]}], "/", 
           RowBox[{"\[PartialD]", 
            SuperscriptBox["x", "3"]}]}], "-", 
          RowBox[{
           RowBox[{"\[PartialD]", 
            SubscriptBox["\[CapitalXi]", "3"]}], "/", 
           RowBox[{"\[PartialD]", 
            SuperscriptBox["x", "1"]}]}]}]},
        {
         RowBox[{
          RowBox[{
           RowBox[{"\[PartialD]", 
            SubscriptBox["\[CapitalXi]", "2"]}], "/", 
           RowBox[{"\[PartialD]", 
            SuperscriptBox["x", "1"]}]}], "-", 
          RowBox[{
           RowBox[{"\[PartialD]", 
            SubscriptBox["\[CapitalXi]", "1"]}], "/", 
           RowBox[{"\[PartialD]", 
            SuperscriptBox["x", "2"]}]}]}]}
       }], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "c5917e72-36df-4808-ab1a-620f15fb816a"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"c", "(", 
      RowBox[{
       RowBox[{
        RowBox[{"\[PartialD]", 
         SuperscriptBox["\[CapitalXi]", "1"]}], "/", 
        RowBox[{"\[PartialD]", 
         SuperscriptBox["x", "1"]}]}], "+", 
       RowBox[{
        RowBox[{"\[PartialD]", 
         SuperscriptBox["\[CapitalXi]", "2"]}], "/", 
        RowBox[{"\[PartialD]", 
         SuperscriptBox["x", "2"]}]}], "+", 
       RowBox[{
        RowBox[{"\[PartialD]", 
         SuperscriptBox["\[CapitalXi]", "3"]}], "/", 
        RowBox[{"\[PartialD]", 
         SuperscriptBox["x", "3"]}]}]}], ")"}], "+", 
     RowBox[{
      FractionBox["c", 
       SqrtBox["g"]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[CapitalXi]", "1"], 
         RowBox[{
          RowBox[{"\[PartialD]", 
           SqrtBox["g"]}], "/", 
          RowBox[{"\[PartialD]", 
           SuperscriptBox["x", "1"]}]}]}], "+", 
        RowBox[{
         SuperscriptBox["\[CapitalXi]", "2"], 
         RowBox[{
          RowBox[{"\[PartialD]", 
           SqrtBox["g"]}], "/", 
          RowBox[{"\[PartialD]", 
           SuperscriptBox["x", "2"]}]}]}], "+", 
        RowBox[{
         SuperscriptBox["\[CapitalXi]", "3"], 
         RowBox[{
          RowBox[{"\[PartialD]", 
           SqrtBox["g"]}], "/", 
          RowBox[{"\[PartialD]", 
           SuperscriptBox["x", "3"]}]}]}]}], ")"}]}]}], "=", "\[CapitalPi]"}],
    TraditionalForm]],ExpressionUUID->
  "fcaa7110-364d-4077-ace1-8a4f1e1a3526"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"c", "(", 
      RowBox[{
       RowBox[{
        RowBox[{"\[PartialD]", 
         SuperscriptBox["\[CapitalOmega]", "1"]}], "/", 
        RowBox[{"\[PartialD]", 
         SuperscriptBox["x", "1"]}]}], "+", 
       RowBox[{
        RowBox[{"\[PartialD]", 
         SuperscriptBox["\[CapitalOmega]", "2"]}], "/", 
        RowBox[{"\[PartialD]", 
         SuperscriptBox["x", "2"]}]}], "+", 
       RowBox[{
        RowBox[{"\[PartialD]", 
         SuperscriptBox["\[CapitalOmega]", "3"]}], "/", 
        RowBox[{"\[PartialD]", 
         SuperscriptBox["x", "3"]}]}]}], ")"}], "+", 
     RowBox[{
      FractionBox["c", 
       SqrtBox["g"]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[CapitalOmega]", "1"], 
         RowBox[{
          RowBox[{"\[PartialD]", 
           SqrtBox["g"]}], "/", 
          RowBox[{"\[PartialD]", 
           SuperscriptBox["x", "1"]}]}]}], "+", 
        RowBox[{
         SuperscriptBox["\[CapitalOmega]", "2"], 
         RowBox[{
          RowBox[{"\[PartialD]", 
           SqrtBox["g"]}], "/", 
          RowBox[{"\[PartialD]", 
           SuperscriptBox["x", "2"]}]}]}], "+", 
        RowBox[{
         SuperscriptBox["\[CapitalOmega]", "3"], 
         RowBox[{
          RowBox[{"\[PartialD]", 
           SqrtBox["g"]}], "/", 
          RowBox[{"\[PartialD]", 
           SuperscriptBox["x", "3"]}]}]}]}], ")"}]}]}], "=", "0"}], 
   TraditionalForm]],ExpressionUUID->"c0bdb7d0-e8a5-4e60-b1b2-47a7eff4edc1"],
 "."
}], "Text",ExpressionUUID->"0bf41702-681c-4068-a283-fb1deffc92cf"],

Cell[TextData[{
 "Continuity equation:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"c", "(", 
      RowBox[{
       RowBox[{
        RowBox[{"\[PartialD]", 
         SuperscriptBox["\[ScriptCapitalJ]", "1"]}], "/", 
        RowBox[{"\[PartialD]", 
         SuperscriptBox["x", "1"]}]}], "+", 
       RowBox[{
        RowBox[{"\[PartialD]", 
         SuperscriptBox["\[ScriptCapitalJ]", "2"]}], "/", 
        RowBox[{"\[PartialD]", 
         SuperscriptBox["x", "2"]}]}], "+", 
       RowBox[{
        RowBox[{"\[PartialD]", 
         SuperscriptBox["\[ScriptCapitalJ]", "3"]}], "/", 
        RowBox[{"\[PartialD]", 
         SuperscriptBox["x", "3"]}]}]}], ")"}], "+", 
     RowBox[{
      FractionBox["c", 
       SqrtBox["g"]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[ScriptCapitalJ]", "1"], 
         RowBox[{
          RowBox[{"\[PartialD]", 
           SqrtBox["g"]}], "/", 
          RowBox[{"\[PartialD]", 
           SuperscriptBox["x", "1"]}]}]}], "+", 
        RowBox[{
         SuperscriptBox["\[ScriptCapitalJ]", "2"], 
         RowBox[{
          RowBox[{"\[PartialD]", 
           SqrtBox["g"]}], "/", 
          RowBox[{"\[PartialD]", 
           SuperscriptBox["x", "2"]}]}]}], "+", 
        RowBox[{
         SuperscriptBox["\[ScriptCapitalJ]", "3"], 
         RowBox[{
          RowBox[{"\[PartialD]", 
           SqrtBox["g"]}], "/", 
          RowBox[{"\[PartialD]", 
           SuperscriptBox["x", "3"]}]}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"\[PartialD]", "\[CapitalPi]"}], "/", 
      RowBox[{"\[PartialD]", "t"}]}]}], "=", "0"}], TraditionalForm]],
  ExpressionUUID->"64f595de-e56e-4fbd-9df3-1c7279fdf2de"],
 "."
}], "Text",ExpressionUUID->"2ea5d700-e6d5-4547-8f10-2b540adbf53f"],

Cell[TextData[{
 "Equations of motion (non-relativistic):\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         RowBox[{"\[PartialD]", 
          SuperscriptBox["x", "1"]}], "/", 
         RowBox[{"\[PartialD]", "t"}]}]},
       {
        RowBox[{
         RowBox[{"\[PartialD]", 
          SuperscriptBox["x", "2"]}], "/", 
         RowBox[{"\[PartialD]", "t"}]}]},
       {
        RowBox[{
         RowBox[{"\[PartialD]", 
          SuperscriptBox["x", "3"]}], "/", 
         RowBox[{"\[PartialD]", "t"}]}]}
      }], ")"}], "=", 
    RowBox[{"(", GridBox[{
       {
        SuperscriptBox["v", "1"]},
       {
        SuperscriptBox["v", "2"]},
       {
        SuperscriptBox["v", "3"]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "10136991-9f74-4bbb-b97c-aaa3965fe776"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         RowBox[{"\[PartialD]", 
          SubscriptBox["v", "x"]}], "/", 
         RowBox[{"\[PartialD]", "t"}]}]},
       {
        RowBox[{
         RowBox[{"\[PartialD]", 
          SubscriptBox["v", "y"]}], "/", 
         RowBox[{"\[PartialD]", "t"}]}]},
       {
        RowBox[{
         RowBox[{"\[PartialD]", 
          SubscriptBox["v", "z"]}], "/", 
         RowBox[{"\[PartialD]", "t"}]}]}
      }], ")"}], "=", 
    RowBox[{
     FractionBox[
      SubscriptBox["\[CapitalOmega]", "s"], 
      SubscriptBox["\[CapitalOmega]", "0"]], 
     RowBox[{"(", GridBox[{
        {
         RowBox[{
          RowBox[{"c", " ", 
           SubscriptBox["\[CapitalXi]", "x"]}], "+", 
          RowBox[{
           SubscriptBox["v", "y"], 
           SubscriptBox["\[CapitalOmega]", "z"]}], "-", 
          RowBox[{
           SubscriptBox["v", "z"], 
           SubscriptBox["\[CapitalOmega]", "y"]}]}]},
        {
         RowBox[{
          RowBox[{"c", " ", 
           SubscriptBox["\[CapitalXi]", "y"]}], "+", 
          RowBox[{
           SubscriptBox["v", "z"], 
           SubscriptBox["\[CapitalOmega]", "x"]}], "-", 
          RowBox[{
           SubscriptBox["v", "x"], 
           SubscriptBox["\[CapitalOmega]", "z"]}]}]},
        {
         RowBox[{
          RowBox[{"c", " ", 
           SubscriptBox["\[CapitalXi]", "z"]}], "+", 
          RowBox[{
           SubscriptBox["v", "x"], 
           SubscriptBox["\[CapitalOmega]", "y"]}], "-", 
          RowBox[{
           SubscriptBox["v", "y"], 
           SubscriptBox["\[CapitalOmega]", "x"]}]}]}
       }], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "edcc57f9-8c96-4c17-8f69-9262a22e1f1a"],
 "."
}], "Text",ExpressionUUID->"2709995f-79b9-4654-8c6e-dcd02d4f5c07"],

Cell[TextData[{
 "Cold fluid:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"\[PartialD]", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["\[Delta]n", "f"], "/", 
        SubscriptBox["n", 
         RowBox[{"f", ",", "0"}]]}], ")"}]}], 
     RowBox[{"\[PartialD]", "t"}]], "=", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       SqrtBox["g"]]}], 
     RowBox[{
      FractionBox["\[PartialD]", 
       RowBox[{"\[PartialD]", 
        SuperscriptBox["x", "i"]}]], 
      SqrtBox["g"]}], 
     SuperscriptBox[
      SubscriptBox["V", "f"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "5103b0b4-a0a8-434a-acd1-6a2e6c188bc9"],
 "."
}], "Text",ExpressionUUID->"d1b200e7-1954-45b9-934e-d608b39f9cb8"],

Cell[TextData[{
 "4th-order accurate differencing scheme for spatial derivatives:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"\[PartialD]", 
      SubscriptBox["u", "j"]}], 
     RowBox[{"\[PartialD]", "x"}]], "=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"12", "\[CapitalDelta]x"}]], 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["u", 
        RowBox[{"j", "-", "2"}]], "-", 
       RowBox[{"8", 
        SubscriptBox["u", 
         RowBox[{"j", "-", "1"}]]}], "+", 
       RowBox[{"8", 
        SubscriptBox["u", 
         RowBox[{"j", "+", "1"}]]}], "-", 
       SubscriptBox["u", 
        RowBox[{"j", "+", "2"}]]}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"0c8fc47d-091d-4adb-937e-116dd1969161"],
 "."
}], "Text",ExpressionUUID->"0dbd8797-54ad-4d0b-b1dc-521dd05056a1"],

Cell[CellGroupData[{

Cell[TextData[{
 "1D in ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["x", "1"], TraditionalForm]],ExpressionUUID->
  "aad5311a-8039-4024-9cee-110f38e13513"],
 " coordinate"
}], "Subsection",ExpressionUUID->"a2142f9e-1dc8-48da-bfef-f8b9da8f4271"],

Cell[CellGroupData[{

Cell["Grid: Staggered", "Subsubsection",ExpressionUUID->"aa8594cd-0dd9-4de3-b629-1ed52bfa1b3c"],

Cell[TextData[{
 "Cell center quantities: ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["\[CapitalXi]", "\[RightVector]"], TraditionalForm]],
  ExpressionUUID->"96ea4f5b-9685-42f5-b7d3-2380d7e6b0c2"],
 ", ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["\[ScriptCapitalJ]", "\[RightVector]"], TraditionalForm]],
  ExpressionUUID->"a21bd15a-4d31-4e49-8900-8e3819cf2d4d"],
 ", all discrete particle moments, and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[DoubleStruckCapitalV]", "f"], TraditionalForm]],
  ExpressionUUID->"90607150-f828-4ff2-b88d-3ac8dd209afb"],
 ".\nCell corner quantities: ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["\[CapitalOmega]", "\[RightVector]"], TraditionalForm]],
  ExpressionUUID->"64bd1a49-3cb0-4b00-a49b-44e152811a75"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Delta]n", "f"], TraditionalForm]],ExpressionUUID->
  "9c9f5ba2-6f13-49cb-94cd-1b3454ccedfa"],
 "."
}], "Text",ExpressionUUID->"f247c1ea-359f-40a1-aac7-f8a14703cfa7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Xi]", "=", "0."}], ",", 
     RowBox[{"\[CapitalDelta]1", "=", "1"}], ",", 
     RowBox[{"\[CapitalDelta]2", "=", "1"}], ",", 
     RowBox[{"q1max", "=", "4"}], ",", 
     RowBox[{"q2max", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1max"}], 
       "\[GreaterEqual]", 
       RowBox[{"\[Pi]", "/", "2"}]}], ",", 
      RowBox[{"Abort", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[CapitalDelta]1q1", ",", "\[CapitalDelta]2q2", ",", "xyF", ",", 
        "xyH"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalDelta]1q1", "=", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"-", "q1max"}], ",", "q1max"}], "]"}], 
         "\[CapitalDelta]1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[CapitalDelta]2q2", "=", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"-", "q2max"}], ",", "q2max"}], "]"}], 
         "\[CapitalDelta]2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xyF", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Chop", "[", "\[Xi]", "]"}], "\[Equal]", "0"}], ",", 
               "#", ",", 
               RowBox[{
                RowBox[{"Tan", "[", 
                 RowBox[{"\[Xi]", "#"}], "]"}], "/", "\[Xi]"}]}], "]"}], ",", 
             
             RowBox[{"\[CapitalDelta]2q2", " ", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Xi]", "#"}], "]"}], "^", "2"}]}]}], "}"}], "]"}], 
          "&"}], "/@", "\[CapitalDelta]1q1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xyH", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Chop", "[", "\[Xi]", "]"}], "\[Equal]", "0"}], ",", 
               "#", ",", 
               RowBox[{
                RowBox[{"Tan", "[", 
                 RowBox[{"\[Xi]", "#"}], "]"}], "/", "\[Xi]"}]}], "]"}], ",", 
             
             RowBox[{
              RowBox[{"Plus", "[", 
               RowBox[{"\[CapitalDelta]2q2", ",", 
                RowBox[{"+", ".5"}]}], "]"}], 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Xi]", "#"}], "]"}], "^", "2"}]}]}], "}"}], "]"}], 
          "&"}], "/@", 
         RowBox[{"Plus", "[", 
          RowBox[{"\[CapitalDelta]1q1", ",", 
           RowBox[{"+", ".5"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Legended", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Graphics", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"LightBlue", ",", 
                RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
                RowBox[{"Line", "/@", "xyF"}], ",", 
                RowBox[{"Line", "/@", 
                 RowBox[{"Thread", "[", "xyF", "]"}]}]}], "}"}], ","}], 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"LightRed", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
               RowBox[{"Line", "/@", "xyH"}], ",", 
               RowBox[{"Line", "/@", 
                RowBox[{"Thread", "[", "xyH", "]"}]}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Red", ",", 
               RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
               RowBox[{"Point", "/@", 
                RowBox[{"xyH", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}], ",", 
                   RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}]}], "]"}], "]"}]}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"LightRed", ",", 
               RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"First", "[", "xyH", "]"}], "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"First", "/@", "xyH"}], "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"Last", "[", "xyH", "]"}], "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"Last", "/@", "xyH"}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Blue", ",", 
               RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
               RowBox[{"Point", "/@", 
                RowBox[{"xyF", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}], ",", 
                   RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}]}], "]"}], "]"}]}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"LightBlue", ",", 
               RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"First", "[", "xyF", "]"}], "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"First", "/@", "xyF"}], "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"Last", "[", "xyF", "]"}], "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"Last", "/@", "xyF"}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Gray", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
               RowBox[{"Line", "[", 
                RowBox[{
                 RowBox[{"First", "[", "xyH", "]"}], "//", "Most"}], "]"}], 
               ",", 
               RowBox[{"Line", "[", 
                RowBox[{
                 RowBox[{"First", "/@", "xyH"}], "//", "Most"}], "]"}], ",", 
               RowBox[{"Line", "[", 
                RowBox[{
                 RowBox[{"Part", "[", 
                  RowBox[{"xyH", ",", 
                   RowBox[{"-", "2"}]}], "]"}], "//", "Most"}], "]"}], ",", 
               RowBox[{"Line", "[", 
                RowBox[{
                 RowBox[{"Part", "[", 
                  RowBox[{"xyH", ",", "All", ",", 
                   RowBox[{"-", "2"}]}], "]"}], "//", "Most"}], "]"}]}], 
              "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Darker", "@", "Blue"}], ",", 
               RowBox[{"MapIndexed", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#2", "]"}], "-", "1"}], ",", "#", 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}], "&"}], ",", 
                 RowBox[{"xyF", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}], ",", 
                    RowBox[{"q2max", "+", "1"}]}], "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"MapIndexed", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#2", "]"}], "-", "1"}], ",", "#", 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], "&"}], 
                 ",", 
                 RowBox[{"xyF", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"q1max", "+", "1"}], ",", 
                    RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}]}], "]"}], "]"}]}], "]"}]}], "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Darker", "@", "Red"}], ",", 
               RowBox[{"MapIndexed", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#2", "]"}], "-", "1"}], ",", "#", 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}], "&"}], ",", 
                 RowBox[{"xyH", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}], ",", 
                    RowBox[{"q2max", "+", "1"}]}], "]"}], "]"}]}], "]"}]}], 
              "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"AspectRatio", "\[Rule]", 
            RowBox[{
             RowBox[{"xyF", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", 
                RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}], "/", 
             RowBox[{"xyF", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1", ",", "1"}], "]"}], "]"}]}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"Axes", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"True", ",", "False"}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Ticks", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
           
           RowBox[{"BaseStyle", "\[Rule]", "11"}], ",", "\[IndentingNewLine]", 
           RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "\[IndentingNewLine]",
           "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Placed", "[", 
          RowBox[{
           RowBox[{"PointLegend", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "LightRed", ",", "Gray", ",", "Red", ",", "Blue", ",", "Gray"}],
               "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Cell Boundary\>\"", ",", "\"\<Particle Boundary\>\"", ",", 
               "\"\<Cell Corner\>\"", ",", "\"\<Cell Center\>\"", ",", 
               "\"\<Ghost Cells\>\""}], "}"}], ",", 
             RowBox[{"Joined", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
               "True", ",", "True", ",", "False", ",", "False", ",", 
                "False"}], "}"}]}], ",", 
             RowBox[{"LegendLayout", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{
                  RowBox[{"Join", "@@", "#"}], ",", 
                  RowBox[{"Spacer", "[", "2", "]"}]}], "]"}], "&"}], 
               ")"}]}]}], "]"}], ",", "Above"}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 Editable->False,
 CellOpen->False,ExpressionUUID->"2b6ee556-d754-41ba-bf75-3397923095ea"],

Cell[BoxData[
 TemplateBox[{
   GraphicsBox[{{
      RGBColor[1, 0.85, 0.85], 
      Thickness[Medium], {
       LineBox[{{-3.5, -0.5}, {-3.5, 0.5}, {-3.5, 1.5}}], 
       LineBox[{{-2.5, -0.5}, {-2.5, 0.5}, {-2.5, 1.5}}], 
       LineBox[{{-1.5, -0.5}, {-1.5, 0.5}, {-1.5, 1.5}}], 
       LineBox[{{-0.5, -0.5}, {-0.5, 0.5}, {-0.5, 1.5}}], 
       LineBox[{{0.5, -0.5}, {0.5, 0.5}, {0.5, 1.5}}], 
       LineBox[{{1.5, -0.5}, {1.5, 0.5}, {1.5, 1.5}}], 
       LineBox[{{2.5, -0.5}, {2.5, 0.5}, {2.5, 1.5}}], 
       LineBox[{{3.5, -0.5}, {3.5, 0.5}, {3.5, 1.5}}], 
       LineBox[{{4.5, -0.5}, {4.5, 0.5}, {4.5, 1.5}}]}, {
       LineBox[{{-3.5, -0.5}, {-2.5, -0.5}, {-1.5, -0.5}, {-0.5, -0.5}, {
        0.5, -0.5}, {1.5, -0.5}, {2.5, -0.5}, {3.5, -0.5}, {4.5, -0.5}}], 
       LineBox[{{-3.5, 0.5}, {-2.5, 0.5}, {-1.5, 0.5}, {-0.5, 0.5}, {0.5, 
        0.5}, {1.5, 0.5}, {2.5, 0.5}, {3.5, 0.5}, {4.5, 0.5}}], 
       LineBox[{{-3.5, 1.5}, {-2.5, 1.5}, {-1.5, 1.5}, {-0.5, 1.5}, {0.5, 
        1.5}, {1.5, 1.5}, {2.5, 1.5}, {3.5, 1.5}, {4.5, 1.5}}]}}, {
      RGBColor[1, 0, 0], 
      PointSize[Medium], {
       PointBox[{{-2.5, 0.5}}], 
       PointBox[{{-1.5, 0.5}}], 
       PointBox[{{-0.5, 0.5}}], 
       PointBox[{{0.5, 0.5}}], 
       PointBox[{{1.5, 0.5}}], 
       PointBox[{{2.5, 0.5}}], 
       PointBox[{{3.5, 0.5}}]}}, {
      RGBColor[1, 0.85, 0.85], 
      PointSize[Medium], 
      PointBox[{{-3.5, -0.5}, {-3.5, 0.5}, {-3.5, 1.5}}], 
      PointBox[{{-3.5, -0.5}, {-2.5, -0.5}, {-1.5, -0.5}, {-0.5, -0.5}, {
       0.5, -0.5}, {1.5, -0.5}, {2.5, -0.5}, {3.5, -0.5}, {4.5, -0.5}}], 
      PointBox[{{4.5, -0.5}, {4.5, 0.5}, {4.5, 1.5}}], 
      PointBox[{{-3.5, 1.5}, {-2.5, 1.5}, {-1.5, 1.5}, {-0.5, 1.5}, {0.5, 
       1.5}, {1.5, 1.5}, {2.5, 1.5}, {3.5, 1.5}, {4.5, 1.5}}]}, {
      RGBColor[0, 0, 1], 
      PointSize[Medium], {
       PointBox[{{-3, 0.}}], 
       PointBox[{{-2, 0.}}], 
       PointBox[{{-1, 0.}}], 
       PointBox[{{0, 0.}}], 
       PointBox[{{1, 0.}}], 
       PointBox[{{2, 0.}}], 
       PointBox[{{3, 0.}}]}}, {
      RGBColor[0.87, 0.94, 1], 
      PointSize[Medium], 
      PointBox[{{-4, -1.}, {-4, 0.}, {-4, 1.}}], 
      PointBox[{{-4, -1.}, {-3, -1.}, {-2, -1.}, {-1, -1.}, {0, -1.}, {
        1, -1.}, {2, -1.}, {3, -1.}, {4, -1.}}], 
      PointBox[{{4, -1.}, {4, 0.}, {4, 1.}}], 
      PointBox[{{-4, 1.}, {-3, 1.}, {-2, 1.}, {-1, 1.}, {0, 1.}, {1, 1.}, {
        2, 1.}, {3, 1.}, {4, 1.}}]}, {
      GrayLevel[0.5], 
      Thickness[Medium], 
      LineBox[{{-3.5, -0.5}, {-3.5, 0.5}}], 
      LineBox[{{-3.5, -0.5}, {-2.5, -0.5}, {-1.5, -0.5}, {-0.5, -0.5}, {
       0.5, -0.5}, {1.5, -0.5}, {2.5, -0.5}, {3.5, -0.5}}], 
      LineBox[{{3.5, -0.5}, {3.5, 0.5}}], 
      LineBox[{{-3.5, 0.5}, {-2.5, 0.5}, {-1.5, 0.5}, {-0.5, 0.5}, {0.5, 
       0.5}, {1.5, 0.5}, {2.5, 0.5}, {3.5, 0.5}}]}, {
      RGBColor[0, 0, 
       NCache[
        Rational[2, 3], 0.6666666666666666]], {
       InsetBox[
        FormBox["0", TraditionalForm], {-3, 0.}, {-1, -1}], 
       InsetBox[
        FormBox["1", TraditionalForm], {-2, 0.}, {-1, -1}], 
       InsetBox[
        FormBox["2", TraditionalForm], {-1, 0.}, {-1, -1}], 
       InsetBox[
        FormBox["3", TraditionalForm], {0, 0.}, {-1, -1}], 
       InsetBox[
        FormBox["4", TraditionalForm], {1, 0.}, {-1, -1}], 
       InsetBox[
        FormBox["5", TraditionalForm], {2, 0.}, {-1, -1}], 
       InsetBox[
        FormBox["6", TraditionalForm], {3, 0.}, {-1, -1}]}, {
       InsetBox[
        FormBox["0", TraditionalForm], {0, 0.}, {-1, 1}]}}, {
      RGBColor[
       NCache[
        Rational[2, 3], 0.6666666666666666], 0, 0], {
       InsetBox[
        FormBox["0", TraditionalForm], {-2.5, 0.5}, {1, -1}], 
       InsetBox[
        FormBox["1", TraditionalForm], {-1.5, 0.5}, {1, -1}], 
       InsetBox[
        FormBox["2", TraditionalForm], {-0.5, 0.5}, {1, -1}], 
       InsetBox[
        FormBox["3", TraditionalForm], {0.5, 0.5}, {1, -1}], 
       InsetBox[
        FormBox["4", TraditionalForm], {1.5, 0.5}, {1, -1}], 
       InsetBox[
        FormBox["5", TraditionalForm], {2.5, 0.5}, {1, -1}], 
       InsetBox[
        FormBox["6", TraditionalForm], {3.5, 0.5}, {1, -1}]}}}, AspectRatio -> 
    0.25, Axes -> {True, False}, Ticks -> False, BaseStyle -> 11, ImageSize -> 
    Large], 
   FormBox[
    FormBox[
     TemplateBox[{
      "\"Cell Boundary\"", "\"Particle Boundary\"", "\"Cell Corner\"", 
       "\"Cell Center\"", "\"Ghost Cells\""}, "PointLegend", 
      DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TemplateBox[{
             InterpretationBox[
              StyleBox[
               
               GraphicsBox[{}, ImageSize -> {2, 0}, BaselinePosition -> 
                Baseline], "CacheGraphics" -> False], 
              Spacer[2]], 
             GraphicsBox[{{
                Directive[
                 EdgeForm[
                  Directive[
                   Opacity[0.3], 
                   GrayLevel[0]]], 
                 PointSize[0.5], 
                 AbsoluteThickness[1.6], 
                 RGBColor[1, 0.85, 0.85]], {
                 LineBox[{{0, 10}, {20, 10}}]}}, {
                Directive[
                 EdgeForm[
                  Directive[
                   Opacity[0.3], 
                   GrayLevel[0]]], 
                 PointSize[0.5], 
                 AbsoluteThickness[1.6], 
                 RGBColor[1, 0.85, 0.85]], {}}}, AspectRatio -> Full, 
              ImageSize -> {20, 10}, PlotRangePadding -> None, ImagePadding -> 
              Automatic, BaselinePosition -> (Scaled[0.1] -> Baseline)], #, 
             GraphicsBox[{{
                Directive[
                 EdgeForm[
                  Directive[
                   Opacity[0.3], 
                   GrayLevel[0]]], 
                 PointSize[0.5], 
                 AbsoluteThickness[1.6], 
                 GrayLevel[0.5]], {
                 LineBox[{{0, 10}, {20, 10}}]}}, {
                Directive[
                 EdgeForm[
                  Directive[
                   Opacity[0.3], 
                   GrayLevel[0]]], 
                 PointSize[0.5], 
                 AbsoluteThickness[1.6], 
                 GrayLevel[0.5]], {}}}, AspectRatio -> Full, 
              ImageSize -> {20, 10}, PlotRangePadding -> None, ImagePadding -> 
              Automatic, BaselinePosition -> (Scaled[0.1] -> Baseline)], #2, 
             GraphicsBox[{{}, {
                Directive[
                 EdgeForm[
                  Directive[
                   Opacity[0.3], 
                   GrayLevel[0]]], 
                 PointSize[0.5], 
                 AbsoluteThickness[1.6], 
                 RGBColor[1, 0, 0]], {
                 Directive[
                  EdgeForm[
                   Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                  PointSize[0.5], 
                  AbsoluteThickness[1.6], 
                  RGBColor[1, 0, 0]], 
                 PointBox[
                  NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
              ImageSize -> {10, 10}, PlotRangePadding -> None, ImagePadding -> 
              Automatic, BaselinePosition -> (Scaled[0.1] -> Baseline)], #3, 
             GraphicsBox[{{}, {
                Directive[
                 EdgeForm[
                  Directive[
                   Opacity[0.3], 
                   GrayLevel[0]]], 
                 PointSize[0.5], 
                 AbsoluteThickness[1.6], 
                 RGBColor[0, 0, 1]], {
                 Directive[
                  EdgeForm[
                   Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                  PointSize[0.5], 
                  AbsoluteThickness[1.6], 
                  RGBColor[0, 0, 1]], 
                 PointBox[
                  NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
              ImageSize -> {10, 10}, PlotRangePadding -> None, ImagePadding -> 
              Automatic, BaselinePosition -> (Scaled[0.1] -> Baseline)], #4, 
             GraphicsBox[{{}, {
                Directive[
                 EdgeForm[
                  Directive[
                   Opacity[0.3], 
                   GrayLevel[0]]], 
                 PointSize[0.5], 
                 AbsoluteThickness[1.6], 
                 GrayLevel[0.5]], {
                 Directive[
                  EdgeForm[
                   Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                  PointSize[0.5], 
                  AbsoluteThickness[1.6], 
                  GrayLevel[0.5]], 
                 PointBox[
                  NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
              ImageSize -> {10, 10}, PlotRangePadding -> None, ImagePadding -> 
              Automatic, BaselinePosition -> (Scaled[0.1] -> Baseline)], #5}, 
            "RowWithSeparator"], Alignment -> Left, AppearanceElements -> 
           None, ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"PointLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               InterpretationBox[
                ButtonBox[
                 TooltipBox[
                  GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[1, 0.85, 0.85], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                   True, FrameStyle -> 
                   RGBColor[
                    0.6666666666666666, 0.5666666666666667, 
                    0.5666666666666667], FrameTicks -> None, PlotRangePadding -> 
                   None, ImageSize -> 
                   Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], "RGBColor[1, 0.85, 0.85]"], 
                 Appearance -> None, BaseStyle -> {}, BaselinePosition -> 
                 Baseline, DefaultBaseStyle -> {}, ButtonFunction :> 
                 With[{Typeset`box$ = EvaluationBox[]}, 
                   If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[1, 0.85, 0.85]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                 Automatic, Method -> "Preemptive"], 
                RGBColor[1, 0.85, 0.85], Editable -> False, Selectable -> 
                False], ",", 
               InterpretationBox[
                ButtonBox[
                 TooltipBox[
                  GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    GrayLevel[0.5], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                   True, FrameStyle -> GrayLevel[0.33333333333333337`], 
                   FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                   Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], "GrayLevel[0.5]"], Appearance -> None,
                  BaseStyle -> {}, BaselinePosition -> Baseline, 
                 DefaultBaseStyle -> {}, ButtonFunction :> 
                 With[{Typeset`box$ = EvaluationBox[]}, 
                   If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    GrayLevel[0.5]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["GrayLevelColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                 Automatic, Method -> "Preemptive"], 
                GrayLevel[0.5], Editable -> False, Selectable -> False], ",", 
               
               InterpretationBox[
                ButtonBox[
                 TooltipBox[
                  GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[1, 0, 0], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                   True, FrameStyle -> RGBColor[0.6666666666666666, 0., 0.], 
                   FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                   Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], "RGBColor[1, 0, 0]"], Appearance -> 
                 None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                 DefaultBaseStyle -> {}, ButtonFunction :> 
                 With[{Typeset`box$ = EvaluationBox[]}, 
                   If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[1, 0, 0]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                 Automatic, Method -> "Preemptive"], 
                RGBColor[1, 0, 0], Editable -> False, Selectable -> False], 
               ",", 
               InterpretationBox[
                ButtonBox[
                 TooltipBox[
                  GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0, 0, 1], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                   True, FrameStyle -> RGBColor[0., 0., 0.6666666666666666], 
                   FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                   Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], "RGBColor[0, 0, 1]"], Appearance -> 
                 None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                 DefaultBaseStyle -> {}, ButtonFunction :> 
                 With[{Typeset`box$ = EvaluationBox[]}, 
                   If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0, 0, 1]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                 Automatic, Method -> "Preemptive"], 
                RGBColor[0, 0, 1], Editable -> False, Selectable -> False], 
               ",", 
               InterpretationBox[
                ButtonBox[
                 TooltipBox[
                  GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    GrayLevel[0.5], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                   True, FrameStyle -> GrayLevel[0.33333333333333337`], 
                   FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                   Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], "GrayLevel[0.5]"], Appearance -> None,
                  BaseStyle -> {}, BaselinePosition -> Baseline, 
                 DefaultBaseStyle -> {}, ButtonFunction :> 
                 With[{Typeset`box$ = EvaluationBox[]}, 
                   If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    GrayLevel[0.5]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["GrayLevelColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                 Automatic, Method -> "Preemptive"], 
                GrayLevel[0.5], Editable -> False, Selectable -> False]}], 
             "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2, ",", #3, ",", #4, ",", #5}], "}"}], ",", 
           RowBox[{"Joined", "\[Rule]", 
             RowBox[{"{", 
               
               RowBox[{
                "True", ",", "True", ",", "False", ",", "False", ",", 
                 "False"}], "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", 
             RowBox[{"(", 
               RowBox[{
                 RowBox[{"Row", "[", 
                   RowBox[{
                    RowBox[{"Join", "@@", "#1"}], ",", 
                    InterpretationBox[
                    StyleBox[
                    
                    GraphicsBox[{}, ImageSize -> {2, 0}, BaselinePosition -> 
                    Baseline], "CacheGraphics" -> False], 
                    Spacer[2]]}], "]"}], "&"}], ")"}]}]}], "]"}]& ), Editable -> 
      True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}, {
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {2, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "Above"}], "]"}]}], "]"}]& )]], "Output",ExpressionU\
UID->"ca24214f-1985-47c4-a74b-20b8a98f1321"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Grid: Collocated", "Subsubsection",ExpressionUUID->"0ca0ed9f-2370-4971-adc5-e8154968cad4"],

Cell["Grid points are located in cell centers.", "Text",ExpressionUUID->"78dc4e21-d9c1-41d8-a836-e9bdda1687e8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Xi]", "=", "0"}], ",", 
     RowBox[{"\[CapitalDelta]1", "=", "1"}], ",", 
     RowBox[{"\[CapitalDelta]2", "=", "1"}], ",", 
     RowBox[{"q1max", "=", 
      RowBox[{"4", "+", "2"}]}], ",", 
     RowBox[{"q2max", "=", 
      RowBox[{"0", "+", "2"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1max"}], 
       "\[GreaterEqual]", 
       RowBox[{"\[Pi]", "/", "2"}]}], ",", 
      RowBox[{"Abort", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[CapitalDelta]1q1", ",", "\[CapitalDelta]2q2", ",", "xyF", ",", 
        "xyH"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalDelta]1q1", "=", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"-", "q1max"}], ",", "q1max"}], "]"}], 
         "\[CapitalDelta]1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[CapitalDelta]2q2", "=", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"-", "q2max"}], ",", "q2max"}], "]"}], 
         "\[CapitalDelta]2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xyF", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Chop", "[", "\[Xi]", "]"}], "\[Equal]", "0"}], ",", 
               "#", ",", 
               RowBox[{
                RowBox[{"Tan", "[", 
                 RowBox[{"\[Xi]", "#"}], "]"}], "/", "\[Xi]"}]}], "]"}], ",", 
             
             RowBox[{"\[CapitalDelta]2q2", " ", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Xi]", "#"}], "]"}], "^", "2"}]}]}], "}"}], "]"}], 
          "&"}], "/@", "\[CapitalDelta]1q1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xyH", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Chop", "[", "\[Xi]", "]"}], "\[Equal]", "0"}], ",", 
               "#", ",", 
               RowBox[{
                RowBox[{"Tan", "[", 
                 RowBox[{"\[Xi]", "#"}], "]"}], "/", "\[Xi]"}]}], "]"}], ",", 
             
             RowBox[{
              RowBox[{"MovingAverage", "[", 
               RowBox[{"\[CapitalDelta]2q2", ",", "2"}], "]"}], 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Xi]", "#"}], "]"}], "^", "2"}]}]}], "}"}], "]"}], 
          "&"}], "/@", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"\[CapitalDelta]1q1", ",", "2"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Legended", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Graphics", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"LightBlue", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
               RowBox[{"Line", "/@", 
                RowBox[{"xyH", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}], ",", 
                   RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}]}], "]"}], "]"}]}], ",", 
               RowBox[{"Line", "/@", 
                RowBox[{"Thread", "[", 
                 RowBox[{"xyH", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}], ",", 
                    RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}]}], "]"}], "]"}], "]"}]}]}], "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Black", ",", 
               RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
               RowBox[{"Point", "/@", 
                RowBox[{"xyF", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"3", ";;", 
                    RowBox[{"-", "3"}]}], ",", 
                   RowBox[{"3", ";;", 
                    RowBox[{"-", "3"}]}]}], "]"}], "]"}]}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Gray", ",", 
               RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
               RowBox[{"Point", "/@", 
                RowBox[{"xyF", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ";;", "2"}], "]"}], "]"}]}], ",", 
               RowBox[{"Point", "/@", 
                RowBox[{"xyF", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", 
                   RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], ",", 
               RowBox[{"Point", "/@", 
                RowBox[{"xyF", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"-", "2"}], ";;", 
                   RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
               RowBox[{"Point", "/@", 
                RowBox[{"xyF", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", 
                   RowBox[{
                    RowBox[{"-", "2"}], ";;", 
                    RowBox[{"-", "1"}]}]}], "]"}], "]"}]}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Blue", ",", 
               RowBox[{"MapIndexed", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#2", "]"}], "-", "1", "-", 
                    "q1max"}], ",", "#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}], "&"}], ",", 
                 RowBox[{"xyF", "[", 
                  RowBox[{"[", 
                   RowBox[{"All", ",", 
                    RowBox[{"q2max", "+", "1"}]}], "]"}], "]"}]}], "]"}]}], 
              "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Black", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
               RowBox[{"Line", "[", 
                RowBox[{"xyH", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}], ",", "2"}], "]"}], "]"}], "]"}], 
               ",", 
               RowBox[{"Line", "[", 
                RowBox[{"xyH", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"-", "2"}], ",", 
                   RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}]}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"Line", "[", 
                RowBox[{"xyH", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}], ",", 
                   RowBox[{"-", "2"}]}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"Line", "[", 
                RowBox[{"xyH", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", 
                   RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}]}], "]"}], "]"}], "]"}]}], "}"}]}], 
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"AspectRatio", "\[Rule]", 
            RowBox[{
             RowBox[{"xyF", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", 
                RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}], "/", 
             RowBox[{"xyF", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1", ",", "1"}], "]"}], "]"}]}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"Axes", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"True", ",", "False"}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Ticks", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
           
           RowBox[{"BaseStyle", "\[Rule]", "11"}], ",", "\[IndentingNewLine]", 
           RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "\[IndentingNewLine]",
           "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Placed", "[", 
          RowBox[{
           RowBox[{"PointLegend", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Black", ",", "Black", ",", "Gray"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Particle Boundary\>\"", ",", "\"\<Cell Center\>\"", ",", 
               "\"\<Ghost Cells\>\""}], "}"}], ",", 
             RowBox[{"Joined", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"True", ",", "False", ",", "False"}], "}"}]}], ",", 
             RowBox[{"LegendLayout", "\[Rule]", "\"\<Row\>\""}]}], "]"}], ",",
            "Above"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",\

 Editable->False,
 CellOpen->False,ExpressionUUID->"96981617-fb2d-4c2d-b571-35745fe4bd52"],

Cell[BoxData[
 TemplateBox[{
   GraphicsBox[{{
      RGBColor[0.87, 0.94, 1], 
      Thickness[Medium], {
       LineBox[
        NCache[{{
           Rational[-9, 2], 
           Rational[-1, 2]}, {
           Rational[-9, 2], 
           Rational[1, 2]}}, {{-4.5, -0.5}, {-4.5, 0.5}}]], 
       LineBox[
        NCache[{{
           Rational[-7, 2], 
           Rational[-1, 2]}, {
           Rational[-7, 2], 
           Rational[1, 2]}}, {{-3.5, -0.5}, {-3.5, 0.5}}]], 
       LineBox[
        NCache[{{
           Rational[-5, 2], 
           Rational[-1, 2]}, {
           Rational[-5, 2], 
           Rational[1, 2]}}, {{-2.5, -0.5}, {-2.5, 0.5}}]], 
       LineBox[
        NCache[{{
           Rational[-3, 2], 
           Rational[-1, 2]}, {
           Rational[-3, 2], 
           Rational[1, 2]}}, {{-1.5, -0.5}, {-1.5, 0.5}}]], 
       LineBox[
        NCache[{{
           Rational[-1, 2], 
           Rational[-1, 2]}, {
           Rational[-1, 2], 
           Rational[1, 2]}}, {{-0.5, -0.5}, {-0.5, 0.5}}]], 
       LineBox[
        NCache[{{
           Rational[1, 2], 
           Rational[-1, 2]}, {
           Rational[1, 2], 
           Rational[1, 2]}}, {{0.5, -0.5}, {0.5, 0.5}}]], 
       LineBox[
        NCache[{{
           Rational[3, 2], 
           Rational[-1, 2]}, {
           Rational[3, 2], 
           Rational[1, 2]}}, {{1.5, -0.5}, {1.5, 0.5}}]], 
       LineBox[
        NCache[{{
           Rational[5, 2], 
           Rational[-1, 2]}, {
           Rational[5, 2], 
           Rational[1, 2]}}, {{2.5, -0.5}, {2.5, 0.5}}]], 
       LineBox[
        NCache[{{
           Rational[7, 2], 
           Rational[-1, 2]}, {
           Rational[7, 2], 
           Rational[1, 2]}}, {{3.5, -0.5}, {3.5, 0.5}}]], 
       LineBox[
        NCache[{{
           Rational[9, 2], 
           Rational[-1, 2]}, {
           Rational[9, 2], 
           Rational[1, 2]}}, {{4.5, -0.5}, {4.5, 0.5}}]]}, {
       LineBox[
        NCache[{{
           Rational[-9, 2], 
           Rational[-1, 2]}, {
           Rational[-7, 2], 
           Rational[-1, 2]}, {
           Rational[-5, 2], 
           Rational[-1, 2]}, {
           Rational[-3, 2], 
           Rational[-1, 2]}, {
           Rational[-1, 2], 
           Rational[-1, 2]}, {
           Rational[1, 2], 
           Rational[-1, 2]}, {
           Rational[3, 2], 
           Rational[-1, 2]}, {
           Rational[5, 2], 
           Rational[-1, 2]}, {
           Rational[7, 2], 
           Rational[-1, 2]}, {
           Rational[9, 2], 
           
           Rational[-1, 
            2]}}, {{-4.5, -0.5}, {-3.5, -0.5}, {-2.5, -0.5}, {-1.5, -0.5}, \
{-0.5, -0.5}, {0.5, -0.5}, {1.5, -0.5}, {2.5, -0.5}, {3.5, -0.5}, {
         4.5, -0.5}}]], 
       LineBox[
        NCache[{{
           Rational[-9, 2], 
           Rational[1, 2]}, {
           Rational[-7, 2], 
           Rational[1, 2]}, {
           Rational[-5, 2], 
           Rational[1, 2]}, {
           Rational[-3, 2], 
           Rational[1, 2]}, {
           Rational[-1, 2], 
           Rational[1, 2]}, {
           Rational[1, 2], 
           Rational[1, 2]}, {
           Rational[3, 2], 
           Rational[1, 2]}, {
           Rational[5, 2], 
           Rational[1, 2]}, {
           Rational[7, 2], 
           Rational[1, 2]}, {
           Rational[9, 2], 
           Rational[1, 2]}}, {{-4.5, 0.5}, {-3.5, 0.5}, {-2.5, 0.5}, {-1.5, 
         0.5}, {-0.5, 0.5}, {0.5, 0.5}, {1.5, 0.5}, {2.5, 0.5}, {3.5, 0.5}, {
         4.5, 0.5}}]]}}, {
      GrayLevel[0], 
      PointSize[Medium], {
       PointBox[{{-4, 0}}], 
       PointBox[{{-3, 0}}], 
       PointBox[{{-2, 0}}], 
       PointBox[{{-1, 0}}], 
       PointBox[{{0, 0}}], 
       PointBox[{{1, 0}}], 
       PointBox[{{2, 0}}], 
       PointBox[{{3, 0}}], 
       PointBox[{{4, 0}}]}}, {
      GrayLevel[0.5], 
      PointSize[Medium], {
       PointBox[{{-6, -2}, {-6, -1}, {-6, 0}, {-6, 1}, {-6, 2}}], 
       PointBox[{{-5, -2}, {-5, -1}, {-5, 0}, {-5, 1}, {-5, 2}}]}, {
       PointBox[{{-6, -2}, {-6, -1}}], 
       PointBox[{{-5, -2}, {-5, -1}}], 
       PointBox[{{-4, -2}, {-4, -1}}], 
       PointBox[{{-3, -2}, {-3, -1}}], 
       PointBox[{{-2, -2}, {-2, -1}}], 
       PointBox[{{-1, -2}, {-1, -1}}], 
       PointBox[{{0, -2}, {0, -1}}], 
       PointBox[{{1, -2}, {1, -1}}], 
       PointBox[{{2, -2}, {2, -1}}], 
       PointBox[{{3, -2}, {3, -1}}], 
       PointBox[{{4, -2}, {4, -1}}], 
       PointBox[{{5, -2}, {5, -1}}], 
       PointBox[{{6, -2}, {6, -1}}]}, {
       PointBox[{{5, -2}, {5, -1}, {5, 0}, {5, 1}, {5, 2}}], 
       PointBox[{{6, -2}, {6, -1}, {6, 0}, {6, 1}, {6, 2}}]}, {
       PointBox[{{-6, 1}, {-6, 2}}], 
       PointBox[{{-5, 1}, {-5, 2}}], 
       PointBox[{{-4, 1}, {-4, 2}}], 
       PointBox[{{-3, 1}, {-3, 2}}], 
       PointBox[{{-2, 1}, {-2, 2}}], 
       PointBox[{{-1, 1}, {-1, 2}}], 
       PointBox[{{0, 1}, {0, 2}}], 
       PointBox[{{1, 1}, {1, 2}}], 
       PointBox[{{2, 1}, {2, 2}}], 
       PointBox[{{3, 1}, {3, 2}}], 
       PointBox[{{4, 1}, {4, 2}}], 
       PointBox[{{5, 1}, {5, 2}}], 
       PointBox[{{6, 1}, {6, 2}}]}}, {
      RGBColor[0, 0, 1], {
       InsetBox[
        FormBox[
         RowBox[{"-", "6"}], TraditionalForm], {-6, 0}, {-1, -1}], 
       InsetBox[
        FormBox[
         RowBox[{"-", "5"}], TraditionalForm], {-5, 0}, {-1, -1}], 
       InsetBox[
        FormBox[
         RowBox[{"-", "4"}], TraditionalForm], {-4, 0}, {-1, -1}], 
       InsetBox[
        FormBox[
         RowBox[{"-", "3"}], TraditionalForm], {-3, 0}, {-1, -1}], 
       InsetBox[
        FormBox[
         RowBox[{"-", "2"}], TraditionalForm], {-2, 0}, {-1, -1}], 
       InsetBox[
        FormBox[
         RowBox[{"-", "1"}], TraditionalForm], {-1, 0}, {-1, -1}], 
       InsetBox[
        FormBox["0", TraditionalForm], {0, 0}, {-1, -1}], 
       InsetBox[
        FormBox["1", TraditionalForm], {1, 0}, {-1, -1}], 
       InsetBox[
        FormBox["2", TraditionalForm], {2, 0}, {-1, -1}], 
       InsetBox[
        FormBox["3", TraditionalForm], {3, 0}, {-1, -1}], 
       InsetBox[
        FormBox["4", TraditionalForm], {4, 0}, {-1, -1}], 
       InsetBox[
        FormBox["5", TraditionalForm], {5, 0}, {-1, -1}], 
       InsetBox[
        FormBox["6", TraditionalForm], {6, 0}, {-1, -1}]}}, {
      GrayLevel[0], 
      Thickness[Medium], 
      LineBox[
       NCache[{{
          Rational[-9, 2], 
          Rational[-1, 2]}, {
          Rational[-7, 2], 
          Rational[-1, 2]}, {
          Rational[-5, 2], 
          Rational[-1, 2]}, {
          Rational[-3, 2], 
          Rational[-1, 2]}, {
          Rational[-1, 2], 
          Rational[-1, 2]}, {
          Rational[1, 2], 
          Rational[-1, 2]}, {
          Rational[3, 2], 
          Rational[-1, 2]}, {
          Rational[5, 2], 
          Rational[-1, 2]}, {
          Rational[7, 2], 
          Rational[-1, 2]}, {
          Rational[9, 2], 
          
          Rational[-1, 
           2]}}, {{-4.5, -0.5}, {-3.5, -0.5}, {-2.5, -0.5}, {-1.5, -0.5}, \
{-0.5, -0.5}, {0.5, -0.5}, {1.5, -0.5}, {2.5, -0.5}, {3.5, -0.5}, {
        4.5, -0.5}}]], 
      LineBox[
       NCache[{{
          Rational[9, 2], 
          Rational[-1, 2]}, {
          Rational[9, 2], 
          Rational[1, 2]}}, {{4.5, -0.5}, {4.5, 0.5}}]], 
      LineBox[
       NCache[{{
          Rational[-9, 2], 
          Rational[1, 2]}, {
          Rational[-7, 2], 
          Rational[1, 2]}, {
          Rational[-5, 2], 
          Rational[1, 2]}, {
          Rational[-3, 2], 
          Rational[1, 2]}, {
          Rational[-1, 2], 
          Rational[1, 2]}, {
          Rational[1, 2], 
          Rational[1, 2]}, {
          Rational[3, 2], 
          Rational[1, 2]}, {
          Rational[5, 2], 
          Rational[1, 2]}, {
          Rational[7, 2], 
          Rational[1, 2]}, {
          Rational[9, 2], 
          Rational[1, 2]}}, {{-4.5, 0.5}, {-3.5, 0.5}, {-2.5, 0.5}, {-1.5, 
        0.5}, {-0.5, 0.5}, {0.5, 0.5}, {1.5, 0.5}, {2.5, 0.5}, {3.5, 0.5}, {
        4.5, 0.5}}]], 
      LineBox[
       NCache[{{
          Rational[-9, 2], 
          Rational[-1, 2]}, {
          Rational[-9, 2], 
          Rational[1, 2]}}, {{-4.5, -0.5}, {-4.5, 0.5}}]]}}, AspectRatio -> 
    NCache[
      Rational[1, 3], 0.3333333333333333], Axes -> {True, False}, Ticks -> 
    False, BaseStyle -> 11, ImageSize -> Large], 
   FormBox[
    FormBox[
     TemplateBox[{
      "\"Particle Boundary\"", "\"Cell Center\"", "\"Ghost Cells\""}, 
      "PointLegend", DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    GrayLevel[0]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    GrayLevel[0]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #, 
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    GrayLevel[0]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    GrayLevel[0]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #2, 
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    GrayLevel[0.5]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    GrayLevel[0.5]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #3}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {"Columns" -> {{0.8, 0.5}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxDividers -> {"Columns" -> {{None}}, "Rows" -> {{None}}}, 
             GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}}, 
             GridBoxSpacings -> {"Columns" -> {{0}}, "Rows" -> {{1}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"PointLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               InterpretationBox[
                ButtonBox[
                 TooltipBox[
                  GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    GrayLevel[0], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                   True, FrameStyle -> GrayLevel[0.], FrameTicks -> None, 
                   PlotRangePadding -> None, ImageSize -> 
                   Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], "GrayLevel[0]"], Appearance -> None, 
                 BaseStyle -> {}, BaselinePosition -> Baseline, 
                 DefaultBaseStyle -> {}, ButtonFunction :> 
                 With[{Typeset`box$ = EvaluationBox[]}, 
                   If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    GrayLevel[0]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["GrayLevelColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                 Automatic, Method -> "Preemptive"], 
                GrayLevel[0], Editable -> False, Selectable -> False], ",", 
               InterpretationBox[
                ButtonBox[
                 TooltipBox[
                  GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    GrayLevel[0], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                   True, FrameStyle -> GrayLevel[0.], FrameTicks -> None, 
                   PlotRangePadding -> None, ImageSize -> 
                   Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], "GrayLevel[0]"], Appearance -> None, 
                 BaseStyle -> {}, BaselinePosition -> Baseline, 
                 DefaultBaseStyle -> {}, ButtonFunction :> 
                 With[{Typeset`box$ = EvaluationBox[]}, 
                   If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    GrayLevel[0]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["GrayLevelColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                 Automatic, Method -> "Preemptive"], 
                GrayLevel[0], Editable -> False, Selectable -> False], ",", 
               InterpretationBox[
                ButtonBox[
                 TooltipBox[
                  GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    GrayLevel[0.5], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                   True, FrameStyle -> GrayLevel[0.33333333333333337`], 
                   FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                   Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], "GrayLevel[0.5]"], Appearance -> None,
                  BaseStyle -> {}, BaselinePosition -> Baseline, 
                 DefaultBaseStyle -> {}, ButtonFunction :> 
                 With[{Typeset`box$ = EvaluationBox[]}, 
                   If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    GrayLevel[0.5]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["GrayLevelColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                 Automatic, Method -> "Preemptive"], 
                GrayLevel[0.5], Editable -> False, Selectable -> False]}], 
             "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2, ",", #3}], "}"}], ",", 
           RowBox[{"Joined", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{"True", ",", "False", ",", "False"}], "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Row\""}]}], "]"}]& ), 
      Editable -> True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}, {
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {2, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "Above"}], "]"}]}], "]"}]& )]], "Output",ExpressionU\
UID->"00ee22ef-4580-4b53-ab5f-f963095ce234"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Magnetic field update", "Subsubsection",ExpressionUUID->"fb6b39f5-8799-4aa8-a8ce-21e0009a5abe"],

Cell[TextData[{
 "Staggered grid:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         SuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "1"], "/", 
         "\[CapitalDelta]t"}]},
       {
        RowBox[{
         SuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "2"], "/", 
         "\[CapitalDelta]t"}]},
       {
        RowBox[{
         SuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "3"], "/", 
         "\[CapitalDelta]t"}]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["c", 
       SqrtBox["g"]]}], 
     RowBox[{"(", GridBox[{
        {"0"},
        {
         RowBox[{
          RowBox[{"-", 
           SubsuperscriptBox["\[CapitalDelta]\[CapitalXi]", "3", "t"]}], "/", 
          
          SuperscriptBox["\[CapitalDelta]x", "1"]}]},
        {
         RowBox[{
          RowBox[{"+", 
           SubsuperscriptBox["\[CapitalDelta]\[CapitalXi]", "2", "t"]}], "/", 
          
          SuperscriptBox["\[CapitalDelta]x", "1"]}]}
       }], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "0af257e7-317a-41aa-84ed-90803a142db7"],
 " \[DoubleRightArrow] \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["\[CapitalOmega]", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
         RowBox[{"1", ";", "i"}]]},
       {
        SubsuperscriptBox["\[CapitalOmega]", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
         RowBox[{"2", ";", "i"}]]},
       {
        SubsuperscriptBox["\[CapitalOmega]", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
         RowBox[{"3", ";", "i"}]]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["\[CapitalOmega]", 
          RowBox[{"t", "-", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
          RowBox[{"1", ";", "i"}]]},
        {
         SubsuperscriptBox["\[CapitalOmega]", 
          RowBox[{"t", "-", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
          RowBox[{"2", ";", "i"}]]},
        {
         SubsuperscriptBox["\[CapitalOmega]", 
          RowBox[{"t", "-", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
          RowBox[{"3", ";", "i"}]]}
       }], ")"}], "-", 
     RowBox[{
      FractionBox[
       RowBox[{"c", " ", "\[CapitalDelta]t"}], 
       RowBox[{
        SqrtBox["g"], 
        SuperscriptBox["\[CapitalDelta]x", "1"]}]], 
      RowBox[{"(", GridBox[{
         {"0"},
         {
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             SubsuperscriptBox["\[CapitalXi]", 
              RowBox[{"3", ";", 
               RowBox[{"i", "+", "1"}]}], "t"], "-", 
             SubsuperscriptBox["\[CapitalXi]", 
              RowBox[{"3", ";", "i"}], "t"]}], ")"}]}]},
         {
          RowBox[{"+", 
           RowBox[{"(", 
            RowBox[{
             SubsuperscriptBox["\[CapitalXi]", 
              RowBox[{"2", ";", 
               RowBox[{"i", "+", "1"}]}], "t"], "-", 
             SubsuperscriptBox["\[CapitalXi]", 
              RowBox[{"2", ";", "i"}], "t"]}], ")"}]}]}
        }], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "f7f19ee1-af55-4362-ab92-86d2676d8ed4"]
}], "Text",ExpressionUUID->"ea180c80-1d45-4c8e-b169-0a13ac3cec31"],

Cell[TextData[{
 "Collocated grid:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         SuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "1"], "/", 
         "\[CapitalDelta]t"}]},
       {
        RowBox[{
         SuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "2"], "/", 
         "\[CapitalDelta]t"}]},
       {
        RowBox[{
         SuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "3"], "/", 
         "\[CapitalDelta]t"}]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["c", 
       SqrtBox["g"]]}], 
     RowBox[{"(", GridBox[{
        {"0"},
        {
         RowBox[{
          RowBox[{"-", 
           SubsuperscriptBox["\[CapitalDelta]\[CapitalXi]", "3", "t"]}], "/", 
          
          SuperscriptBox["\[CapitalDelta]x", "1"]}]},
        {
         RowBox[{
          RowBox[{"+", 
           SubsuperscriptBox["\[CapitalDelta]\[CapitalXi]", "2", "t"]}], "/", 
          
          SuperscriptBox["\[CapitalDelta]x", "1"]}]}
       }], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "a24858ff-c49c-44de-893b-517fe2307fdf"],
 " \[DoubleRightArrow] \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["\[CapitalOmega]", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
         RowBox[{"1", ";", "i"}]]},
       {
        SubsuperscriptBox["\[CapitalOmega]", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
         RowBox[{"2", ";", "i"}]]},
       {
        SubsuperscriptBox["\[CapitalOmega]", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
         RowBox[{"3", ";", "i"}]]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["\[CapitalOmega]", 
          RowBox[{"t", "-", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
          RowBox[{"1", ";", "i"}]]},
        {
         SubsuperscriptBox["\[CapitalOmega]", 
          RowBox[{"t", "-", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
          RowBox[{"2", ";", "i"}]]},
        {
         SubsuperscriptBox["\[CapitalOmega]", 
          RowBox[{"t", "-", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
          RowBox[{"3", ";", "i"}]]}
       }], ")"}], "-", 
     RowBox[{
      FractionBox[
       RowBox[{"c", " ", 
        RowBox[{"\[CapitalDelta]t", "/", 
         SqrtBox["g"]}]}], 
       RowBox[{"12", 
        SuperscriptBox["\[CapitalDelta]x", "1"]}]], 
      RowBox[{"(", GridBox[{
         {"0"},
         {
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             SubsuperscriptBox["\[CapitalXi]", 
              RowBox[{"3", ";", 
               RowBox[{"i", "-", "2"}]}], "t"], "-", 
             RowBox[{"8", 
              SubsuperscriptBox["\[CapitalXi]", 
               RowBox[{"3", ";", 
                RowBox[{"i", "-", "1"}]}], "t"]}], "+", 
             RowBox[{"8", 
              SubsuperscriptBox["\[CapitalXi]", 
               RowBox[{"3", ";", 
                RowBox[{"i", "+", "1"}]}], "t"]}], "-", 
             SubsuperscriptBox["\[CapitalXi]", 
              RowBox[{"3", ";", 
               RowBox[{"i", "+", "2"}]}], "t"]}], ")"}]}]},
         {
          RowBox[{"+", 
           RowBox[{"(", 
            RowBox[{
             SubsuperscriptBox["\[CapitalXi]", 
              RowBox[{"2", ";", 
               RowBox[{"i", "-", "2"}]}], "t"], "-", 
             RowBox[{"8", 
              SubsuperscriptBox["\[CapitalXi]", 
               RowBox[{"2", ";", 
                RowBox[{"i", "-", "1"}]}], "t"]}], "+", 
             RowBox[{"8", 
              SubsuperscriptBox["\[CapitalXi]", 
               RowBox[{"2", ";", 
                RowBox[{"i", "+", "1"}]}], "t"]}], "-", 
             SubsuperscriptBox["\[CapitalXi]", 
              RowBox[{"2", ";", 
               RowBox[{"i", "+", "2"}]}], "t"]}], ")"}]}]}
        }], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "be09b251-bd93-4b25-a2d7-4bffc63a45c4"]
}], "Text",ExpressionUUID->"b035bbbd-9d60-4cde-9f68-70df00c38835"],

Cell[TextData[{
 "After update, calculate covariant components:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[CapitalOmega]", "i"], "=", 
    RowBox[{
     SuperscriptBox["\[CapitalOmega]", "j"], 
     SubscriptBox["g", 
      RowBox[{"i", "\[VeryThinSpace]", "j"}]]}]}], TraditionalForm]],
  ExpressionUUID->"dd3908cf-4e25-43e2-bc00-6052e5d57090"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["\[CapitalOmega]", "1"]},
       {
        SubscriptBox["\[CapitalOmega]", "2"]},
       {
        SubscriptBox["\[CapitalOmega]", "3"]}
      }], ")"}], "=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         RowBox[{
          SubscriptBox["g", "11"], 
          SuperscriptBox["\[CapitalOmega]", "1"]}], "+", 
         RowBox[{
          SubscriptBox["g", "12"], 
          SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
         RowBox[{
          SubscriptBox["g", "13"], 
          SuperscriptBox["\[CapitalOmega]", "3"]}]}]},
       {
        RowBox[{
         RowBox[{
          SubscriptBox["g", "21"], 
          SuperscriptBox["\[CapitalOmega]", "1"]}], "+", 
         RowBox[{
          SubscriptBox["g", "22"], 
          SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
         RowBox[{
          SubscriptBox["g", "23"], 
          SuperscriptBox["\[CapitalOmega]", "3"]}]}]},
       {
        RowBox[{
         RowBox[{
          SubscriptBox["g", "31"], 
          SuperscriptBox["\[CapitalOmega]", "1"]}], "+", 
         RowBox[{
          SubscriptBox["g", "32"], 
          SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
         RowBox[{
          SubscriptBox["g", "33"], 
          SuperscriptBox["\[CapitalOmega]", "3"]}]}]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "ba5e94eb-4f1a-42fa-98ec-1140340a252a"],
 ";\nand cartesian components:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["\[CapitalOmega]", "x"]},
       {
        SubscriptBox["\[CapitalOmega]", "y"]},
       {
        SubscriptBox["\[CapitalOmega]", "z"]}
      }], ")"}], "=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         RowBox[{
          SuperscriptBox["\[CapitalOmega]", "1"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "x"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalOmega]", "2"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "x"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalOmega]", "3"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "x"]}]}]}]},
       {
        RowBox[{
         RowBox[{
          SuperscriptBox["\[CapitalOmega]", "1"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "y"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalOmega]", "2"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "y"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalOmega]", "3"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "y"]}]}]}]},
       {
        RowBox[{
         RowBox[{
          SuperscriptBox["\[CapitalOmega]", "1"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "z"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalOmega]", "2"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "z"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalOmega]", "3"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "z"]}]}]}]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "55c8a377-f373-4eb2-81bf-f7de8bd7a4b2"]
}], "Text",ExpressionUUID->"5a9fed65-c44e-47db-939e-da9302f55582"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Electric field update", "Subsubsection",ExpressionUUID->"41eaf251-6f3e-47eb-ae80-da78b37dbb03"],

Cell[TextData[{
 "Staggered grid:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         SuperscriptBox["\[CapitalDelta]\[CapitalXi]", "1"], "/", 
         "\[CapitalDelta]t"}]},
       {
        RowBox[{
         SuperscriptBox["\[CapitalDelta]\[CapitalXi]", "2"], "/", 
         "\[CapitalDelta]t"}]},
       {
        RowBox[{
         SuperscriptBox["\[CapitalDelta]\[CapitalXi]", "3"], "/", 
         "\[CapitalDelta]t"}]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{
      FractionBox["c", 
       SqrtBox["g"]], 
      RowBox[{"(", GridBox[{
         {"0"},
         {
          RowBox[{
           RowBox[{"-", 
            SubsuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "3", 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], "/", 
           SuperscriptBox["\[CapitalDelta]x", "1"]}]},
         {
          RowBox[{
           RowBox[{"+", 
            SubsuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "2", 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], "/", 
           SuperscriptBox["\[CapitalDelta]x", "1"]}]}
        }], ")"}]}], "-", 
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], "1"]},
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], "2"]},
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], "3"]}
       }], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "a0905b0c-71e5-4cef-b5fa-4f7be6836c81"],
 " \[DoubleRightArrow] \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["\[CapitalXi]", 
         RowBox[{"t", "+", "\[CapitalDelta]t"}], 
         RowBox[{"1", ";", "i"}]]},
       {
        SubsuperscriptBox["\[CapitalXi]", 
         RowBox[{"t", "+", "\[CapitalDelta]t"}], 
         RowBox[{"2", ";", "i"}]]},
       {
        SubsuperscriptBox["\[CapitalXi]", 
         RowBox[{"t", "+", "\[CapitalDelta]t"}], 
         RowBox[{"3", ";", "i"}]]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["\[CapitalXi]", "t", 
          RowBox[{"1", ";", "i"}]]},
        {
         SubsuperscriptBox["\[CapitalXi]", "t", 
          RowBox[{"2", ";", "i"}]]},
        {
         SubsuperscriptBox["\[CapitalXi]", "t", 
          RowBox[{"3", ";", "i"}]]}
       }], ")"}], "-", 
     RowBox[{"\[CapitalDelta]t", "(", GridBox[{
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
          RowBox[{"1", ";", "i"}]]},
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
          RowBox[{"2", ";", "i"}]]},
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
          RowBox[{"3", ";", "i"}]]}
       }], ")"}], "+", 
     RowBox[{
      FractionBox[
       RowBox[{"c", " ", "\[CapitalDelta]t"}], 
       RowBox[{
        SqrtBox["g"], 
        SuperscriptBox["\[CapitalDelta]x", "1"]}]], 
      RowBox[{"(", GridBox[{
         {"0"},
         {
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             SubsuperscriptBox["\[CapitalOmega]", 
              RowBox[{"3", ";", "i"}], 
              RowBox[{"t", "+", 
               RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "-", 
             SubsuperscriptBox["\[CapitalOmega]", 
              RowBox[{"3", ";", 
               RowBox[{"i", "-", "1"}]}], 
              RowBox[{"t", "+", 
               RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}]},
         {
          RowBox[{"+", 
           RowBox[{"(", 
            RowBox[{
             SubsuperscriptBox["\[CapitalOmega]", 
              RowBox[{"2", ";", "i"}], 
              RowBox[{"t", "+", 
               RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "-", 
             SubsuperscriptBox["\[CapitalOmega]", 
              RowBox[{"2", ";", 
               RowBox[{"i", "-", "1"}]}], 
              RowBox[{"t", "+", 
               RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}]}
        }], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "da6de087-7620-438d-a80c-130a673551d5"]
}], "Text",ExpressionUUID->"484bfdcd-5ff3-4130-b6e2-7731b48e9897"],

Cell[TextData[{
 "Collocated grid:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         SuperscriptBox["\[CapitalDelta]\[CapitalXi]", "1"], "/", 
         "\[CapitalDelta]t"}]},
       {
        RowBox[{
         SuperscriptBox["\[CapitalDelta]\[CapitalXi]", "2"], "/", 
         "\[CapitalDelta]t"}]},
       {
        RowBox[{
         SuperscriptBox["\[CapitalDelta]\[CapitalXi]", "3"], "/", 
         "\[CapitalDelta]t"}]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{
      FractionBox["c", 
       SqrtBox["g"]], 
      RowBox[{"(", GridBox[{
         {"0"},
         {
          RowBox[{
           RowBox[{"-", 
            SubsuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "3", 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], "/", 
           SuperscriptBox["\[CapitalDelta]x", "1"]}]},
         {
          RowBox[{
           RowBox[{"+", 
            SubsuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "2", 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], "/", 
           SuperscriptBox["\[CapitalDelta]x", "1"]}]}
        }], ")"}]}], "-", 
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], "1"]},
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], "2"]},
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], "3"]}
       }], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "dc4313f6-4cf2-4d18-bc4e-0874818236d6"],
 " \[DoubleRightArrow] \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["\[CapitalXi]", 
         RowBox[{"t", "+", "\[CapitalDelta]t"}], 
         RowBox[{"1", ";", "i"}]]},
       {
        SubsuperscriptBox["\[CapitalXi]", 
         RowBox[{"t", "+", "\[CapitalDelta]t"}], 
         RowBox[{"2", ";", "i"}]]},
       {
        SubsuperscriptBox["\[CapitalXi]", 
         RowBox[{"t", "+", "\[CapitalDelta]t"}], 
         RowBox[{"3", ";", "i"}]]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["\[CapitalXi]", "t", 
          RowBox[{"1", ";", "i"}]]},
        {
         SubsuperscriptBox["\[CapitalXi]", "t", 
          RowBox[{"2", ";", "i"}]]},
        {
         SubsuperscriptBox["\[CapitalXi]", "t", 
          RowBox[{"3", ";", "i"}]]}
       }], ")"}], "-", 
     RowBox[{"\[CapitalDelta]t", "(", GridBox[{
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
          RowBox[{"1", ";", "i"}]]},
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
          RowBox[{"2", ";", "i"}]]},
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
          RowBox[{"3", ";", "i"}]]}
       }], ")"}], "+", 
     RowBox[{
      FractionBox[
       RowBox[{"c", " ", 
        RowBox[{"\[CapitalDelta]t", "/", 
         SqrtBox["g"]}]}], 
       RowBox[{"12", 
        SuperscriptBox["\[CapitalDelta]x", "1"]}]], 
      RowBox[{"(", GridBox[{
         {"0"},
         {
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             SubsuperscriptBox["\[CapitalOmega]", 
              RowBox[{"3", ";", 
               RowBox[{"i", "-", "2"}]}], 
              RowBox[{"t", "+", 
               RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "-", 
             RowBox[{"8", 
              SubsuperscriptBox["\[CapitalOmega]", 
               RowBox[{"3", ";", 
                RowBox[{"i", "-", "1"}]}], 
               RowBox[{"t", "+", 
                RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], "+", 
             RowBox[{"8", 
              SubsuperscriptBox["\[CapitalOmega]", 
               RowBox[{"3", ";", 
                RowBox[{"i", "+", "1"}]}], 
               RowBox[{"t", "+", 
                RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], "-", 
             SubsuperscriptBox["\[CapitalOmega]", 
              RowBox[{"3", ";", 
               RowBox[{"i", "+", "2"}]}], 
              RowBox[{"t", "+", 
               RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}]},
         {
          RowBox[{"+", 
           RowBox[{"(", 
            RowBox[{
             SubsuperscriptBox["\[CapitalOmega]", 
              RowBox[{"2", ";", 
               RowBox[{"i", "-", "2"}]}], 
              RowBox[{"t", "+", 
               RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "-", 
             RowBox[{"8", 
              SubsuperscriptBox["\[CapitalOmega]", 
               RowBox[{"2", ";", 
                RowBox[{"i", "-", "1"}]}], 
               RowBox[{"t", "+", 
                RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], "+", 
             RowBox[{"8", 
              SubsuperscriptBox["\[CapitalOmega]", 
               RowBox[{"2", ";", 
                RowBox[{"i", "+", "1"}]}], 
               RowBox[{"t", "+", 
                RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], "-", 
             SubsuperscriptBox["\[CapitalOmega]", 
              RowBox[{"2", ";", 
               RowBox[{"i", "+", "2"}]}], 
              RowBox[{"t", "+", 
               RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}]}
        }], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "987e36a5-6270-49a1-b66d-e351e2382529"]
}], "Text",ExpressionUUID->"738dd1ec-eff3-4631-bf86-9489a7c71b10"],

Cell[TextData[{
 "After update, calculate covariant components:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[CapitalXi]", "i"], "=", 
    RowBox[{
     SuperscriptBox["\[CapitalXi]", "j"], 
     SubscriptBox["g", 
      RowBox[{"i", "\[VeryThinSpace]", "j"}]]}]}], TraditionalForm]],
  ExpressionUUID->"cc5f8f9c-bbef-4ddf-98d4-79f9e8629954"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["\[CapitalXi]", "1"]},
       {
        SubscriptBox["\[CapitalXi]", "2"]},
       {
        SubscriptBox["\[CapitalXi]", "3"]}
      }], ")"}], "=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         RowBox[{
          SubscriptBox["g", "11"], 
          SuperscriptBox["\[CapitalXi]", "1"]}], "+", 
         RowBox[{
          SubscriptBox["g", "12"], 
          SuperscriptBox["\[CapitalXi]", "2"]}], "+", 
         RowBox[{
          SubscriptBox["g", "13"], 
          SuperscriptBox["\[CapitalXi]", "3"]}]}]},
       {
        RowBox[{
         RowBox[{
          SubscriptBox["g", "21"], 
          SuperscriptBox["\[CapitalXi]", "1"]}], "+", 
         RowBox[{
          SubscriptBox["g", "22"], 
          SuperscriptBox["\[CapitalXi]", "2"]}], "+", 
         RowBox[{
          SubscriptBox["g", "23"], 
          SuperscriptBox["\[CapitalXi]", "3"]}]}]},
       {
        RowBox[{
         RowBox[{
          SubscriptBox["g", "31"], 
          SuperscriptBox["\[CapitalXi]", "1"]}], "+", 
         RowBox[{
          SubscriptBox["g", "32"], 
          SuperscriptBox["\[CapitalXi]", "2"]}], "+", 
         RowBox[{
          SubscriptBox["g", "33"], 
          SuperscriptBox["\[CapitalXi]", "3"]}]}]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "54148420-7a80-4baf-9b7c-1da31f78b5e6"],
 ";\nand cartesian components:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["\[CapitalXi]", "x"]},
       {
        SubscriptBox["\[CapitalXi]", "y"]},
       {
        SubscriptBox["\[CapitalXi]", "z"]}
      }], ")"}], "=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         RowBox[{
          SuperscriptBox["\[CapitalXi]", "1"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "x"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalXi]", "2"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "x"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalXi]", "3"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "x"]}]}]}]},
       {
        RowBox[{
         RowBox[{
          SuperscriptBox["\[CapitalXi]", "1"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "y"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalXi]", "2"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "y"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalXi]", "3"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "y"]}]}]}]},
       {
        RowBox[{
         RowBox[{
          SuperscriptBox["\[CapitalXi]", "1"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "z"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalXi]", "2"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "z"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalXi]", "3"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "z"]}]}]}]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "fbf7de8d-eb3c-4800-8960-9f84799b3fd5"]
}], "Text",ExpressionUUID->"09a334d1-0b00-4340-ad74-e61e7a711d23"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cold fluid update", "Subsubsection",ExpressionUUID->"b0c75cdb-01cb-479a-9090-089265b05490"],

Cell[TextData[{
 "Staggered grid:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"\[CapitalDelta]", "(", 
      RowBox[{
       SubscriptBox["\[Delta]n", "f"], "/", 
       SubscriptBox["n", 
        RowBox[{"f", ",", "0"}]]}], ")"}], "\[CapitalDelta]t"], "=", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       SqrtBox["g"]]}], 
     RowBox[{"(", 
      FractionBox[
       RowBox[{"\[CapitalDelta]", "(", 
        RowBox[{
         SqrtBox["g"], 
         SubsuperscriptBox["V", 
          RowBox[{"f", ";", 
           RowBox[{"t", "+", 
            RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], "1"]}], ")"}], 
       SuperscriptBox["\[CapitalDelta]x", "1"]], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"27e49324-93c9-48d1-bcea-d625558c6c03"],
 " \[DoubleRightArrow] \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     SubsuperscriptBox["\[Delta]n", 
      RowBox[{"f", ";", "i"}], 
      RowBox[{"t", "+", "\[CapitalDelta]t"}]], 
     SubscriptBox["n", 
      RowBox[{"f", ",", "0"}]]], "=", 
    RowBox[{
     FractionBox[
      SubsuperscriptBox["\[Delta]n", 
       RowBox[{"f", ";", "i"}], "t"], 
      SubscriptBox["n", 
       RowBox[{"f", ",", "0"}]]], "-", 
     RowBox[{
      FractionBox[
       RowBox[{"2", "\[CapitalDelta]t"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SqrtBox[
           SubscriptBox["g", 
            RowBox[{"i", "+", "1"}]]], "+", 
          SqrtBox[
           SubscriptBox["g", "i"]]}], ")"}], 
        SuperscriptBox["\[CapitalDelta]x", "1"]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SqrtBox[
          SubscriptBox["g", 
           RowBox[{"i", "+", "1"}]]], 
         SubsuperscriptBox["V", 
          RowBox[{"f", ";", 
           RowBox[{"t", "+", 
            RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
          RowBox[{"1", ";", 
           RowBox[{"i", "+", "1"}]}]]}], "-", 
        RowBox[{
         SqrtBox[
          SubscriptBox["g", "i"]], 
         SubsuperscriptBox["V", 
          RowBox[{"f", ";", 
           RowBox[{"t", "+", 
            RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
          RowBox[{"1", ";", "i"}]]}]}], ")"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"7bde2497-2942-4b73-85dc-20c396cf0208"]
}], "Text",ExpressionUUID->"d2811ea1-3d92-4826-9024-55551c9205d5"],

Cell[TextData[{
 "Collocated grid:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"\[CapitalDelta]", "(", 
      RowBox[{
       SubscriptBox["\[Delta]n", "f"], "/", 
       SubscriptBox["n", 
        RowBox[{"f", ",", "0"}]]}], ")"}], "\[CapitalDelta]t"], "=", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       SqrtBox["g"]]}], 
     RowBox[{"(", 
      FractionBox[
       RowBox[{"\[CapitalDelta]", "(", 
        RowBox[{
         SqrtBox["g"], 
         SubsuperscriptBox["V", 
          RowBox[{"f", ";", 
           RowBox[{"t", "+", 
            RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], "1"]}], ")"}], 
       SuperscriptBox["\[CapitalDelta]x", "1"]], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"5b4a016a-3d5a-42f3-b409-5ca48037e5ba"],
 " \[DoubleRightArrow] \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     SubsuperscriptBox["\[Delta]n", 
      RowBox[{"f", ";", "i"}], 
      RowBox[{"t", "+", "\[CapitalDelta]t"}]], 
     SubscriptBox["n", 
      RowBox[{"f", ",", "0"}]]], "=", 
    RowBox[{
     FractionBox[
      SubsuperscriptBox["\[Delta]n", 
       RowBox[{"f", ";", "i"}], "t"], 
      SubscriptBox["n", 
       RowBox[{"f", ",", "0"}]]], "-", 
     RowBox[{
      FractionBox[
       RowBox[{"\[CapitalDelta]t", "/", 
        SqrtBox[
         SubscriptBox["g", "i"]]}], 
       RowBox[{"12", 
        SuperscriptBox["\[CapitalDelta]x", "1"]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SqrtBox[
          SubscriptBox["g", 
           RowBox[{"i", "-", "2"}]]], 
         SubsuperscriptBox["V", 
          RowBox[{"f", ";", 
           RowBox[{"t", "+", 
            RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
          RowBox[{"1", ";", 
           RowBox[{"i", "-", "2"}]}]]}], "-", 
        RowBox[{"8", 
         SqrtBox[
          SubscriptBox["g", 
           RowBox[{"i", "-", "1"}]]], 
         SubsuperscriptBox["V", 
          RowBox[{"f", ";", 
           RowBox[{"t", "+", 
            RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
          RowBox[{"1", ";", 
           RowBox[{"i", "-", "1"}]}]]}], "+", 
        RowBox[{"8", 
         SqrtBox[
          SubscriptBox["g", 
           RowBox[{"i", "+", "1"}]]], 
         SubsuperscriptBox["V", 
          RowBox[{"f", ";", 
           RowBox[{"t", "+", 
            RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
          RowBox[{"1", ";", 
           RowBox[{"i", "+", "1"}]}]]}], "-", 
        RowBox[{
         SqrtBox[
          SubscriptBox["g", 
           RowBox[{"i", "+", "2"}]]], 
         SubsuperscriptBox["V", 
          RowBox[{"f", ";", 
           RowBox[{"t", "+", 
            RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
          RowBox[{"1", ";", 
           RowBox[{"i", "+", "2"}]}]]}]}], ")"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"2ad02577-f31b-4fec-966c-aa7f184d7aab"]
}], "Text",ExpressionUUID->"7458d1ba-90dd-478e-89e7-284a5c5c8def"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Position update", "Subsubsection",ExpressionUUID->"9702f1ed-9629-406b-9309-30a50865f5fa"],

Cell[TextData[{
 "Cartesian to curvilinear:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SuperscriptBox["v", "1"]},
       {
        SuperscriptBox["v", "2"]},
       {
        SuperscriptBox["v", "3"]}
      }], ")"}], "=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         RowBox[{
          SubscriptBox["v", "x"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "x"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"]}]}], "+", 
         RowBox[{
          SubscriptBox["v", "y"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "y"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"]}]}], "+", 
         RowBox[{
          SubscriptBox["v", "z"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "z"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"]}]}]}]},
       {
        RowBox[{
         RowBox[{
          SubscriptBox["v", "x"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "x"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"]}]}], "+", 
         RowBox[{
          SubscriptBox["v", "y"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "y"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"]}]}], "+", 
         RowBox[{
          SubscriptBox["v", "z"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "z"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"]}]}]}]},
       {
        RowBox[{
         RowBox[{
          SubscriptBox["v", "x"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "x"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"]}]}], "+", 
         RowBox[{
          SubscriptBox["v", "y"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "y"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"]}]}], "+", 
         RowBox[{
          SubscriptBox["v", "z"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "z"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"]}]}]}]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "93301a69-0c2e-4e38-9518-6cacbafd4cae"]
}], "Text",ExpressionUUID->"15fc059f-3db7-454a-b869-6d8c724caef5"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["x", 
     RowBox[{"t", "+", "\[CapitalDelta]t"}], "1"], "=", 
    RowBox[{
     SubsuperscriptBox["x", "t", "1"], "+", 
     RowBox[{"\[CapitalDelta]t", " ", 
      SubsuperscriptBox["v", 
       RowBox[{"t", "+", 
        RowBox[{"\[CapitalDelta]t", "/", "2"}]}], "1"]}]}]}], 
   TraditionalForm]],ExpressionUUID->"1689cc2d-1496-4ce5-9d10-bc41fd98c06a"],
 "."
}], "Text",ExpressionUUID->"802f5501-9506-4b3d-8d00-ab35752ed2e9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Velocity update in cartesian coordinate", "Subsubsection",ExpressionUUID->"65487bfb-867e-421b-b381-db68cd6843d9"],

Cell[TextData[{
 "Step 0 - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         SubscriptBox["\[CapitalXi]", "x"], "[", 
         SubsuperscriptBox["x", "t", "1"], "]"}]},
       {
        RowBox[{
         SubscriptBox["\[CapitalXi]", "y"], "[", 
         SubsuperscriptBox["x", "t", "1"], "]"}]},
       {
        RowBox[{
         SubscriptBox["\[CapitalXi]", "z"], "[", 
         SubsuperscriptBox["x", "t", "1"], "]"}]}
      }], ")"}], "=", 
    RowBox[{
     SubscriptBox["\[Sum]", 
      RowBox[{"i", ",", "j"}]], 
     RowBox[{
      RowBox[{"(", GridBox[{
         {
          SubsuperscriptBox["\[CapitalXi]", 
           RowBox[{"x", ";", "i"}], "t"]},
         {
          SubsuperscriptBox["\[CapitalXi]", 
           RowBox[{"y", ";", "i"}], "t"]},
         {
          SubsuperscriptBox["\[CapitalXi]", 
           RowBox[{"z", ";", "i"}], "t"]}
        }], ")"}], 
      RowBox[{"S", "[", 
       RowBox[{
        SubsuperscriptBox["x", "t", "1"], "-", 
        SuperscriptBox["x", 
         RowBox[{"1", ";", "i"}]]}], "]"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"87d306ea-3744-4788-8284-6421194d72f4"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         SubscriptBox["\[CapitalOmega]", "x"], "[", 
         SubsuperscriptBox["x", "t", "1"], "]"}]},
       {
        RowBox[{
         SubscriptBox["\[CapitalOmega]", "y"], "[", 
         SubsuperscriptBox["x", "t", "1"], "]"}]},
       {
        RowBox[{
         SubscriptBox["\[CapitalOmega]", "z"], "[", 
         SubsuperscriptBox["x", "t", "1"], "]"}]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         RowBox[{
          SubsuperscriptBox["\[CapitalOmega]", "x", "0"], "[", 
          SubsuperscriptBox["x", "t", "1"], "]"}]},
        {
         RowBox[{
          SubsuperscriptBox["\[CapitalOmega]", "y", "0"], "[", 
          SubsuperscriptBox["x", "t", "1"], "]"}]},
        {
         RowBox[{
          SubsuperscriptBox["\[CapitalOmega]", "z", "0"], "[", 
          SubsuperscriptBox["x", "t", "1"], "]"}]}
       }], ")"}], "+", 
     RowBox[{
      SubscriptBox["\[Sum]", "i"], 
      RowBox[{
       RowBox[{"(", GridBox[{
          {
           SubsuperscriptBox["\[Delta]\[CapitalOmega]", 
            RowBox[{"x", ";", "i"}], "t"]},
          {
           SubsuperscriptBox["\[Delta]\[CapitalOmega]", 
            RowBox[{"y", ";", "i"}], "t"]},
          {
           SubsuperscriptBox["\[Delta]\[CapitalOmega]", 
            RowBox[{"z", ";", "i"}], "t"]}
         }], ")"}], 
       RowBox[{"S", "[", 
        RowBox[{
         SubsuperscriptBox["x", "t", "1"], "-", 
         RowBox[{
          SuperscriptBox["\[CapitalDelta]x", "1"], "/", "2"}], "-", 
         SuperscriptBox["x", 
          RowBox[{"1", ";", "i"}]]}], "]"}]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"e7fed2f9-79a9-4dc2-9169-b7fb00a1eb18"],
 ",\nStep 1 - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["v", "x", "-"]},
       {
        SubsuperscriptBox["v", "y", "-"]},
       {
        SubsuperscriptBox["v", "z", "-"]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["v", "x", 
          RowBox[{"t", "-", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]},
        {
         SubsuperscriptBox["v", "y", 
          RowBox[{"t", "-", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]},
        {
         SubsuperscriptBox["v", "z", 
          RowBox[{"t", "-", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}
       }], ")"}], "+", 
     RowBox[{
      FractionBox[
       SubscriptBox["\[CapitalOmega]", "s"], 
       SubscriptBox["\[CapitalOmega]", "0"]], 
      FractionBox[
       RowBox[{"c", " ", "\[CapitalDelta]t"}], "2"], 
      RowBox[{"(", GridBox[{
         {
          SubsuperscriptBox["\[CapitalXi]", "x", "t"]},
         {
          SubsuperscriptBox["\[CapitalXi]", "y", "t"]},
         {
          SubsuperscriptBox["\[CapitalXi]", "z", "t"]}
        }], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "9a01a5ff-6159-48c7-8c37-3a01afda69a2"],
 ",\nStep 2 - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["v", "x", "0"]},
       {
        SubsuperscriptBox["v", "y", "0"]},
       {
        SubsuperscriptBox["v", "z", "0"]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["v", "x", "-"]},
        {
         SubsuperscriptBox["v", "y", "-"]},
        {
         SubsuperscriptBox["v", "z", "-"]}
       }], ")"}], "+", 
     RowBox[{
      FractionBox[
       SubscriptBox["\[CapitalOmega]", "s"], 
       SubscriptBox["\[CapitalOmega]", "0"]], 
      FractionBox["\[CapitalDelta]t", "2"], 
      RowBox[{"(", GridBox[{
         {
          RowBox[{
           RowBox[{
            SubsuperscriptBox["v", "y", "-"], 
            SubsuperscriptBox["\[CapitalOmega]", "z", "t"]}], "-", 
           RowBox[{
            SubsuperscriptBox["v", "z", "-"], 
            SubsuperscriptBox["\[CapitalOmega]", "y", "t"]}]}]},
         {
          RowBox[{
           RowBox[{
            SubsuperscriptBox["v", "z", "-"], 
            SubsuperscriptBox["\[CapitalOmega]", "x", "t"]}], "-", 
           RowBox[{
            SubsuperscriptBox["v", "x", "-"], 
            SubsuperscriptBox["\[CapitalOmega]", "z", "t"]}]}]},
         {
          RowBox[{
           RowBox[{
            SubsuperscriptBox["v", "x", "-"], 
            SubsuperscriptBox["\[CapitalOmega]", "y", "t"]}], "-", 
           RowBox[{
            SubsuperscriptBox["v", "y", "-"], 
            SubsuperscriptBox["\[CapitalOmega]", "x", "t"]}]}]}
        }], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "d19bc3f2-0de1-410a-a1d3-e22b05518844"],
 ",\nStep 3 - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["v", "x", "+"]},
       {
        SubsuperscriptBox["v", "y", "+"]},
       {
        SubsuperscriptBox["v", "z", "+"]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["v", "x", "-"]},
        {
         SubsuperscriptBox["v", "y", "-"]},
        {
         SubsuperscriptBox["v", "z", "-"]}
       }], ")"}], "+", 
     RowBox[{
      FractionBox[
       SubscriptBox["\[CapitalOmega]", "s"], 
       SubscriptBox["\[CapitalOmega]", "0"]], 
      FractionBox["\[CapitalDelta]t", "2"], 
      FractionBox["2", 
       RowBox[{"1", "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             SubscriptBox["\[CapitalOmega]", "s"], 
             SubscriptBox["\[CapitalOmega]", "0"]], 
            FractionBox["\[CapitalDelta]t", "2"]}], ")"}], "2"], 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             SubsuperscriptBox["\[CapitalOmega]", "x", "t"], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             SubsuperscriptBox["\[CapitalOmega]", "y", "t"], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             SubsuperscriptBox["\[CapitalOmega]", "z", "t"], ")"}], "2"]}], 
          ")"}]}]}]], 
      RowBox[{"(", GridBox[{
         {
          RowBox[{
           RowBox[{
            SubsuperscriptBox["v", "y", "0"], 
            SubsuperscriptBox["\[CapitalOmega]", "z", "t"]}], "-", 
           RowBox[{
            SubsuperscriptBox["v", "z", "0"], 
            SubsuperscriptBox["\[CapitalOmega]", "y", "t"]}]}]},
         {
          RowBox[{
           RowBox[{
            SubsuperscriptBox["v", "z", "0"], 
            SubsuperscriptBox["\[CapitalOmega]", "x", "t"]}], "-", 
           RowBox[{
            SubsuperscriptBox["v", "x", "0"], 
            SubsuperscriptBox["\[CapitalOmega]", "z", "t"]}]}]},
         {
          RowBox[{
           RowBox[{
            SubsuperscriptBox["v", "x", "0"], 
            SubsuperscriptBox["\[CapitalOmega]", "y", "t"]}], "-", 
           RowBox[{
            SubsuperscriptBox["v", "y", "0"], 
            SubsuperscriptBox["\[CapitalOmega]", "x", "t"]}]}]}
        }], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "ccc7453a-76d9-4d86-a35c-6b5dacdc4639"],
 ", and\nStep 4 - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["v", "x", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]},
       {
        SubsuperscriptBox["v", "y", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]},
       {
        SubsuperscriptBox["v", "z", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["v", "x", "+"]},
        {
         SubsuperscriptBox["v", "y", "+"]},
        {
         SubsuperscriptBox["v", "z", "+"]}
       }], ")"}], "+", 
     RowBox[{
      FractionBox[
       SubscriptBox["\[CapitalOmega]", "s"], 
       SubscriptBox["\[CapitalOmega]", "0"]], 
      FractionBox[
       RowBox[{"c", " ", "\[CapitalDelta]t"}], "2"], 
      RowBox[{"(", GridBox[{
         {
          SubsuperscriptBox["\[CapitalXi]", "x", "t"]},
         {
          SubsuperscriptBox["\[CapitalXi]", "y", "t"]},
         {
          SubsuperscriptBox["\[CapitalXi]", "z", "t"]}
        }], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "0c2ecebe-6ebd-4931-8acc-dac97cfddf36"],
 "."
}], "Text",ExpressionUUID->"c3990e72-d5ea-4e55-af7d-409b5977a4a6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Moments: from particle to grid", "Subsubsection",ExpressionUUID->"cd1c9823-f092-41bb-8582-ab06a06d2c09"],

Cell[TextData[{
 "Number density (zeroth velocity moment) at ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],ExpressionUUID->
  "cdc6f31b-181f-4713-96ba-8370daa4e26b"],
 "th grid point:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["n", 
     RowBox[{"t", ";", "s"}], "i"], "=", 
    RowBox[{
     RowBox[{
      SubsuperscriptBox["n", 
       RowBox[{"0", ";", "s"}], "i"], 
      FractionBox[
       RowBox[{
        SubscriptBox["\[Sum]", "p"], 
        RowBox[{"S", "[", 
         RowBox[{
          SubsuperscriptBox["x", 
           RowBox[{"t", ";", "s"}], 
           RowBox[{"1", ";", "p"}]], "-", 
          SuperscriptBox["x", 
           RowBox[{"1", ";", "i"}]]}], "]"}]}], 
       SubsuperscriptBox["N", 
        RowBox[{"c", ";", "s"}], 
        RowBox[{"0", ";", "i"}]]]}], "=", 
     RowBox[{
      SubscriptBox["n", 
       RowBox[{"0", ";", "s"}]], 
      FractionBox[
       RowBox[{
        SubscriptBox["\[Sum]", "p"], 
        RowBox[{"S", "[", 
         RowBox[{
          SubsuperscriptBox["x", 
           RowBox[{"t", ";", "s"}], 
           RowBox[{"1", ";", "p"}]], "-", 
          SuperscriptBox["x", 
           RowBox[{"1", ";", "i"}]]}], "]"}]}], 
       SubscriptBox["N", 
        RowBox[{"c", ";", "s"}]]]}]}]}], TraditionalForm]],ExpressionUUID->
  "cb005f14-a944-44a5-9abf-737fefb241f1"],
 ", where ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["N", 
    RowBox[{"c", ";", "s"}], "0"], TraditionalForm]],ExpressionUUID->
  "f6f9ae12-3ece-49d8-b370-b6536f910401"],
 " is the initial number of simulation particles of species ",
 Cell[BoxData[
  FormBox["s", TraditionalForm]],ExpressionUUID->
  "82fab8c1-8e26-42c9-879b-7106750667cb"],
 " at a reference cell; ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", 
    RowBox[{"0", ";", "s"}]], TraditionalForm]],ExpressionUUID->
  "7eac9088-b832-4e32-8dea-ad955e12f263"],
 " is the initial number density of the species ",
 Cell[BoxData[
  FormBox["s", TraditionalForm]],ExpressionUUID->
  "15c457d6-0c4c-4cb6-b5ea-d574733715e8"],
 " at that cell; ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["N", 
    RowBox[{"c", ";", "s"}], 
    RowBox[{"0", ";", "i"}]], TraditionalForm]],ExpressionUUID->
  "bb192f29-6a3a-41c6-97c3-48ae9752f54a"],
 " is the initial number of simulation particles at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    SuperscriptBox["q", "i"], ")"}], TraditionalForm]],ExpressionUUID->
  "58b61ec4-87a4-4dfa-9be5-1f495fc41435"],
 " cell; and ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["n", 
    RowBox[{"0", ";", "s"}], "i"], TraditionalForm]],ExpressionUUID->
  "304540e3-6d28-47dc-9763-4b106cfc86a0"],
 " is the initial number density at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    SuperscriptBox["q", "i"], ")"}], TraditionalForm]],ExpressionUUID->
  "ecb85ed6-a9be-4bb7-ac65-bba71a12446f"],
 " cell.\nCharge density at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    SuperscriptBox["q", "i"], ")"}], TraditionalForm]],ExpressionUUID->
  "84fe7c61-6ae2-4a94-bda2-482404ab7768"],
 " cell is:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["\[CapitalPi]", "t", "i"], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Sum]", "s"], 
      RowBox[{
       FractionBox[
        SubscriptBox["\[CapitalOmega]", "0"], 
        SubscriptBox["\[CapitalOmega]", "s"]], 
       SubsuperscriptBox["\[Omega]", 
        RowBox[{"s", ";", "i"}], "2"], 
       FractionBox[
        RowBox[{
         SubscriptBox["\[Sum]", "p"], 
         RowBox[{"S", "[", 
          RowBox[{
           SubsuperscriptBox["x", 
            RowBox[{"t", ";", "s"}], 
            RowBox[{"1", ";", "p"}]], "-", 
           SuperscriptBox["x", 
            RowBox[{"1", ";", "i"}]]}], "]"}]}], 
        SubsuperscriptBox["N", 
         RowBox[{"c", ";", "s"}], 
         RowBox[{"0", ";", "i"}]]]}]}], "=", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Sum]", "s"], 
       RowBox[{
        FractionBox[
         SubscriptBox["\[CapitalOmega]", "0"], 
         SubscriptBox["\[CapitalOmega]", "s"]], 
        SubsuperscriptBox["\[Omega]", 
         RowBox[{"s", ";", "0"}], "2"], 
        FractionBox[
         RowBox[{
          SubscriptBox["\[Sum]", "p"], 
          RowBox[{"S", "[", 
           RowBox[{
            SubsuperscriptBox["x", 
             RowBox[{"t", ";", "s"}], 
             RowBox[{"1", ";", "p"}]], "-", 
            SuperscriptBox["x", 
             RowBox[{"1", ";", "i"}]]}], "]"}]}], 
         SubsuperscriptBox["N", 
          RowBox[{"c", ";", "s"}], "0"]]}]}], "=", 
      RowBox[{
       SubscriptBox["\[Sum]", "s"], 
       RowBox[{
        FractionBox[
         SubscriptBox["\[CapitalOmega]", "0"], 
         SubscriptBox["\[CapitalOmega]", "s"]], 
        SubsuperscriptBox["\[Omega]", 
         RowBox[{"s", ";", "0"}], "2"], 
        FractionBox[
         SubsuperscriptBox["n", 
          RowBox[{"t", ";", "s"}], "i"], 
         SubscriptBox["n", 
          RowBox[{"0", ";", "s"}]]]}]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"48490104-c5c0-470c-b4f3-6c349893793f"],
 ",\nwhere ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Omega]", 
    RowBox[{"s", ";", "0"}]], TraditionalForm]],ExpressionUUID->
  "8b9ad351-ea51-495d-b3ea-da811517fc6b"],
 " is the initial plasma frequency at the reference cell; and ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[Omega]", 
    RowBox[{"s", ";", "i"}], "2"], TraditionalForm]],ExpressionUUID->
  "645f0eaf-0233-4aeb-973d-69e2ecf8263d"],
 " is the initial plasma frequency at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    SuperscriptBox["q", "i"], ")"}], TraditionalForm]],ExpressionUUID->
  "5b442d27-f6e9-4cb9-9b4c-4c6de54fd9cb"],
 " cell."
}], "Text",ExpressionUUID->"3c7b42f0-d3c1-414b-8a7f-4fd101de6620"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Nc", "=", "100"}], ",", 
     RowBox[{"Nx", "=", "2"}], ",", 
     RowBox[{"n0", "=", "1."}], ",", 
     RowBox[{"S", "=", 
      RowBox[{"Function", "[", 
       RowBox[{"x", 
        RowBox[{"(*", 
         RowBox[{"0", "\[LessEqual]", "x", "\[LessEqual]", "1"}], "*)"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "-", "x"}], ",", "x"}], "}"}], "//", "N"}]}], 
       "]"}]}]}], "}"}], ",", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"x", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", 
         RowBox[{"Nc", "*", "Nx"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Plus", "@@@", 
         RowBox[{"S", "[", "x", "]"}]}], ")"}], "/", "Nc"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "]"}]], "Input",ExpressionUUID->"dac6d09b-\
7866-4b87-81e2-0ec0db3c2d41"],

Cell[TextData[{
 "Average flow speed weighted by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["n", 
     RowBox[{"t", ";", "s"}], "i"], "/", 
    SubscriptBox["n", 
     RowBox[{"0", ";", "s"}]]}], TraditionalForm]],ExpressionUUID->
  "f01a8c8f-6b98-4e3b-a992-609f01c22c92"],
 ":\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["V", 
         RowBox[{"x", ";", "i"}], 
         RowBox[{"t", ";", "s"}]]},
       {
        SubsuperscriptBox["V", 
         RowBox[{"y", ";", "i"}], 
         RowBox[{"t", ";", "s"}]]},
       {
        SubsuperscriptBox["V", 
         RowBox[{"z", ";", "i"}], 
         RowBox[{"t", ";", "s"}]]}
      }], ")"}], "=", 
    RowBox[{
     SubscriptBox["\[Sum]", "p"], 
     RowBox[{
      RowBox[{"(", GridBox[{
         {
          SubsuperscriptBox["v", 
           RowBox[{"x", ";", "p"}], 
           RowBox[{"t", ";", "s"}]]},
         {
          SubsuperscriptBox["v", 
           RowBox[{"y", ";", "p"}], 
           RowBox[{"t", ";", "s"}]]},
         {
          SubsuperscriptBox["v", 
           RowBox[{"z", ";", "p"}], 
           RowBox[{"t", ";", "s"}]]}
        }], ")"}], 
      FractionBox[
       RowBox[{"S", "[", 
        RowBox[{
         SubsuperscriptBox["x", 
          RowBox[{"t", ";", "s"}], 
          RowBox[{"1", ";", "p"}]], "-", 
         SuperscriptBox["x", 
          RowBox[{"1", ";", "i"}]]}], "]"}], 
       SubsuperscriptBox["N", 
        RowBox[{"c", ";", "s"}], "0"]]}]}]}], TraditionalForm]],
  ExpressionUUID->"42da0afb-206b-434a-8f43-86ba157e469b"],
 "\nAverage flow speed is given by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["V", 
         RowBox[{"x", ";", "i"}], 
         RowBox[{"t", ";", "s"}]]},
       {
        SubsuperscriptBox["V", 
         RowBox[{"y", ";", "i"}], 
         RowBox[{"t", ";", "s"}]]},
       {
        SubsuperscriptBox["V", 
         RowBox[{"z", ";", "i"}], 
         RowBox[{"t", ";", "s"}]]}
      }], ")"}], "/", 
    FractionBox[
     SubsuperscriptBox["n", 
      RowBox[{"t", ";", "s"}], "i"], 
     SubscriptBox["n", 
      RowBox[{"0", ";", "s"}]]]}], TraditionalForm]],ExpressionUUID->
  "b553aaaa-966c-46ec-b06c-4c791fb54968"],
 ".\nCurrent density:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["\[ScriptCapitalJ]", 
         RowBox[{"x", ";", "i"}], 
         RowBox[{"t", ";", "s"}]]},
       {
        SubsuperscriptBox["\[ScriptCapitalJ]", 
         RowBox[{"y", ";", "i"}], 
         RowBox[{"t", ";", "s"}]]},
       {
        SubsuperscriptBox["\[ScriptCapitalJ]", 
         RowBox[{"z", ";", "i"}], 
         RowBox[{"t", ";", "s"}]]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{
      FractionBox[
       SubscriptBox["\[CapitalOmega]", "0"], 
       SubscriptBox["\[CapitalOmega]", "s"]], 
      FractionBox[
       SubsuperscriptBox["\[Omega]", 
        RowBox[{"s", ";", "i"}], "2"], "c"], 
      RowBox[{
       SubscriptBox["\[Sum]", "p"], 
       RowBox[{
        RowBox[{"(", GridBox[{
           {
            SubsuperscriptBox["v", 
             RowBox[{"x", ";", "p"}], 
             RowBox[{"t", ";", "s"}]]},
           {
            SubsuperscriptBox["v", 
             RowBox[{"y", ";", "p"}], 
             RowBox[{"t", ";", "s"}]]},
           {
            SubsuperscriptBox["v", 
             RowBox[{"z", ";", "p"}], 
             RowBox[{"t", ";", "s"}]]}
          }], ")"}], 
        FractionBox[
         RowBox[{"S", "[", 
          RowBox[{
           SubsuperscriptBox["x", 
            RowBox[{"t", ";", "s"}], 
            RowBox[{"1", ";", "p"}]], "-", 
           SuperscriptBox["x", 
            RowBox[{"1", ";", "i"}]]}], "]"}], 
         SubsuperscriptBox["N", 
          RowBox[{"c", ";", "s"}], 
          RowBox[{"0", ";", "i"}]]]}]}]}], "=", 
     RowBox[{
      RowBox[{
       FractionBox[
        SubscriptBox["\[CapitalOmega]", "0"], 
        SubscriptBox["\[CapitalOmega]", "s"]], 
       FractionBox[
        SubsuperscriptBox["\[Omega]", 
         RowBox[{"s", ";", "0"}], "2"], "c"], 
       RowBox[{
        SubscriptBox["\[Sum]", "p"], 
        RowBox[{
         RowBox[{"(", GridBox[{
            {
             SubsuperscriptBox["v", 
              RowBox[{"x", ";", "p"}], 
              RowBox[{"t", ";", "s"}]]},
            {
             SubsuperscriptBox["v", 
              RowBox[{"y", ";", "p"}], 
              RowBox[{"t", ";", "s"}]]},
            {
             SubsuperscriptBox["v", 
              RowBox[{"z", ";", "p"}], 
              RowBox[{"t", ";", "s"}]]}
           }], ")"}], 
         FractionBox[
          RowBox[{"S", "[", 
           RowBox[{
            SubsuperscriptBox["x", 
             RowBox[{"t", ";", "s"}], 
             RowBox[{"1", ";", "p"}]], "-", 
            SuperscriptBox["x", 
             RowBox[{"1", ";", "i"}]]}], "]"}], 
          SubsuperscriptBox["N", 
           RowBox[{"c", ";", "s"}], "0"]]}]}]}], "=", 
      RowBox[{
       FractionBox[
        SubscriptBox["\[CapitalOmega]", "0"], 
        SubscriptBox["\[CapitalOmega]", "s"]], 
       FractionBox[
        SubsuperscriptBox["\[Omega]", 
         RowBox[{"s", ";", "0"}], "2"], "c"], 
       RowBox[{"(", GridBox[{
          {
           SubsuperscriptBox["V", 
            RowBox[{"x", ";", "i"}], 
            RowBox[{"t", ";", "s"}]]},
          {
           SubsuperscriptBox["V", 
            RowBox[{"y", ";", "i"}], 
            RowBox[{"t", ";", "s"}]]},
          {
           SubsuperscriptBox["V", 
            RowBox[{"z", ";", "i"}], 
            RowBox[{"t", ";", "s"}]]}
         }], ")"}]}]}]}]}], TraditionalForm]],ExpressionUUID->
  "42b3285d-e3b4-4af6-94f4-db356b53147d"],
 "\nCartesian to curvilinear:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SuperscriptBox["\[ScriptCapitalJ]", "1"]},
       {
        SuperscriptBox["\[ScriptCapitalJ]", "2"]},
       {
        SuperscriptBox["\[ScriptCapitalJ]", "3"]}
      }], ")"}], "=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         RowBox[{
          SubscriptBox["\[ScriptCapitalJ]", "x"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "x"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"]}]}], "+", 
         RowBox[{
          SubscriptBox["\[ScriptCapitalJ]", "y"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "y"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"]}]}], "+", 
         RowBox[{
          SubscriptBox["\[ScriptCapitalJ]", "z"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "z"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"]}]}]}]},
       {
        RowBox[{
         RowBox[{
          SubscriptBox["\[ScriptCapitalJ]", "x"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "x"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"]}]}], "+", 
         RowBox[{
          SubscriptBox["\[ScriptCapitalJ]", "y"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "y"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"]}]}], "+", 
         RowBox[{
          SubscriptBox["\[ScriptCapitalJ]", "z"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "z"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"]}]}]}]},
       {
        RowBox[{
         RowBox[{
          SubscriptBox["\[ScriptCapitalJ]", "x"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "x"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"]}]}], "+", 
         RowBox[{
          SubscriptBox["\[ScriptCapitalJ]", "y"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "y"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"]}]}], "+", 
         RowBox[{
          SubscriptBox["\[ScriptCapitalJ]", "z"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "z"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"]}]}]}]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "dabbbad5-8d97-4fa6-9cac-402ac958549e"]
}], "Text",ExpressionUUID->"4b8e7b31-f5c5-49da-9836-8538cf778466"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "icdf", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"icdf", ":=", 
  RowBox[{"icdf", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"cdf", "=", 
        RowBox[{"Function", "[", 
         RowBox[{"v", ",", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             RowBox[{"2", " ", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"-", 
                SuperscriptBox["v", "2"]}]], " ", "v"}], 
             SqrtBox["\[Pi]"]]}], "+", 
           RowBox[{"Erf", "[", "v", "]"}]}]}], "]"}]}], ",", 
       RowBox[{"n", "=", "1000"}], ",", 
       RowBox[{"vmax", "=", "4."}]}], "}"}], ",", 
     RowBox[{"Interpolation", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"cdf", "[", 
           RowBox[{"vmax", " ", 
            RowBox[{"i", "/", "n"}]}], "]"}], ",", 
          RowBox[{"vmax", " ", 
           RowBox[{"i", "/", "n"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "n"}], "}"}]}], "]"}], "]"}]}], 
    "]"}]}]}]}], "Input",ExpressionUUID->"410b688e-e2f3-4e15-b714-\
2fa7a2629dfb"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"icdf", "[", "i", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",ExpressionUUID->\
"1cd6d324-5f1a-4d4d-8958-67d03364ea74"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Nc", "=", "1000"}], ",", 
     RowBox[{"Nx", "=", "2"}], ",", 
     RowBox[{"n0", "=", "1."}], ",", 
     RowBox[{"\[Theta]", "=", "1."}], ",", 
     RowBox[{"S", "=", 
      RowBox[{"Function", "[", 
       RowBox[{"x", 
        RowBox[{"(*", 
         RowBox[{"0", "\[LessEqual]", "x", "\[LessEqual]", "1"}], "*)"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "-", "x"}], ",", "x"}], "}"}], "//", "N"}]}], 
       "]"}]}]}], "}"}], ",", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "rng", ",", "x", ",", "v", ",", "vx", ",", "vy", ",", "vz", ",", 
       "\[Psi]"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rng", ":=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", 
         RowBox[{"Nc", "*", "Nx"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"x", "=", "rng"}], ";", "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{
        RowBox[{"icdf", "[", "rng", "]"}], "\[Theta]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vx", "=", 
       RowBox[{"v", " ", 
        RowBox[{"(", 
         RowBox[{"\[Psi]", "=", 
          RowBox[{"1", "-", 
           RowBox[{"2", "rng"}]}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"v", " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[Psi]", "2"]}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vy", "=", 
       RowBox[{"v", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Psi]", "=", 
          RowBox[{"2", "\[Pi]", " ", "rng"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vz", "=", 
       RowBox[{"v", " ", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"TableForm", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"v", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"v", "//", "Mean"}], ",", 
             RowBox[{
              RowBox[{"Mean", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Total", "[", 
                    RowBox[{"v", "#"}], "]"}], "&"}], "/@", 
                  RowBox[{"S", "[", "x", "]"}]}], ")"}], "/", "Nc"}], "]"}], 
              "n0"}]}], "}"}]}], "]"}], "/@", 
         RowBox[{"{", 
          RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}]}], ",", 
        RowBox[{"TableHeadings", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SubscriptBox[\(v\), \(x\)]\)\>\"", ",", 
             "\"\<\!\(\*SubscriptBox[\(v\), \(y\)]\)\>\"", ",", 
             "\"\<\!\(\*SubscriptBox[\(v\), \(z\)]\)\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\[LeftAngleBracket]\[DoubleStruckV]\[RightAngleBracket]\>\"",
              ",", "\"\<2nd Mom \[Times] \!\(\*SubsuperscriptBox[\(n\), \
\(s\), \(0\)]\)\>\""}], "}"}]}], "}"}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "]"}]], "Input",ExpressionUUID->"ce0adfe1-a58f-4f6b-bdce-\
c11947e83776"],

Cell[TextData[{
 "Average second velocity moment weighted by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["n", 
     RowBox[{"t", ";", "s"}], "i"], "/", 
    SubscriptBox["n", 
     RowBox[{"0", ";", "s"}]]}], TraditionalForm]],ExpressionUUID->
  "12469d9f-52d7-458a-9d7b-18c7261520ac"],
 ":\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"2", 
      SubscriptBox["\[DoubleStruckW]", "s"]}], 
     SubscriptBox["m", "s"]], "=", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       SubsuperscriptBox["\[DoubleStruckV]", "i", 
        RowBox[{"t", ";", "s"}]], 
       SubsuperscriptBox["\[DoubleStruckV]", "i", 
        RowBox[{"t", ";", "s"}]]}], "\[RightAngleBracket]"}], "=", 
     RowBox[{
      RowBox[{
       SubsuperscriptBox["n", 
        RowBox[{"0", ";", "s"}], "i"], 
       RowBox[{
        SubscriptBox["\[Sum]", "p"], 
        RowBox[{
         SubsuperscriptBox["\[DoubleStruckV]", "p", 
          RowBox[{"t", ";", "s"}]], 
         SubsuperscriptBox["\[DoubleStruckV]", "p", 
          RowBox[{"t", ";", "s"}]], 
         FractionBox[
          RowBox[{"S", "[", 
           RowBox[{
            SubsuperscriptBox["x", 
             RowBox[{"t", ";", "s"}], 
             RowBox[{"1", ";", "p"}]], "-", 
            SuperscriptBox["x", 
             RowBox[{"1", ";", "i"}]]}], "]"}], 
          SubsuperscriptBox["N", 
           RowBox[{"c", ";", "s"}], 
           RowBox[{"0", ";", "i"}]]]}]}]}], "=", 
      RowBox[{
       SubscriptBox["n", 
        RowBox[{"0", ";", "s"}]], 
       RowBox[{
        SubscriptBox["\[Sum]", "p"], 
        RowBox[{
         SubsuperscriptBox["\[DoubleStruckV]", "p", 
          RowBox[{"t", ";", "s"}]], 
         SubsuperscriptBox["\[DoubleStruckV]", "p", 
          RowBox[{"t", ";", "s"}]], 
         FractionBox[
          RowBox[{"S", "[", 
           RowBox[{
            SubsuperscriptBox["x", 
             RowBox[{"t", ";", "s"}], 
             RowBox[{"1", ";", "p"}]], "-", 
            SuperscriptBox["x", 
             RowBox[{"1", ";", "i"}]]}], "]"}], 
          SubsuperscriptBox["N", 
           RowBox[{"c", ";", "s"}], "0"]]}]}]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"6aed44af-ac2b-469f-a5e2-0a5999cc91f3"],
 ".\nKinetic energy density (equivalent to pressure):\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["\[CurlyEpsilon]", "i", 
     RowBox[{"t", ";", "s"}]], "=", 
    RowBox[{
     RowBox[{
      FractionBox[
       SubsuperscriptBox["\[CapitalOmega]", "0", "2"], 
       SubsuperscriptBox["\[CapitalOmega]", "s", "2"]], 
      FractionBox[
       SubsuperscriptBox["\[Omega]", 
        RowBox[{"s", ";", "i"}], "2"], 
       SuperscriptBox["c", "2"]], 
      RowBox[{
       SubscriptBox["\[Sum]", "p"], 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"(", GridBox[{
           {
            SubsuperscriptBox["v", 
             RowBox[{"x", ";", "p"}], "2"]},
           {
            SubsuperscriptBox["v", 
             RowBox[{"y", ";", "p"}], "2"]},
           {
            SubsuperscriptBox["v", 
             RowBox[{"z", ";", "p"}], "2"]}
          }], ")"}], 
        FractionBox[
         RowBox[{"S", "[", 
          RowBox[{
           SubsuperscriptBox["x", 
            RowBox[{"t", ";", "s"}], 
            RowBox[{"1", ";", "p"}]], "-", 
           SuperscriptBox["x", 
            RowBox[{"1", ";", "i"}]]}], "]"}], 
         SubsuperscriptBox["N", 
          RowBox[{"c", ";", "s"}], 
          RowBox[{"0", ";", "i"}]]]}]}]}], "=", 
     RowBox[{
      FractionBox[
       SubsuperscriptBox["\[CapitalOmega]", "0", "2"], 
       SubsuperscriptBox["\[CapitalOmega]", "s", "2"]], 
      FractionBox[
       SubsuperscriptBox["\[Omega]", 
        RowBox[{"s", ";", "0"}], "2"], 
       SuperscriptBox["c", "2"]], 
      RowBox[{
       SubscriptBox["\[Sum]", "p"], 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"(", GridBox[{
           {
            SubsuperscriptBox["v", 
             RowBox[{"x", ";", "p"}], "2"]},
           {
            SubsuperscriptBox["v", 
             RowBox[{"y", ";", "p"}], "2"]},
           {
            SubsuperscriptBox["v", 
             RowBox[{"z", ";", "p"}], "2"]}
          }], ")"}], 
        FractionBox[
         RowBox[{"S", "[", 
          RowBox[{
           SubsuperscriptBox["x", 
            RowBox[{"t", ";", "s"}], 
            RowBox[{"1", ";", "p"}]], "-", 
           SuperscriptBox["x", 
            RowBox[{"1", ";", "i"}]]}], "]"}], 
         SubsuperscriptBox["N", 
          RowBox[{"c", ";", "s"}], "0"]]}]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"8b4abd05-da6f-4d16-a704-7baaf831a59b"],
 ".\nThermal speed squared:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["\[CapitalDelta]v", 
          RowBox[{"x", ",", 
           RowBox[{"s", ";", "i"}]}], "2"]},
        {
         SubsuperscriptBox["\[CapitalDelta]v", 
          RowBox[{"y", ",", 
           RowBox[{"s", ";", "i"}]}], "2"]},
        {
         SubsuperscriptBox["\[CapitalDelta]v", 
          RowBox[{"z", ",", 
           RowBox[{"s", ";", "i"}]}], "2"]}
       }], ")"}], "\[RightAngleBracket]"}], "=", 
    RowBox[{
     FractionBox[
      SubscriptBox["n", 
       RowBox[{"0", ";", "s"}]], 
      SubsuperscriptBox["n", 
       RowBox[{"t", ";", "s"}], "i"]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Sum]", "p"], 
        RowBox[{
         RowBox[{"(", GridBox[{
            {
             SubsuperscriptBox["v", 
              RowBox[{"x", ";", "p"}], "2"]},
            {
             SubsuperscriptBox["v", 
              RowBox[{"y", ";", "p"}], "2"]},
            {
             SubsuperscriptBox["v", 
              RowBox[{"z", ";", "p"}], "2"]}
           }], ")"}], 
         FractionBox[
          RowBox[{"S", "[", 
           RowBox[{
            SubsuperscriptBox["x", 
             RowBox[{"t", ";", "s"}], 
             RowBox[{"1", ";", "p"}]], "-", 
            SuperscriptBox["x", 
             RowBox[{"1", ";", "i"}]]}], "]"}], 
          SubsuperscriptBox["N", 
           RowBox[{"c", ";", "s"}], "0"]]}]}], "-", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", GridBox[{
            {
             SubsuperscriptBox["V", 
              RowBox[{"x", ";", "i"}], 
              RowBox[{"t", ";", "s"}]]},
            {
             SubsuperscriptBox["V", 
              RowBox[{"y", ";", "i"}], 
              RowBox[{"t", ";", "s"}]]},
            {
             SubsuperscriptBox["V", 
              RowBox[{"z", ";", "i"}], 
              RowBox[{"t", ";", "s"}]]}
           }], ")"}], "2"], "/", 
        FractionBox[
         SubsuperscriptBox["n", 
          RowBox[{"t", ";", "s"}], "i"], 
         SubscriptBox["n", 
          RowBox[{"0", ";", "s"}]]]}]}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"385a22d6-da6a-4e07-b0fb-446e3a3f4e58"],
 "."
}], "Text",ExpressionUUID->"c269a811-6c20-4ec2-9138-4d3b98812bc8"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Nc", "=", "1000"}], ",", 
     RowBox[{"Nx", "=", "2"}], ",", 
     RowBox[{"n0", "=", "1."}], ",", 
     RowBox[{"\[Theta]", "=", "1."}], ",", 
     RowBox[{"S", "=", 
      RowBox[{"Function", "[", 
       RowBox[{"x", 
        RowBox[{"(*", 
         RowBox[{"0", "\[LessEqual]", "x", "\[LessEqual]", "1"}], "*)"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "-", "x"}], ",", "x"}], "}"}], "//", "N"}]}], 
       "]"}]}]}], "}"}], ",", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "rng", ",", "x", ",", "v", ",", "vx", ",", "vy", ",", "vz", ",", 
       "\[Psi]"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rng", ":=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", 
         RowBox[{"Nc", "*", "Nx"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"x", "=", "rng"}], ";", "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{
        RowBox[{"icdf", "[", "rng", "]"}], "\[Theta]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vx", "=", 
       RowBox[{"v", " ", 
        RowBox[{"(", 
         RowBox[{"\[Psi]", "=", 
          RowBox[{"1", "-", 
           RowBox[{"2", "rng"}]}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"v", " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[Psi]", "2"]}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vy", "=", 
       RowBox[{"v", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Psi]", "=", 
          RowBox[{"2", "\[Pi]", " ", "rng"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vz", "=", 
       RowBox[{"v", " ", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{"Flatten", "[", 
           SuperscriptBox[
            RowBox[{"{", 
             RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}], "2"], "]"}], "]"}], 
         "/", "2"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Total", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["vx", "2"], "+", 
                 SuperscriptBox["vy", "2"], "+", 
                 SuperscriptBox["vz", "2"]}], ")"}], 
               RowBox[{"#", "/", "2"}]}], "]"}], "/", "Nc"}], "&"}], "/@", 
           RowBox[{"S", "[", "x", "]"}]}], "]"}], "*", "Nc"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "]"}]], "Input",ExpressionUUID->"4796ec80-\
888a-4512-954f-8a6f09a2344e"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "2D in ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["x", "1"], "-", 
    SuperscriptBox["x", "2"]}], TraditionalForm]],ExpressionUUID->
  "d6fd6755-9259-43c4-b954-ff28a3215a1a"],
 " plane"
}], "Subsection",ExpressionUUID->"b7812201-bd18-4907-b203-b99955572430"],

Cell[CellGroupData[{

Cell["Grid: Staggered", "Subsubsection",ExpressionUUID->"6462dce5-1685-4dac-898e-7544962e9b38"],

Cell[TextData[{
 "Cell center quantities: ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["\[CapitalXi]", "\[RightVector]"], TraditionalForm]],
  ExpressionUUID->"5e4b2e71-1935-4c40-aa34-457eb88199b9"],
 ", ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["\[ScriptCapitalJ]", "\[RightVector]"], TraditionalForm]],
  ExpressionUUID->"39502c33-d5ea-4db6-afdb-6b2988aad52f"],
 ", all discrete particle moments, and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[DoubleStruckCapitalV]", "f"], TraditionalForm]],
  ExpressionUUID->"e501e6eb-c5ba-4e14-a4ee-7ba41b946b2f"],
 ".\nCell corner quantities: ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["\[CapitalOmega]", "\[RightVector]"], TraditionalForm]],
  ExpressionUUID->"b4b71755-a6e5-4eec-8d01-187d3998a76c"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Delta]n", "f"], TraditionalForm]],ExpressionUUID->
  "f4f94c15-346b-4e79-b1eb-b26c4aaa2f82"],
 "."
}], "Text",ExpressionUUID->"9be42b0f-8b28-4f92-81b7-03a7b5345aa5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Xi]", "=", ".0"}], ",", 
     RowBox[{"\[CapitalDelta]1", "=", "1"}], ",", 
     RowBox[{"\[CapitalDelta]2", "=", "1"}], ",", 
     RowBox[{"q1max", "=", "4"}], ",", 
     RowBox[{"q2max", "=", "3"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1max"}], 
       "\[GreaterEqual]", 
       RowBox[{"\[Pi]", "/", "2"}]}], ",", 
      RowBox[{"Abort", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[CapitalDelta]1q1", ",", "\[CapitalDelta]2q2", ",", "xyF", ",", 
        "xyH"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalDelta]1q1", "=", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"-", "q1max"}], ",", "q1max"}], "]"}], 
         "\[CapitalDelta]1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[CapitalDelta]2q2", "=", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"-", "q2max"}], ",", "q2max"}], "]"}], 
         "\[CapitalDelta]2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xyF", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Chop", "[", "\[Xi]", "]"}], "\[Equal]", "0"}], ",", 
               "#", ",", 
               RowBox[{
                RowBox[{"Tan", "[", 
                 RowBox[{"\[Xi]", "#"}], "]"}], "/", "\[Xi]"}]}], "]"}], ",", 
             
             RowBox[{"\[CapitalDelta]2q2", " ", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Xi]", "#"}], "]"}], "^", "2"}]}]}], "}"}], "]"}], 
          "&"}], "/@", "\[CapitalDelta]1q1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xyH", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Chop", "[", "\[Xi]", "]"}], "\[Equal]", "0"}], ",", 
               "#", ",", 
               RowBox[{
                RowBox[{"Tan", "[", 
                 RowBox[{"\[Xi]", "#"}], "]"}], "/", "\[Xi]"}]}], "]"}], ",", 
             
             RowBox[{
              RowBox[{"Plus", "[", 
               RowBox[{"\[CapitalDelta]2q2", ",", 
                RowBox[{"+", ".5"}]}], "]"}], 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Xi]", "#"}], "]"}], "^", "2"}]}]}], "}"}], "]"}], 
          "&"}], "/@", 
         RowBox[{"Plus", "[", 
          RowBox[{"\[CapitalDelta]1q1", ",", 
           RowBox[{"+", ".5"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Legended", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Graphics", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"LightBlue", ",", 
                RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
                RowBox[{"Line", "/@", "xyF"}], ",", 
                RowBox[{"Line", "/@", 
                 RowBox[{"Thread", "[", "xyF", "]"}]}]}], "}"}], ","}], 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"LightRed", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
               RowBox[{"Line", "/@", "xyH"}], ",", 
               RowBox[{"Line", "/@", 
                RowBox[{"Thread", "[", "xyH", "]"}]}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Red", ",", 
               RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
               RowBox[{"Point", "/@", 
                RowBox[{"xyH", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}], ",", 
                   RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}]}], "]"}], "]"}]}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"LightRed", ",", 
               RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"First", "[", "xyH", "]"}], "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"First", "/@", "xyH"}], "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"Last", "[", "xyH", "]"}], "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"Last", "/@", "xyH"}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Blue", ",", 
               RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
               RowBox[{"Point", "/@", 
                RowBox[{"xyF", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}], ",", 
                   RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}]}], "]"}], "]"}]}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"LightBlue", ",", 
               RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"First", "[", "xyF", "]"}], "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"First", "/@", "xyF"}], "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"Last", "[", "xyF", "]"}], "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"Last", "/@", "xyF"}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Gray", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
               RowBox[{"Line", "[", 
                RowBox[{
                 RowBox[{"First", "[", "xyH", "]"}], "//", "Most"}], "]"}], 
               ",", 
               RowBox[{"Line", "[", 
                RowBox[{
                 RowBox[{"First", "/@", "xyH"}], "//", "Most"}], "]"}], ",", 
               RowBox[{"Line", "[", 
                RowBox[{
                 RowBox[{"Part", "[", 
                  RowBox[{"xyH", ",", 
                   RowBox[{"-", "2"}]}], "]"}], "//", "Most"}], "]"}], ",", 
               RowBox[{"Line", "[", 
                RowBox[{
                 RowBox[{"Part", "[", 
                  RowBox[{"xyH", ",", "All", ",", 
                   RowBox[{"-", "2"}]}], "]"}], "//", "Most"}], "]"}]}], 
              "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Darker", "@", "Blue"}], ",", 
               RowBox[{"MapIndexed", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#2", "]"}], "-", "1"}], ",", "#", 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}], "&"}], ",", 
                 RowBox[{"xyF", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}], ",", 
                    RowBox[{"q2max", "+", "1"}]}], "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"MapIndexed", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#2", "]"}], "-", "1"}], ",", "#", 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], "&"}], 
                 ",", 
                 RowBox[{"xyF", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"q1max", "+", "1"}], ",", 
                    RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}]}], "]"}], "]"}]}], "]"}]}], "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Darker", "@", "Red"}], ",", 
               RowBox[{"MapIndexed", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#2", "]"}], "-", "1"}], ",", "#", 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}], "&"}], ",", 
                 RowBox[{"xyH", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}], ",", "q2max"}], "]"}], "]"}]}], 
                "]"}], ",", 
               RowBox[{"MapIndexed", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#2", "]"}], "-", "1"}], ",", "#", 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], "&"}], 
                 ",", 
                 RowBox[{"xyH", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"q1max", "+", "1"}], ",", 
                    RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}]}], "]"}], "]"}]}], "]"}]}], "}"}]}], 
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"AspectRatio", "\[Rule]", 
            RowBox[{
             RowBox[{"xyF", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", 
                RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}], "/", 
             RowBox[{"xyF", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1", ",", "1"}], "]"}], "]"}]}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"Axes", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Ticks", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
           
           RowBox[{"BaseStyle", "\[Rule]", "11"}], ",", "\[IndentingNewLine]", 
           RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "\[IndentingNewLine]",
           "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Placed", "[", 
          RowBox[{
           RowBox[{"PointLegend", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "LightRed", ",", "Gray", ",", "Red", ",", "Blue", ",", "Gray"}],
               "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Cell Boundary\>\"", ",", "\"\<Particle Boundary\>\"", ",", 
               "\"\<Cell Corner\>\"", ",", "\"\<Cell Center\>\"", ",", 
               "\"\<Ghost Cells\>\""}], "}"}], ",", 
             RowBox[{"Joined", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
               "True", ",", "True", ",", "False", ",", "False", ",", 
                "False"}], "}"}]}], ",", 
             RowBox[{"LegendLayout", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{
                  RowBox[{"Join", "@@", "#"}], ",", 
                  RowBox[{"Spacer", "[", "2", "]"}]}], "]"}], "&"}], 
               ")"}]}]}], "]"}], ",", "Above"}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 Editable->False,
 CellOpen->False,ExpressionUUID->"16af3c49-03b9-46dc-9830-277ad7f17903"],

Cell[BoxData[
 TemplateBox[{
   GraphicsBox[{{
      RGBColor[1, 0.85, 0.85], 
      Thickness[Medium], {
       LineBox[{{-3.5, -2.5}, {-3.5, -1.5}, {-3.5, -0.5}, {-3.5, 0.5}, {-3.5, 
        1.5}, {-3.5, 2.5}, {-3.5, 3.5}}], 
       LineBox[{{-2.5, -2.5}, {-2.5, -1.5}, {-2.5, -0.5}, {-2.5, 0.5}, {-2.5, 
        1.5}, {-2.5, 2.5}, {-2.5, 3.5}}], 
       LineBox[{{-1.5, -2.5}, {-1.5, -1.5}, {-1.5, -0.5}, {-1.5, 0.5}, {-1.5, 
        1.5}, {-1.5, 2.5}, {-1.5, 3.5}}], 
       LineBox[{{-0.5, -2.5}, {-0.5, -1.5}, {-0.5, -0.5}, {-0.5, 0.5}, {-0.5, 
        1.5}, {-0.5, 2.5}, {-0.5, 3.5}}], 
       LineBox[{{0.5, -2.5}, {0.5, -1.5}, {0.5, -0.5}, {0.5, 0.5}, {0.5, 
        1.5}, {0.5, 2.5}, {0.5, 3.5}}], 
       LineBox[{{1.5, -2.5}, {1.5, -1.5}, {1.5, -0.5}, {1.5, 0.5}, {1.5, 
        1.5}, {1.5, 2.5}, {1.5, 3.5}}], 
       LineBox[{{2.5, -2.5}, {2.5, -1.5}, {2.5, -0.5}, {2.5, 0.5}, {2.5, 
        1.5}, {2.5, 2.5}, {2.5, 3.5}}], 
       LineBox[{{3.5, -2.5}, {3.5, -1.5}, {3.5, -0.5}, {3.5, 0.5}, {3.5, 
        1.5}, {3.5, 2.5}, {3.5, 3.5}}], 
       LineBox[{{4.5, -2.5}, {4.5, -1.5}, {4.5, -0.5}, {4.5, 0.5}, {4.5, 
        1.5}, {4.5, 2.5}, {4.5, 3.5}}]}, {
       LineBox[{{-3.5, -2.5}, {-2.5, -2.5}, {-1.5, -2.5}, {-0.5, -2.5}, {
        0.5, -2.5}, {1.5, -2.5}, {2.5, -2.5}, {3.5, -2.5}, {4.5, -2.5}}], 
       LineBox[{{-3.5, -1.5}, {-2.5, -1.5}, {-1.5, -1.5}, {-0.5, -1.5}, {
        0.5, -1.5}, {1.5, -1.5}, {2.5, -1.5}, {3.5, -1.5}, {4.5, -1.5}}], 
       LineBox[{{-3.5, -0.5}, {-2.5, -0.5}, {-1.5, -0.5}, {-0.5, -0.5}, {
        0.5, -0.5}, {1.5, -0.5}, {2.5, -0.5}, {3.5, -0.5}, {4.5, -0.5}}], 
       LineBox[{{-3.5, 0.5}, {-2.5, 0.5}, {-1.5, 0.5}, {-0.5, 0.5}, {0.5, 
        0.5}, {1.5, 0.5}, {2.5, 0.5}, {3.5, 0.5}, {4.5, 0.5}}], 
       LineBox[{{-3.5, 1.5}, {-2.5, 1.5}, {-1.5, 1.5}, {-0.5, 1.5}, {0.5, 
        1.5}, {1.5, 1.5}, {2.5, 1.5}, {3.5, 1.5}, {4.5, 1.5}}], 
       LineBox[{{-3.5, 2.5}, {-2.5, 2.5}, {-1.5, 2.5}, {-0.5, 2.5}, {0.5, 
        2.5}, {1.5, 2.5}, {2.5, 2.5}, {3.5, 2.5}, {4.5, 2.5}}], 
       LineBox[{{-3.5, 3.5}, {-2.5, 3.5}, {-1.5, 3.5}, {-0.5, 3.5}, {0.5, 
        3.5}, {1.5, 3.5}, {2.5, 3.5}, {3.5, 3.5}, {4.5, 3.5}}]}}, {
      RGBColor[1, 0, 0], 
      PointSize[Medium], {
       PointBox[{{-2.5, -1.5}, {-2.5, -0.5}, {-2.5, 0.5}, {-2.5, 1.5}, {-2.5, 
        2.5}}], 
       PointBox[{{-1.5, -1.5}, {-1.5, -0.5}, {-1.5, 0.5}, {-1.5, 1.5}, {-1.5, 
        2.5}}], 
       PointBox[{{-0.5, -1.5}, {-0.5, -0.5}, {-0.5, 0.5}, {-0.5, 1.5}, {-0.5, 
        2.5}}], 
       PointBox[{{0.5, -1.5}, {0.5, -0.5}, {0.5, 0.5}, {0.5, 1.5}, {0.5, 
        2.5}}], 
       PointBox[{{1.5, -1.5}, {1.5, -0.5}, {1.5, 0.5}, {1.5, 1.5}, {1.5, 
        2.5}}], 
       PointBox[{{2.5, -1.5}, {2.5, -0.5}, {2.5, 0.5}, {2.5, 1.5}, {2.5, 
        2.5}}], 
       PointBox[{{3.5, -1.5}, {3.5, -0.5}, {3.5, 0.5}, {3.5, 1.5}, {3.5, 
        2.5}}]}}, {
      RGBColor[1, 0.85, 0.85], 
      PointSize[Medium], 
      PointBox[{{-3.5, -2.5}, {-3.5, -1.5}, {-3.5, -0.5}, {-3.5, 0.5}, {-3.5, 
       1.5}, {-3.5, 2.5}, {-3.5, 3.5}}], 
      PointBox[{{-3.5, -2.5}, {-2.5, -2.5}, {-1.5, -2.5}, {-0.5, -2.5}, {
       0.5, -2.5}, {1.5, -2.5}, {2.5, -2.5}, {3.5, -2.5}, {4.5, -2.5}}], 
      PointBox[{{4.5, -2.5}, {4.5, -1.5}, {4.5, -0.5}, {4.5, 0.5}, {4.5, 
       1.5}, {4.5, 2.5}, {4.5, 3.5}}], 
      PointBox[{{-3.5, 3.5}, {-2.5, 3.5}, {-1.5, 3.5}, {-0.5, 3.5}, {0.5, 
       3.5}, {1.5, 3.5}, {2.5, 3.5}, {3.5, 3.5}, {4.5, 3.5}}]}, {
      RGBColor[0, 0, 1], 
      PointSize[Medium], {
       PointBox[{{-3, -2.}, {-3, -1.}, {-3, 0.}, {-3, 1.}, {-3, 2.}}], 
       PointBox[{{-2, -2.}, {-2, -1.}, {-2, 0.}, {-2, 1.}, {-2, 2.}}], 
       PointBox[{{-1, -2.}, {-1, -1.}, {-1, 0.}, {-1, 1.}, {-1, 2.}}], 
       PointBox[{{0, -2.}, {0, -1.}, {0, 0.}, {0, 1.}, {0, 2.}}], 
       PointBox[{{1, -2.}, {1, -1.}, {1, 0.}, {1, 1.}, {1, 2.}}], 
       PointBox[{{2, -2.}, {2, -1.}, {2, 0.}, {2, 1.}, {2, 2.}}], 
       PointBox[{{3, -2.}, {3, -1.}, {3, 0.}, {3, 1.}, {3, 2.}}]}}, {
      RGBColor[0.87, 0.94, 1], 
      PointSize[Medium], 
      PointBox[{{-4, -3.}, {-4, -2.}, {-4, -1.}, {-4, 0.}, {-4, 1.}, {-4, 
         2.}, {-4, 3.}}], 
      PointBox[{{-4, -3.}, {-3, -3.}, {-2, -3.}, {-1, -3.}, {0, -3.}, {
        1, -3.}, {2, -3.}, {3, -3.}, {4, -3.}}], 
      PointBox[{{4, -3.}, {4, -2.}, {4, -1.}, {4, 0.}, {4, 1.}, {4, 2.}, {
        4, 3.}}], 
      PointBox[{{-4, 3.}, {-3, 3.}, {-2, 3.}, {-1, 3.}, {0, 3.}, {1, 3.}, {
        2, 3.}, {3, 3.}, {4, 3.}}]}, {
      GrayLevel[0.5], 
      Thickness[Medium], 
      LineBox[{{-3.5, -2.5}, {-3.5, -1.5}, {-3.5, -0.5}, {-3.5, 0.5}, {-3.5, 
       1.5}, {-3.5, 2.5}}], 
      LineBox[{{-3.5, -2.5}, {-2.5, -2.5}, {-1.5, -2.5}, {-0.5, -2.5}, {
       0.5, -2.5}, {1.5, -2.5}, {2.5, -2.5}, {3.5, -2.5}}], 
      LineBox[{{3.5, -2.5}, {3.5, -1.5}, {3.5, -0.5}, {3.5, 0.5}, {3.5, 
       1.5}, {3.5, 2.5}}], 
      LineBox[{{-3.5, 2.5}, {-2.5, 2.5}, {-1.5, 2.5}, {-0.5, 2.5}, {0.5, 
       2.5}, {1.5, 2.5}, {2.5, 2.5}, {3.5, 2.5}}]}, {
      RGBColor[0, 0, 
       NCache[
        Rational[2, 3], 0.6666666666666666]], {
       InsetBox[
        FormBox["0", TraditionalForm], {-3, 0.}, {-1, -1}], 
       InsetBox[
        FormBox["1", TraditionalForm], {-2, 0.}, {-1, -1}], 
       InsetBox[
        FormBox["2", TraditionalForm], {-1, 0.}, {-1, -1}], 
       InsetBox[
        FormBox["3", TraditionalForm], {0, 0.}, {-1, -1}], 
       InsetBox[
        FormBox["4", TraditionalForm], {1, 0.}, {-1, -1}], 
       InsetBox[
        FormBox["5", TraditionalForm], {2, 0.}, {-1, -1}], 
       InsetBox[
        FormBox["6", TraditionalForm], {3, 0.}, {-1, -1}]}, {
       InsetBox[
        FormBox["0", TraditionalForm], {0, -2.}, {-1, 1}], 
       InsetBox[
        FormBox["1", TraditionalForm], {0, -1.}, {-1, 1}], 
       InsetBox[
        FormBox["2", TraditionalForm], {0, 0.}, {-1, 1}], 
       InsetBox[
        FormBox["3", TraditionalForm], {0, 1.}, {-1, 1}], 
       InsetBox[
        FormBox["4", TraditionalForm], {0, 2.}, {-1, 1}]}}, {
      RGBColor[
       NCache[
        Rational[2, 3], 0.6666666666666666], 0, 0], {
       InsetBox[
        FormBox["0", TraditionalForm], {-2.5, -0.5}, {1, -1}], 
       InsetBox[
        FormBox["1", TraditionalForm], {-1.5, -0.5}, {1, -1}], 
       InsetBox[
        FormBox["2", TraditionalForm], {-0.5, -0.5}, {1, -1}], 
       InsetBox[
        FormBox["3", TraditionalForm], {0.5, -0.5}, {1, -1}], 
       InsetBox[
        FormBox["4", TraditionalForm], {1.5, -0.5}, {1, -1}], 
       InsetBox[
        FormBox["5", TraditionalForm], {2.5, -0.5}, {1, -1}], 
       InsetBox[
        FormBox["6", TraditionalForm], {3.5, -0.5}, {1, -1}]}, {
       InsetBox[
        FormBox["0", TraditionalForm], {0.5, -1.5}, {-1, 1}], 
       InsetBox[
        FormBox["1", TraditionalForm], {0.5, -0.5}, {-1, 1}], 
       InsetBox[
        FormBox["2", TraditionalForm], {0.5, 0.5}, {-1, 1}], 
       InsetBox[
        FormBox["3", TraditionalForm], {0.5, 1.5}, {-1, 1}], 
       InsetBox[
        FormBox["4", TraditionalForm], {0.5, 2.5}, {-1, 1}]}}}, AspectRatio -> 
    0.75, Axes -> True, Ticks -> False, BaseStyle -> 11, ImageSize -> Large], 
   
   FormBox[
    FormBox[
     TemplateBox[{
      "\"Cell Boundary\"", "\"Particle Boundary\"", "\"Cell Corner\"", 
       "\"Cell Center\"", "\"Ghost Cells\""}, "PointLegend", 
      DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TemplateBox[{
             InterpretationBox[
              StyleBox[
               
               GraphicsBox[{}, ImageSize -> {2, 0}, BaselinePosition -> 
                Baseline], "CacheGraphics" -> False], 
              Spacer[2]], 
             GraphicsBox[{{
                Directive[
                 EdgeForm[
                  Directive[
                   Opacity[0.3], 
                   GrayLevel[0]]], 
                 PointSize[0.5], 
                 AbsoluteThickness[1.6], 
                 RGBColor[1, 0.85, 0.85]], {
                 LineBox[{{0, 10}, {20, 10}}]}}, {
                Directive[
                 EdgeForm[
                  Directive[
                   Opacity[0.3], 
                   GrayLevel[0]]], 
                 PointSize[0.5], 
                 AbsoluteThickness[1.6], 
                 RGBColor[1, 0.85, 0.85]], {}}}, AspectRatio -> Full, 
              ImageSize -> {20, 10}, PlotRangePadding -> None, ImagePadding -> 
              Automatic, BaselinePosition -> (Scaled[0.1] -> Baseline)], #, 
             GraphicsBox[{{
                Directive[
                 EdgeForm[
                  Directive[
                   Opacity[0.3], 
                   GrayLevel[0]]], 
                 PointSize[0.5], 
                 AbsoluteThickness[1.6], 
                 GrayLevel[0.5]], {
                 LineBox[{{0, 10}, {20, 10}}]}}, {
                Directive[
                 EdgeForm[
                  Directive[
                   Opacity[0.3], 
                   GrayLevel[0]]], 
                 PointSize[0.5], 
                 AbsoluteThickness[1.6], 
                 GrayLevel[0.5]], {}}}, AspectRatio -> Full, 
              ImageSize -> {20, 10}, PlotRangePadding -> None, ImagePadding -> 
              Automatic, BaselinePosition -> (Scaled[0.1] -> Baseline)], #2, 
             GraphicsBox[{{}, {
                Directive[
                 EdgeForm[
                  Directive[
                   Opacity[0.3], 
                   GrayLevel[0]]], 
                 PointSize[0.5], 
                 AbsoluteThickness[1.6], 
                 RGBColor[1, 0, 0]], {
                 Directive[
                  EdgeForm[
                   Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                  PointSize[0.5], 
                  AbsoluteThickness[1.6], 
                  RGBColor[1, 0, 0]], 
                 PointBox[
                  NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
              ImageSize -> {10, 10}, PlotRangePadding -> None, ImagePadding -> 
              Automatic, BaselinePosition -> (Scaled[0.1] -> Baseline)], #3, 
             GraphicsBox[{{}, {
                Directive[
                 EdgeForm[
                  Directive[
                   Opacity[0.3], 
                   GrayLevel[0]]], 
                 PointSize[0.5], 
                 AbsoluteThickness[1.6], 
                 RGBColor[0, 0, 1]], {
                 Directive[
                  EdgeForm[
                   Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                  PointSize[0.5], 
                  AbsoluteThickness[1.6], 
                  RGBColor[0, 0, 1]], 
                 PointBox[
                  NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
              ImageSize -> {10, 10}, PlotRangePadding -> None, ImagePadding -> 
              Automatic, BaselinePosition -> (Scaled[0.1] -> Baseline)], #4, 
             GraphicsBox[{{}, {
                Directive[
                 EdgeForm[
                  Directive[
                   Opacity[0.3], 
                   GrayLevel[0]]], 
                 PointSize[0.5], 
                 AbsoluteThickness[1.6], 
                 GrayLevel[0.5]], {
                 Directive[
                  EdgeForm[
                   Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                  PointSize[0.5], 
                  AbsoluteThickness[1.6], 
                  GrayLevel[0.5]], 
                 PointBox[
                  NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
              ImageSize -> {10, 10}, PlotRangePadding -> None, ImagePadding -> 
              Automatic, BaselinePosition -> (Scaled[0.1] -> Baseline)], #5}, 
            "RowWithSeparator"], Alignment -> Left, AppearanceElements -> 
           None, ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"PointLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               InterpretationBox[
                ButtonBox[
                 TooltipBox[
                  GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[1, 0.85, 0.85], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                   True, FrameStyle -> 
                   RGBColor[
                    0.6666666666666666, 0.5666666666666667, 
                    0.5666666666666667], FrameTicks -> None, PlotRangePadding -> 
                   None, ImageSize -> 
                   Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], "RGBColor[1, 0.85, 0.85]"], 
                 Appearance -> None, BaseStyle -> {}, BaselinePosition -> 
                 Baseline, DefaultBaseStyle -> {}, ButtonFunction :> 
                 With[{Typeset`box$ = EvaluationBox[]}, 
                   If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[1, 0.85, 0.85]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                 Automatic, Method -> "Preemptive"], 
                RGBColor[1, 0.85, 0.85], Editable -> False, Selectable -> 
                False], ",", 
               InterpretationBox[
                ButtonBox[
                 TooltipBox[
                  GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    GrayLevel[0.5], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                   True, FrameStyle -> GrayLevel[0.33333333333333337`], 
                   FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                   Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], "GrayLevel[0.5]"], Appearance -> None,
                  BaseStyle -> {}, BaselinePosition -> Baseline, 
                 DefaultBaseStyle -> {}, ButtonFunction :> 
                 With[{Typeset`box$ = EvaluationBox[]}, 
                   If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    GrayLevel[0.5]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["GrayLevelColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                 Automatic, Method -> "Preemptive"], 
                GrayLevel[0.5], Editable -> False, Selectable -> False], ",", 
               
               InterpretationBox[
                ButtonBox[
                 TooltipBox[
                  GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[1, 0, 0], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                   True, FrameStyle -> RGBColor[0.6666666666666666, 0., 0.], 
                   FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                   Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], "RGBColor[1, 0, 0]"], Appearance -> 
                 None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                 DefaultBaseStyle -> {}, ButtonFunction :> 
                 With[{Typeset`box$ = EvaluationBox[]}, 
                   If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[1, 0, 0]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                 Automatic, Method -> "Preemptive"], 
                RGBColor[1, 0, 0], Editable -> False, Selectable -> False], 
               ",", 
               InterpretationBox[
                ButtonBox[
                 TooltipBox[
                  GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0, 0, 1], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                   True, FrameStyle -> RGBColor[0., 0., 0.6666666666666666], 
                   FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                   Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], "RGBColor[0, 0, 1]"], Appearance -> 
                 None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                 DefaultBaseStyle -> {}, ButtonFunction :> 
                 With[{Typeset`box$ = EvaluationBox[]}, 
                   If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0, 0, 1]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                 Automatic, Method -> "Preemptive"], 
                RGBColor[0, 0, 1], Editable -> False, Selectable -> False], 
               ",", 
               InterpretationBox[
                ButtonBox[
                 TooltipBox[
                  GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    GrayLevel[0.5], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                   True, FrameStyle -> GrayLevel[0.33333333333333337`], 
                   FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                   Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], "GrayLevel[0.5]"], Appearance -> None,
                  BaseStyle -> {}, BaselinePosition -> Baseline, 
                 DefaultBaseStyle -> {}, ButtonFunction :> 
                 With[{Typeset`box$ = EvaluationBox[]}, 
                   If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    GrayLevel[0.5]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["GrayLevelColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                 Automatic, Method -> "Preemptive"], 
                GrayLevel[0.5], Editable -> False, Selectable -> False]}], 
             "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2, ",", #3, ",", #4, ",", #5}], "}"}], ",", 
           RowBox[{"Joined", "\[Rule]", 
             RowBox[{"{", 
               
               RowBox[{
                "True", ",", "True", ",", "False", ",", "False", ",", 
                 "False"}], "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", 
             RowBox[{"(", 
               RowBox[{
                 RowBox[{"Row", "[", 
                   RowBox[{
                    RowBox[{"Join", "@@", "#1"}], ",", 
                    InterpretationBox[
                    StyleBox[
                    
                    GraphicsBox[{}, ImageSize -> {2, 0}, BaselinePosition -> 
                    Baseline], "CacheGraphics" -> False], 
                    Spacer[2]]}], "]"}], "&"}], ")"}]}]}], "]"}]& ), Editable -> 
      True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}, {
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {2, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "Above"}], "]"}]}], "]"}]& )]], "Output",ExpressionU\
UID->"19081a74-64e8-4920-a0f1-4d886a95947b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Grid: Collocated", "Subsubsection",ExpressionUUID->"3acc5477-ed49-453e-a1fa-6be59f5eb892"],

Cell["Grid points are located in cell centers.", "Text",ExpressionUUID->"8cf8ce31-049d-4179-ba45-2291d3ae4c3c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Xi]", "=", ".0"}], ",", 
     RowBox[{"\[CapitalDelta]1", "=", "1"}], ",", 
     RowBox[{"\[CapitalDelta]2", "=", "1"}], ",", 
     RowBox[{"q1max", "=", 
      RowBox[{"4", "+", "2"}]}], ",", 
     RowBox[{"q2max", "=", 
      RowBox[{"3", "+", "2"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1max"}], 
       "\[GreaterEqual]", 
       RowBox[{"\[Pi]", "/", "2"}]}], ",", 
      RowBox[{"Abort", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[CapitalDelta]1q1", ",", "\[CapitalDelta]2q2", ",", "xyF", ",", 
        "xyH"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalDelta]1q1", "=", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"-", "q1max"}], ",", "q1max"}], "]"}], 
         "\[CapitalDelta]1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[CapitalDelta]2q2", "=", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"-", "q2max"}], ",", "q2max"}], "]"}], 
         "\[CapitalDelta]2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xyF", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Chop", "[", "\[Xi]", "]"}], "\[Equal]", "0"}], ",", 
               "#", ",", 
               RowBox[{
                RowBox[{"Tan", "[", 
                 RowBox[{"\[Xi]", "#"}], "]"}], "/", "\[Xi]"}]}], "]"}], ",", 
             
             RowBox[{"\[CapitalDelta]2q2", " ", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Xi]", "#"}], "]"}], "^", "2"}]}]}], "}"}], "]"}], 
          "&"}], "/@", "\[CapitalDelta]1q1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xyH", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Chop", "[", "\[Xi]", "]"}], "\[Equal]", "0"}], ",", 
               "#", ",", 
               RowBox[{
                RowBox[{"Tan", "[", 
                 RowBox[{"\[Xi]", "#"}], "]"}], "/", "\[Xi]"}]}], "]"}], ",", 
             
             RowBox[{
              RowBox[{"MovingAverage", "[", 
               RowBox[{"\[CapitalDelta]2q2", ",", "2"}], "]"}], 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Xi]", "#"}], "]"}], "^", "2"}]}]}], "}"}], "]"}], 
          "&"}], "/@", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"\[CapitalDelta]1q1", ",", "2"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Legended", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Graphics", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"LightBlue", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
               RowBox[{"Line", "/@", 
                RowBox[{"xyH", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}], ",", 
                   RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}]}], "]"}], "]"}]}], ",", 
               RowBox[{"Line", "/@", 
                RowBox[{"Thread", "[", 
                 RowBox[{"xyH", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}], ",", 
                    RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}]}], "]"}], "]"}], "]"}]}]}], "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Black", ",", 
               RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
               RowBox[{"Point", "/@", 
                RowBox[{"xyF", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"3", ";;", 
                    RowBox[{"-", "3"}]}], ",", 
                   RowBox[{"3", ";;", 
                    RowBox[{"-", "3"}]}]}], "]"}], "]"}]}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Gray", ",", 
               RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
               RowBox[{"Point", "/@", 
                RowBox[{"xyF", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ";;", "2"}], "]"}], "]"}]}], ",", 
               RowBox[{"Point", "/@", 
                RowBox[{"xyF", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", 
                   RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], ",", 
               RowBox[{"Point", "/@", 
                RowBox[{"xyF", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"-", "2"}], ";;", 
                   RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
               RowBox[{"Point", "/@", 
                RowBox[{"xyF", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", 
                   RowBox[{
                    RowBox[{"-", "2"}], ";;", 
                    RowBox[{"-", "1"}]}]}], "]"}], "]"}]}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Blue", ",", 
               RowBox[{"MapIndexed", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#2", "]"}], "-", "1"}], ",", "#", 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}], "&"}], ",", 
                 RowBox[{"xyF", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"3", ";;", 
                    RowBox[{"-", "3"}]}], ",", 
                    RowBox[{"q2max", "+", "1"}]}], "]"}], "]"}]}], "]"}]}], 
              "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Red", ",", 
               RowBox[{"MapIndexed", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#2", "]"}], "-", "1"}], ",", "#", 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}]}], "]"}], "&"}], ",", 
                 RowBox[{"xyF", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"q1max", "+", "1"}], ",", 
                    RowBox[{"3", ";;", 
                    RowBox[{"-", "3"}]}]}], "]"}], "]"}]}], "]"}]}], "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Black", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
               RowBox[{"Line", "[", 
                RowBox[{"xyH", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}], ",", "2"}], "]"}], "]"}], "]"}], 
               ",", 
               RowBox[{"Line", "[", 
                RowBox[{"xyH", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"-", "2"}], ",", 
                   RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}]}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"Line", "[", 
                RowBox[{"xyH", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}], ",", 
                   RowBox[{"-", "2"}]}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"Line", "[", 
                RowBox[{"xyH", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", 
                   RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}]}], "]"}], "]"}], "]"}]}], "}"}]}], 
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"AspectRatio", "\[Rule]", 
            RowBox[{
             RowBox[{"xyF", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", 
                RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}], "/", 
             RowBox[{"xyF", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1", ",", "1"}], "]"}], "]"}]}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"Axes", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Ticks", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
           
           RowBox[{"BaseStyle", "\[Rule]", "11"}], ",", "\[IndentingNewLine]", 
           RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "\[IndentingNewLine]",
           "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Placed", "[", 
          RowBox[{
           RowBox[{"PointLegend", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Black", ",", "Black", ",", "Gray"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Particle Boundary\>\"", ",", "\"\<Cell Center\>\"", ",", 
               "\"\<Ghost Cells\>\""}], "}"}], ",", 
             RowBox[{"Joined", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"True", ",", "False", ",", "False"}], "}"}]}], ",", 
             RowBox[{"LegendLayout", "\[Rule]", "\"\<Row\>\""}]}], "]"}], ",",
            "Above"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",\

 Editable->False,
 CellOpen->False,ExpressionUUID->"02fd0990-e5aa-4cfe-b2a1-be37eedc9a90"],

Cell[BoxData[
 TemplateBox[{
   GraphicsBox[{{
      RGBColor[0.87, 0.94, 1], 
      Thickness[Medium], {
       LineBox[
        NCache[{{
           Rational[-9, 2], -3.5}, {
           Rational[-9, 2], -2.5}, {
           Rational[-9, 2], -1.5}, {
           Rational[-9, 2], -0.5}, {
           Rational[-9, 2], 0.5}, {
           Rational[-9, 2], 1.5}, {
           Rational[-9, 2], 2.5}, {
           Rational[-9, 2], 
           3.5}}, {{-4.5, -3.5}, {-4.5, -2.5}, {-4.5, -1.5}, {-4.5, -0.5}, \
{-4.5, 0.5}, {-4.5, 1.5}, {-4.5, 2.5}, {-4.5, 3.5}}]], 
       LineBox[
        NCache[{{
           Rational[-7, 2], -3.5}, {
           Rational[-7, 2], -2.5}, {
           Rational[-7, 2], -1.5}, {
           Rational[-7, 2], -0.5}, {
           Rational[-7, 2], 0.5}, {
           Rational[-7, 2], 1.5}, {
           Rational[-7, 2], 2.5}, {
           Rational[-7, 2], 
           3.5}}, {{-3.5, -3.5}, {-3.5, -2.5}, {-3.5, -1.5}, {-3.5, -0.5}, \
{-3.5, 0.5}, {-3.5, 1.5}, {-3.5, 2.5}, {-3.5, 3.5}}]], 
       LineBox[
        NCache[{{
           Rational[-5, 2], -3.5}, {
           Rational[-5, 2], -2.5}, {
           Rational[-5, 2], -1.5}, {
           Rational[-5, 2], -0.5}, {
           Rational[-5, 2], 0.5}, {
           Rational[-5, 2], 1.5}, {
           Rational[-5, 2], 2.5}, {
           Rational[-5, 2], 
           3.5}}, {{-2.5, -3.5}, {-2.5, -2.5}, {-2.5, -1.5}, {-2.5, -0.5}, \
{-2.5, 0.5}, {-2.5, 1.5}, {-2.5, 2.5}, {-2.5, 3.5}}]], 
       LineBox[
        NCache[{{
           Rational[-3, 2], -3.5}, {
           Rational[-3, 2], -2.5}, {
           Rational[-3, 2], -1.5}, {
           Rational[-3, 2], -0.5}, {
           Rational[-3, 2], 0.5}, {
           Rational[-3, 2], 1.5}, {
           Rational[-3, 2], 2.5}, {
           Rational[-3, 2], 
           3.5}}, {{-1.5, -3.5}, {-1.5, -2.5}, {-1.5, -1.5}, {-1.5, -0.5}, \
{-1.5, 0.5}, {-1.5, 1.5}, {-1.5, 2.5}, {-1.5, 3.5}}]], 
       LineBox[
        NCache[{{
           Rational[-1, 2], -3.5}, {
           Rational[-1, 2], -2.5}, {
           Rational[-1, 2], -1.5}, {
           Rational[-1, 2], -0.5}, {
           Rational[-1, 2], 0.5}, {
           Rational[-1, 2], 1.5}, {
           Rational[-1, 2], 2.5}, {
           Rational[-1, 2], 
           3.5}}, {{-0.5, -3.5}, {-0.5, -2.5}, {-0.5, -1.5}, {-0.5, -0.5}, \
{-0.5, 0.5}, {-0.5, 1.5}, {-0.5, 2.5}, {-0.5, 3.5}}]], 
       LineBox[
        NCache[{{
           Rational[1, 2], -3.5}, {
           Rational[1, 2], -2.5}, {
           Rational[1, 2], -1.5}, {
           Rational[1, 2], -0.5}, {
           Rational[1, 2], 0.5}, {
           Rational[1, 2], 1.5}, {
           Rational[1, 2], 2.5}, {
           Rational[1, 2], 3.5}}, {{0.5, -3.5}, {0.5, -2.5}, {0.5, -1.5}, {
         0.5, -0.5}, {0.5, 0.5}, {0.5, 1.5}, {0.5, 2.5}, {0.5, 3.5}}]], 
       LineBox[
        NCache[{{
           Rational[3, 2], -3.5}, {
           Rational[3, 2], -2.5}, {
           Rational[3, 2], -1.5}, {
           Rational[3, 2], -0.5}, {
           Rational[3, 2], 0.5}, {
           Rational[3, 2], 1.5}, {
           Rational[3, 2], 2.5}, {
           Rational[3, 2], 3.5}}, {{1.5, -3.5}, {1.5, -2.5}, {1.5, -1.5}, {
         1.5, -0.5}, {1.5, 0.5}, {1.5, 1.5}, {1.5, 2.5}, {1.5, 3.5}}]], 
       LineBox[
        NCache[{{
           Rational[5, 2], -3.5}, {
           Rational[5, 2], -2.5}, {
           Rational[5, 2], -1.5}, {
           Rational[5, 2], -0.5}, {
           Rational[5, 2], 0.5}, {
           Rational[5, 2], 1.5}, {
           Rational[5, 2], 2.5}, {
           Rational[5, 2], 3.5}}, {{2.5, -3.5}, {2.5, -2.5}, {2.5, -1.5}, {
         2.5, -0.5}, {2.5, 0.5}, {2.5, 1.5}, {2.5, 2.5}, {2.5, 3.5}}]], 
       LineBox[
        NCache[{{
           Rational[7, 2], -3.5}, {
           Rational[7, 2], -2.5}, {
           Rational[7, 2], -1.5}, {
           Rational[7, 2], -0.5}, {
           Rational[7, 2], 0.5}, {
           Rational[7, 2], 1.5}, {
           Rational[7, 2], 2.5}, {
           Rational[7, 2], 3.5}}, {{3.5, -3.5}, {3.5, -2.5}, {3.5, -1.5}, {
         3.5, -0.5}, {3.5, 0.5}, {3.5, 1.5}, {3.5, 2.5}, {3.5, 3.5}}]], 
       LineBox[
        NCache[{{
           Rational[9, 2], -3.5}, {
           Rational[9, 2], -2.5}, {
           Rational[9, 2], -1.5}, {
           Rational[9, 2], -0.5}, {
           Rational[9, 2], 0.5}, {
           Rational[9, 2], 1.5}, {
           Rational[9, 2], 2.5}, {
           Rational[9, 2], 3.5}}, {{4.5, -3.5}, {4.5, -2.5}, {4.5, -1.5}, {
         4.5, -0.5}, {4.5, 0.5}, {4.5, 1.5}, {4.5, 2.5}, {4.5, 3.5}}]]}, {
       LineBox[
        NCache[{{
           Rational[-9, 2], -3.5}, {
           Rational[-7, 2], -3.5}, {
           Rational[-5, 2], -3.5}, {
           Rational[-3, 2], -3.5}, {
           Rational[-1, 2], -3.5}, {
           Rational[1, 2], -3.5}, {
           Rational[3, 2], -3.5}, {
           Rational[5, 2], -3.5}, {
           Rational[7, 2], -3.5}, {
           Rational[
           9, 2], -3.5}}, {{-4.5, -3.5}, {-3.5, -3.5}, {-2.5, -3.5}, {-1.5, \
-3.5}, {-0.5, -3.5}, {0.5, -3.5}, {1.5, -3.5}, {2.5, -3.5}, {3.5, -3.5}, {
         4.5, -3.5}}]], 
       LineBox[
        NCache[{{
           Rational[-9, 2], -2.5}, {
           Rational[-7, 2], -2.5}, {
           Rational[-5, 2], -2.5}, {
           Rational[-3, 2], -2.5}, {
           Rational[-1, 2], -2.5}, {
           Rational[1, 2], -2.5}, {
           Rational[3, 2], -2.5}, {
           Rational[5, 2], -2.5}, {
           Rational[7, 2], -2.5}, {
           Rational[
           9, 2], -2.5}}, {{-4.5, -2.5}, {-3.5, -2.5}, {-2.5, -2.5}, {-1.5, \
-2.5}, {-0.5, -2.5}, {0.5, -2.5}, {1.5, -2.5}, {2.5, -2.5}, {3.5, -2.5}, {
         4.5, -2.5}}]], 
       LineBox[
        NCache[{{
           Rational[-9, 2], -1.5}, {
           Rational[-7, 2], -1.5}, {
           Rational[-5, 2], -1.5}, {
           Rational[-3, 2], -1.5}, {
           Rational[-1, 2], -1.5}, {
           Rational[1, 2], -1.5}, {
           Rational[3, 2], -1.5}, {
           Rational[5, 2], -1.5}, {
           Rational[7, 2], -1.5}, {
           Rational[
           9, 2], -1.5}}, {{-4.5, -1.5}, {-3.5, -1.5}, {-2.5, -1.5}, {-1.5, \
-1.5}, {-0.5, -1.5}, {0.5, -1.5}, {1.5, -1.5}, {2.5, -1.5}, {3.5, -1.5}, {
         4.5, -1.5}}]], 
       LineBox[
        NCache[{{
           Rational[-9, 2], -0.5}, {
           Rational[-7, 2], -0.5}, {
           Rational[-5, 2], -0.5}, {
           Rational[-3, 2], -0.5}, {
           Rational[-1, 2], -0.5}, {
           Rational[1, 2], -0.5}, {
           Rational[3, 2], -0.5}, {
           Rational[5, 2], -0.5}, {
           Rational[7, 2], -0.5}, {
           Rational[
           9, 2], -0.5}}, {{-4.5, -0.5}, {-3.5, -0.5}, {-2.5, -0.5}, {-1.5, \
-0.5}, {-0.5, -0.5}, {0.5, -0.5}, {1.5, -0.5}, {2.5, -0.5}, {3.5, -0.5}, {
         4.5, -0.5}}]], 
       LineBox[
        NCache[{{
           Rational[-9, 2], 0.5}, {
           Rational[-7, 2], 0.5}, {
           Rational[-5, 2], 0.5}, {
           Rational[-3, 2], 0.5}, {
           Rational[-1, 2], 0.5}, {
           Rational[1, 2], 0.5}, {
           Rational[3, 2], 0.5}, {
           Rational[5, 2], 0.5}, {
           Rational[7, 2], 0.5}, {
           Rational[9, 2], 0.5}}, {{-4.5, 0.5}, {-3.5, 0.5}, {-2.5, 
         0.5}, {-1.5, 0.5}, {-0.5, 0.5}, {0.5, 0.5}, {1.5, 0.5}, {2.5, 0.5}, {
         3.5, 0.5}, {4.5, 0.5}}]], 
       LineBox[
        NCache[{{
           Rational[-9, 2], 1.5}, {
           Rational[-7, 2], 1.5}, {
           Rational[-5, 2], 1.5}, {
           Rational[-3, 2], 1.5}, {
           Rational[-1, 2], 1.5}, {
           Rational[1, 2], 1.5}, {
           Rational[3, 2], 1.5}, {
           Rational[5, 2], 1.5}, {
           Rational[7, 2], 1.5}, {
           Rational[9, 2], 1.5}}, {{-4.5, 1.5}, {-3.5, 1.5}, {-2.5, 
         1.5}, {-1.5, 1.5}, {-0.5, 1.5}, {0.5, 1.5}, {1.5, 1.5}, {2.5, 1.5}, {
         3.5, 1.5}, {4.5, 1.5}}]], 
       LineBox[
        NCache[{{
           Rational[-9, 2], 2.5}, {
           Rational[-7, 2], 2.5}, {
           Rational[-5, 2], 2.5}, {
           Rational[-3, 2], 2.5}, {
           Rational[-1, 2], 2.5}, {
           Rational[1, 2], 2.5}, {
           Rational[3, 2], 2.5}, {
           Rational[5, 2], 2.5}, {
           Rational[7, 2], 2.5}, {
           Rational[9, 2], 2.5}}, {{-4.5, 2.5}, {-3.5, 2.5}, {-2.5, 
         2.5}, {-1.5, 2.5}, {-0.5, 2.5}, {0.5, 2.5}, {1.5, 2.5}, {2.5, 2.5}, {
         3.5, 2.5}, {4.5, 2.5}}]], 
       LineBox[
        NCache[{{
           Rational[-9, 2], 3.5}, {
           Rational[-7, 2], 3.5}, {
           Rational[-5, 2], 3.5}, {
           Rational[-3, 2], 3.5}, {
           Rational[-1, 2], 3.5}, {
           Rational[1, 2], 3.5}, {
           Rational[3, 2], 3.5}, {
           Rational[5, 2], 3.5}, {
           Rational[7, 2], 3.5}, {
           Rational[9, 2], 3.5}}, {{-4.5, 3.5}, {-3.5, 3.5}, {-2.5, 
         3.5}, {-1.5, 3.5}, {-0.5, 3.5}, {0.5, 3.5}, {1.5, 3.5}, {2.5, 3.5}, {
         3.5, 3.5}, {4.5, 3.5}}]]}}, {
      GrayLevel[0], 
      PointSize[Medium], {
       PointBox[{{-4, -3.}, {-4, -2.}, {-4, -1.}, {-4, 0.}, {-4, 1.}, {-4, 
          2.}, {-4, 3.}}], 
       PointBox[{{-3, -3.}, {-3, -2.}, {-3, -1.}, {-3, 0.}, {-3, 1.}, {-3, 
          2.}, {-3, 3.}}], 
       PointBox[{{-2, -3.}, {-2, -2.}, {-2, -1.}, {-2, 0.}, {-2, 1.}, {-2, 
          2.}, {-2, 3.}}], 
       PointBox[{{-1, -3.}, {-1, -2.}, {-1, -1.}, {-1, 0.}, {-1, 1.}, {-1, 
          2.}, {-1, 3.}}], 
       PointBox[{{0, -3.}, {0, -2.}, {0, -1.}, {0, 0.}, {0, 1.}, {0, 2.}, {
         0, 3.}}], 
       PointBox[{{1, -3.}, {1, -2.}, {1, -1.}, {1, 0.}, {1, 1.}, {1, 2.}, {
         1, 3.}}], 
       PointBox[{{2, -3.}, {2, -2.}, {2, -1.}, {2, 0.}, {2, 1.}, {2, 2.}, {
         2, 3.}}], 
       PointBox[{{3, -3.}, {3, -2.}, {3, -1.}, {3, 0.}, {3, 1.}, {3, 2.}, {
         3, 3.}}], 
       PointBox[{{4, -3.}, {4, -2.}, {4, -1.}, {4, 0.}, {4, 1.}, {4, 2.}, {
         4, 3.}}]}}, {
      GrayLevel[0.5], 
      PointSize[Medium], {
       PointBox[{{-6, -5.}, {-6, -4.}, {-6, -3.}, {-6, -2.}, {-6, -1.}, {-6, 
          0.}, {-6, 1.}, {-6, 2.}, {-6, 3.}, {-6, 4.}, {-6, 5.}}], 
       PointBox[{{-5, -5.}, {-5, -4.}, {-5, -3.}, {-5, -2.}, {-5, -1.}, {-5, 
          0.}, {-5, 1.}, {-5, 2.}, {-5, 3.}, {-5, 4.}, {-5, 5.}}]}, {
       PointBox[{{-6, -5.}, {-6, -4.}}], 
       PointBox[{{-5, -5.}, {-5, -4.}}], 
       PointBox[{{-4, -5.}, {-4, -4.}}], 
       PointBox[{{-3, -5.}, {-3, -4.}}], 
       PointBox[{{-2, -5.}, {-2, -4.}}], 
       PointBox[{{-1, -5.}, {-1, -4.}}], 
       PointBox[{{0, -5.}, {0, -4.}}], 
       PointBox[{{1, -5.}, {1, -4.}}], 
       PointBox[{{2, -5.}, {2, -4.}}], 
       PointBox[{{3, -5.}, {3, -4.}}], 
       PointBox[{{4, -5.}, {4, -4.}}], 
       PointBox[{{5, -5.}, {5, -4.}}], 
       PointBox[{{6, -5.}, {6, -4.}}]}, {
       PointBox[{{5, -5.}, {5, -4.}, {5, -3.}, {5, -2.}, {5, -1.}, {5, 0.}, {
         5, 1.}, {5, 2.}, {5, 3.}, {5, 4.}, {5, 5.}}], 
       PointBox[{{6, -5.}, {6, -4.}, {6, -3.}, {6, -2.}, {6, -1.}, {6, 0.}, {
         6, 1.}, {6, 2.}, {6, 3.}, {6, 4.}, {6, 5.}}]}, {
       PointBox[{{-6, 4.}, {-6, 5.}}], 
       PointBox[{{-5, 4.}, {-5, 5.}}], 
       PointBox[{{-4, 4.}, {-4, 5.}}], 
       PointBox[{{-3, 4.}, {-3, 5.}}], 
       PointBox[{{-2, 4.}, {-2, 5.}}], 
       PointBox[{{-1, 4.}, {-1, 5.}}], 
       PointBox[{{0, 4.}, {0, 5.}}], 
       PointBox[{{1, 4.}, {1, 5.}}], 
       PointBox[{{2, 4.}, {2, 5.}}], 
       PointBox[{{3, 4.}, {3, 5.}}], 
       PointBox[{{4, 4.}, {4, 5.}}], 
       PointBox[{{5, 4.}, {5, 5.}}], 
       PointBox[{{6, 4.}, {6, 5.}}]}}, {
      RGBColor[0, 0, 1], {
       InsetBox[
        FormBox["0", TraditionalForm], {-4, 0.}, {-1, -1}], 
       InsetBox[
        FormBox["1", TraditionalForm], {-3, 0.}, {-1, -1}], 
       InsetBox[
        FormBox["2", TraditionalForm], {-2, 0.}, {-1, -1}], 
       InsetBox[
        FormBox["3", TraditionalForm], {-1, 0.}, {-1, -1}], 
       InsetBox[
        FormBox["4", TraditionalForm], {0, 0.}, {-1, -1}], 
       InsetBox[
        FormBox["5", TraditionalForm], {1, 0.}, {-1, -1}], 
       InsetBox[
        FormBox["6", TraditionalForm], {2, 0.}, {-1, -1}], 
       InsetBox[
        FormBox["7", TraditionalForm], {3, 0.}, {-1, -1}], 
       InsetBox[
        FormBox["8", TraditionalForm], {4, 0.}, {-1, -1}]}}, {
      RGBColor[1, 0, 0], {
       InsetBox[
        FormBox["0", TraditionalForm], {0, -3.}, {1, 1}], 
       InsetBox[
        FormBox["1", TraditionalForm], {0, -2.}, {1, 1}], 
       InsetBox[
        FormBox["2", TraditionalForm], {0, -1.}, {1, 1}], 
       InsetBox[
        FormBox["3", TraditionalForm], {0, 0.}, {1, 1}], 
       InsetBox[
        FormBox["4", TraditionalForm], {0, 1.}, {1, 1}], 
       InsetBox[
        FormBox["5", TraditionalForm], {0, 2.}, {1, 1}], 
       InsetBox[
        FormBox["6", TraditionalForm], {0, 3.}, {1, 1}]}}, {
      GrayLevel[0], 
      Thickness[Medium], 
      LineBox[
       NCache[{{
          Rational[-9, 2], -3.5}, {
          Rational[-7, 2], -3.5}, {
          Rational[-5, 2], -3.5}, {
          Rational[-3, 2], -3.5}, {
          Rational[-1, 2], -3.5}, {
          Rational[1, 2], -3.5}, {
          Rational[3, 2], -3.5}, {
          Rational[5, 2], -3.5}, {
          Rational[7, 2], -3.5}, {
          Rational[
          9, 2], -3.5}}, {{-4.5, -3.5}, {-3.5, -3.5}, {-2.5, -3.5}, {-1.5, \
-3.5}, {-0.5, -3.5}, {0.5, -3.5}, {1.5, -3.5}, {2.5, -3.5}, {3.5, -3.5}, {
        4.5, -3.5}}]], 
      LineBox[
       NCache[{{
          Rational[9, 2], -3.5}, {
          Rational[9, 2], -2.5}, {
          Rational[9, 2], -1.5}, {
          Rational[9, 2], -0.5}, {
          Rational[9, 2], 0.5}, {
          Rational[9, 2], 1.5}, {
          Rational[9, 2], 2.5}, {
          Rational[9, 2], 3.5}}, {{4.5, -3.5}, {4.5, -2.5}, {4.5, -1.5}, {
        4.5, -0.5}, {4.5, 0.5}, {4.5, 1.5}, {4.5, 2.5}, {4.5, 3.5}}]], 
      LineBox[
       NCache[{{
          Rational[-9, 2], 3.5}, {
          Rational[-7, 2], 3.5}, {
          Rational[-5, 2], 3.5}, {
          Rational[-3, 2], 3.5}, {
          Rational[-1, 2], 3.5}, {
          Rational[1, 2], 3.5}, {
          Rational[3, 2], 3.5}, {
          Rational[5, 2], 3.5}, {
          Rational[7, 2], 3.5}, {
          Rational[9, 2], 3.5}}, {{-4.5, 3.5}, {-3.5, 3.5}, {-2.5, 
        3.5}, {-1.5, 3.5}, {-0.5, 3.5}, {0.5, 3.5}, {1.5, 3.5}, {2.5, 3.5}, {
        3.5, 3.5}, {4.5, 3.5}}]], 
      LineBox[
       NCache[{{
          Rational[-9, 2], -3.5}, {
          Rational[-9, 2], -2.5}, {
          Rational[-9, 2], -1.5}, {
          Rational[-9, 2], -0.5}, {
          Rational[-9, 2], 0.5}, {
          Rational[-9, 2], 1.5}, {
          Rational[-9, 2], 2.5}, {
          Rational[-9, 2], 
          3.5}}, {{-4.5, -3.5}, {-4.5, -2.5}, {-4.5, -1.5}, {-4.5, -0.5}, \
{-4.5, 0.5}, {-4.5, 1.5}, {-4.5, 2.5}, {-4.5, 3.5}}]]}}, AspectRatio -> 
    0.8333333333333333, Axes -> True, Ticks -> False, BaseStyle -> 11, 
    ImageSize -> Large], 
   FormBox[
    FormBox[
     TemplateBox[{
      "\"Particle Boundary\"", "\"Cell Center\"", "\"Ghost Cells\""}, 
      "PointLegend", DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    GrayLevel[0]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    GrayLevel[0]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #, 
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    GrayLevel[0]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    GrayLevel[0]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #2, 
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    GrayLevel[0.5]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    GrayLevel[0.5]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #3}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {"Columns" -> {{0.8, 0.5}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxDividers -> {"Columns" -> {{None}}, "Rows" -> {{None}}}, 
             GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}}, 
             GridBoxSpacings -> {"Columns" -> {{0}}, "Rows" -> {{1}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"PointLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               InterpretationBox[
                ButtonBox[
                 TooltipBox[
                  GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    GrayLevel[0], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                   True, FrameStyle -> GrayLevel[0.], FrameTicks -> None, 
                   PlotRangePadding -> None, ImageSize -> 
                   Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], "GrayLevel[0]"], Appearance -> None, 
                 BaseStyle -> {}, BaselinePosition -> Baseline, 
                 DefaultBaseStyle -> {}, ButtonFunction :> 
                 With[{Typeset`box$ = EvaluationBox[]}, 
                   If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    GrayLevel[0]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["GrayLevelColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                 Automatic, Method -> "Preemptive"], 
                GrayLevel[0], Editable -> False, Selectable -> False], ",", 
               InterpretationBox[
                ButtonBox[
                 TooltipBox[
                  GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    GrayLevel[0], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                   True, FrameStyle -> GrayLevel[0.], FrameTicks -> None, 
                   PlotRangePadding -> None, ImageSize -> 
                   Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], "GrayLevel[0]"], Appearance -> None, 
                 BaseStyle -> {}, BaselinePosition -> Baseline, 
                 DefaultBaseStyle -> {}, ButtonFunction :> 
                 With[{Typeset`box$ = EvaluationBox[]}, 
                   If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    GrayLevel[0]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["GrayLevelColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                 Automatic, Method -> "Preemptive"], 
                GrayLevel[0], Editable -> False, Selectable -> False], ",", 
               InterpretationBox[
                ButtonBox[
                 TooltipBox[
                  GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    GrayLevel[0.5], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                   True, FrameStyle -> GrayLevel[0.33333333333333337`], 
                   FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                   Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], "GrayLevel[0.5]"], Appearance -> None,
                  BaseStyle -> {}, BaselinePosition -> Baseline, 
                 DefaultBaseStyle -> {}, ButtonFunction :> 
                 With[{Typeset`box$ = EvaluationBox[]}, 
                   If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    GrayLevel[0.5]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["GrayLevelColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                 Automatic, Method -> "Preemptive"], 
                GrayLevel[0.5], Editable -> False, Selectable -> False]}], 
             "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2, ",", #3}], "}"}], ",", 
           RowBox[{"Joined", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{"True", ",", "False", ",", "False"}], "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Row\""}]}], "]"}]& ), 
      Editable -> True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}, {
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {2, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "Above"}], "]"}]}], "]"}]& )]], "Output",ExpressionU\
UID->"72b17c62-75ab-440a-bf58-e313a513100b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Magnetic field update", "Subsubsection",ExpressionUUID->"4a14bfee-67cd-41cf-b8f9-0ff48b4600a7"],

Cell[TextData[{
 "Staggered grid:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         SuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "1"], "/", 
         "\[CapitalDelta]t"}]},
       {
        RowBox[{
         SuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "2"], "/", 
         "\[CapitalDelta]t"}]},
       {
        RowBox[{
         SuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "3"], "/", 
         "\[CapitalDelta]t"}]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["c", 
       SqrtBox["g"]]}], 
     RowBox[{"(", GridBox[{
        {
         RowBox[{
          SubsuperscriptBox["\[CapitalDelta]\[CapitalXi]", "3", "t"], "/", 
          SuperscriptBox["\[CapitalDelta]x", "2"]}]},
        {
         RowBox[{
          RowBox[{"-", 
           SubsuperscriptBox["\[CapitalDelta]\[CapitalXi]", "3", "t"]}], "/", 
          
          SuperscriptBox["\[CapitalDelta]x", "1"]}]},
        {
         RowBox[{
          RowBox[{
           SubsuperscriptBox["\[CapitalDelta]\[CapitalXi]", "2", "t"], "/", 
           SuperscriptBox["\[CapitalDelta]x", "1"]}], "-", 
          RowBox[{
           SubsuperscriptBox["\[CapitalDelta]\[CapitalXi]", "1", "t"], "/", 
           SuperscriptBox["\[CapitalDelta]x", "2"]}]}]}
       }], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "b94e4a71-b933-4211-a828-b2c2a855b4ad"],
 " \[DoubleRightArrow] \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["\[CapitalOmega]", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
         RowBox[{
          RowBox[{"1", ";", "i"}], ",", "j"}]]},
       {
        SubsuperscriptBox["\[CapitalOmega]", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
         RowBox[{
          RowBox[{"2", ";", "i"}], ",", "j"}]]},
       {
        SubsuperscriptBox["\[CapitalOmega]", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
         RowBox[{
          RowBox[{"3", ";", "i"}], ",", "j"}]]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["\[CapitalOmega]", 
          RowBox[{"t", "-", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
          RowBox[{
           RowBox[{"1", ";", "i"}], ",", "j"}]]},
        {
         SubsuperscriptBox["\[CapitalOmega]", 
          RowBox[{"t", "-", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
          RowBox[{
           RowBox[{"2", ";", "i"}], ",", "j"}]]},
        {
         SubsuperscriptBox["\[CapitalOmega]", 
          RowBox[{"t", "-", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
          RowBox[{
           RowBox[{"3", ";", "i"}], ",", "j"}]]}
       }], ")"}], "-", 
     RowBox[{
      FractionBox[
       RowBox[{"c", " ", "\[CapitalDelta]t"}], 
       RowBox[{"2", 
        SqrtBox["g"], 
        SuperscriptBox["\[CapitalDelta]x", "1"]}]], 
      RowBox[{"(", GridBox[{
         {"0"},
         {
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"3", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", 
                 RowBox[{"j", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"3", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", "j"}], "t"]}], ")"}], "-", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"3", ";", "i"}], ",", 
                 RowBox[{"j", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"3", ";", "i"}], ",", "j"}], "t"]}], ")"}]}], 
            ")"}]}]},
         {
          RowBox[{"+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"2", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", 
                 RowBox[{"j", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"2", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", "j"}], "t"]}], ")"}], "-", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"2", ";", "i"}], ",", 
                 RowBox[{"j", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"2", ";", "i"}], ",", "j"}], "t"]}], ")"}]}], ")"}]}]}
        }], ")"}]}], "-", 
     RowBox[{
      FractionBox[
       RowBox[{"c", " ", "\[CapitalDelta]t"}], 
       RowBox[{"2", 
        SqrtBox["g"], 
        SuperscriptBox["\[CapitalDelta]x", "2"]}]], 
      RowBox[{"(", GridBox[{
         {
          RowBox[{"+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"3", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", 
                 RowBox[{"j", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"3", ";", "i"}], ",", 
                 RowBox[{"j", "+", "1"}]}], "t"]}], ")"}], "-", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"3", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", "j"}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"3", ";", "i"}], ",", "j"}], "t"]}], ")"}]}], 
            ")"}]}]},
         {"0"},
         {
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"1", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", 
                 RowBox[{"j", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"1", ";", "i"}], ",", 
                 RowBox[{"j", "+", "1"}]}], "t"]}], ")"}], "-", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"1", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", "j"}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"1", ";", "i"}], ",", "j"}], "t"]}], ")"}]}], ")"}]}]}
        }], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "7aafa89c-405d-4415-a70b-2cc819f40096"]
}], "Text",ExpressionUUID->"71dd6534-88ee-4f77-b585-a0871fd1c7be"],

Cell[TextData[{
 "Collocated grid:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         SuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "1"], "/", 
         "\[CapitalDelta]t"}]},
       {
        RowBox[{
         SuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "2"], "/", 
         "\[CapitalDelta]t"}]},
       {
        RowBox[{
         SuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "3"], "/", 
         "\[CapitalDelta]t"}]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["c", 
       SqrtBox["g"]]}], 
     RowBox[{"(", GridBox[{
        {
         RowBox[{
          SubsuperscriptBox["\[CapitalDelta]\[CapitalXi]", "3", "t"], "/", 
          SuperscriptBox["\[CapitalDelta]x", "2"]}]},
        {
         RowBox[{
          RowBox[{"-", 
           SubsuperscriptBox["\[CapitalDelta]\[CapitalXi]", "3", "t"]}], "/", 
          
          SuperscriptBox["\[CapitalDelta]x", "1"]}]},
        {
         RowBox[{
          RowBox[{
           SubsuperscriptBox["\[CapitalDelta]\[CapitalXi]", "2", "t"], "/", 
           SuperscriptBox["\[CapitalDelta]x", "1"]}], "-", 
          RowBox[{
           SubsuperscriptBox["\[CapitalDelta]\[CapitalXi]", "1", "t"], "/", 
           SuperscriptBox["\[CapitalDelta]x", "2"]}]}]}
       }], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "d077f751-4a5e-4b35-bb63-12d90cbe3ce3"],
 " \[DoubleRightArrow] \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["\[CapitalOmega]", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
         RowBox[{
          RowBox[{"1", ";", "i"}], ",", "j"}]]},
       {
        SubsuperscriptBox["\[CapitalOmega]", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
         RowBox[{
          RowBox[{"2", ";", "i"}], ",", "j"}]]},
       {
        SubsuperscriptBox["\[CapitalOmega]", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
         RowBox[{
          RowBox[{"3", ";", "i"}], ",", "j"}]]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["\[CapitalOmega]", 
          RowBox[{"t", "-", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
          RowBox[{
           RowBox[{"1", ";", "i"}], ",", "j"}]]},
        {
         SubsuperscriptBox["\[CapitalOmega]", 
          RowBox[{"t", "-", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
          RowBox[{
           RowBox[{"2", ";", "i"}], ",", "j"}]]},
        {
         SubsuperscriptBox["\[CapitalOmega]", 
          RowBox[{"t", "-", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
          RowBox[{
           RowBox[{"3", ";", "i"}], ",", "j"}]]}
       }], ")"}], "-", 
     RowBox[{
      FractionBox[
       RowBox[{"c", " ", 
        RowBox[{"\[CapitalDelta]t", "/", 
         SqrtBox["g"]}]}], 
       RowBox[{"12", 
        SuperscriptBox["\[CapitalDelta]x", "1"]}]], 
      RowBox[{"(", GridBox[{
         {"0"},
         {
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             SubsuperscriptBox["\[CapitalXi]", 
              RowBox[{
               RowBox[{"3", ";", 
                RowBox[{"i", "-", "2"}]}], ",", "j"}], "t"], "-", 
             RowBox[{"8", 
              SubsuperscriptBox["\[CapitalXi]", 
               RowBox[{
                RowBox[{"3", ";", 
                 RowBox[{"i", "-", "1"}]}], ",", "j"}], "t"]}], "+", 
             RowBox[{"8", 
              SubsuperscriptBox["\[CapitalXi]", 
               RowBox[{
                RowBox[{"3", ";", 
                 RowBox[{"i", "+", "1"}]}], ",", "j"}], "t"]}], "-", 
             SubsuperscriptBox["\[CapitalXi]", 
              RowBox[{
               RowBox[{"3", ";", 
                RowBox[{"i", "+", "2"}]}], ",", "j"}], "t"]}], ")"}]}]},
         {
          RowBox[{"+", 
           RowBox[{"(", 
            RowBox[{
             SubsuperscriptBox["\[CapitalXi]", 
              RowBox[{
               RowBox[{"2", ";", 
                RowBox[{"i", "-", "2"}]}], ",", "j"}], "t"], "-", 
             RowBox[{"8", 
              SubsuperscriptBox["\[CapitalXi]", 
               RowBox[{
                RowBox[{"2", ";", 
                 RowBox[{"i", "-", "1"}]}], ",", "j"}], "t"]}], "+", 
             RowBox[{"8", 
              SubsuperscriptBox["\[CapitalXi]", 
               RowBox[{
                RowBox[{"2", ";", 
                 RowBox[{"i", "+", "1"}]}], ",", "j"}], "t"]}], "-", 
             SubsuperscriptBox["\[CapitalXi]", 
              RowBox[{
               RowBox[{"2", ";", 
                RowBox[{"i", "+", "2"}]}], ",", "j"}], "t"]}], ")"}]}]}
        }], ")"}]}], "-", 
     RowBox[{
      FractionBox[
       RowBox[{"c", " ", 
        RowBox[{"\[CapitalDelta]t", "/", 
         SqrtBox["g"]}]}], 
       RowBox[{"12", 
        SuperscriptBox["\[CapitalDelta]x", "2"]}]], 
      RowBox[{"(", GridBox[{
         {
          RowBox[{"+", 
           RowBox[{"(", 
            RowBox[{
             SubsuperscriptBox["\[CapitalXi]", 
              RowBox[{
               RowBox[{"3", ";", "i"}], ",", 
               RowBox[{"j", "-", "2"}]}], "t"], "-", 
             RowBox[{"8", 
              SubsuperscriptBox["\[CapitalXi]", 
               RowBox[{
                RowBox[{"3", ";", "i"}], ",", 
                RowBox[{"j", "-", "1"}]}], "t"]}], "+", 
             RowBox[{"8", 
              SubsuperscriptBox["\[CapitalXi]", 
               RowBox[{
                RowBox[{"3", ";", "i"}], ",", 
                RowBox[{"j", "+", "1"}]}], "t"]}], "-", 
             SubsuperscriptBox["\[CapitalXi]", 
              RowBox[{
               RowBox[{"3", ";", "i"}], ",", 
               RowBox[{"j", "+", "2"}]}], "t"]}], ")"}]}]},
         {"0"},
         {
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             SubsuperscriptBox["\[CapitalXi]", 
              RowBox[{
               RowBox[{"1", ";", "i"}], ",", 
               RowBox[{"j", "-", "2"}]}], "t"], "-", 
             RowBox[{"8", 
              SubsuperscriptBox["\[CapitalXi]", 
               RowBox[{
                RowBox[{"1", ";", "i"}], ",", 
                RowBox[{"j", "-", "1"}]}], "t"]}], "+", 
             RowBox[{"8", 
              SubsuperscriptBox["\[CapitalXi]", 
               RowBox[{
                RowBox[{"1", ";", "i"}], ",", 
                RowBox[{"j", "+", "1"}]}], "t"]}], "-", 
             SubsuperscriptBox["\[CapitalXi]", 
              RowBox[{
               RowBox[{"1", ";", "i"}], ",", 
               RowBox[{"j", "+", "2"}]}], "t"]}], ")"}]}]}
        }], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "c48aad53-88ff-42ea-839f-42e7ded77cb5"]
}], "Text",ExpressionUUID->"36013628-fe85-42dd-a15b-610d333f3ddd"],

Cell[TextData[{
 "After update, calculate covariant components:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[CapitalOmega]", "i"], "=", 
    RowBox[{
     SuperscriptBox["\[CapitalOmega]", "j"], 
     SubscriptBox["g", 
      RowBox[{"i", "\[VeryThinSpace]", "j"}]]}]}], TraditionalForm]],
  ExpressionUUID->"7133874f-c99b-4446-8492-890f844d43dd"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["\[CapitalOmega]", "1"]},
       {
        SubscriptBox["\[CapitalOmega]", "2"]},
       {
        SubscriptBox["\[CapitalOmega]", "3"]}
      }], ")"}], "=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         RowBox[{
          SubscriptBox["g", "11"], 
          SuperscriptBox["\[CapitalOmega]", "1"]}], "+", 
         RowBox[{
          SubscriptBox["g", "12"], 
          SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
         RowBox[{
          SubscriptBox["g", "13"], 
          SuperscriptBox["\[CapitalOmega]", "3"]}]}]},
       {
        RowBox[{
         RowBox[{
          SubscriptBox["g", "21"], 
          SuperscriptBox["\[CapitalOmega]", "1"]}], "+", 
         RowBox[{
          SubscriptBox["g", "22"], 
          SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
         RowBox[{
          SubscriptBox["g", "23"], 
          SuperscriptBox["\[CapitalOmega]", "3"]}]}]},
       {
        RowBox[{
         RowBox[{
          SubscriptBox["g", "31"], 
          SuperscriptBox["\[CapitalOmega]", "1"]}], "+", 
         RowBox[{
          SubscriptBox["g", "32"], 
          SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
         RowBox[{
          SubscriptBox["g", "33"], 
          SuperscriptBox["\[CapitalOmega]", "3"]}]}]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "1e99eb98-575b-4421-9c96-7a9b3bf6f8e5"],
 ";\nand cartesian components:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["\[CapitalOmega]", "x"]},
       {
        SubscriptBox["\[CapitalOmega]", "y"]},
       {
        SubscriptBox["\[CapitalOmega]", "z"]}
      }], ")"}], "=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         RowBox[{
          SuperscriptBox["\[CapitalOmega]", "1"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "x"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalOmega]", "2"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "x"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalOmega]", "3"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "x"]}]}]}]},
       {
        RowBox[{
         RowBox[{
          SuperscriptBox["\[CapitalOmega]", "1"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "y"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalOmega]", "2"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "y"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalOmega]", "3"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "y"]}]}]}]},
       {
        RowBox[{
         RowBox[{
          SuperscriptBox["\[CapitalOmega]", "1"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "z"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalOmega]", "2"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "z"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalOmega]", "3"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "z"]}]}]}]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "5e3f588c-be0e-4fb6-adb1-4c8f38b1838c"]
}], "Text",ExpressionUUID->"ec1a98ec-a38d-4d68-8f40-dfff4cdc89d3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Electric field update", "Subsubsection",ExpressionUUID->"23e261f9-4f3f-4280-a06b-4cccde14ee40"],

Cell[TextData[{
 "Staggered grid:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         SuperscriptBox["\[CapitalDelta]\[CapitalXi]", "1"], "/", 
         "\[CapitalDelta]t"}]},
       {
        RowBox[{
         SuperscriptBox["\[CapitalDelta]\[CapitalXi]", "2"], "/", 
         "\[CapitalDelta]t"}]},
       {
        RowBox[{
         SuperscriptBox["\[CapitalDelta]\[CapitalXi]", "3"], "/", 
         "\[CapitalDelta]t"}]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{
      FractionBox["c", 
       SqrtBox["g"]], 
      RowBox[{"(", GridBox[{
         {
          RowBox[{
           SubsuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "3", 
            RowBox[{"t", "+", 
             RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "/", 
           SuperscriptBox["\[CapitalDelta]x", "2"]}]},
         {
          RowBox[{
           RowBox[{"-", 
            SubsuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "3", 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], "/", 
           SuperscriptBox["\[CapitalDelta]x", "1"]}]},
         {
          RowBox[{
           RowBox[{
            SubsuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "2", 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "/", 
            SuperscriptBox["\[CapitalDelta]x", "1"]}], "-", 
           RowBox[{
            SubsuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "1", 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "/", 
            SuperscriptBox["\[CapitalDelta]x", "2"]}]}]}
        }], ")"}]}], "-", 
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], "1"]},
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], "2"]},
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], "3"]}
       }], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "eb3ef938-1879-4ba1-88b6-fac946f234aa"],
 " \[DoubleRightArrow] \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["\[CapitalXi]", 
         RowBox[{"t", "+", "\[CapitalDelta]t"}], 
         RowBox[{
          RowBox[{"1", ";", "i"}], ",", "j"}]]},
       {
        SubsuperscriptBox["\[CapitalXi]", 
         RowBox[{"t", "+", "\[CapitalDelta]t"}], 
         RowBox[{
          RowBox[{"2", ";", "i"}], ",", "j"}]]},
       {
        SubsuperscriptBox["\[CapitalXi]", 
         RowBox[{"t", "+", "\[CapitalDelta]t"}], 
         RowBox[{
          RowBox[{"3", ";", "i"}], ",", "j"}]]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["\[CapitalXi]", "t", 
          RowBox[{
           RowBox[{"1", ";", "i"}], ",", "j"}]]},
        {
         SubsuperscriptBox["\[CapitalXi]", "t", 
          RowBox[{
           RowBox[{"2", ";", "i"}], ",", "j"}]]},
        {
         SubsuperscriptBox["\[CapitalXi]", "t", 
          RowBox[{
           RowBox[{"3", ";", "i"}], ",", "j"}]]}
       }], ")"}], "-", 
     RowBox[{"\[CapitalDelta]t", "(", GridBox[{
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
          RowBox[{
           RowBox[{"1", ";", "i"}], ",", "j"}]]},
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
          RowBox[{
           RowBox[{"2", ";", "i"}], ",", "j"}]]},
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
          RowBox[{
           RowBox[{"3", ";", "i"}], ",", "j"}]]}
       }], ")"}], "+", 
     RowBox[{
      FractionBox[
       RowBox[{"c", " ", "\[CapitalDelta]t"}], 
       RowBox[{"2", 
        SqrtBox["g"], 
        SuperscriptBox["\[CapitalDelta]x", "1"]}]], 
      RowBox[{"(", GridBox[{
         {"0"},
         {
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"3", ";", "i"}], ",", "j"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"3", ";", "i"}], ",", 
                 RowBox[{"j", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}], "-", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"3", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", "j"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"3", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", 
                 RowBox[{"j", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}], 
            ")"}]}]},
         {
          RowBox[{"+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"2", ";", "i"}], ",", "j"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"2", ";", "i"}], ",", 
                 RowBox[{"j", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}], "-", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"2", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", "j"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"2", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", 
                 RowBox[{"j", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}], ")"}]}]}
        }], ")"}]}], "+", 
     RowBox[{
      FractionBox[
       RowBox[{"c", " ", "\[CapitalDelta]t"}], 
       RowBox[{"2", 
        SqrtBox["g"], 
        SuperscriptBox["\[CapitalDelta]x", "2"]}]], 
      RowBox[{"(", GridBox[{
         {
          RowBox[{"+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"3", ";", "i"}], ",", "j"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"3", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", "j"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}], "-", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"3", ";", "i"}], ",", 
                 RowBox[{"j", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"3", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", 
                 RowBox[{"j", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}], 
            ")"}]}]},
         {"0"},
         {
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"1", ";", "i"}], ",", "j"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"1", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", "j"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}], "-", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"1", ";", "i"}], ",", 
                 RowBox[{"j", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"1", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", 
                 RowBox[{"j", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}], ")"}]}]}
        }], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "db0b61a0-12e6-452c-b29c-4f18fe9453ac"]
}], "Text",ExpressionUUID->"de0dd5ee-859e-4eaa-a654-7fcee3abb3a2"],

Cell[TextData[{
 "Collocated grid:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         SuperscriptBox["\[CapitalDelta]\[CapitalXi]", "1"], "/", 
         "\[CapitalDelta]t"}]},
       {
        RowBox[{
         SuperscriptBox["\[CapitalDelta]\[CapitalXi]", "2"], "/", 
         "\[CapitalDelta]t"}]},
       {
        RowBox[{
         SuperscriptBox["\[CapitalDelta]\[CapitalXi]", "3"], "/", 
         "\[CapitalDelta]t"}]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{
      FractionBox["c", 
       SqrtBox["g"]], 
      RowBox[{"(", GridBox[{
         {
          RowBox[{
           SubsuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "3", 
            RowBox[{"t", "+", 
             RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "/", 
           SuperscriptBox["\[CapitalDelta]x", "2"]}]},
         {
          RowBox[{
           RowBox[{"-", 
            SubsuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "3", 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], "/", 
           SuperscriptBox["\[CapitalDelta]x", "1"]}]},
         {
          RowBox[{
           RowBox[{
            SubsuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "2", 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "/", 
            SuperscriptBox["\[CapitalDelta]x", "1"]}], "-", 
           RowBox[{
            SubsuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "1", 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "/", 
            SuperscriptBox["\[CapitalDelta]x", "2"]}]}]}
        }], ")"}]}], "-", 
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], "1"]},
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], "2"]},
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], "3"]}
       }], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "99b35305-a60b-4b9e-91c9-bc4ec70604c0"],
 " \[DoubleRightArrow] \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["\[CapitalXi]", 
         RowBox[{"t", "+", "\[CapitalDelta]t"}], 
         RowBox[{
          RowBox[{"1", ";", "i"}], ",", "j"}]]},
       {
        SubsuperscriptBox["\[CapitalXi]", 
         RowBox[{"t", "+", "\[CapitalDelta]t"}], 
         RowBox[{
          RowBox[{"2", ";", "i"}], ",", "j"}]]},
       {
        SubsuperscriptBox["\[CapitalXi]", 
         RowBox[{"t", "+", "\[CapitalDelta]t"}], 
         RowBox[{
          RowBox[{"3", ";", "i"}], ",", "j"}]]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["\[CapitalXi]", "t", 
          RowBox[{
           RowBox[{"1", ";", "i"}], ",", "j"}]]},
        {
         SubsuperscriptBox["\[CapitalXi]", "t", 
          RowBox[{
           RowBox[{"2", ";", "i"}], ",", "j"}]]},
        {
         SubsuperscriptBox["\[CapitalXi]", "t", 
          RowBox[{
           RowBox[{"3", ";", "i"}], ",", "j"}]]}
       }], ")"}], "-", 
     RowBox[{"\[CapitalDelta]t", "(", GridBox[{
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
          RowBox[{
           RowBox[{"1", ";", "i"}], ",", "j"}]]},
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
          RowBox[{
           RowBox[{"2", ";", "i"}], ",", "j"}]]},
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
          RowBox[{
           RowBox[{"3", ";", "i"}], ",", "j"}]]}
       }], ")"}], "+", 
     RowBox[{
      FractionBox[
       RowBox[{"c", " ", 
        RowBox[{"\[CapitalDelta]t", "/", 
         SqrtBox["g"]}]}], 
       RowBox[{"12", 
        SuperscriptBox["\[CapitalDelta]x", "1"]}]], 
      RowBox[{"(", GridBox[{
         {"0"},
         {
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             SubsuperscriptBox["\[CapitalOmega]", 
              RowBox[{
               RowBox[{"3", ";", 
                RowBox[{"i", "-", "2"}]}], ",", "j"}], 
              RowBox[{"t", "+", 
               RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "-", 
             RowBox[{"8", 
              SubsuperscriptBox["\[CapitalOmega]", 
               RowBox[{
                RowBox[{"3", ";", 
                 RowBox[{"i", "-", "1"}]}], ",", "j"}], 
               RowBox[{"t", "+", 
                RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], "+", 
             RowBox[{"8", 
              SubsuperscriptBox["\[CapitalOmega]", 
               RowBox[{
                RowBox[{"3", ";", 
                 RowBox[{"i", "+", "1"}]}], ",", "j"}], 
               RowBox[{"t", "+", 
                RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], "-", 
             SubsuperscriptBox["\[CapitalOmega]", 
              RowBox[{
               RowBox[{"3", ";", 
                RowBox[{"i", "+", "2"}]}], ",", "j"}], 
              RowBox[{"t", "+", 
               RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}]},
         {
          RowBox[{"+", 
           RowBox[{"(", 
            RowBox[{
             SubsuperscriptBox["\[CapitalOmega]", 
              RowBox[{
               RowBox[{"2", ";", 
                RowBox[{"i", "-", "2"}]}], ",", "j"}], 
              RowBox[{"t", "+", 
               RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "-", 
             RowBox[{"8", 
              SubsuperscriptBox["\[CapitalOmega]", 
               RowBox[{
                RowBox[{"2", ";", 
                 RowBox[{"i", "-", "1"}]}], ",", "j"}], 
               RowBox[{"t", "+", 
                RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], "+", 
             RowBox[{"8", 
              SubsuperscriptBox["\[CapitalOmega]", 
               RowBox[{
                RowBox[{"2", ";", 
                 RowBox[{"i", "+", "1"}]}], ",", "j"}], 
               RowBox[{"t", "+", 
                RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], "-", 
             SubsuperscriptBox["\[CapitalOmega]", 
              RowBox[{
               RowBox[{"2", ";", 
                RowBox[{"i", "+", "2"}]}], ",", "j"}], 
              RowBox[{"t", "+", 
               RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}]}
        }], ")"}]}], "+", 
     RowBox[{
      FractionBox[
       RowBox[{"c", " ", 
        RowBox[{"\[CapitalDelta]t", "/", 
         SqrtBox["g"]}]}], 
       RowBox[{"12", 
        SuperscriptBox["\[CapitalDelta]x", "2"]}]], 
      RowBox[{"(", GridBox[{
         {
          RowBox[{"+", 
           RowBox[{"(", 
            RowBox[{
             SubsuperscriptBox["\[CapitalOmega]", 
              RowBox[{
               RowBox[{"3", ";", "i"}], ",", 
               RowBox[{"j", "-", "2"}]}], 
              RowBox[{"t", "+", 
               RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "-", 
             RowBox[{"8", 
              SubsuperscriptBox["\[CapitalOmega]", 
               RowBox[{
                RowBox[{"3", ";", "i"}], ",", 
                RowBox[{"j", "-", "1"}]}], 
               RowBox[{"t", "+", 
                RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], "+", 
             RowBox[{"8", 
              SubsuperscriptBox["\[CapitalOmega]", 
               RowBox[{
                RowBox[{"3", ";", "i"}], ",", 
                RowBox[{"j", "+", "1"}]}], 
               RowBox[{"t", "+", 
                RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], "-", 
             SubsuperscriptBox["\[CapitalOmega]", 
              RowBox[{
               RowBox[{"3", ";", "i"}], ",", 
               RowBox[{"j", "+", "2"}]}], 
              RowBox[{"t", "+", 
               RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}]},
         {"0"},
         {
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             SubsuperscriptBox["\[CapitalOmega]", 
              RowBox[{
               RowBox[{"1", ";", "i"}], ",", 
               RowBox[{"j", "-", "2"}]}], 
              RowBox[{"t", "+", 
               RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "-", 
             RowBox[{"8", 
              SubsuperscriptBox["\[CapitalOmega]", 
               RowBox[{
                RowBox[{"1", ";", "i"}], ",", 
                RowBox[{"j", "-", "1"}]}], 
               RowBox[{"t", "+", 
                RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], "+", 
             RowBox[{"8", 
              SubsuperscriptBox["\[CapitalOmega]", 
               RowBox[{
                RowBox[{"1", ";", "i"}], ",", 
                RowBox[{"j", "+", "1"}]}], 
               RowBox[{"t", "+", 
                RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], "-", 
             SubsuperscriptBox["\[CapitalOmega]", 
              RowBox[{
               RowBox[{"1", ";", "i"}], ",", 
               RowBox[{"j", "+", "2"}]}], 
              RowBox[{"t", "+", 
               RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}]}
        }], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "9dae9175-f5b0-456a-aa1f-53700ebb879b"]
}], "Text",ExpressionUUID->"7c7421d9-8a6f-4e6e-b740-c3542a8ee789"],

Cell[TextData[{
 "After update, calculate covariant components:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[CapitalXi]", "i"], "=", 
    RowBox[{
     SuperscriptBox["\[CapitalXi]", "j"], 
     SubscriptBox["g", 
      RowBox[{"i", "\[VeryThinSpace]", "j"}]]}]}], TraditionalForm]],
  ExpressionUUID->"6005408c-f0ea-41c0-9437-66ec56b30ae5"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["\[CapitalXi]", "1"]},
       {
        SubscriptBox["\[CapitalXi]", "2"]},
       {
        SubscriptBox["\[CapitalXi]", "3"]}
      }], ")"}], "=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         RowBox[{
          SubscriptBox["g", "11"], 
          SuperscriptBox["\[CapitalXi]", "1"]}], "+", 
         RowBox[{
          SubscriptBox["g", "12"], 
          SuperscriptBox["\[CapitalXi]", "2"]}], "+", 
         RowBox[{
          SubscriptBox["g", "13"], 
          SuperscriptBox["\[CapitalXi]", "3"]}]}]},
       {
        RowBox[{
         RowBox[{
          SubscriptBox["g", "21"], 
          SuperscriptBox["\[CapitalXi]", "1"]}], "+", 
         RowBox[{
          SubscriptBox["g", "22"], 
          SuperscriptBox["\[CapitalXi]", "2"]}], "+", 
         RowBox[{
          SubscriptBox["g", "23"], 
          SuperscriptBox["\[CapitalXi]", "3"]}]}]},
       {
        RowBox[{
         RowBox[{
          SubscriptBox["g", "31"], 
          SuperscriptBox["\[CapitalXi]", "1"]}], "+", 
         RowBox[{
          SubscriptBox["g", "32"], 
          SuperscriptBox["\[CapitalXi]", "2"]}], "+", 
         RowBox[{
          SubscriptBox["g", "33"], 
          SuperscriptBox["\[CapitalXi]", "3"]}]}]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "49cc5a95-67a5-40c7-aad9-45077fcf6e1a"],
 ";\nand cartesian components:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["\[CapitalXi]", "x"]},
       {
        SubscriptBox["\[CapitalXi]", "y"]},
       {
        SubscriptBox["\[CapitalXi]", "z"]}
      }], ")"}], "=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         RowBox[{
          SuperscriptBox["\[CapitalXi]", "1"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "x"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalXi]", "2"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "x"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalXi]", "3"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "x"]}]}]}]},
       {
        RowBox[{
         RowBox[{
          SuperscriptBox["\[CapitalXi]", "1"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "y"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalXi]", "2"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "y"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalXi]", "3"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "y"]}]}]}]},
       {
        RowBox[{
         RowBox[{
          SuperscriptBox["\[CapitalXi]", "1"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "z"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalXi]", "2"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "z"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalXi]", "3"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "z"]}]}]}]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "f0518933-b5ff-4e97-b5a7-2b7eb6f526db"]
}], "Text",ExpressionUUID->"06fdc702-55b4-4b4f-bb84-6feee923bc2a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cold fluid update", "Subsubsection",ExpressionUUID->"25693883-e3df-4ab8-953c-bac84cbdf2a6"],

Cell[TextData[{
 "Staggered grid:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"\[CapitalDelta]", "(", 
      RowBox[{
       SubscriptBox["\[Delta]n", "f"], "/", 
       SubscriptBox["n", 
        RowBox[{"f", ",", "0"}]]}], ")"}], "\[CapitalDelta]t"], "=", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       SqrtBox["g"]]}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"\[CapitalDelta]", "(", 
         RowBox[{
          SqrtBox["g"], 
          SubsuperscriptBox["V", 
           RowBox[{"f", ";", 
            RowBox[{"t", "+", 
             RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], "1"]}], ")"}], 
        SuperscriptBox["\[CapitalDelta]x", "1"]], "+", 
       FractionBox[
        RowBox[{"\[CapitalDelta]", "(", 
         RowBox[{
          SqrtBox["g"], 
          SubsuperscriptBox["V", 
           RowBox[{"f", ";", 
            RowBox[{"t", "+", 
             RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], "2"]}], ")"}], 
        SuperscriptBox["\[CapitalDelta]x", "2"]]}], ")"}]}]}], 
   TraditionalForm]],ExpressionUUID->"19d0db88-e085-4d39-a3ff-50d2e6c8ba37"],
 " \[DoubleRightArrow] \n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    FractionBox[
     SubsuperscriptBox["\[Delta]n", 
      RowBox[{
       RowBox[{"f", ";", "i"}], ",", "j"}], 
      RowBox[{"t", "+", "\[CapitalDelta]t"}]], 
     SubscriptBox["n", 
      RowBox[{"f", ",", "0"}]]], "=", 
    FractionBox[
     SubsuperscriptBox["\[Delta]n", 
      RowBox[{
       RowBox[{"f", ";", "i"}], ",", "j"}], "t"], 
     SubscriptBox["n", 
      RowBox[{"f", ",", "0"}]]]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"4", "\[CapitalDelta]t"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SqrtBox[
            SubscriptBox["g", 
             RowBox[{
              RowBox[{"i", "+", "1"}], ",", 
              RowBox[{"j", "+", "1"}]}]]], "+", 
           SqrtBox[
            SubscriptBox["g", 
             RowBox[{"i", ",", 
              RowBox[{"j", "+", "1"}]}]]]}], ")"}], "+", 
         RowBox[{"(", 
          RowBox[{
           SqrtBox[
            SubscriptBox["g", 
             RowBox[{
              RowBox[{"i", "+", "1"}], ",", "j"}]]], "+", 
           SqrtBox[
            SubscriptBox["g", 
             RowBox[{"i", ",", "j"}]]]}], ")"}]}], ")"}], "2", 
       SuperscriptBox["\[CapitalDelta]x", "1"]}]]}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SqrtBox[
          SubscriptBox["g", 
           RowBox[{
            RowBox[{"i", "+", "1"}], ",", 
            RowBox[{"j", "+", "1"}]}]]], 
         SubsuperscriptBox["V", 
          RowBox[{"f", ";", 
           RowBox[{"t", "+", 
            RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
          RowBox[{
           RowBox[{"1", ";", 
            RowBox[{"i", "+", "1"}]}], ",", 
           RowBox[{"j", "+", "1"}]}]]}], "+", 
        RowBox[{
         SqrtBox[
          SubscriptBox["g", 
           RowBox[{
            RowBox[{"i", "+", "1"}], ",", "j"}]]], 
         SubsuperscriptBox["V", 
          RowBox[{"f", ";", 
           RowBox[{"t", "+", 
            RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
          RowBox[{
           RowBox[{"1", ";", 
            RowBox[{"i", "+", "1"}]}], ",", "j"}]]}]}], ")"}], "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SqrtBox[
          SubscriptBox["g", 
           RowBox[{"i", ",", 
            RowBox[{"j", "+", "1"}]}]]], 
         SubsuperscriptBox["V", 
          RowBox[{"f", ";", 
           RowBox[{"t", "+", 
            RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
          RowBox[{
           RowBox[{"1", ";", "i"}], ",", 
           RowBox[{"j", "+", "1"}]}]]}], "+", 
        RowBox[{
         SqrtBox[
          SubscriptBox["g", 
           RowBox[{"i", ",", "j"}]]], 
         SubsuperscriptBox["V", 
          RowBox[{"f", ";", 
           RowBox[{"t", "+", 
            RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
          RowBox[{
           RowBox[{"1", ";", "i"}], ",", "j"}]]}]}], ")"}]}], ")"}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"4", "\[CapitalDelta]t"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SqrtBox[
            SubscriptBox["g", 
             RowBox[{
              RowBox[{"i", "+", "1"}], ",", 
              RowBox[{"j", "+", "1"}]}]]], "+", 
           SqrtBox[
            SubscriptBox["g", 
             RowBox[{"i", ",", 
              RowBox[{"j", "+", "1"}]}]]]}], ")"}], "+", 
         RowBox[{"(", 
          RowBox[{
           SqrtBox[
            SubscriptBox["g", 
             RowBox[{
              RowBox[{"i", "+", "1"}], ",", "j"}]]], "+", 
           SqrtBox[
            SubscriptBox["g", 
             RowBox[{"i", ",", "j"}]]]}], ")"}]}], ")"}], "2", 
       SuperscriptBox["\[CapitalDelta]x", "2"]}]]}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SqrtBox[
          SubscriptBox["g", 
           RowBox[{
            RowBox[{"i", "+", "1"}], ",", 
            RowBox[{"j", "+", "1"}]}]]], 
         SubsuperscriptBox["V", 
          RowBox[{"f", ";", 
           RowBox[{"t", "+", 
            RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
          RowBox[{
           RowBox[{"2", ";", 
            RowBox[{"i", "+", "1"}]}], ",", 
           RowBox[{"j", "+", "1"}]}]]}], "+", 
        RowBox[{
         SqrtBox[
          SubscriptBox["g", 
           RowBox[{"i", ",", 
            RowBox[{"j", "+", "1"}]}]]], 
         SubsuperscriptBox["V", 
          RowBox[{"f", ";", 
           RowBox[{"t", "+", 
            RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
          RowBox[{
           RowBox[{"2", ";", "i"}], ",", 
           RowBox[{"j", "+", "1"}]}]]}]}], ")"}], "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SqrtBox[
          SubscriptBox["g", 
           RowBox[{
            RowBox[{"i", "+", "1"}], ",", "j"}]]], 
         SubsuperscriptBox["V", 
          RowBox[{"f", ";", 
           RowBox[{"t", "+", 
            RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
          RowBox[{
           RowBox[{"2", ";", 
            RowBox[{"i", "+", "1"}]}], ",", "j"}]]}], "+", 
        RowBox[{
         SqrtBox[
          SubscriptBox["g", 
           RowBox[{"i", ",", "j"}]]], 
         SubsuperscriptBox["V", 
          RowBox[{"f", ";", 
           RowBox[{"t", "+", 
            RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
          RowBox[{
           RowBox[{"2", ";", "i"}], ",", "j"}]]}]}], ")"}]}], ")"}]}], 
   TraditionalForm]}],ExpressionUUID->"41a0534e-e9f4-44fd-b625-bfd3fd1edf7f"]
}], "Text",ExpressionUUID->"fcd8dee0-ec11-4ab6-8a3d-d5174515d896"],

Cell[TextData[{
 "Collocated grid:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"\[CapitalDelta]", "(", 
      RowBox[{
       SubscriptBox["\[Delta]n", "f"], "/", 
       SubscriptBox["n", 
        RowBox[{"f", ",", "0"}]]}], ")"}], "\[CapitalDelta]t"], "=", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       SqrtBox["g"]]}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"\[CapitalDelta]", "(", 
         RowBox[{
          SqrtBox["g"], 
          SubsuperscriptBox["V", 
           RowBox[{"f", ";", 
            RowBox[{"t", "+", 
             RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], "1"]}], ")"}], 
        SuperscriptBox["\[CapitalDelta]x", "1"]], "+", 
       FractionBox[
        RowBox[{"\[CapitalDelta]", "(", 
         RowBox[{
          SqrtBox["g"], 
          SubsuperscriptBox["V", 
           RowBox[{"f", ";", 
            RowBox[{"t", "+", 
             RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], "2"]}], ")"}], 
        SuperscriptBox["\[CapitalDelta]x", "2"]]}], ")"}]}]}], 
   TraditionalForm]],ExpressionUUID->"4d1965a7-8c28-458f-a050-1d6a6aa2b1a8"],
 " \[DoubleRightArrow] \n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    FractionBox[
     SubsuperscriptBox["\[Delta]n", 
      RowBox[{
       RowBox[{"f", ";", "i"}], ",", "j"}], 
      RowBox[{"t", "+", "\[CapitalDelta]t"}]], 
     SubscriptBox["n", 
      RowBox[{"f", ",", "0"}]]], "=", 
    FractionBox[
     SubsuperscriptBox["\[Delta]n", 
      RowBox[{
       RowBox[{"f", ";", "i"}], ",", "j"}], "t"], 
     SubscriptBox["n", 
      RowBox[{"f", ",", "0"}]]]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"\[CapitalDelta]t", "/", 
       SqrtBox[
        SubscriptBox["g", 
         RowBox[{"i", ",", "j"}]]]}], 
      RowBox[{"12", 
       SuperscriptBox["\[CapitalDelta]x", "1"]}]]}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SqrtBox[
        SubscriptBox["g", 
         RowBox[{
          RowBox[{"i", "-", "2"}], ",", "j"}]]], 
       SubsuperscriptBox["V", 
        RowBox[{"f", ";", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
        RowBox[{
         RowBox[{"1", ";", 
          RowBox[{"i", "-", "2"}]}], ",", "j"}]]}], "-", 
      RowBox[{"8", 
       SqrtBox[
        SubscriptBox["g", 
         RowBox[{
          RowBox[{"i", "-", "1"}], ",", "j"}]]], 
       SubsuperscriptBox["V", 
        RowBox[{"f", ";", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
        RowBox[{
         RowBox[{"1", ";", 
          RowBox[{"i", "-", "1"}]}], ",", "j"}]]}], "+", 
      RowBox[{"8", 
       SqrtBox[
        SubscriptBox["g", 
         RowBox[{
          RowBox[{"i", "+", "1"}], ",", "j"}]]], 
       SubsuperscriptBox["V", 
        RowBox[{"f", ";", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
        RowBox[{
         RowBox[{"1", ";", 
          RowBox[{"i", "+", "1"}]}], ",", "j"}]]}], "-", 
      RowBox[{
       SqrtBox[
        SubscriptBox["g", 
         RowBox[{
          RowBox[{"i", "+", "2"}], ",", "j"}]]], 
       SubsuperscriptBox["V", 
        RowBox[{"f", ";", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
        RowBox[{
         RowBox[{"1", ";", 
          RowBox[{"i", "+", "2"}]}], ",", "j"}]]}]}], ")"}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"\[CapitalDelta]t", "/", 
       SqrtBox[
        SubscriptBox["g", 
         RowBox[{"i", ",", "j"}]]]}], 
      RowBox[{"12", 
       SuperscriptBox["\[CapitalDelta]x", "2"]}]]}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SqrtBox[
        SubscriptBox["g", 
         RowBox[{"i", ",", 
          RowBox[{"j", "-", "2"}]}]]], 
       SubsuperscriptBox["V", 
        RowBox[{"f", ";", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
        RowBox[{
         RowBox[{"2", ";", "i"}], ",", 
         RowBox[{"j", "-", "2"}]}]]}], "-", 
      RowBox[{"8", 
       SqrtBox[
        SubscriptBox["g", 
         RowBox[{"i", ",", 
          RowBox[{"j", "-", "1"}]}]]], 
       SubsuperscriptBox["V", 
        RowBox[{"f", ";", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
        RowBox[{
         RowBox[{"2", ";", "i"}], ",", 
         RowBox[{"j", "-", "1"}]}]]}], "+", 
      RowBox[{"8", 
       SqrtBox[
        SubscriptBox["g", 
         RowBox[{"i", ",", 
          RowBox[{"j", "+", "1"}]}]]], 
       SubsuperscriptBox["V", 
        RowBox[{"f", ";", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
        RowBox[{
         RowBox[{"2", ";", "i"}], ",", 
         RowBox[{"j", "+", "1"}]}]]}], "-", 
      RowBox[{
       SqrtBox[
        SubscriptBox["g", 
         RowBox[{"i", ",", 
          RowBox[{"j", "+", "2"}]}]]], 
       SubsuperscriptBox["V", 
        RowBox[{"f", ";", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
        RowBox[{
         RowBox[{"2", ";", "i"}], ",", 
         RowBox[{"j", "+", "2"}]}]]}]}], ")"}]}], TraditionalForm]}],
  ExpressionUUID->"e12c01a6-db96-42f5-95b7-a037c550dde5"]
}], "Text",ExpressionUUID->"dc97685c-bdbc-43a6-a0bb-711e3072f802"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Position update", "Subsubsection",ExpressionUUID->"371ad179-8aa9-4123-bd48-b786e6c6f78d"],

Cell[TextData[{
 "Cartesian to curvilinear:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SuperscriptBox["v", "1"]},
       {
        SuperscriptBox["v", "2"]},
       {
        SuperscriptBox["v", "3"]}
      }], ")"}], "=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         RowBox[{
          SubscriptBox["v", "x"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "x"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"]}]}], "+", 
         RowBox[{
          SubscriptBox["v", "y"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "y"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"]}]}], "+", 
         RowBox[{
          SubscriptBox["v", "z"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "z"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"]}]}]}]},
       {
        RowBox[{
         RowBox[{
          SubscriptBox["v", "x"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "x"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"]}]}], "+", 
         RowBox[{
          SubscriptBox["v", "y"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "y"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"]}]}], "+", 
         RowBox[{
          SubscriptBox["v", "z"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "z"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"]}]}]}]},
       {
        RowBox[{
         RowBox[{
          SubscriptBox["v", "x"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "x"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"]}]}], "+", 
         RowBox[{
          SubscriptBox["v", "y"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "y"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"]}]}], "+", 
         RowBox[{
          SubscriptBox["v", "z"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "z"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"]}]}]}]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "b1e8ad5a-ba8a-4be3-88bd-ce2c8fafed84"]
}], "Text",ExpressionUUID->"d4bd98e6-bc8d-4c06-9462-f153b84ae9d9"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["x", 
     RowBox[{"t", "+", "\[CapitalDelta]t"}], "1"], "=", 
    RowBox[{
     SubsuperscriptBox["x", "t", "1"], "+", 
     RowBox[{"\[CapitalDelta]t", " ", 
      SubsuperscriptBox["v", 
       RowBox[{"t", "+", 
        RowBox[{"\[CapitalDelta]t", "/", "2"}]}], "1"]}]}]}], 
   TraditionalForm]],ExpressionUUID->"0fe803af-992a-42fd-8a3c-50f0684836dd"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["x", 
     RowBox[{"t", "+", "\[CapitalDelta]t"}], "2"], "=", 
    RowBox[{
     SubsuperscriptBox["x", "t", "2"], "+", 
     RowBox[{"\[CapitalDelta]t", " ", 
      SubsuperscriptBox["v", 
       RowBox[{"t", "+", 
        RowBox[{"\[CapitalDelta]t", "/", "2"}]}], "2"]}]}]}], 
   TraditionalForm]],ExpressionUUID->"83b1ac68-63c8-4071-b83d-c7f8cda2e446"],
 "."
}], "Text",ExpressionUUID->"e176e514-7268-48b2-8886-6145a6a64883"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Velocity update in cartesian coordinate", "Subsubsection",ExpressionUUID->"89ac2bf6-54bc-4121-9438-9b0a318cfecb"],

Cell[TextData[{
 "Step 0 - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         SubscriptBox["\[CapitalXi]", "x"], "[", 
         RowBox[{
          SubsuperscriptBox["x", "t", "1"], ",", 
          SubsuperscriptBox["x", "t", "2"]}], "]"}]},
       {
        RowBox[{
         SubscriptBox["\[CapitalXi]", "y"], "[", 
         RowBox[{
          SubsuperscriptBox["x", "t", "1"], ",", 
          SubsuperscriptBox["x", "t", "2"]}], "]"}]},
       {
        RowBox[{
         SubscriptBox["\[CapitalXi]", "z"], "[", 
         RowBox[{
          SubsuperscriptBox["x", "t", "1"], ",", 
          SubsuperscriptBox["x", "t", "2"]}], "]"}]}
      }], ")"}], "=", 
    RowBox[{
     SubscriptBox["\[Sum]", 
      RowBox[{"i", ",", "j"}]], 
     RowBox[{
      RowBox[{"(", GridBox[{
         {
          SubsuperscriptBox["\[CapitalXi]", 
           RowBox[{
            RowBox[{"x", ";", "i"}], ",", "j"}], "t"]},
         {
          SubsuperscriptBox["\[CapitalXi]", 
           RowBox[{
            RowBox[{"y", ";", "i"}], ",", "j"}], "t"]},
         {
          SubsuperscriptBox["\[CapitalXi]", 
           RowBox[{
            RowBox[{"z", ";", "i"}], ",", "j"}], "t"]}
        }], ")"}], 
      RowBox[{"S", "[", 
       RowBox[{
        SubsuperscriptBox["x", "t", "1"], "-", 
        SuperscriptBox["x", 
         RowBox[{"1", ";", "i"}]]}], "]"}], 
      RowBox[{"S", "[", 
       RowBox[{
        SubsuperscriptBox["x", "t", "2"], "-", 
        SuperscriptBox["x", 
         RowBox[{"2", ";", "j"}]]}], "]"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"e4f057e2-5f46-4c55-b9da-bd6d8e31ef90"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         SubscriptBox["\[CapitalOmega]", "x"], "[", 
         RowBox[{
          SubsuperscriptBox["x", "t", "1"], ",", 
          SubsuperscriptBox["x", "t", "2"]}], "]"}]},
       {
        RowBox[{
         SubscriptBox["\[CapitalOmega]", "y"], "[", 
         RowBox[{
          SubsuperscriptBox["x", "t", "1"], ",", 
          SubsuperscriptBox["x", "t", "2"]}], "]"}]},
       {
        RowBox[{
         SubscriptBox["\[CapitalOmega]", "z"], "[", 
         RowBox[{
          SubsuperscriptBox["x", "t", "1"], ",", 
          SubsuperscriptBox["x", "t", "2"]}], "]"}]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         RowBox[{
          SubsuperscriptBox["\[CapitalOmega]", "x", "0"], "[", 
          RowBox[{
           SubsuperscriptBox["x", "t", "1"], ",", 
           SubsuperscriptBox["x", "t", "2"]}], "]"}]},
        {
         RowBox[{
          SubsuperscriptBox["\[CapitalOmega]", "y", "0"], "[", 
          RowBox[{
           SubsuperscriptBox["x", "t", "1"], ",", 
           SubsuperscriptBox["x", "t", "2"]}], "]"}]},
        {
         RowBox[{
          SubsuperscriptBox["\[CapitalOmega]", "z", "0"], "[", 
          RowBox[{
           SubsuperscriptBox["x", "t", "1"], ",", 
           SubsuperscriptBox["x", "t", "2"]}], "]"}]}
       }], ")"}], "+", 
     RowBox[{
      SubscriptBox["\[Sum]", 
       RowBox[{"i", ",", "j"}]], 
      RowBox[{
       RowBox[{"(", GridBox[{
          {
           SubsuperscriptBox["\[Delta]\[CapitalOmega]", 
            RowBox[{
             RowBox[{"x", ";", "i"}], ",", "j"}], "t"]},
          {
           SubsuperscriptBox["\[Delta]\[CapitalOmega]", 
            RowBox[{
             RowBox[{"y", ";", "i"}], ",", "j"}], "t"]},
          {
           SubsuperscriptBox["\[Delta]\[CapitalOmega]", 
            RowBox[{
             RowBox[{"z", ";", "i"}], ",", "j"}], "t"]}
         }], ")"}], 
       RowBox[{"S", "[", 
        RowBox[{
         SubsuperscriptBox["x", "t", "1"], "-", 
         RowBox[{
          SuperscriptBox["\[CapitalDelta]x", "1"], "/", "2"}], "-", 
         SuperscriptBox["x", 
          RowBox[{"1", ";", "i"}]]}], "]"}], 
       RowBox[{"S", "[", 
        RowBox[{
         SubsuperscriptBox["x", "t", "2"], "-", 
         RowBox[{
          SuperscriptBox["\[CapitalDelta]x", "2"], "/", "2"}], "-", 
         SuperscriptBox["x", 
          RowBox[{"2", ";", "j"}]]}], "]"}]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"749adacb-6d77-4c6f-b0b0-995ced2a5596"],
 ",\nStep 1 - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["v", "x", "-"]},
       {
        SubsuperscriptBox["v", "y", "-"]},
       {
        SubsuperscriptBox["v", "z", "-"]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["v", "x", 
          RowBox[{"t", "-", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]},
        {
         SubsuperscriptBox["v", "y", 
          RowBox[{"t", "-", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]},
        {
         SubsuperscriptBox["v", "z", 
          RowBox[{"t", "-", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}
       }], ")"}], "+", 
     RowBox[{
      FractionBox[
       SubscriptBox["\[CapitalOmega]", "s"], 
       SubscriptBox["\[CapitalOmega]", "0"]], 
      FractionBox[
       RowBox[{"c", " ", "\[CapitalDelta]t"}], "2"], 
      RowBox[{"(", GridBox[{
         {
          SubsuperscriptBox["\[CapitalXi]", "x", "t"]},
         {
          SubsuperscriptBox["\[CapitalXi]", "y", "t"]},
         {
          SubsuperscriptBox["\[CapitalXi]", "z", "t"]}
        }], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "3f49118f-0f99-4a47-96ea-242daab47c76"],
 ",\nStep 2 - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["v", "x", "0"]},
       {
        SubsuperscriptBox["v", "y", "0"]},
       {
        SubsuperscriptBox["v", "z", "0"]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["v", "x", "-"]},
        {
         SubsuperscriptBox["v", "y", "-"]},
        {
         SubsuperscriptBox["v", "z", "-"]}
       }], ")"}], "+", 
     RowBox[{
      FractionBox[
       SubscriptBox["\[CapitalOmega]", "s"], 
       SubscriptBox["\[CapitalOmega]", "0"]], 
      FractionBox["\[CapitalDelta]t", "2"], 
      RowBox[{"(", GridBox[{
         {
          RowBox[{
           RowBox[{
            SubsuperscriptBox["v", "y", "-"], 
            SubsuperscriptBox["\[CapitalOmega]", "z", "t"]}], "-", 
           RowBox[{
            SubsuperscriptBox["v", "z", "-"], 
            SubsuperscriptBox["\[CapitalOmega]", "y", "t"]}]}]},
         {
          RowBox[{
           RowBox[{
            SubsuperscriptBox["v", "z", "-"], 
            SubsuperscriptBox["\[CapitalOmega]", "x", "t"]}], "-", 
           RowBox[{
            SubsuperscriptBox["v", "x", "-"], 
            SubsuperscriptBox["\[CapitalOmega]", "z", "t"]}]}]},
         {
          RowBox[{
           RowBox[{
            SubsuperscriptBox["v", "x", "-"], 
            SubsuperscriptBox["\[CapitalOmega]", "y", "t"]}], "-", 
           RowBox[{
            SubsuperscriptBox["v", "y", "-"], 
            SubsuperscriptBox["\[CapitalOmega]", "x", "t"]}]}]}
        }], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "a9a30a32-d523-4e03-904e-0242176670b2"],
 ",\nStep 3 - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["v", "x", "+"]},
       {
        SubsuperscriptBox["v", "y", "+"]},
       {
        SubsuperscriptBox["v", "z", "+"]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["v", "x", "-"]},
        {
         SubsuperscriptBox["v", "y", "-"]},
        {
         SubsuperscriptBox["v", "z", "-"]}
       }], ")"}], "+", 
     RowBox[{
      FractionBox[
       SubscriptBox["\[CapitalOmega]", "s"], 
       SubscriptBox["\[CapitalOmega]", "0"]], 
      FractionBox["\[CapitalDelta]t", "2"], 
      FractionBox["2", 
       RowBox[{"1", "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             SubscriptBox["\[CapitalOmega]", "s"], 
             SubscriptBox["\[CapitalOmega]", "0"]], 
            FractionBox["\[CapitalDelta]t", "2"]}], ")"}], "2"], 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             SubsuperscriptBox["\[CapitalOmega]", "x", "t"], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             SubsuperscriptBox["\[CapitalOmega]", "y", "t"], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             SubsuperscriptBox["\[CapitalOmega]", "z", "t"], ")"}], "2"]}], 
          ")"}]}]}]], 
      RowBox[{"(", GridBox[{
         {
          RowBox[{
           RowBox[{
            SubsuperscriptBox["v", "y", "0"], 
            SubsuperscriptBox["\[CapitalOmega]", "z", "t"]}], "-", 
           RowBox[{
            SubsuperscriptBox["v", "z", "0"], 
            SubsuperscriptBox["\[CapitalOmega]", "y", "t"]}]}]},
         {
          RowBox[{
           RowBox[{
            SubsuperscriptBox["v", "z", "0"], 
            SubsuperscriptBox["\[CapitalOmega]", "x", "t"]}], "-", 
           RowBox[{
            SubsuperscriptBox["v", "x", "0"], 
            SubsuperscriptBox["\[CapitalOmega]", "z", "t"]}]}]},
         {
          RowBox[{
           RowBox[{
            SubsuperscriptBox["v", "x", "0"], 
            SubsuperscriptBox["\[CapitalOmega]", "y", "t"]}], "-", 
           RowBox[{
            SubsuperscriptBox["v", "y", "0"], 
            SubsuperscriptBox["\[CapitalOmega]", "x", "t"]}]}]}
        }], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "5b5aa7d2-d0d7-4195-b2c8-dba0b8536293"],
 ", and\nStep 4 - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["v", "x", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]},
       {
        SubsuperscriptBox["v", "y", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]},
       {
        SubsuperscriptBox["v", "z", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["v", "x", "+"]},
        {
         SubsuperscriptBox["v", "y", "+"]},
        {
         SubsuperscriptBox["v", "z", "+"]}
       }], ")"}], "+", 
     RowBox[{
      FractionBox[
       SubscriptBox["\[CapitalOmega]", "s"], 
       SubscriptBox["\[CapitalOmega]", "0"]], 
      FractionBox[
       RowBox[{"c", " ", "\[CapitalDelta]t"}], "2"], 
      RowBox[{"(", GridBox[{
         {
          SubsuperscriptBox["\[CapitalXi]", "x", "t"]},
         {
          SubsuperscriptBox["\[CapitalXi]", "y", "t"]},
         {
          SubsuperscriptBox["\[CapitalXi]", "z", "t"]}
        }], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "6de718ce-0b51-4aae-ae07-52ef74c290ec"],
 "."
}], "Text",ExpressionUUID->"be81b364-834e-47ae-bb10-f0b168d8837d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Moments: from particle to grid", "Subsubsection",ExpressionUUID->"98ccbfc0-4eda-4fe5-96cd-5594d4529875"],

Cell[TextData[{
 "Number density (zeroth velocity moment) at ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],ExpressionUUID->
  "8636098a-f2d3-4fe1-8dfe-c33b9012ff9e"],
 "th grid point:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["n", 
     RowBox[{"t", ";", "s"}], 
     RowBox[{"i", ",", "j"}]], "=", 
    RowBox[{
     RowBox[{
      SubsuperscriptBox["n", 
       RowBox[{"0", ";", "s"}], 
       RowBox[{"i", ",", "j"}]], 
      FractionBox[
       RowBox[{
        SubscriptBox["\[Sum]", "p"], 
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{
           SubsuperscriptBox["x", 
            RowBox[{"t", ";", "s"}], 
            RowBox[{"1", ";", "p"}]], "-", 
           SuperscriptBox["x", 
            RowBox[{"1", ";", "i"}]]}], "]"}], 
         RowBox[{"S", "[", 
          RowBox[{
           SubsuperscriptBox["x", 
            RowBox[{"t", ";", "s"}], 
            RowBox[{"2", ";", "p"}]], "-", 
           SuperscriptBox["x", 
            RowBox[{"2", ";", "j"}]]}], "]"}]}]}], 
       SubsuperscriptBox["N", 
        RowBox[{"c", ";", "s"}], 
        RowBox[{
         RowBox[{"0", ";", "i"}], ",", "j"}]]]}], "=", 
     RowBox[{
      SubscriptBox["n", 
       RowBox[{"0", ";", "s"}]], 
      FractionBox[
       RowBox[{
        SubscriptBox["\[Sum]", "p"], 
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{
           SubsuperscriptBox["x", 
            RowBox[{"t", ";", "s"}], 
            RowBox[{"1", ";", "p"}]], "-", 
           SuperscriptBox["x", 
            RowBox[{"1", ";", "i"}]]}], "]"}], 
         RowBox[{"S", "[", 
          RowBox[{
           SubsuperscriptBox["x", 
            RowBox[{"t", ";", "s"}], 
            RowBox[{"2", ";", "p"}]], "-", 
           SuperscriptBox["x", 
            RowBox[{"2", ";", "j"}]]}], "]"}]}]}], 
       SubscriptBox["N", 
        RowBox[{"c", ";", "s"}]]]}]}]}], TraditionalForm]],ExpressionUUID->
  "45be1acf-bdc8-4e32-9ff9-a55dd664633b"],
 ", where ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["N", 
    RowBox[{"c", ";", "s"}], "0"], TraditionalForm]],ExpressionUUID->
  "e98fdfa6-a355-4321-a70e-2a8538770ac3"],
 " is the initial number of simulation particles of species ",
 Cell[BoxData[
  FormBox["s", TraditionalForm]],ExpressionUUID->
  "42564a84-60ff-49ad-b130-f58003e7c819"],
 " at a reference cell; ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", 
    RowBox[{"0", ";", "s"}]], TraditionalForm]],ExpressionUUID->
  "8f9e23a2-55b7-4553-b6dd-6bd81ac3cc2a"],
 " is the initial number density of the species ",
 Cell[BoxData[
  FormBox["s", TraditionalForm]],ExpressionUUID->
  "5b7cd48f-599e-4868-a4f0-cbf871259c7f"],
 " at that cell; ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["N", 
    RowBox[{"c", ";", "s"}], 
    RowBox[{
     RowBox[{"0", ";", "i"}], ",", "j"}]], TraditionalForm]],ExpressionUUID->
  "49dba9bd-ca44-4fb7-82fe-0e71cf7abb1d"],
 " is the initial number of simulation particles at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["q", "i"], ",", 
     SuperscriptBox["q", "j"]}], ")"}], TraditionalForm]],ExpressionUUID->
  "43a4f5a1-b217-4524-8a43-af392d4bc995"],
 " cell; and ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["n", 
    RowBox[{"0", ";", "s"}], 
    RowBox[{"i", ",", "j"}]], TraditionalForm]],ExpressionUUID->
  "02505e43-8afb-4ef2-8d55-a4b9298d1798"],
 " is the initial number density at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["q", "i"], ",", 
     SuperscriptBox["q", "j"]}], ")"}], TraditionalForm]],ExpressionUUID->
  "e3224c95-71be-4837-95e1-6c6a29753d45"],
 " cell.\nCharge density at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["q", "i"], ",", 
     SuperscriptBox["q", "j"]}], ")"}], TraditionalForm]],ExpressionUUID->
  "181a263e-ea7f-446d-a058-7ebd6bbd18bd"],
 " cell is:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["\[CapitalPi]", "t", 
     RowBox[{"i", ",", "j"}]], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Sum]", "s"], 
      RowBox[{
       FractionBox[
        SubscriptBox["\[CapitalOmega]", "0"], 
        SubscriptBox["\[CapitalOmega]", "s"]], 
       SubsuperscriptBox["\[Omega]", 
        RowBox[{
         RowBox[{"s", ";", "i"}], ",", "j"}], "2"], 
       FractionBox[
        RowBox[{
         SubscriptBox["\[Sum]", "p"], 
         RowBox[{
          RowBox[{"S", "[", 
           RowBox[{
            SubsuperscriptBox["x", 
             RowBox[{"t", ";", "s"}], 
             RowBox[{"1", ";", "p"}]], "-", 
            SuperscriptBox["x", 
             RowBox[{"1", ";", "i"}]]}], "]"}], 
          RowBox[{"S", "[", 
           RowBox[{
            SubsuperscriptBox["x", 
             RowBox[{"t", ";", "s"}], 
             RowBox[{"2", ";", "p"}]], "-", 
            SuperscriptBox["x", 
             RowBox[{"2", ";", "j"}]]}], "]"}]}]}], 
        SubsuperscriptBox["N", 
         RowBox[{"c", ";", "s"}], 
         RowBox[{
          RowBox[{"0", ";", "i"}], ",", "j"}]]]}]}], "=", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Sum]", "s"], 
       RowBox[{
        FractionBox[
         SubscriptBox["\[CapitalOmega]", "0"], 
         SubscriptBox["\[CapitalOmega]", "s"]], 
        SubsuperscriptBox["\[Omega]", 
         RowBox[{"s", ";", "0"}], "2"], 
        FractionBox[
         RowBox[{
          SubscriptBox["\[Sum]", "p"], 
          RowBox[{
           RowBox[{"S", "[", 
            RowBox[{
             SubsuperscriptBox["x", 
              RowBox[{"t", ";", "s"}], 
              RowBox[{"1", ";", "p"}]], "-", 
             SuperscriptBox["x", 
              RowBox[{"1", ";", "i"}]]}], "]"}], 
           RowBox[{"S", "[", 
            RowBox[{
             SubsuperscriptBox["x", 
              RowBox[{"t", ";", "s"}], 
              RowBox[{"2", ";", "p"}]], "-", 
             SuperscriptBox["x", 
              RowBox[{"2", ";", "j"}]]}], "]"}]}]}], 
         SubsuperscriptBox["N", 
          RowBox[{"c", ";", "s"}], "0"]]}]}], "=", 
      RowBox[{
       SubscriptBox["\[Sum]", "s"], 
       RowBox[{
        FractionBox[
         SubscriptBox["\[CapitalOmega]", "0"], 
         SubscriptBox["\[CapitalOmega]", "s"]], 
        SubsuperscriptBox["\[Omega]", 
         RowBox[{"s", ";", "0"}], "2"], 
        FractionBox[
         SubsuperscriptBox["n", 
          RowBox[{"t", ";", "s"}], 
          RowBox[{"i", ",", "j"}]], 
         SubscriptBox["n", 
          RowBox[{"0", ";", "s"}]]]}]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"d834675a-a36e-4b8e-99af-cd46655b8c78"],
 ",\nwhere ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Omega]", 
    RowBox[{"s", ";", "0"}]], TraditionalForm]],ExpressionUUID->
  "7c8b5d4b-080c-48e0-bae5-ccae3090f768"],
 " is the initial plasma frequency at the reference cell; and ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[Omega]", 
    RowBox[{
     RowBox[{"s", ";", "i"}], ",", "j"}], "2"], TraditionalForm]],
  ExpressionUUID->"8c7ea9ef-4fc2-48ab-9c86-13b824500abf"],
 " is the initial plasma frequency at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["q", "i"], ",", 
     SuperscriptBox["q", "j"]}], ")"}], TraditionalForm]],ExpressionUUID->
  "5028fc60-0a50-4ac6-bc39-df193e409c4d"],
 " cell."
}], "Text",ExpressionUUID->"00d5de90-68ea-44e8-b25c-e078a7294345"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Nc", "=", "100"}], ",", 
     RowBox[{"Nx", "=", "2"}], ",", 
     RowBox[{"n0", "=", "1."}], ",", 
     RowBox[{"S", "=", 
      RowBox[{"Function", "[", 
       RowBox[{"x", 
        RowBox[{"(*", 
         RowBox[{"0", "\[LessEqual]", "x", "\[LessEqual]", "1"}], "*)"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "-", "x"}], ",", "x"}], "}"}], "//", "N"}]}], 
       "]"}]}]}], "}"}], ",", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"x", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", 
         RowBox[{"Nc", "*", "Nx"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Plus", "@@@", 
         RowBox[{"S", "[", "x", "]"}]}], ")"}], "/", "Nc"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "]"}]], "Input",ExpressionUUID->"9182bf70-\
3ed0-4026-a43b-96e67113f93c"],

Cell[TextData[{
 "Average flow speed weighted by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["n", 
     RowBox[{"t", ";", "s"}], 
     RowBox[{"i", ",", "j"}]], "/", 
    SubscriptBox["n", 
     RowBox[{"0", ";", "s"}]]}], TraditionalForm]],ExpressionUUID->
  "8eb2d1db-6bd2-40ea-ae3d-2c5ed461861b"],
 ":\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["V", 
         RowBox[{
          RowBox[{"x", ";", "i"}], ",", "j"}], 
         RowBox[{"t", ";", "s"}]]},
       {
        SubsuperscriptBox["V", 
         RowBox[{
          RowBox[{"y", ";", "i"}], ",", "j"}], 
         RowBox[{"t", ";", "s"}]]},
       {
        SubsuperscriptBox["V", 
         RowBox[{
          RowBox[{"z", ";", "i"}], ",", "j"}], 
         RowBox[{"t", ";", "s"}]]}
      }], ")"}], "=", 
    RowBox[{
     SubscriptBox["\[Sum]", "p"], 
     RowBox[{
      RowBox[{"(", GridBox[{
         {
          SubsuperscriptBox["v", 
           RowBox[{"x", ";", "p"}], 
           RowBox[{"t", ";", "s"}]]},
         {
          SubsuperscriptBox["v", 
           RowBox[{"y", ";", "p"}], 
           RowBox[{"t", ";", "s"}]]},
         {
          SubsuperscriptBox["v", 
           RowBox[{"z", ";", "p"}], 
           RowBox[{"t", ";", "s"}]]}
        }], ")"}], 
      FractionBox[
       RowBox[{
        RowBox[{"S", "[", 
         RowBox[{
          SubsuperscriptBox["x", 
           RowBox[{"t", ";", "s"}], 
           RowBox[{"1", ";", "p"}]], "-", 
          SuperscriptBox["x", 
           RowBox[{"1", ";", "i"}]]}], "]"}], 
        RowBox[{"S", "[", 
         RowBox[{
          SubsuperscriptBox["x", 
           RowBox[{"t", ";", "s"}], 
           RowBox[{"2", ";", "p"}]], "-", 
          SuperscriptBox["x", 
           RowBox[{"2", ";", "j"}]]}], "]"}]}], 
       SubsuperscriptBox["N", 
        RowBox[{"c", ";", "s"}], "0"]]}]}]}], TraditionalForm]],
  ExpressionUUID->"2d49da6b-df58-49b6-bb8a-acd8ce322e18"],
 "\nAverage flow speed is given by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["V", 
         RowBox[{
          RowBox[{"x", ";", "i"}], ",", "j"}], 
         RowBox[{"t", ";", "s"}]]},
       {
        SubsuperscriptBox["V", 
         RowBox[{
          RowBox[{"y", ";", "i"}], ",", "j"}], 
         RowBox[{"t", ";", "s"}]]},
       {
        SubsuperscriptBox["V", 
         RowBox[{
          RowBox[{"z", ";", "i"}], ",", "j"}], 
         RowBox[{"t", ";", "s"}]]}
      }], ")"}], "/", 
    FractionBox[
     SubsuperscriptBox["n", 
      RowBox[{"t", ";", "s"}], 
      RowBox[{"i", ",", "j"}]], 
     SubscriptBox["n", 
      RowBox[{"0", ";", "s"}]]]}], TraditionalForm]],ExpressionUUID->
  "d61afad0-1650-4c5d-b931-f3a8837db8f4"],
 ".\nCurrent density:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["\[ScriptCapitalJ]", 
         RowBox[{
          RowBox[{"x", ";", "i"}], ",", "j"}], 
         RowBox[{"t", ";", "s"}]]},
       {
        SubsuperscriptBox["\[ScriptCapitalJ]", 
         RowBox[{
          RowBox[{"y", ";", "i"}], ",", "j"}], 
         RowBox[{"t", ";", "s"}]]},
       {
        SubsuperscriptBox["\[ScriptCapitalJ]", 
         RowBox[{
          RowBox[{"z", ";", "i"}], ",", "j"}], 
         RowBox[{"t", ";", "s"}]]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{
      FractionBox[
       SubscriptBox["\[CapitalOmega]", "0"], 
       SubscriptBox["\[CapitalOmega]", "s"]], 
      FractionBox[
       SubsuperscriptBox["\[Omega]", 
        RowBox[{
         RowBox[{"s", ";", "i"}], ",", "j"}], "2"], "c"], 
      RowBox[{
       SubscriptBox["\[Sum]", "p"], 
       RowBox[{
        RowBox[{"(", GridBox[{
           {
            SubsuperscriptBox["v", 
             RowBox[{"x", ";", "p"}], 
             RowBox[{"t", ";", "s"}]]},
           {
            SubsuperscriptBox["v", 
             RowBox[{"y", ";", "p"}], 
             RowBox[{"t", ";", "s"}]]},
           {
            SubsuperscriptBox["v", 
             RowBox[{"z", ";", "p"}], 
             RowBox[{"t", ";", "s"}]]}
          }], ")"}], 
        FractionBox[
         RowBox[{
          RowBox[{"S", "[", 
           RowBox[{
            SubsuperscriptBox["x", 
             RowBox[{"t", ";", "s"}], 
             RowBox[{"1", ";", "p"}]], "-", 
            SuperscriptBox["x", 
             RowBox[{"1", ";", "i"}]]}], "]"}], 
          RowBox[{"S", "[", 
           RowBox[{
            SubsuperscriptBox["x", 
             RowBox[{"t", ";", "s"}], 
             RowBox[{"2", ";", "p"}]], "-", 
            SuperscriptBox["x", 
             RowBox[{"2", ";", "j"}]]}], "]"}]}], 
         SubsuperscriptBox["N", 
          RowBox[{"c", ";", "s"}], 
          RowBox[{
           RowBox[{"0", ";", "i"}], ",", "j"}]]]}]}]}], "=", 
     RowBox[{
      RowBox[{
       FractionBox[
        SubscriptBox["\[CapitalOmega]", "0"], 
        SubscriptBox["\[CapitalOmega]", "s"]], 
       FractionBox[
        SubsuperscriptBox["\[Omega]", 
         RowBox[{"s", ";", "0"}], "2"], "c"], 
       RowBox[{
        SubscriptBox["\[Sum]", "p"], 
        RowBox[{
         RowBox[{"(", GridBox[{
            {
             SubsuperscriptBox["v", 
              RowBox[{"x", ";", "p"}], 
              RowBox[{"t", ";", "s"}]]},
            {
             SubsuperscriptBox["v", 
              RowBox[{"y", ";", "p"}], 
              RowBox[{"t", ";", "s"}]]},
            {
             SubsuperscriptBox["v", 
              RowBox[{"z", ";", "p"}], 
              RowBox[{"t", ";", "s"}]]}
           }], ")"}], 
         FractionBox[
          RowBox[{
           RowBox[{"S", "[", 
            RowBox[{
             SubsuperscriptBox["x", 
              RowBox[{"t", ";", "s"}], 
              RowBox[{"1", ";", "p"}]], "-", 
             SuperscriptBox["x", 
              RowBox[{"1", ";", "i"}]]}], "]"}], 
           RowBox[{"S", "[", 
            RowBox[{
             SubsuperscriptBox["x", 
              RowBox[{"t", ";", "s"}], 
              RowBox[{"2", ";", "p"}]], "-", 
             SuperscriptBox["x", 
              RowBox[{"2", ";", "j"}]]}], "]"}]}], 
          SubsuperscriptBox["N", 
           RowBox[{"c", ";", "s"}], "0"]]}]}]}], "=", 
      RowBox[{
       FractionBox[
        SubscriptBox["\[CapitalOmega]", "0"], 
        SubscriptBox["\[CapitalOmega]", "s"]], 
       FractionBox[
        SubsuperscriptBox["\[Omega]", 
         RowBox[{"s", ";", "0"}], "2"], "c"], 
       RowBox[{"(", GridBox[{
          {
           SubsuperscriptBox["V", 
            RowBox[{
             RowBox[{"x", ";", "i"}], ",", "j"}], 
            RowBox[{"t", ";", "s"}]]},
          {
           SubsuperscriptBox["V", 
            RowBox[{
             RowBox[{"y", ";", "i"}], ",", "j"}], 
            RowBox[{"t", ";", "s"}]]},
          {
           SubsuperscriptBox["V", 
            RowBox[{
             RowBox[{"z", ";", "i"}], ",", "j"}], 
            RowBox[{"t", ";", "s"}]]}
         }], ")"}]}]}]}]}], TraditionalForm]],ExpressionUUID->
  "6c0c12c4-33ae-4f00-bf16-c8ad2f93732a"],
 "\nCartesian to curvilinear:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SuperscriptBox["\[ScriptCapitalJ]", "1"]},
       {
        SuperscriptBox["\[ScriptCapitalJ]", "2"]},
       {
        SuperscriptBox["\[ScriptCapitalJ]", "3"]}
      }], ")"}], "=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         RowBox[{
          SubscriptBox["\[ScriptCapitalJ]", "x"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "x"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"]}]}], "+", 
         RowBox[{
          SubscriptBox["\[ScriptCapitalJ]", "y"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "y"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"]}]}], "+", 
         RowBox[{
          SubscriptBox["\[ScriptCapitalJ]", "z"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "z"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"]}]}]}]},
       {
        RowBox[{
         RowBox[{
          SubscriptBox["\[ScriptCapitalJ]", "x"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "x"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"]}]}], "+", 
         RowBox[{
          SubscriptBox["\[ScriptCapitalJ]", "y"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "y"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"]}]}], "+", 
         RowBox[{
          SubscriptBox["\[ScriptCapitalJ]", "z"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "z"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"]}]}]}]},
       {
        RowBox[{
         RowBox[{
          SubscriptBox["\[ScriptCapitalJ]", "x"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "x"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"]}]}], "+", 
         RowBox[{
          SubscriptBox["\[ScriptCapitalJ]", "y"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "y"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"]}]}], "+", 
         RowBox[{
          SubscriptBox["\[ScriptCapitalJ]", "z"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "z"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"]}]}]}]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "2d8e4460-0f41-4628-b94c-ed51808e8066"]
}], "Text",ExpressionUUID->"08de6e68-6832-4afd-8303-0173c6d708d4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "icdf", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"icdf", ":=", 
  RowBox[{"icdf", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"cdf", "=", 
        RowBox[{"Function", "[", 
         RowBox[{"v", ",", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             RowBox[{"2", " ", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"-", 
                SuperscriptBox["v", "2"]}]], " ", "v"}], 
             SqrtBox["\[Pi]"]]}], "+", 
           RowBox[{"Erf", "[", "v", "]"}]}]}], "]"}]}], ",", 
       RowBox[{"n", "=", "1000"}], ",", 
       RowBox[{"vmax", "=", "4."}]}], "}"}], ",", 
     RowBox[{"Interpolation", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"cdf", "[", 
           RowBox[{"vmax", " ", 
            RowBox[{"i", "/", "n"}]}], "]"}], ",", 
          RowBox[{"vmax", " ", 
           RowBox[{"i", "/", "n"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "n"}], "}"}]}], "]"}], "]"}]}], 
    "]"}]}]}]}], "Input",ExpressionUUID->"f7387adc-b2c6-4a42-bc32-\
9cfa30b8e50c"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"icdf", "[", "i", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",ExpressionUUID->\
"d0759c65-a16d-4938-92f7-9bdae3a511cd"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Nc", "=", "1000"}], ",", 
     RowBox[{"Nx", "=", "2"}], ",", 
     RowBox[{"n0", "=", "1."}], ",", 
     RowBox[{"\[Theta]", "=", "1."}], ",", 
     RowBox[{"S", "=", 
      RowBox[{"Function", "[", 
       RowBox[{"x", 
        RowBox[{"(*", 
         RowBox[{"0", "\[LessEqual]", "x", "\[LessEqual]", "1"}], "*)"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "-", "x"}], ",", "x"}], "}"}], "//", "N"}]}], 
       "]"}]}]}], "}"}], ",", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "rng", ",", "x", ",", "v", ",", "vx", ",", "vy", ",", "vz", ",", 
       "\[Psi]"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rng", ":=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", 
         RowBox[{"Nc", "*", "Nx"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"x", "=", "rng"}], ";", "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{
        RowBox[{"icdf", "[", "rng", "]"}], "\[Theta]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vx", "=", 
       RowBox[{"v", " ", 
        RowBox[{"(", 
         RowBox[{"\[Psi]", "=", 
          RowBox[{"1", "-", 
           RowBox[{"2", "rng"}]}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"v", " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[Psi]", "2"]}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vy", "=", 
       RowBox[{"v", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Psi]", "=", 
          RowBox[{"2", "\[Pi]", " ", "rng"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vz", "=", 
       RowBox[{"v", " ", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"TableForm", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"v", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"v", "//", "Mean"}], ",", 
             RowBox[{
              RowBox[{"Mean", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Total", "[", 
                    RowBox[{"v", "#"}], "]"}], "&"}], "/@", 
                  RowBox[{"S", "[", "x", "]"}]}], ")"}], "/", "Nc"}], "]"}], 
              "n0"}]}], "}"}]}], "]"}], "/@", 
         RowBox[{"{", 
          RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}]}], ",", 
        RowBox[{"TableHeadings", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SubscriptBox[\(v\), \(x\)]\)\>\"", ",", 
             "\"\<\!\(\*SubscriptBox[\(v\), \(y\)]\)\>\"", ",", 
             "\"\<\!\(\*SubscriptBox[\(v\), \(z\)]\)\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\[LeftAngleBracket]\[DoubleStruckV]\[RightAngleBracket]\>\"",
              ",", "\"\<2nd Mom \[Times] \!\(\*SubsuperscriptBox[\(n\), \
\(s\), \(0\)]\)\>\""}], "}"}]}], "}"}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "]"}]], "Input",ExpressionUUID->"349b68c8-fc43-4719-bf0f-\
c80f44eab938"],

Cell[TextData[{
 "Average second velocity moment weighted by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["n", 
     RowBox[{"t", ";", "s"}], 
     RowBox[{"i", ",", "j"}]], "/", 
    SubscriptBox["n", 
     RowBox[{"0", ";", "s"}]]}], TraditionalForm]],ExpressionUUID->
  "0b4673bf-cf27-4593-9c67-7cf3cc701d8c"],
 ":\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"2", 
      SubscriptBox["\[DoubleStruckW]", "s"]}], 
     SubscriptBox["m", "s"]], "=", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       SubsuperscriptBox["\[DoubleStruckV]", 
        RowBox[{"i", ",", "j"}], 
        RowBox[{"t", ";", "s"}]], 
       SubsuperscriptBox["\[DoubleStruckV]", 
        RowBox[{"i", ",", "j"}], 
        RowBox[{"t", ";", "s"}]]}], "\[RightAngleBracket]"}], "=", 
     RowBox[{
      RowBox[{
       SubsuperscriptBox["n", 
        RowBox[{"0", ";", "s"}], 
        RowBox[{"i", ",", "j"}]], 
       RowBox[{
        SubscriptBox["\[Sum]", "p"], 
        RowBox[{
         SubsuperscriptBox["\[DoubleStruckV]", "p", 
          RowBox[{"t", ";", "s"}]], 
         SubsuperscriptBox["\[DoubleStruckV]", "p", 
          RowBox[{"t", ";", "s"}]], 
         FractionBox[
          RowBox[{
           RowBox[{"S", "[", 
            RowBox[{
             SubsuperscriptBox["x", 
              RowBox[{"t", ";", "s"}], 
              RowBox[{"1", ";", "p"}]], "-", 
             SuperscriptBox["x", 
              RowBox[{"1", ";", "i"}]]}], "]"}], 
           RowBox[{"S", "[", 
            RowBox[{
             SubsuperscriptBox["x", 
              RowBox[{"t", ";", "s"}], 
              RowBox[{"2", ";", "p"}]], "-", 
             SuperscriptBox["x", 
              RowBox[{"2", ";", "j"}]]}], "]"}]}], 
          SubsuperscriptBox["N", 
           RowBox[{"c", ";", "s"}], 
           RowBox[{
            RowBox[{"0", ";", "i"}], ",", "j"}]]]}]}]}], "=", 
      RowBox[{
       SubscriptBox["n", 
        RowBox[{"0", ";", "s"}]], 
       RowBox[{
        SubscriptBox["\[Sum]", "p"], 
        RowBox[{
         SubsuperscriptBox["\[DoubleStruckV]", "p", 
          RowBox[{"t", ";", "s"}]], 
         SubsuperscriptBox["\[DoubleStruckV]", "p", 
          RowBox[{"t", ";", "s"}]], 
         FractionBox[
          RowBox[{
           RowBox[{"S", "[", 
            RowBox[{
             SubsuperscriptBox["x", 
              RowBox[{"t", ";", "s"}], 
              RowBox[{"1", ";", "p"}]], "-", 
             SuperscriptBox["x", 
              RowBox[{"1", ";", "i"}]]}], "]"}], 
           RowBox[{"S", "[", 
            RowBox[{
             SubsuperscriptBox["x", 
              RowBox[{"t", ";", "s"}], 
              RowBox[{"2", ";", "p"}]], "-", 
             SuperscriptBox["x", 
              RowBox[{"2", ";", "j"}]]}], "]"}]}], 
          SubsuperscriptBox["N", 
           RowBox[{"c", ";", "s"}], "0"]]}]}]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"4b2245e6-721b-413b-ab1a-a1b7328406d3"],
 ".\nKinetic energy density (equivalent to pressure):\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["\[CurlyEpsilon]", 
     RowBox[{"i", ",", "j"}], 
     RowBox[{"t", ";", "s"}]], "=", 
    RowBox[{
     RowBox[{
      FractionBox[
       SubsuperscriptBox["\[CapitalOmega]", "0", "2"], 
       SubsuperscriptBox["\[CapitalOmega]", "s", "2"]], 
      FractionBox[
       SubsuperscriptBox["\[Omega]", 
        RowBox[{
         RowBox[{"s", ";", "i"}], ",", "j"}], "2"], 
       SuperscriptBox["c", "2"]], 
      RowBox[{
       SubscriptBox["\[Sum]", "p"], 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"(", GridBox[{
           {
            SubsuperscriptBox["v", 
             RowBox[{"x", ";", "p"}], "2"]},
           {
            SubsuperscriptBox["v", 
             RowBox[{"y", ";", "p"}], "2"]},
           {
            SubsuperscriptBox["v", 
             RowBox[{"z", ";", "p"}], "2"]}
          }], ")"}], 
        FractionBox[
         RowBox[{
          RowBox[{"S", "[", 
           RowBox[{
            SubsuperscriptBox["x", 
             RowBox[{"t", ";", "s"}], 
             RowBox[{"1", ";", "p"}]], "-", 
            SuperscriptBox["x", 
             RowBox[{"1", ";", "i"}]]}], "]"}], 
          RowBox[{"S", "[", 
           RowBox[{
            SubsuperscriptBox["x", 
             RowBox[{"t", ";", "s"}], 
             RowBox[{"2", ";", "p"}]], "-", 
            SuperscriptBox["x", 
             RowBox[{"2", ";", "j"}]]}], "]"}]}], 
         SubsuperscriptBox["N", 
          RowBox[{"c", ";", "s"}], 
          RowBox[{
           RowBox[{"0", ";", "i"}], ",", "j"}]]]}]}]}], "=", 
     RowBox[{
      FractionBox[
       SubsuperscriptBox["\[CapitalOmega]", "0", "2"], 
       SubsuperscriptBox["\[CapitalOmega]", "s", "2"]], 
      FractionBox[
       SubsuperscriptBox["\[Omega]", 
        RowBox[{"s", ";", "0"}], "2"], 
       SuperscriptBox["c", "2"]], 
      RowBox[{
       SubscriptBox["\[Sum]", "p"], 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"(", GridBox[{
           {
            SubsuperscriptBox["v", 
             RowBox[{"x", ";", "p"}], "2"]},
           {
            SubsuperscriptBox["v", 
             RowBox[{"y", ";", "p"}], "2"]},
           {
            SubsuperscriptBox["v", 
             RowBox[{"z", ";", "p"}], "2"]}
          }], ")"}], 
        FractionBox[
         RowBox[{
          RowBox[{"S", "[", 
           RowBox[{
            SubsuperscriptBox["x", 
             RowBox[{"t", ";", "s"}], 
             RowBox[{"1", ";", "p"}]], "-", 
            SuperscriptBox["x", 
             RowBox[{"1", ";", "i"}]]}], "]"}], 
          RowBox[{"S", "[", 
           RowBox[{
            SubsuperscriptBox["x", 
             RowBox[{"t", ";", "s"}], 
             RowBox[{"2", ";", "p"}]], "-", 
            SuperscriptBox["x", 
             RowBox[{"2", ";", "j"}]]}], "]"}]}], 
         SubsuperscriptBox["N", 
          RowBox[{"c", ";", "s"}], "0"]]}]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"c97569bd-847e-456d-9873-97595cdfcd23"],
 ".\nThermal speed squared:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["\[CapitalDelta]v", 
          RowBox[{"x", ",", 
           RowBox[{"s", ";", "i"}], ",", "j"}], "2"]},
        {
         SubsuperscriptBox["\[CapitalDelta]v", 
          RowBox[{"y", ",", 
           RowBox[{"s", ";", "i"}], ",", "j"}], "2"]},
        {
         SubsuperscriptBox["\[CapitalDelta]v", 
          RowBox[{"z", ",", 
           RowBox[{"s", ";", "i"}], ",", "j"}], "2"]}
       }], ")"}], "\[RightAngleBracket]"}], "=", 
    RowBox[{
     FractionBox[
      SubscriptBox["n", 
       RowBox[{"0", ";", "s"}]], 
      SubsuperscriptBox["n", 
       RowBox[{"t", ";", "s"}], 
       RowBox[{"i", ",", "j"}]]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Sum]", "p"], 
        RowBox[{
         RowBox[{"(", GridBox[{
            {
             SubsuperscriptBox["v", 
              RowBox[{"x", ";", "p"}], "2"]},
            {
             SubsuperscriptBox["v", 
              RowBox[{"y", ";", "p"}], "2"]},
            {
             SubsuperscriptBox["v", 
              RowBox[{"z", ";", "p"}], "2"]}
           }], ")"}], 
         FractionBox[
          RowBox[{
           RowBox[{"S", "[", 
            RowBox[{
             SubsuperscriptBox["x", 
              RowBox[{"t", ";", "s"}], 
              RowBox[{"1", ";", "p"}]], "-", 
             SuperscriptBox["x", 
              RowBox[{"1", ";", "i"}]]}], "]"}], 
           RowBox[{"S", "[", 
            RowBox[{
             SubsuperscriptBox["x", 
              RowBox[{"t", ";", "s"}], 
              RowBox[{"2", ";", "p"}]], "-", 
             SuperscriptBox["x", 
              RowBox[{"2", ";", "j"}]]}], "]"}]}], 
          SubsuperscriptBox["N", 
           RowBox[{"c", ";", "s"}], "0"]]}]}], "-", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", GridBox[{
            {
             SubsuperscriptBox["V", 
              RowBox[{
               RowBox[{"x", ";", "i"}], ",", "j"}], 
              RowBox[{"t", ";", "s"}]]},
            {
             SubsuperscriptBox["V", 
              RowBox[{
               RowBox[{"y", ";", "i"}], ",", "j"}], 
              RowBox[{"t", ";", "s"}]]},
            {
             SubsuperscriptBox["V", 
              RowBox[{
               RowBox[{"z", ";", "i"}], ",", "j"}], 
              RowBox[{"t", ";", "s"}]]}
           }], ")"}], "2"], "/", 
        FractionBox[
         SubsuperscriptBox["n", 
          RowBox[{"t", ";", "s"}], "i"], 
         SubscriptBox["n", 
          RowBox[{"0", ";", "s"}]]]}]}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"fc4943ec-4ddf-4f14-882f-55e9d3dd8aea"],
 "."
}], "Text",ExpressionUUID->"59fc32ea-eade-4306-a38e-8ba6362e937b"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Nc", "=", "1000"}], ",", 
     RowBox[{"Nx", "=", "2"}], ",", 
     RowBox[{"n0", "=", "1."}], ",", 
     RowBox[{"\[Theta]", "=", "1."}], ",", 
     RowBox[{"S", "=", 
      RowBox[{"Function", "[", 
       RowBox[{"x", 
        RowBox[{"(*", 
         RowBox[{"0", "\[LessEqual]", "x", "\[LessEqual]", "1"}], "*)"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "-", "x"}], ",", "x"}], "}"}], "//", "N"}]}], 
       "]"}]}]}], "}"}], ",", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "rng", ",", "x", ",", "v", ",", "vx", ",", "vy", ",", "vz", ",", 
       "\[Psi]"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rng", ":=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", 
         RowBox[{"Nc", "*", "Nx"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"x", "=", "rng"}], ";", "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{
        RowBox[{"icdf", "[", "rng", "]"}], "\[Theta]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vx", "=", 
       RowBox[{"v", " ", 
        RowBox[{"(", 
         RowBox[{"\[Psi]", "=", 
          RowBox[{"1", "-", 
           RowBox[{"2", "rng"}]}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"v", " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[Psi]", "2"]}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vy", "=", 
       RowBox[{"v", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Psi]", "=", 
          RowBox[{"2", "\[Pi]", " ", "rng"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vz", "=", 
       RowBox[{"v", " ", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{"Flatten", "[", 
           SuperscriptBox[
            RowBox[{"{", 
             RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}], "2"], "]"}], "]"}], 
         "/", "2"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Total", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["vx", "2"], "+", 
                 SuperscriptBox["vy", "2"], "+", 
                 SuperscriptBox["vz", "2"]}], ")"}], 
               RowBox[{"#", "/", "2"}]}], "]"}], "/", "Nc"}], "&"}], "/@", 
           RowBox[{"S", "[", "x", "]"}]}], "]"}], "*", "Nc"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "]"}]], "Input",ExpressionUUID->"dd0a03e8-\
94b4-45d0-abc3-4e919c4edb8f"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "3D in ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["x", "1"], "-", 
    SuperscriptBox["x", "2"], "-", 
    SuperscriptBox["x", "3"]}], TraditionalForm]],ExpressionUUID->
  "55a9d6de-c163-4a03-bb68-b1690a7a25f0"],
 " plane"
}], "Subsection",ExpressionUUID->"d32e5f04-a70d-46df-91b1-209d254e0177"],

Cell[CellGroupData[{

Cell["Grid: Staggered", "Subsubsection",ExpressionUUID->"4fda6b53-7a37-422e-99c8-5a58a99d174b"],

Cell[TextData[{
 "Cell center quantities: ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["\[CapitalXi]", "\[RightVector]"], TraditionalForm]],
  ExpressionUUID->"14bfa6b0-264c-4783-b610-9fe13942dbe0"],
 ", ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["\[ScriptCapitalJ]", "\[RightVector]"], TraditionalForm]],
  ExpressionUUID->"a36c6eff-64ed-4f4e-97ed-a333a49bfe04"],
 ", all discrete particle moments, and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[DoubleStruckCapitalV]", "f"], TraditionalForm]],
  ExpressionUUID->"ec0b5715-5545-4eba-b9d2-9816f010f8ee"],
 ".\nCell corner quantities: ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["\[CapitalOmega]", "\[RightVector]"], TraditionalForm]],
  ExpressionUUID->"e237f17c-c6b0-4421-aa53-8b19df7658cf"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Delta]n", "f"], TraditionalForm]],ExpressionUUID->
  "d879e339-a81a-4cce-81aa-9c6f3ecaae2c"],
 "."
}], "Text",ExpressionUUID->"51cb748a-0b20-4044-bd39-6bf9ff1cb549"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Xi]", "=", ".0"}], ",", 
     RowBox[{"\[CapitalDelta]1", "=", "1"}], ",", 
     RowBox[{"\[CapitalDelta]2", "=", "1"}], ",", 
     RowBox[{"q1max", "=", "4"}], ",", 
     RowBox[{"q2max", "=", "3"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1max"}], 
       "\[GreaterEqual]", 
       RowBox[{"\[Pi]", "/", "2"}]}], ",", 
      RowBox[{"Abort", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[CapitalDelta]1q1", ",", "\[CapitalDelta]2q2", ",", "xyF", ",", 
        "xyH"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalDelta]1q1", "=", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"-", "q1max"}], ",", "q1max"}], "]"}], 
         "\[CapitalDelta]1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[CapitalDelta]2q2", "=", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"-", "q2max"}], ",", "q2max"}], "]"}], 
         "\[CapitalDelta]2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xyF", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Chop", "[", "\[Xi]", "]"}], "\[Equal]", "0"}], ",", 
               "#", ",", 
               RowBox[{
                RowBox[{"Tan", "[", 
                 RowBox[{"\[Xi]", "#"}], "]"}], "/", "\[Xi]"}]}], "]"}], ",", 
             
             RowBox[{"\[CapitalDelta]2q2", " ", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Xi]", "#"}], "]"}], "^", "2"}]}]}], "}"}], "]"}], 
          "&"}], "/@", "\[CapitalDelta]1q1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xyH", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Chop", "[", "\[Xi]", "]"}], "\[Equal]", "0"}], ",", 
               "#", ",", 
               RowBox[{
                RowBox[{"Tan", "[", 
                 RowBox[{"\[Xi]", "#"}], "]"}], "/", "\[Xi]"}]}], "]"}], ",", 
             
             RowBox[{
              RowBox[{"Plus", "[", 
               RowBox[{"\[CapitalDelta]2q2", ",", 
                RowBox[{"+", ".5"}]}], "]"}], 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Xi]", "#"}], "]"}], "^", "2"}]}]}], "}"}], "]"}], 
          "&"}], "/@", 
         RowBox[{"Plus", "[", 
          RowBox[{"\[CapitalDelta]1q1", ",", 
           RowBox[{"+", ".5"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Legended", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Graphics", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"LightBlue", ",", 
                RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
                RowBox[{"Line", "/@", "xyF"}], ",", 
                RowBox[{"Line", "/@", 
                 RowBox[{"Thread", "[", "xyF", "]"}]}]}], "}"}], ","}], 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"LightRed", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
               RowBox[{"Line", "/@", "xyH"}], ",", 
               RowBox[{"Line", "/@", 
                RowBox[{"Thread", "[", "xyH", "]"}]}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Red", ",", 
               RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
               RowBox[{"Point", "/@", 
                RowBox[{"xyH", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}], ",", 
                   RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}]}], "]"}], "]"}]}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"LightRed", ",", 
               RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"First", "[", "xyH", "]"}], "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"First", "/@", "xyH"}], "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"Last", "[", "xyH", "]"}], "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"Last", "/@", "xyH"}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Blue", ",", 
               RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
               RowBox[{"Point", "/@", 
                RowBox[{"xyF", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}], ",", 
                   RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}]}], "]"}], "]"}]}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"LightBlue", ",", 
               RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"First", "[", "xyF", "]"}], "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"First", "/@", "xyF"}], "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"Last", "[", "xyF", "]"}], "]"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"Last", "/@", "xyF"}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Gray", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
               RowBox[{"Line", "[", 
                RowBox[{
                 RowBox[{"First", "[", "xyH", "]"}], "//", "Most"}], "]"}], 
               ",", 
               RowBox[{"Line", "[", 
                RowBox[{
                 RowBox[{"First", "/@", "xyH"}], "//", "Most"}], "]"}], ",", 
               RowBox[{"Line", "[", 
                RowBox[{
                 RowBox[{"Part", "[", 
                  RowBox[{"xyH", ",", 
                   RowBox[{"-", "2"}]}], "]"}], "//", "Most"}], "]"}], ",", 
               RowBox[{"Line", "[", 
                RowBox[{
                 RowBox[{"Part", "[", 
                  RowBox[{"xyH", ",", "All", ",", 
                   RowBox[{"-", "2"}]}], "]"}], "//", "Most"}], "]"}]}], 
              "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Darker", "@", "Blue"}], ",", 
               RowBox[{"MapIndexed", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#2", "]"}], "-", "1"}], ",", "#", 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}], "&"}], ",", 
                 RowBox[{"xyF", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}], ",", 
                    RowBox[{"q2max", "+", "1"}]}], "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"MapIndexed", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#2", "]"}], "-", "1"}], ",", "#", 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], "&"}], 
                 ",", 
                 RowBox[{"xyF", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"q1max", "+", "1"}], ",", 
                    RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}]}], "]"}], "]"}]}], "]"}]}], "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Darker", "@", "Red"}], ",", 
               RowBox[{"MapIndexed", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#2", "]"}], "-", "1"}], ",", "#", 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}], "&"}], ",", 
                 RowBox[{"xyH", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}], ",", "q2max"}], "]"}], "]"}]}], 
                "]"}], ",", 
               RowBox[{"MapIndexed", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#2", "]"}], "-", "1"}], ",", "#", 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], "&"}], 
                 ",", 
                 RowBox[{"xyH", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"q1max", "+", "1"}], ",", 
                    RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}]}], "]"}], "]"}]}], "]"}]}], "}"}]}], 
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"AspectRatio", "\[Rule]", 
            RowBox[{
             RowBox[{"xyF", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", 
                RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}], "/", 
             RowBox[{"xyF", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1", ",", "1"}], "]"}], "]"}]}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"Axes", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Ticks", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
           
           RowBox[{"BaseStyle", "\[Rule]", "11"}], ",", "\[IndentingNewLine]", 
           RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "\[IndentingNewLine]",
           "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Placed", "[", 
          RowBox[{
           RowBox[{"PointLegend", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "LightRed", ",", "Gray", ",", "Red", ",", "Blue", ",", "Gray"}],
               "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Cell Boundary\>\"", ",", "\"\<Particle Boundary\>\"", ",", 
               "\"\<Cell Corner\>\"", ",", "\"\<Cell Center\>\"", ",", 
               "\"\<Ghost Cells\>\""}], "}"}], ",", 
             RowBox[{"Joined", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
               "True", ",", "True", ",", "False", ",", "False", ",", 
                "False"}], "}"}]}], ",", 
             RowBox[{"LegendLayout", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{
                  RowBox[{"Join", "@@", "#"}], ",", 
                  RowBox[{"Spacer", "[", "2", "]"}]}], "]"}], "&"}], 
               ")"}]}]}], "]"}], ",", "Above"}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 Editable->False,
 CellOpen->False,ExpressionUUID->"1f5bcfe9-cae3-40dd-8970-0f492c259f27"],

Cell[BoxData[
 TemplateBox[{
   GraphicsBox[{{
      RGBColor[1, 0.85, 0.85], 
      Thickness[Medium], {
       LineBox[{{-3.5, -2.5}, {-3.5, -1.5}, {-3.5, -0.5}, {-3.5, 0.5}, {-3.5, 
        1.5}, {-3.5, 2.5}, {-3.5, 3.5}}], 
       LineBox[{{-2.5, -2.5}, {-2.5, -1.5}, {-2.5, -0.5}, {-2.5, 0.5}, {-2.5, 
        1.5}, {-2.5, 2.5}, {-2.5, 3.5}}], 
       LineBox[{{-1.5, -2.5}, {-1.5, -1.5}, {-1.5, -0.5}, {-1.5, 0.5}, {-1.5, 
        1.5}, {-1.5, 2.5}, {-1.5, 3.5}}], 
       LineBox[{{-0.5, -2.5}, {-0.5, -1.5}, {-0.5, -0.5}, {-0.5, 0.5}, {-0.5, 
        1.5}, {-0.5, 2.5}, {-0.5, 3.5}}], 
       LineBox[{{0.5, -2.5}, {0.5, -1.5}, {0.5, -0.5}, {0.5, 0.5}, {0.5, 
        1.5}, {0.5, 2.5}, {0.5, 3.5}}], 
       LineBox[{{1.5, -2.5}, {1.5, -1.5}, {1.5, -0.5}, {1.5, 0.5}, {1.5, 
        1.5}, {1.5, 2.5}, {1.5, 3.5}}], 
       LineBox[{{2.5, -2.5}, {2.5, -1.5}, {2.5, -0.5}, {2.5, 0.5}, {2.5, 
        1.5}, {2.5, 2.5}, {2.5, 3.5}}], 
       LineBox[{{3.5, -2.5}, {3.5, -1.5}, {3.5, -0.5}, {3.5, 0.5}, {3.5, 
        1.5}, {3.5, 2.5}, {3.5, 3.5}}], 
       LineBox[{{4.5, -2.5}, {4.5, -1.5}, {4.5, -0.5}, {4.5, 0.5}, {4.5, 
        1.5}, {4.5, 2.5}, {4.5, 3.5}}]}, {
       LineBox[{{-3.5, -2.5}, {-2.5, -2.5}, {-1.5, -2.5}, {-0.5, -2.5}, {
        0.5, -2.5}, {1.5, -2.5}, {2.5, -2.5}, {3.5, -2.5}, {4.5, -2.5}}], 
       LineBox[{{-3.5, -1.5}, {-2.5, -1.5}, {-1.5, -1.5}, {-0.5, -1.5}, {
        0.5, -1.5}, {1.5, -1.5}, {2.5, -1.5}, {3.5, -1.5}, {4.5, -1.5}}], 
       LineBox[{{-3.5, -0.5}, {-2.5, -0.5}, {-1.5, -0.5}, {-0.5, -0.5}, {
        0.5, -0.5}, {1.5, -0.5}, {2.5, -0.5}, {3.5, -0.5}, {4.5, -0.5}}], 
       LineBox[{{-3.5, 0.5}, {-2.5, 0.5}, {-1.5, 0.5}, {-0.5, 0.5}, {0.5, 
        0.5}, {1.5, 0.5}, {2.5, 0.5}, {3.5, 0.5}, {4.5, 0.5}}], 
       LineBox[{{-3.5, 1.5}, {-2.5, 1.5}, {-1.5, 1.5}, {-0.5, 1.5}, {0.5, 
        1.5}, {1.5, 1.5}, {2.5, 1.5}, {3.5, 1.5}, {4.5, 1.5}}], 
       LineBox[{{-3.5, 2.5}, {-2.5, 2.5}, {-1.5, 2.5}, {-0.5, 2.5}, {0.5, 
        2.5}, {1.5, 2.5}, {2.5, 2.5}, {3.5, 2.5}, {4.5, 2.5}}], 
       LineBox[{{-3.5, 3.5}, {-2.5, 3.5}, {-1.5, 3.5}, {-0.5, 3.5}, {0.5, 
        3.5}, {1.5, 3.5}, {2.5, 3.5}, {3.5, 3.5}, {4.5, 3.5}}]}}, {
      RGBColor[1, 0, 0], 
      PointSize[Medium], {
       PointBox[{{-2.5, -1.5}, {-2.5, -0.5}, {-2.5, 0.5}, {-2.5, 1.5}, {-2.5, 
        2.5}}], 
       PointBox[{{-1.5, -1.5}, {-1.5, -0.5}, {-1.5, 0.5}, {-1.5, 1.5}, {-1.5, 
        2.5}}], 
       PointBox[{{-0.5, -1.5}, {-0.5, -0.5}, {-0.5, 0.5}, {-0.5, 1.5}, {-0.5, 
        2.5}}], 
       PointBox[{{0.5, -1.5}, {0.5, -0.5}, {0.5, 0.5}, {0.5, 1.5}, {0.5, 
        2.5}}], 
       PointBox[{{1.5, -1.5}, {1.5, -0.5}, {1.5, 0.5}, {1.5, 1.5}, {1.5, 
        2.5}}], 
       PointBox[{{2.5, -1.5}, {2.5, -0.5}, {2.5, 0.5}, {2.5, 1.5}, {2.5, 
        2.5}}], 
       PointBox[{{3.5, -1.5}, {3.5, -0.5}, {3.5, 0.5}, {3.5, 1.5}, {3.5, 
        2.5}}]}}, {
      RGBColor[1, 0.85, 0.85], 
      PointSize[Medium], 
      PointBox[{{-3.5, -2.5}, {-3.5, -1.5}, {-3.5, -0.5}, {-3.5, 0.5}, {-3.5, 
       1.5}, {-3.5, 2.5}, {-3.5, 3.5}}], 
      PointBox[{{-3.5, -2.5}, {-2.5, -2.5}, {-1.5, -2.5}, {-0.5, -2.5}, {
       0.5, -2.5}, {1.5, -2.5}, {2.5, -2.5}, {3.5, -2.5}, {4.5, -2.5}}], 
      PointBox[{{4.5, -2.5}, {4.5, -1.5}, {4.5, -0.5}, {4.5, 0.5}, {4.5, 
       1.5}, {4.5, 2.5}, {4.5, 3.5}}], 
      PointBox[{{-3.5, 3.5}, {-2.5, 3.5}, {-1.5, 3.5}, {-0.5, 3.5}, {0.5, 
       3.5}, {1.5, 3.5}, {2.5, 3.5}, {3.5, 3.5}, {4.5, 3.5}}]}, {
      RGBColor[0, 0, 1], 
      PointSize[Medium], {
       PointBox[{{-3, -2.}, {-3, -1.}, {-3, 0.}, {-3, 1.}, {-3, 2.}}], 
       PointBox[{{-2, -2.}, {-2, -1.}, {-2, 0.}, {-2, 1.}, {-2, 2.}}], 
       PointBox[{{-1, -2.}, {-1, -1.}, {-1, 0.}, {-1, 1.}, {-1, 2.}}], 
       PointBox[{{0, -2.}, {0, -1.}, {0, 0.}, {0, 1.}, {0, 2.}}], 
       PointBox[{{1, -2.}, {1, -1.}, {1, 0.}, {1, 1.}, {1, 2.}}], 
       PointBox[{{2, -2.}, {2, -1.}, {2, 0.}, {2, 1.}, {2, 2.}}], 
       PointBox[{{3, -2.}, {3, -1.}, {3, 0.}, {3, 1.}, {3, 2.}}]}}, {
      RGBColor[0.87, 0.94, 1], 
      PointSize[Medium], 
      PointBox[{{-4, -3.}, {-4, -2.}, {-4, -1.}, {-4, 0.}, {-4, 1.}, {-4, 
         2.}, {-4, 3.}}], 
      PointBox[{{-4, -3.}, {-3, -3.}, {-2, -3.}, {-1, -3.}, {0, -3.}, {
        1, -3.}, {2, -3.}, {3, -3.}, {4, -3.}}], 
      PointBox[{{4, -3.}, {4, -2.}, {4, -1.}, {4, 0.}, {4, 1.}, {4, 2.}, {
        4, 3.}}], 
      PointBox[{{-4, 3.}, {-3, 3.}, {-2, 3.}, {-1, 3.}, {0, 3.}, {1, 3.}, {
        2, 3.}, {3, 3.}, {4, 3.}}]}, {
      GrayLevel[0.5], 
      Thickness[Medium], 
      LineBox[{{-3.5, -2.5}, {-3.5, -1.5}, {-3.5, -0.5}, {-3.5, 0.5}, {-3.5, 
       1.5}, {-3.5, 2.5}}], 
      LineBox[{{-3.5, -2.5}, {-2.5, -2.5}, {-1.5, -2.5}, {-0.5, -2.5}, {
       0.5, -2.5}, {1.5, -2.5}, {2.5, -2.5}, {3.5, -2.5}}], 
      LineBox[{{3.5, -2.5}, {3.5, -1.5}, {3.5, -0.5}, {3.5, 0.5}, {3.5, 
       1.5}, {3.5, 2.5}}], 
      LineBox[{{-3.5, 2.5}, {-2.5, 2.5}, {-1.5, 2.5}, {-0.5, 2.5}, {0.5, 
       2.5}, {1.5, 2.5}, {2.5, 2.5}, {3.5, 2.5}}]}, {
      RGBColor[0, 0, 
       NCache[
        Rational[2, 3], 0.6666666666666666]], {
       InsetBox[
        FormBox["0", TraditionalForm], {-3, 0.}, {-1, -1}], 
       InsetBox[
        FormBox["1", TraditionalForm], {-2, 0.}, {-1, -1}], 
       InsetBox[
        FormBox["2", TraditionalForm], {-1, 0.}, {-1, -1}], 
       InsetBox[
        FormBox["3", TraditionalForm], {0, 0.}, {-1, -1}], 
       InsetBox[
        FormBox["4", TraditionalForm], {1, 0.}, {-1, -1}], 
       InsetBox[
        FormBox["5", TraditionalForm], {2, 0.}, {-1, -1}], 
       InsetBox[
        FormBox["6", TraditionalForm], {3, 0.}, {-1, -1}]}, {
       InsetBox[
        FormBox["0", TraditionalForm], {0, -2.}, {-1, 1}], 
       InsetBox[
        FormBox["1", TraditionalForm], {0, -1.}, {-1, 1}], 
       InsetBox[
        FormBox["2", TraditionalForm], {0, 0.}, {-1, 1}], 
       InsetBox[
        FormBox["3", TraditionalForm], {0, 1.}, {-1, 1}], 
       InsetBox[
        FormBox["4", TraditionalForm], {0, 2.}, {-1, 1}]}}, {
      RGBColor[
       NCache[
        Rational[2, 3], 0.6666666666666666], 0, 0], {
       InsetBox[
        FormBox["0", TraditionalForm], {-2.5, -0.5}, {1, -1}], 
       InsetBox[
        FormBox["1", TraditionalForm], {-1.5, -0.5}, {1, -1}], 
       InsetBox[
        FormBox["2", TraditionalForm], {-0.5, -0.5}, {1, -1}], 
       InsetBox[
        FormBox["3", TraditionalForm], {0.5, -0.5}, {1, -1}], 
       InsetBox[
        FormBox["4", TraditionalForm], {1.5, -0.5}, {1, -1}], 
       InsetBox[
        FormBox["5", TraditionalForm], {2.5, -0.5}, {1, -1}], 
       InsetBox[
        FormBox["6", TraditionalForm], {3.5, -0.5}, {1, -1}]}, {
       InsetBox[
        FormBox["0", TraditionalForm], {0.5, -1.5}, {-1, 1}], 
       InsetBox[
        FormBox["1", TraditionalForm], {0.5, -0.5}, {-1, 1}], 
       InsetBox[
        FormBox["2", TraditionalForm], {0.5, 0.5}, {-1, 1}], 
       InsetBox[
        FormBox["3", TraditionalForm], {0.5, 1.5}, {-1, 1}], 
       InsetBox[
        FormBox["4", TraditionalForm], {0.5, 2.5}, {-1, 1}]}}}, AspectRatio -> 
    0.75, Axes -> True, Ticks -> False, BaseStyle -> 11, ImageSize -> Large], 
   
   FormBox[
    FormBox[
     TemplateBox[{
      "\"Cell Boundary\"", "\"Particle Boundary\"", "\"Cell Corner\"", 
       "\"Cell Center\"", "\"Ghost Cells\""}, "PointLegend", 
      DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TemplateBox[{
             InterpretationBox[
              StyleBox[
               
               GraphicsBox[{}, ImageSize -> {2, 0}, BaselinePosition -> 
                Baseline], "CacheGraphics" -> False], 
              Spacer[2]], 
             GraphicsBox[{{
                Directive[
                 EdgeForm[
                  Directive[
                   Opacity[0.3], 
                   GrayLevel[0]]], 
                 PointSize[0.5], 
                 AbsoluteThickness[1.6], 
                 RGBColor[1, 0.85, 0.85]], {
                 LineBox[{{0, 10}, {20, 10}}]}}, {
                Directive[
                 EdgeForm[
                  Directive[
                   Opacity[0.3], 
                   GrayLevel[0]]], 
                 PointSize[0.5], 
                 AbsoluteThickness[1.6], 
                 RGBColor[1, 0.85, 0.85]], {}}}, AspectRatio -> Full, 
              ImageSize -> {20, 10}, PlotRangePadding -> None, ImagePadding -> 
              Automatic, BaselinePosition -> (Scaled[0.1] -> Baseline)], #, 
             GraphicsBox[{{
                Directive[
                 EdgeForm[
                  Directive[
                   Opacity[0.3], 
                   GrayLevel[0]]], 
                 PointSize[0.5], 
                 AbsoluteThickness[1.6], 
                 GrayLevel[0.5]], {
                 LineBox[{{0, 10}, {20, 10}}]}}, {
                Directive[
                 EdgeForm[
                  Directive[
                   Opacity[0.3], 
                   GrayLevel[0]]], 
                 PointSize[0.5], 
                 AbsoluteThickness[1.6], 
                 GrayLevel[0.5]], {}}}, AspectRatio -> Full, 
              ImageSize -> {20, 10}, PlotRangePadding -> None, ImagePadding -> 
              Automatic, BaselinePosition -> (Scaled[0.1] -> Baseline)], #2, 
             GraphicsBox[{{}, {
                Directive[
                 EdgeForm[
                  Directive[
                   Opacity[0.3], 
                   GrayLevel[0]]], 
                 PointSize[0.5], 
                 AbsoluteThickness[1.6], 
                 RGBColor[1, 0, 0]], {
                 Directive[
                  EdgeForm[
                   Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                  PointSize[0.5], 
                  AbsoluteThickness[1.6], 
                  RGBColor[1, 0, 0]], 
                 PointBox[
                  NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
              ImageSize -> {10, 10}, PlotRangePadding -> None, ImagePadding -> 
              Automatic, BaselinePosition -> (Scaled[0.1] -> Baseline)], #3, 
             GraphicsBox[{{}, {
                Directive[
                 EdgeForm[
                  Directive[
                   Opacity[0.3], 
                   GrayLevel[0]]], 
                 PointSize[0.5], 
                 AbsoluteThickness[1.6], 
                 RGBColor[0, 0, 1]], {
                 Directive[
                  EdgeForm[
                   Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                  PointSize[0.5], 
                  AbsoluteThickness[1.6], 
                  RGBColor[0, 0, 1]], 
                 PointBox[
                  NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
              ImageSize -> {10, 10}, PlotRangePadding -> None, ImagePadding -> 
              Automatic, BaselinePosition -> (Scaled[0.1] -> Baseline)], #4, 
             GraphicsBox[{{}, {
                Directive[
                 EdgeForm[
                  Directive[
                   Opacity[0.3], 
                   GrayLevel[0]]], 
                 PointSize[0.5], 
                 AbsoluteThickness[1.6], 
                 GrayLevel[0.5]], {
                 Directive[
                  EdgeForm[
                   Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                  PointSize[0.5], 
                  AbsoluteThickness[1.6], 
                  GrayLevel[0.5]], 
                 PointBox[
                  NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
              ImageSize -> {10, 10}, PlotRangePadding -> None, ImagePadding -> 
              Automatic, BaselinePosition -> (Scaled[0.1] -> Baseline)], #5}, 
            "RowWithSeparator"], Alignment -> Left, AppearanceElements -> 
           None, ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"PointLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               InterpretationBox[
                ButtonBox[
                 TooltipBox[
                  GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[1, 0.85, 0.85], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                   True, FrameStyle -> 
                   RGBColor[
                    0.6666666666666666, 0.5666666666666667, 
                    0.5666666666666667], FrameTicks -> None, PlotRangePadding -> 
                   None, ImageSize -> 
                   Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], "RGBColor[1, 0.85, 0.85]"], 
                 Appearance -> None, BaseStyle -> {}, BaselinePosition -> 
                 Baseline, DefaultBaseStyle -> {}, ButtonFunction :> 
                 With[{Typeset`box$ = EvaluationBox[]}, 
                   If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[1, 0.85, 0.85]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                 Automatic, Method -> "Preemptive"], 
                RGBColor[1, 0.85, 0.85], Editable -> False, Selectable -> 
                False], ",", 
               InterpretationBox[
                ButtonBox[
                 TooltipBox[
                  GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    GrayLevel[0.5], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                   True, FrameStyle -> GrayLevel[0.33333333333333337`], 
                   FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                   Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], "GrayLevel[0.5]"], Appearance -> None,
                  BaseStyle -> {}, BaselinePosition -> Baseline, 
                 DefaultBaseStyle -> {}, ButtonFunction :> 
                 With[{Typeset`box$ = EvaluationBox[]}, 
                   If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    GrayLevel[0.5]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["GrayLevelColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                 Automatic, Method -> "Preemptive"], 
                GrayLevel[0.5], Editable -> False, Selectable -> False], ",", 
               
               InterpretationBox[
                ButtonBox[
                 TooltipBox[
                  GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[1, 0, 0], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                   True, FrameStyle -> RGBColor[0.6666666666666666, 0., 0.], 
                   FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                   Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], "RGBColor[1, 0, 0]"], Appearance -> 
                 None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                 DefaultBaseStyle -> {}, ButtonFunction :> 
                 With[{Typeset`box$ = EvaluationBox[]}, 
                   If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[1, 0, 0]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                 Automatic, Method -> "Preemptive"], 
                RGBColor[1, 0, 0], Editable -> False, Selectable -> False], 
               ",", 
               InterpretationBox[
                ButtonBox[
                 TooltipBox[
                  GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0, 0, 1], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                   True, FrameStyle -> RGBColor[0., 0., 0.6666666666666666], 
                   FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                   Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], "RGBColor[0, 0, 1]"], Appearance -> 
                 None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                 DefaultBaseStyle -> {}, ButtonFunction :> 
                 With[{Typeset`box$ = EvaluationBox[]}, 
                   If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0, 0, 1]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                 Automatic, Method -> "Preemptive"], 
                RGBColor[0, 0, 1], Editable -> False, Selectable -> False], 
               ",", 
               InterpretationBox[
                ButtonBox[
                 TooltipBox[
                  GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    GrayLevel[0.5], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                   True, FrameStyle -> GrayLevel[0.33333333333333337`], 
                   FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                   Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], "GrayLevel[0.5]"], Appearance -> None,
                  BaseStyle -> {}, BaselinePosition -> Baseline, 
                 DefaultBaseStyle -> {}, ButtonFunction :> 
                 With[{Typeset`box$ = EvaluationBox[]}, 
                   If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    GrayLevel[0.5]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["GrayLevelColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                 Automatic, Method -> "Preemptive"], 
                GrayLevel[0.5], Editable -> False, Selectable -> False]}], 
             "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2, ",", #3, ",", #4, ",", #5}], "}"}], ",", 
           RowBox[{"Joined", "\[Rule]", 
             RowBox[{"{", 
               
               RowBox[{
                "True", ",", "True", ",", "False", ",", "False", ",", 
                 "False"}], "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", 
             RowBox[{"(", 
               RowBox[{
                 RowBox[{"Row", "[", 
                   RowBox[{
                    RowBox[{"Join", "@@", "#1"}], ",", 
                    InterpretationBox[
                    StyleBox[
                    
                    GraphicsBox[{}, ImageSize -> {2, 0}, BaselinePosition -> 
                    Baseline], "CacheGraphics" -> False], 
                    Spacer[2]]}], "]"}], "&"}], ")"}]}]}], "]"}]& ), Editable -> 
      True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}, {
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {2, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "Above"}], "]"}]}], "]"}]& )]], "Output",ExpressionU\
UID->"9a80ce38-d2c9-4df6-8fd6-41208d4fc72a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Grid: Collocated", "Subsubsection",ExpressionUUID->"9efd36d5-80ea-4ab2-a658-830f702c6892"],

Cell["Grid points are located in cell centers.", "Text",ExpressionUUID->"1476d000-42ea-4eec-a0e0-e7a85268dc8c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Xi]", "=", ".0"}], ",", 
     RowBox[{"\[CapitalDelta]1", "=", "1"}], ",", 
     RowBox[{"\[CapitalDelta]2", "=", "1"}], ",", 
     RowBox[{"q1max", "=", 
      RowBox[{"4", "+", "2"}]}], ",", 
     RowBox[{"q2max", "=", 
      RowBox[{"3", "+", "2"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Xi]", " ", "\[CapitalDelta]1", " ", "q1max"}], 
       "\[GreaterEqual]", 
       RowBox[{"\[Pi]", "/", "2"}]}], ",", 
      RowBox[{"Abort", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[CapitalDelta]1q1", ",", "\[CapitalDelta]2q2", ",", "xyF", ",", 
        "xyH"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[CapitalDelta]1q1", "=", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"-", "q1max"}], ",", "q1max"}], "]"}], 
         "\[CapitalDelta]1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[CapitalDelta]2q2", "=", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"-", "q2max"}], ",", "q2max"}], "]"}], 
         "\[CapitalDelta]2"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xyF", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Chop", "[", "\[Xi]", "]"}], "\[Equal]", "0"}], ",", 
               "#", ",", 
               RowBox[{
                RowBox[{"Tan", "[", 
                 RowBox[{"\[Xi]", "#"}], "]"}], "/", "\[Xi]"}]}], "]"}], ",", 
             
             RowBox[{"\[CapitalDelta]2q2", " ", 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Xi]", "#"}], "]"}], "^", "2"}]}]}], "}"}], "]"}], 
          "&"}], "/@", "\[CapitalDelta]1q1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"xyH", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Chop", "[", "\[Xi]", "]"}], "\[Equal]", "0"}], ",", 
               "#", ",", 
               RowBox[{
                RowBox[{"Tan", "[", 
                 RowBox[{"\[Xi]", "#"}], "]"}], "/", "\[Xi]"}]}], "]"}], ",", 
             
             RowBox[{
              RowBox[{"MovingAverage", "[", 
               RowBox[{"\[CapitalDelta]2q2", ",", "2"}], "]"}], 
              RowBox[{
               RowBox[{"Cos", "[", 
                RowBox[{"\[Xi]", "#"}], "]"}], "^", "2"}]}]}], "}"}], "]"}], 
          "&"}], "/@", 
         RowBox[{"MovingAverage", "[", 
          RowBox[{"\[CapitalDelta]1q1", ",", "2"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Legended", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Graphics", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"LightBlue", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
               RowBox[{"Line", "/@", 
                RowBox[{"xyH", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}], ",", 
                   RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}]}], "]"}], "]"}]}], ",", 
               RowBox[{"Line", "/@", 
                RowBox[{"Thread", "[", 
                 RowBox[{"xyH", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}], ",", 
                    RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}]}], "]"}], "]"}], "]"}]}]}], "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Black", ",", 
               RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
               RowBox[{"Point", "/@", 
                RowBox[{"xyF", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"3", ";;", 
                    RowBox[{"-", "3"}]}], ",", 
                   RowBox[{"3", ";;", 
                    RowBox[{"-", "3"}]}]}], "]"}], "]"}]}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Gray", ",", 
               RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
               RowBox[{"Point", "/@", 
                RowBox[{"xyF", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ";;", "2"}], "]"}], "]"}]}], ",", 
               RowBox[{"Point", "/@", 
                RowBox[{"xyF", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", 
                   RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], ",", 
               RowBox[{"Point", "/@", 
                RowBox[{"xyF", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"-", "2"}], ";;", 
                   RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", 
               RowBox[{"Point", "/@", 
                RowBox[{"xyF", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", 
                   RowBox[{
                    RowBox[{"-", "2"}], ";;", 
                    RowBox[{"-", "1"}]}]}], "]"}], "]"}]}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Blue", ",", 
               RowBox[{"MapIndexed", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#2", "]"}], "-", "1"}], ",", "#", 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}], "&"}], ",", 
                 RowBox[{"xyF", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"3", ";;", 
                    RowBox[{"-", "3"}]}], ",", 
                    RowBox[{"q2max", "+", "1"}]}], "]"}], "]"}]}], "]"}]}], 
              "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Red", ",", 
               RowBox[{"MapIndexed", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Text", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"First", "[", "#2", "]"}], "-", "1"}], ",", "#", 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}]}], "]"}], "&"}], ",", 
                 RowBox[{"xyF", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"q1max", "+", "1"}], ",", 
                    RowBox[{"3", ";;", 
                    RowBox[{"-", "3"}]}]}], "]"}], "]"}]}], "]"}]}], "}"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"Black", ",", 
               RowBox[{"Thickness", "[", "Medium", "]"}], ",", 
               RowBox[{"Line", "[", 
                RowBox[{"xyH", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}], ",", "2"}], "]"}], "]"}], "]"}], 
               ",", 
               RowBox[{"Line", "[", 
                RowBox[{"xyH", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"-", "2"}], ",", 
                   RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}]}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"Line", "[", 
                RowBox[{"xyH", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}], ",", 
                   RowBox[{"-", "2"}]}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"Line", "[", 
                RowBox[{"xyH", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", ",", 
                   RowBox[{"2", ";;", 
                    RowBox[{"-", "2"}]}]}], "]"}], "]"}], "]"}]}], "}"}]}], 
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"AspectRatio", "\[Rule]", 
            RowBox[{
             RowBox[{"xyF", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", 
                RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}], "/", 
             RowBox[{"xyF", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1", ",", "1"}], "]"}], "]"}]}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"Axes", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Ticks", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
           
           RowBox[{"BaseStyle", "\[Rule]", "11"}], ",", "\[IndentingNewLine]", 
           RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "\[IndentingNewLine]",
           "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Placed", "[", 
          RowBox[{
           RowBox[{"PointLegend", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Black", ",", "Black", ",", "Gray"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "\"\<Particle Boundary\>\"", ",", "\"\<Cell Center\>\"", ",", 
               "\"\<Ghost Cells\>\""}], "}"}], ",", 
             RowBox[{"Joined", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"True", ",", "False", ",", "False"}], "}"}]}], ",", 
             RowBox[{"LegendLayout", "\[Rule]", "\"\<Row\>\""}]}], "]"}], ",",
            "Above"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",\

 Editable->False,
 CellOpen->False,ExpressionUUID->"2f744134-13d6-4bed-a8ce-49fd1311bf4d"],

Cell[BoxData[
 TemplateBox[{
   GraphicsBox[{{
      RGBColor[0.87, 0.94, 1], 
      Thickness[Medium], {
       LineBox[
        NCache[{{
           Rational[-9, 2], -3.5}, {
           Rational[-9, 2], -2.5}, {
           Rational[-9, 2], -1.5}, {
           Rational[-9, 2], -0.5}, {
           Rational[-9, 2], 0.5}, {
           Rational[-9, 2], 1.5}, {
           Rational[-9, 2], 2.5}, {
           Rational[-9, 2], 
           3.5}}, {{-4.5, -3.5}, {-4.5, -2.5}, {-4.5, -1.5}, {-4.5, -0.5}, \
{-4.5, 0.5}, {-4.5, 1.5}, {-4.5, 2.5}, {-4.5, 3.5}}]], 
       LineBox[
        NCache[{{
           Rational[-7, 2], -3.5}, {
           Rational[-7, 2], -2.5}, {
           Rational[-7, 2], -1.5}, {
           Rational[-7, 2], -0.5}, {
           Rational[-7, 2], 0.5}, {
           Rational[-7, 2], 1.5}, {
           Rational[-7, 2], 2.5}, {
           Rational[-7, 2], 
           3.5}}, {{-3.5, -3.5}, {-3.5, -2.5}, {-3.5, -1.5}, {-3.5, -0.5}, \
{-3.5, 0.5}, {-3.5, 1.5}, {-3.5, 2.5}, {-3.5, 3.5}}]], 
       LineBox[
        NCache[{{
           Rational[-5, 2], -3.5}, {
           Rational[-5, 2], -2.5}, {
           Rational[-5, 2], -1.5}, {
           Rational[-5, 2], -0.5}, {
           Rational[-5, 2], 0.5}, {
           Rational[-5, 2], 1.5}, {
           Rational[-5, 2], 2.5}, {
           Rational[-5, 2], 
           3.5}}, {{-2.5, -3.5}, {-2.5, -2.5}, {-2.5, -1.5}, {-2.5, -0.5}, \
{-2.5, 0.5}, {-2.5, 1.5}, {-2.5, 2.5}, {-2.5, 3.5}}]], 
       LineBox[
        NCache[{{
           Rational[-3, 2], -3.5}, {
           Rational[-3, 2], -2.5}, {
           Rational[-3, 2], -1.5}, {
           Rational[-3, 2], -0.5}, {
           Rational[-3, 2], 0.5}, {
           Rational[-3, 2], 1.5}, {
           Rational[-3, 2], 2.5}, {
           Rational[-3, 2], 
           3.5}}, {{-1.5, -3.5}, {-1.5, -2.5}, {-1.5, -1.5}, {-1.5, -0.5}, \
{-1.5, 0.5}, {-1.5, 1.5}, {-1.5, 2.5}, {-1.5, 3.5}}]], 
       LineBox[
        NCache[{{
           Rational[-1, 2], -3.5}, {
           Rational[-1, 2], -2.5}, {
           Rational[-1, 2], -1.5}, {
           Rational[-1, 2], -0.5}, {
           Rational[-1, 2], 0.5}, {
           Rational[-1, 2], 1.5}, {
           Rational[-1, 2], 2.5}, {
           Rational[-1, 2], 
           3.5}}, {{-0.5, -3.5}, {-0.5, -2.5}, {-0.5, -1.5}, {-0.5, -0.5}, \
{-0.5, 0.5}, {-0.5, 1.5}, {-0.5, 2.5}, {-0.5, 3.5}}]], 
       LineBox[
        NCache[{{
           Rational[1, 2], -3.5}, {
           Rational[1, 2], -2.5}, {
           Rational[1, 2], -1.5}, {
           Rational[1, 2], -0.5}, {
           Rational[1, 2], 0.5}, {
           Rational[1, 2], 1.5}, {
           Rational[1, 2], 2.5}, {
           Rational[1, 2], 3.5}}, {{0.5, -3.5}, {0.5, -2.5}, {0.5, -1.5}, {
         0.5, -0.5}, {0.5, 0.5}, {0.5, 1.5}, {0.5, 2.5}, {0.5, 3.5}}]], 
       LineBox[
        NCache[{{
           Rational[3, 2], -3.5}, {
           Rational[3, 2], -2.5}, {
           Rational[3, 2], -1.5}, {
           Rational[3, 2], -0.5}, {
           Rational[3, 2], 0.5}, {
           Rational[3, 2], 1.5}, {
           Rational[3, 2], 2.5}, {
           Rational[3, 2], 3.5}}, {{1.5, -3.5}, {1.5, -2.5}, {1.5, -1.5}, {
         1.5, -0.5}, {1.5, 0.5}, {1.5, 1.5}, {1.5, 2.5}, {1.5, 3.5}}]], 
       LineBox[
        NCache[{{
           Rational[5, 2], -3.5}, {
           Rational[5, 2], -2.5}, {
           Rational[5, 2], -1.5}, {
           Rational[5, 2], -0.5}, {
           Rational[5, 2], 0.5}, {
           Rational[5, 2], 1.5}, {
           Rational[5, 2], 2.5}, {
           Rational[5, 2], 3.5}}, {{2.5, -3.5}, {2.5, -2.5}, {2.5, -1.5}, {
         2.5, -0.5}, {2.5, 0.5}, {2.5, 1.5}, {2.5, 2.5}, {2.5, 3.5}}]], 
       LineBox[
        NCache[{{
           Rational[7, 2], -3.5}, {
           Rational[7, 2], -2.5}, {
           Rational[7, 2], -1.5}, {
           Rational[7, 2], -0.5}, {
           Rational[7, 2], 0.5}, {
           Rational[7, 2], 1.5}, {
           Rational[7, 2], 2.5}, {
           Rational[7, 2], 3.5}}, {{3.5, -3.5}, {3.5, -2.5}, {3.5, -1.5}, {
         3.5, -0.5}, {3.5, 0.5}, {3.5, 1.5}, {3.5, 2.5}, {3.5, 3.5}}]], 
       LineBox[
        NCache[{{
           Rational[9, 2], -3.5}, {
           Rational[9, 2], -2.5}, {
           Rational[9, 2], -1.5}, {
           Rational[9, 2], -0.5}, {
           Rational[9, 2], 0.5}, {
           Rational[9, 2], 1.5}, {
           Rational[9, 2], 2.5}, {
           Rational[9, 2], 3.5}}, {{4.5, -3.5}, {4.5, -2.5}, {4.5, -1.5}, {
         4.5, -0.5}, {4.5, 0.5}, {4.5, 1.5}, {4.5, 2.5}, {4.5, 3.5}}]]}, {
       LineBox[
        NCache[{{
           Rational[-9, 2], -3.5}, {
           Rational[-7, 2], -3.5}, {
           Rational[-5, 2], -3.5}, {
           Rational[-3, 2], -3.5}, {
           Rational[-1, 2], -3.5}, {
           Rational[1, 2], -3.5}, {
           Rational[3, 2], -3.5}, {
           Rational[5, 2], -3.5}, {
           Rational[7, 2], -3.5}, {
           Rational[
           9, 2], -3.5}}, {{-4.5, -3.5}, {-3.5, -3.5}, {-2.5, -3.5}, {-1.5, \
-3.5}, {-0.5, -3.5}, {0.5, -3.5}, {1.5, -3.5}, {2.5, -3.5}, {3.5, -3.5}, {
         4.5, -3.5}}]], 
       LineBox[
        NCache[{{
           Rational[-9, 2], -2.5}, {
           Rational[-7, 2], -2.5}, {
           Rational[-5, 2], -2.5}, {
           Rational[-3, 2], -2.5}, {
           Rational[-1, 2], -2.5}, {
           Rational[1, 2], -2.5}, {
           Rational[3, 2], -2.5}, {
           Rational[5, 2], -2.5}, {
           Rational[7, 2], -2.5}, {
           Rational[
           9, 2], -2.5}}, {{-4.5, -2.5}, {-3.5, -2.5}, {-2.5, -2.5}, {-1.5, \
-2.5}, {-0.5, -2.5}, {0.5, -2.5}, {1.5, -2.5}, {2.5, -2.5}, {3.5, -2.5}, {
         4.5, -2.5}}]], 
       LineBox[
        NCache[{{
           Rational[-9, 2], -1.5}, {
           Rational[-7, 2], -1.5}, {
           Rational[-5, 2], -1.5}, {
           Rational[-3, 2], -1.5}, {
           Rational[-1, 2], -1.5}, {
           Rational[1, 2], -1.5}, {
           Rational[3, 2], -1.5}, {
           Rational[5, 2], -1.5}, {
           Rational[7, 2], -1.5}, {
           Rational[
           9, 2], -1.5}}, {{-4.5, -1.5}, {-3.5, -1.5}, {-2.5, -1.5}, {-1.5, \
-1.5}, {-0.5, -1.5}, {0.5, -1.5}, {1.5, -1.5}, {2.5, -1.5}, {3.5, -1.5}, {
         4.5, -1.5}}]], 
       LineBox[
        NCache[{{
           Rational[-9, 2], -0.5}, {
           Rational[-7, 2], -0.5}, {
           Rational[-5, 2], -0.5}, {
           Rational[-3, 2], -0.5}, {
           Rational[-1, 2], -0.5}, {
           Rational[1, 2], -0.5}, {
           Rational[3, 2], -0.5}, {
           Rational[5, 2], -0.5}, {
           Rational[7, 2], -0.5}, {
           Rational[
           9, 2], -0.5}}, {{-4.5, -0.5}, {-3.5, -0.5}, {-2.5, -0.5}, {-1.5, \
-0.5}, {-0.5, -0.5}, {0.5, -0.5}, {1.5, -0.5}, {2.5, -0.5}, {3.5, -0.5}, {
         4.5, -0.5}}]], 
       LineBox[
        NCache[{{
           Rational[-9, 2], 0.5}, {
           Rational[-7, 2], 0.5}, {
           Rational[-5, 2], 0.5}, {
           Rational[-3, 2], 0.5}, {
           Rational[-1, 2], 0.5}, {
           Rational[1, 2], 0.5}, {
           Rational[3, 2], 0.5}, {
           Rational[5, 2], 0.5}, {
           Rational[7, 2], 0.5}, {
           Rational[9, 2], 0.5}}, {{-4.5, 0.5}, {-3.5, 0.5}, {-2.5, 
         0.5}, {-1.5, 0.5}, {-0.5, 0.5}, {0.5, 0.5}, {1.5, 0.5}, {2.5, 0.5}, {
         3.5, 0.5}, {4.5, 0.5}}]], 
       LineBox[
        NCache[{{
           Rational[-9, 2], 1.5}, {
           Rational[-7, 2], 1.5}, {
           Rational[-5, 2], 1.5}, {
           Rational[-3, 2], 1.5}, {
           Rational[-1, 2], 1.5}, {
           Rational[1, 2], 1.5}, {
           Rational[3, 2], 1.5}, {
           Rational[5, 2], 1.5}, {
           Rational[7, 2], 1.5}, {
           Rational[9, 2], 1.5}}, {{-4.5, 1.5}, {-3.5, 1.5}, {-2.5, 
         1.5}, {-1.5, 1.5}, {-0.5, 1.5}, {0.5, 1.5}, {1.5, 1.5}, {2.5, 1.5}, {
         3.5, 1.5}, {4.5, 1.5}}]], 
       LineBox[
        NCache[{{
           Rational[-9, 2], 2.5}, {
           Rational[-7, 2], 2.5}, {
           Rational[-5, 2], 2.5}, {
           Rational[-3, 2], 2.5}, {
           Rational[-1, 2], 2.5}, {
           Rational[1, 2], 2.5}, {
           Rational[3, 2], 2.5}, {
           Rational[5, 2], 2.5}, {
           Rational[7, 2], 2.5}, {
           Rational[9, 2], 2.5}}, {{-4.5, 2.5}, {-3.5, 2.5}, {-2.5, 
         2.5}, {-1.5, 2.5}, {-0.5, 2.5}, {0.5, 2.5}, {1.5, 2.5}, {2.5, 2.5}, {
         3.5, 2.5}, {4.5, 2.5}}]], 
       LineBox[
        NCache[{{
           Rational[-9, 2], 3.5}, {
           Rational[-7, 2], 3.5}, {
           Rational[-5, 2], 3.5}, {
           Rational[-3, 2], 3.5}, {
           Rational[-1, 2], 3.5}, {
           Rational[1, 2], 3.5}, {
           Rational[3, 2], 3.5}, {
           Rational[5, 2], 3.5}, {
           Rational[7, 2], 3.5}, {
           Rational[9, 2], 3.5}}, {{-4.5, 3.5}, {-3.5, 3.5}, {-2.5, 
         3.5}, {-1.5, 3.5}, {-0.5, 3.5}, {0.5, 3.5}, {1.5, 3.5}, {2.5, 3.5}, {
         3.5, 3.5}, {4.5, 3.5}}]]}}, {
      GrayLevel[0], 
      PointSize[Medium], {
       PointBox[{{-4, -3.}, {-4, -2.}, {-4, -1.}, {-4, 0.}, {-4, 1.}, {-4, 
          2.}, {-4, 3.}}], 
       PointBox[{{-3, -3.}, {-3, -2.}, {-3, -1.}, {-3, 0.}, {-3, 1.}, {-3, 
          2.}, {-3, 3.}}], 
       PointBox[{{-2, -3.}, {-2, -2.}, {-2, -1.}, {-2, 0.}, {-2, 1.}, {-2, 
          2.}, {-2, 3.}}], 
       PointBox[{{-1, -3.}, {-1, -2.}, {-1, -1.}, {-1, 0.}, {-1, 1.}, {-1, 
          2.}, {-1, 3.}}], 
       PointBox[{{0, -3.}, {0, -2.}, {0, -1.}, {0, 0.}, {0, 1.}, {0, 2.}, {
         0, 3.}}], 
       PointBox[{{1, -3.}, {1, -2.}, {1, -1.}, {1, 0.}, {1, 1.}, {1, 2.}, {
         1, 3.}}], 
       PointBox[{{2, -3.}, {2, -2.}, {2, -1.}, {2, 0.}, {2, 1.}, {2, 2.}, {
         2, 3.}}], 
       PointBox[{{3, -3.}, {3, -2.}, {3, -1.}, {3, 0.}, {3, 1.}, {3, 2.}, {
         3, 3.}}], 
       PointBox[{{4, -3.}, {4, -2.}, {4, -1.}, {4, 0.}, {4, 1.}, {4, 2.}, {
         4, 3.}}]}}, {
      GrayLevel[0.5], 
      PointSize[Medium], {
       PointBox[{{-6, -5.}, {-6, -4.}, {-6, -3.}, {-6, -2.}, {-6, -1.}, {-6, 
          0.}, {-6, 1.}, {-6, 2.}, {-6, 3.}, {-6, 4.}, {-6, 5.}}], 
       PointBox[{{-5, -5.}, {-5, -4.}, {-5, -3.}, {-5, -2.}, {-5, -1.}, {-5, 
          0.}, {-5, 1.}, {-5, 2.}, {-5, 3.}, {-5, 4.}, {-5, 5.}}]}, {
       PointBox[{{-6, -5.}, {-6, -4.}}], 
       PointBox[{{-5, -5.}, {-5, -4.}}], 
       PointBox[{{-4, -5.}, {-4, -4.}}], 
       PointBox[{{-3, -5.}, {-3, -4.}}], 
       PointBox[{{-2, -5.}, {-2, -4.}}], 
       PointBox[{{-1, -5.}, {-1, -4.}}], 
       PointBox[{{0, -5.}, {0, -4.}}], 
       PointBox[{{1, -5.}, {1, -4.}}], 
       PointBox[{{2, -5.}, {2, -4.}}], 
       PointBox[{{3, -5.}, {3, -4.}}], 
       PointBox[{{4, -5.}, {4, -4.}}], 
       PointBox[{{5, -5.}, {5, -4.}}], 
       PointBox[{{6, -5.}, {6, -4.}}]}, {
       PointBox[{{5, -5.}, {5, -4.}, {5, -3.}, {5, -2.}, {5, -1.}, {5, 0.}, {
         5, 1.}, {5, 2.}, {5, 3.}, {5, 4.}, {5, 5.}}], 
       PointBox[{{6, -5.}, {6, -4.}, {6, -3.}, {6, -2.}, {6, -1.}, {6, 0.}, {
         6, 1.}, {6, 2.}, {6, 3.}, {6, 4.}, {6, 5.}}]}, {
       PointBox[{{-6, 4.}, {-6, 5.}}], 
       PointBox[{{-5, 4.}, {-5, 5.}}], 
       PointBox[{{-4, 4.}, {-4, 5.}}], 
       PointBox[{{-3, 4.}, {-3, 5.}}], 
       PointBox[{{-2, 4.}, {-2, 5.}}], 
       PointBox[{{-1, 4.}, {-1, 5.}}], 
       PointBox[{{0, 4.}, {0, 5.}}], 
       PointBox[{{1, 4.}, {1, 5.}}], 
       PointBox[{{2, 4.}, {2, 5.}}], 
       PointBox[{{3, 4.}, {3, 5.}}], 
       PointBox[{{4, 4.}, {4, 5.}}], 
       PointBox[{{5, 4.}, {5, 5.}}], 
       PointBox[{{6, 4.}, {6, 5.}}]}}, {
      RGBColor[0, 0, 1], {
       InsetBox[
        FormBox["0", TraditionalForm], {-4, 0.}, {-1, -1}], 
       InsetBox[
        FormBox["1", TraditionalForm], {-3, 0.}, {-1, -1}], 
       InsetBox[
        FormBox["2", TraditionalForm], {-2, 0.}, {-1, -1}], 
       InsetBox[
        FormBox["3", TraditionalForm], {-1, 0.}, {-1, -1}], 
       InsetBox[
        FormBox["4", TraditionalForm], {0, 0.}, {-1, -1}], 
       InsetBox[
        FormBox["5", TraditionalForm], {1, 0.}, {-1, -1}], 
       InsetBox[
        FormBox["6", TraditionalForm], {2, 0.}, {-1, -1}], 
       InsetBox[
        FormBox["7", TraditionalForm], {3, 0.}, {-1, -1}], 
       InsetBox[
        FormBox["8", TraditionalForm], {4, 0.}, {-1, -1}]}}, {
      RGBColor[1, 0, 0], {
       InsetBox[
        FormBox["0", TraditionalForm], {0, -3.}, {1, 1}], 
       InsetBox[
        FormBox["1", TraditionalForm], {0, -2.}, {1, 1}], 
       InsetBox[
        FormBox["2", TraditionalForm], {0, -1.}, {1, 1}], 
       InsetBox[
        FormBox["3", TraditionalForm], {0, 0.}, {1, 1}], 
       InsetBox[
        FormBox["4", TraditionalForm], {0, 1.}, {1, 1}], 
       InsetBox[
        FormBox["5", TraditionalForm], {0, 2.}, {1, 1}], 
       InsetBox[
        FormBox["6", TraditionalForm], {0, 3.}, {1, 1}]}}, {
      GrayLevel[0], 
      Thickness[Medium], 
      LineBox[
       NCache[{{
          Rational[-9, 2], -3.5}, {
          Rational[-7, 2], -3.5}, {
          Rational[-5, 2], -3.5}, {
          Rational[-3, 2], -3.5}, {
          Rational[-1, 2], -3.5}, {
          Rational[1, 2], -3.5}, {
          Rational[3, 2], -3.5}, {
          Rational[5, 2], -3.5}, {
          Rational[7, 2], -3.5}, {
          Rational[
          9, 2], -3.5}}, {{-4.5, -3.5}, {-3.5, -3.5}, {-2.5, -3.5}, {-1.5, \
-3.5}, {-0.5, -3.5}, {0.5, -3.5}, {1.5, -3.5}, {2.5, -3.5}, {3.5, -3.5}, {
        4.5, -3.5}}]], 
      LineBox[
       NCache[{{
          Rational[9, 2], -3.5}, {
          Rational[9, 2], -2.5}, {
          Rational[9, 2], -1.5}, {
          Rational[9, 2], -0.5}, {
          Rational[9, 2], 0.5}, {
          Rational[9, 2], 1.5}, {
          Rational[9, 2], 2.5}, {
          Rational[9, 2], 3.5}}, {{4.5, -3.5}, {4.5, -2.5}, {4.5, -1.5}, {
        4.5, -0.5}, {4.5, 0.5}, {4.5, 1.5}, {4.5, 2.5}, {4.5, 3.5}}]], 
      LineBox[
       NCache[{{
          Rational[-9, 2], 3.5}, {
          Rational[-7, 2], 3.5}, {
          Rational[-5, 2], 3.5}, {
          Rational[-3, 2], 3.5}, {
          Rational[-1, 2], 3.5}, {
          Rational[1, 2], 3.5}, {
          Rational[3, 2], 3.5}, {
          Rational[5, 2], 3.5}, {
          Rational[7, 2], 3.5}, {
          Rational[9, 2], 3.5}}, {{-4.5, 3.5}, {-3.5, 3.5}, {-2.5, 
        3.5}, {-1.5, 3.5}, {-0.5, 3.5}, {0.5, 3.5}, {1.5, 3.5}, {2.5, 3.5}, {
        3.5, 3.5}, {4.5, 3.5}}]], 
      LineBox[
       NCache[{{
          Rational[-9, 2], -3.5}, {
          Rational[-9, 2], -2.5}, {
          Rational[-9, 2], -1.5}, {
          Rational[-9, 2], -0.5}, {
          Rational[-9, 2], 0.5}, {
          Rational[-9, 2], 1.5}, {
          Rational[-9, 2], 2.5}, {
          Rational[-9, 2], 
          3.5}}, {{-4.5, -3.5}, {-4.5, -2.5}, {-4.5, -1.5}, {-4.5, -0.5}, \
{-4.5, 0.5}, {-4.5, 1.5}, {-4.5, 2.5}, {-4.5, 3.5}}]]}}, AspectRatio -> 
    0.8333333333333333, Axes -> True, Ticks -> False, BaseStyle -> 11, 
    ImageSize -> Large], 
   FormBox[
    FormBox[
     TemplateBox[{
      "\"Particle Boundary\"", "\"Cell Center\"", "\"Ghost Cells\""}, 
      "PointLegend", DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    GrayLevel[0]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    GrayLevel[0]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #, 
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    GrayLevel[0]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    GrayLevel[0]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #2, 
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    GrayLevel[0.5]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.5], 
                    AbsoluteThickness[1.6], 
                    GrayLevel[0.5]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #3}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {"Columns" -> {{0.8, 0.5}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxDividers -> {"Columns" -> {{None}}, "Rows" -> {{None}}}, 
             GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}}, 
             GridBoxSpacings -> {"Columns" -> {{0}}, "Rows" -> {{1}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"PointLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               InterpretationBox[
                ButtonBox[
                 TooltipBox[
                  GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    GrayLevel[0], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                   True, FrameStyle -> GrayLevel[0.], FrameTicks -> None, 
                   PlotRangePadding -> None, ImageSize -> 
                   Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], "GrayLevel[0]"], Appearance -> None, 
                 BaseStyle -> {}, BaselinePosition -> Baseline, 
                 DefaultBaseStyle -> {}, ButtonFunction :> 
                 With[{Typeset`box$ = EvaluationBox[]}, 
                   If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    GrayLevel[0]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["GrayLevelColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                 Automatic, Method -> "Preemptive"], 
                GrayLevel[0], Editable -> False, Selectable -> False], ",", 
               InterpretationBox[
                ButtonBox[
                 TooltipBox[
                  GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    GrayLevel[0], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                   True, FrameStyle -> GrayLevel[0.], FrameTicks -> None, 
                   PlotRangePadding -> None, ImageSize -> 
                   Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], "GrayLevel[0]"], Appearance -> None, 
                 BaseStyle -> {}, BaselinePosition -> Baseline, 
                 DefaultBaseStyle -> {}, ButtonFunction :> 
                 With[{Typeset`box$ = EvaluationBox[]}, 
                   If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    GrayLevel[0]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["GrayLevelColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                 Automatic, Method -> "Preemptive"], 
                GrayLevel[0], Editable -> False, Selectable -> False], ",", 
               InterpretationBox[
                ButtonBox[
                 TooltipBox[
                  GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    GrayLevel[0.5], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                   True, FrameStyle -> GrayLevel[0.33333333333333337`], 
                   FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                   Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}]], "GrayLevel[0.5]"], Appearance -> None,
                  BaseStyle -> {}, BaselinePosition -> Baseline, 
                 DefaultBaseStyle -> {}, ButtonFunction :> 
                 With[{Typeset`box$ = EvaluationBox[]}, 
                   If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    GrayLevel[0.5]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["GrayLevelColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                 Automatic, Method -> "Preemptive"], 
                GrayLevel[0.5], Editable -> False, Selectable -> False]}], 
             "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2, ",", #3}], "}"}], ",", 
           RowBox[{"Joined", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{"True", ",", "False", ",", "False"}], "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Row\""}]}], "]"}]& ), 
      Editable -> True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}, {
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {2, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "Above"}], "]"}]}], "]"}]& )]], "Output",ExpressionU\
UID->"0eb1e3e0-54e2-4a72-bebd-800c14a41388"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Magnetic field update", "Subsubsection",ExpressionUUID->"1dae012a-764d-4823-989f-9132e3b05eb5"],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"(", GridBox[{
      {
       RowBox[{
        SuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "1"], "/", 
        "\[CapitalDelta]t"}]},
      {
       RowBox[{
        SuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "2"], "/", 
        "\[CapitalDelta]t"}]},
      {
       RowBox[{
        SuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "3"], "/", 
        "\[CapitalDelta]t"}]}
     }], ")"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["c", 
       SqrtBox["g"]]}], 
     RowBox[{"(", GridBox[{
        {
         RowBox[{
          RowBox[{
           SubsuperscriptBox["\[CapitalDelta]\[CapitalXi]", "3", "t"], "/", 
           SuperscriptBox["\[CapitalDelta]x", "2"]}], "-", 
          RowBox[{
           SubsuperscriptBox["\[CapitalDelta]\[CapitalXi]", "2", "t"], "/", 
           SuperscriptBox["\[CapitalDelta]x", "3"]}]}]},
        {
         RowBox[{
          RowBox[{
           SubsuperscriptBox["\[CapitalDelta]\[CapitalXi]", "1", "t"], "/", 
           SuperscriptBox["\[CapitalDelta]x", "3"]}], "-", 
          RowBox[{
           SubsuperscriptBox["\[CapitalDelta]\[CapitalXi]", "3", "t"], "/", 
           SuperscriptBox["\[CapitalDelta]x", "1"]}]}]},
        {
         RowBox[{
          RowBox[{
           SubsuperscriptBox["\[CapitalDelta]\[CapitalXi]", "2", "t"], "/", 
           SuperscriptBox["\[CapitalDelta]x", "1"]}], "-", 
          RowBox[{
           SubsuperscriptBox["\[CapitalDelta]\[CapitalXi]", "1", "t"], "/", 
           SuperscriptBox["\[CapitalDelta]x", "2"]}]}]}
       }], ")"}]}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["c", 
        SqrtBox["g"]]}], 
      RowBox[{"(", GridBox[{
         {"0"},
         {
          RowBox[{
           RowBox[{"-", 
            SubsuperscriptBox["\[CapitalDelta]\[CapitalXi]", "3", "t"]}], "/", 
           SuperscriptBox["\[CapitalDelta]x", "1"]}]},
         {
          RowBox[{
           SubsuperscriptBox["\[CapitalDelta]\[CapitalXi]", "2", "t"], "/", 
           SuperscriptBox["\[CapitalDelta]x", "1"]}]}
        }], ")"}]}], "-", 
     RowBox[{
      FractionBox["c", 
       SqrtBox["g"]], 
      RowBox[{"(", GridBox[{
         {
          RowBox[{
           SubsuperscriptBox["\[CapitalDelta]\[CapitalXi]", "3", "t"], "/", 
           SuperscriptBox["\[CapitalDelta]x", "2"]}]},
         {"0"},
         {
          RowBox[{
           RowBox[{"-", 
            SubsuperscriptBox["\[CapitalDelta]\[CapitalXi]", "1", "t"]}], "/", 
           SuperscriptBox["\[CapitalDelta]x", "2"]}]}
        }], ")"}]}], "-", 
     RowBox[{
      FractionBox["c", 
       SqrtBox["g"]], 
      RowBox[{"(", GridBox[{
         {
          RowBox[{
           RowBox[{"-", 
            SubsuperscriptBox["\[CapitalDelta]\[CapitalXi]", "2", "t"]}], "/", 
           SuperscriptBox["\[CapitalDelta]x", "3"]}]},
         {
          RowBox[{
           SubsuperscriptBox["\[CapitalDelta]\[CapitalXi]", "1", "t"], "/", 
           SuperscriptBox["\[CapitalDelta]x", "3"]}]},
         {"0"}
        }], ")"}]}]}]}]}], 
  TraditionalForm]],ExpressionUUID->"954bb14d-ecb2-4db9-941c-48fe5b02f50f"]], \
"Text",ExpressionUUID->"4a32c144-2bed-460c-b504-1817619480a4"],

Cell[TextData[{
 "Staggered grid:\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["\[CapitalOmega]", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
         RowBox[{
          RowBox[{"1", ";", "i"}], ",", "j", ",", "k"}]]},
       {
        SubsuperscriptBox["\[CapitalOmega]", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
         RowBox[{
          RowBox[{"2", ";", "i"}], ",", "j", ",", "k"}]]},
       {
        SubsuperscriptBox["\[CapitalOmega]", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
         RowBox[{
          RowBox[{"3", ";", "i"}], ",", "j", ",", "k"}]]}
      }], ")"}], "=", 
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["\[CapitalOmega]", 
         RowBox[{"t", "-", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
         RowBox[{
          RowBox[{"1", ";", "i"}], ",", "j", ",", "k"}]]},
       {
        SubsuperscriptBox["\[CapitalOmega]", 
         RowBox[{"t", "-", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
         RowBox[{
          RowBox[{"2", ";", "i"}], ",", "j", ",", "k"}]]},
       {
        SubsuperscriptBox["\[CapitalOmega]", 
         RowBox[{"t", "-", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
         RowBox[{
          RowBox[{"3", ";", "i"}], ",", "j", ",", "k"}]]}
      }], ")"}]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"c", " ", "\[CapitalDelta]t"}], 
      RowBox[{"4", 
       SqrtBox["g"], 
       SuperscriptBox["\[CapitalDelta]x", "1"]}]]}], 
    RowBox[{"(", GridBox[{
       {"0"},
       {
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"3", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", 
                 RowBox[{"j", "+", "1"}], ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"3", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", 
                 RowBox[{"j", "+", "1"}], ",", "k"}], "t"]}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"3", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", "j", ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"3", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", "j", ",", "k"}], "t"]}], 
              ")"}]}], ")"}], "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"3", ";", "i"}], ",", 
                 RowBox[{"j", "+", "1"}], ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"3", ";", "i"}], ",", 
                 RowBox[{"j", "+", "1"}], ",", "k"}], "t"]}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"3", ";", "i"}], ",", "j", ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"3", ";", "i"}], ",", "j", ",", "k"}], "t"]}], 
              ")"}]}], ")"}]}], ")"}]}]},
       {
        RowBox[{"+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"2", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", 
                 RowBox[{"j", "+", "1"}], ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"2", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", 
                 RowBox[{"j", "+", "1"}], ",", "k"}], "t"]}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"2", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", "j", ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"2", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", "j", ",", "k"}], "t"]}], 
              ")"}]}], ")"}], "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"2", ";", "i"}], ",", 
                 RowBox[{"j", "+", "1"}], ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"2", ";", "i"}], ",", 
                 RowBox[{"j", "+", "1"}], ",", "k"}], "t"]}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"2", ";", "i"}], ",", "j", ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"2", ";", "i"}], ",", "j", ",", "k"}], "t"]}], 
              ")"}]}], ")"}]}], ")"}]}]}
      }], ")"}]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"c", " ", "\[CapitalDelta]t"}], 
      RowBox[{"4", 
       SqrtBox["g"], 
       SuperscriptBox["\[CapitalDelta]x", "2"]}]]}], 
    RowBox[{"(", GridBox[{
       {
        RowBox[{"+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"3", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", 
                 RowBox[{"j", "+", "1"}], ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"3", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", 
                 RowBox[{"j", "+", "1"}], ",", "k"}], "t"]}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"3", ";", "i", ";", 
                  RowBox[{"j", "+", "1"}]}], ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"3", ";", "i"}], ",", 
                 RowBox[{"j", "+", "1"}], ",", "k"}], "t"]}], ")"}]}], ")"}], 
           "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"3", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", "j", ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"3", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", "j", ",", "k"}], "t"]}], 
              ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"3", ";", "i"}], ",", "j", ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"3", ";", "i"}], ",", "j", ",", "k"}], "t"]}], 
              ")"}]}], ")"}]}], ")"}]}]},
       {"0"},
       {
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"1", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", 
                 RowBox[{"j", "+", "1"}], ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"1", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", 
                 RowBox[{"j", "+", "1"}], ",", "k"}], "t"]}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"1", ";", "i"}], ",", 
                 RowBox[{"j", "+", "1"}], ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"1", ";", "i"}], ",", 
                 RowBox[{"j", "+", "1"}], ",", "k"}], "t"]}], ")"}]}], ")"}], 
           "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"1", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", "j", ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"1", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", "j", ",", "k"}], "t"]}], 
              ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"1", ";", "i"}], ",", "j", ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"1", ";", "i"}], ",", "j", ",", "k"}], "t"]}], 
              ")"}]}], ")"}]}], ")"}]}]}
      }], ")"}]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"c", " ", "\[CapitalDelta]t"}], 
      RowBox[{"4", 
       SqrtBox["g"], 
       SuperscriptBox["\[CapitalDelta]x", "3"]}]]}], 
    RowBox[{"(", GridBox[{
       {
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"2", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", 
                 RowBox[{"j", "+", "1"}], ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"2", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", "j", ",", 
                 RowBox[{"k", "+", "1"}]}], "t"]}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"2", ";", "i"}], ",", 
                 RowBox[{"j", "+", "1"}], ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"2", ";", "i"}], ",", "j", ",", 
                 RowBox[{"k", "+", "1"}]}], "t"]}], ")"}]}], ")"}], "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"2", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", 
                 RowBox[{"j", "+", "1"}], ",", "k"}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"2", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", "j", ",", "k"}], "t"]}], 
              ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"2", ";", "i"}], ",", 
                 RowBox[{"j", "+", "1"}], ",", "k"}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"2", ";", "i"}], ",", "j", ",", "k"}], "t"]}], 
              ")"}]}], ")"}]}], ")"}]}]},
       {
        RowBox[{"+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"1", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", 
                 RowBox[{"j", "+", "1"}], ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"1", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", "j", ",", 
                 RowBox[{"k", "+", "1"}]}], "t"]}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"1", ";", "i"}], ",", 
                 RowBox[{"j", "+", "1"}], ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"1", ";", "i"}], ",", "j", ",", 
                 RowBox[{"k", "+", "1"}]}], "t"]}], ")"}]}], ")"}], "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"1", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", 
                 RowBox[{"j", "+", "1"}], ",", "k"}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"1", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", "j", ",", "k"}], "t"]}], 
              ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"1", ";", "i"}], ",", 
                 RowBox[{"j", "+", "1"}], ",", "k"}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"1", ";", "i"}], ",", "j", ",", "k"}], "t"]}], 
              ")"}]}], ")"}]}], ")"}]}]},
       {"0"}
      }], ")"}]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["\[CapitalOmega]", 
         RowBox[{"t", "-", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
         RowBox[{
          RowBox[{"1", ";", "i"}], ",", "j", ",", "k"}]]},
       {
        SubsuperscriptBox["\[CapitalOmega]", 
         RowBox[{"t", "-", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
         RowBox[{
          RowBox[{"2", ";", "i"}], ",", "j", ",", "k"}]]},
       {
        SubsuperscriptBox["\[CapitalOmega]", 
         RowBox[{"t", "-", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
         RowBox[{
          RowBox[{"3", ";", "i"}], ",", "j", ",", "k"}]]}
      }], ")"}]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"c", " ", "\[CapitalDelta]t"}], 
      RowBox[{"4", 
       SqrtBox["g"], 
       SuperscriptBox["\[CapitalDelta]x", "1"]}]]}], 
    RowBox[{"(", GridBox[{
       {"0"},
       {
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"3", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", 
                 RowBox[{"j", "+", "1"}], ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"3", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", 
                 RowBox[{"j", "+", "1"}], ",", "k"}], "t"]}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"3", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", "j", ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"3", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", "j", ",", "k"}], "t"]}], 
              ")"}]}], ")"}], "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"3", ";", "i"}], ",", 
                 RowBox[{"j", "+", "1"}], ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"3", ";", "i"}], ",", 
                 RowBox[{"j", "+", "1"}], ",", "k"}], "t"]}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"3", ";", "i"}], ",", "j", ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"3", ";", "i"}], ",", "j", ",", "k"}], "t"]}], 
              ")"}]}], ")"}]}], ")"}]}]},
       {
        RowBox[{"+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"2", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", 
                 RowBox[{"j", "+", "1"}], ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"2", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", 
                 RowBox[{"j", "+", "1"}], ",", "k"}], "t"]}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"2", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", "j", ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"2", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", "j", ",", "k"}], "t"]}], 
              ")"}]}], ")"}], "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"2", ";", "i"}], ",", 
                 RowBox[{"j", "+", "1"}], ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"2", ";", "i"}], ",", 
                 RowBox[{"j", "+", "1"}], ",", "k"}], "t"]}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"2", ";", "i"}], ",", "j", ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"2", ";", "i"}], ",", "j", ",", "k"}], "t"]}], 
              ")"}]}], ")"}]}], ")"}]}]}
      }], ")"}]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"c", " ", "\[CapitalDelta]t"}], 
      RowBox[{"4", 
       SqrtBox["g"], 
       SuperscriptBox["\[CapitalDelta]x", "2"]}]]}], 
    RowBox[{"(", GridBox[{
       {
        RowBox[{"+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"3", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", 
                 RowBox[{"j", "+", "1"}], ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"3", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", 
                 RowBox[{"j", "+", "1"}], ",", "k"}], "t"]}], ")"}], "-", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"3", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", "j", ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"3", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", "j", ",", "k"}], "t"]}], 
              ")"}]}], ")"}], "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"3", ";", "i", ";", 
                  RowBox[{"j", "+", "1"}]}], ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"3", ";", "i"}], ",", 
                 RowBox[{"j", "+", "1"}], ",", "k"}], "t"]}], ")"}], "-", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"3", ";", "i"}], ",", "j", ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"3", ";", "i"}], ",", "j", ",", "k"}], "t"]}], 
              ")"}]}], ")"}]}], ")"}]}]},
       {"0"},
       {
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"1", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", 
                 RowBox[{"j", "+", "1"}], ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"1", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", 
                 RowBox[{"j", "+", "1"}], ",", "k"}], "t"]}], ")"}], "-", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"1", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", "j", ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"1", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", "j", ",", "k"}], "t"]}], 
              ")"}]}], ")"}], "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"1", ";", "i"}], ",", 
                 RowBox[{"j", "+", "1"}], ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"1", ";", "i"}], ",", 
                 RowBox[{"j", "+", "1"}], ",", "k"}], "t"]}], ")"}], "-", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"1", ";", "i"}], ",", "j", ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "+", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"1", ";", "i"}], ",", "j", ",", "k"}], "t"]}], 
              ")"}]}], ")"}]}], ")"}]}]}
      }], ")"}]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"c", " ", "\[CapitalDelta]t"}], 
      RowBox[{"4", 
       SqrtBox["g"], 
       SuperscriptBox["\[CapitalDelta]x", "3"]}]]}], 
    RowBox[{"(", GridBox[{
       {
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"2", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", 
                 RowBox[{"j", "+", "1"}], ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "-", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"2", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", 
                 RowBox[{"j", "+", "1"}], ",", "k"}], "t"]}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"2", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", "j", ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "-", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"2", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", "j", ",", "k"}], "t"]}], 
              ")"}]}], ")"}], "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"2", ";", "i"}], ",", 
                 RowBox[{"j", "+", "1"}], ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "-", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"2", ";", "i"}], ",", 
                 RowBox[{"j", "+", "1"}], ",", "k"}], "t"]}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"2", ";", "i"}], ",", "j", ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "-", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"2", ";", "i"}], ",", "j", ",", "k"}], "t"]}], 
              ")"}]}], ")"}]}], ")"}]}]},
       {
        RowBox[{"+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"1", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", 
                 RowBox[{"j", "+", "1"}], ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "-", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"1", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", 
                 RowBox[{"j", "+", "1"}], ",", "k"}], "t"]}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"1", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", "j", ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "-", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"1", ";", 
                  RowBox[{"i", "+", "1"}]}], ",", "j", ",", "k"}], "t"]}], 
              ")"}]}], ")"}], "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"1", ";", "i"}], ",", 
                 RowBox[{"j", "+", "1"}], ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "-", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"1", ";", "i"}], ",", 
                 RowBox[{"j", "+", "1"}], ",", "k"}], "t"]}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"1", ";", "i"}], ",", "j", ",", 
                 RowBox[{"k", "+", "1"}]}], "t"], "-", 
               SubsuperscriptBox["\[CapitalXi]", 
                RowBox[{
                 RowBox[{"1", ";", "i"}], ",", "j", ",", "k"}], "t"]}], 
              ")"}]}], ")"}]}], ")"}]}]},
       {"0"}
      }], ")"}]}], TraditionalForm]}],ExpressionUUID->
  "ab10fe97-bf71-42c5-b299-6a99f56f9745"]
}], "Text",ExpressionUUID->"f68f0d5a-5530-43f3-8bb1-99641057959b"],

Cell[TextData[{
 "Collocated grid:\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["\[CapitalOmega]", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
         RowBox[{
          RowBox[{"1", ";", "i"}], ",", "j", ",", "k"}]]},
       {
        SubsuperscriptBox["\[CapitalOmega]", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
         RowBox[{
          RowBox[{"2", ";", "i"}], ",", "j", ",", "k"}]]},
       {
        SubsuperscriptBox["\[CapitalOmega]", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
         RowBox[{
          RowBox[{"3", ";", "i"}], ",", "j", ",", "k"}]]}
      }], ")"}], "=", 
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["\[CapitalOmega]", 
         RowBox[{"t", "-", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
         RowBox[{
          RowBox[{"1", ";", "i"}], ",", "j", ",", "k"}]]},
       {
        SubsuperscriptBox["\[CapitalOmega]", 
         RowBox[{"t", "-", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
         RowBox[{
          RowBox[{"2", ";", "i"}], ",", "j", ",", "k"}]]},
       {
        SubsuperscriptBox["\[CapitalOmega]", 
         RowBox[{"t", "-", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
         RowBox[{
          RowBox[{"3", ";", "i"}], ",", "j", ",", "k"}]]}
      }], ")"}]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"c", " ", 
       RowBox[{"\[CapitalDelta]t", "/", 
        SqrtBox["g"]}]}], 
      RowBox[{"12", 
       SuperscriptBox["\[CapitalDelta]x", "1"]}]]}], 
    RowBox[{"(", GridBox[{
       {"0"},
       {
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           SubsuperscriptBox["\[CapitalXi]", 
            RowBox[{
             RowBox[{"3", ";", 
              RowBox[{"i", "-", "2"}]}], ",", "j", ",", "k"}], "t"], "-", 
           RowBox[{"8", 
            SubsuperscriptBox["\[CapitalXi]", 
             RowBox[{
              RowBox[{"3", ";", 
               RowBox[{"i", "-", "1"}]}], ",", "j", ",", "k"}], "t"]}], "+", 
           RowBox[{"8", 
            SubsuperscriptBox["\[CapitalXi]", 
             RowBox[{
              RowBox[{"3", ";", 
               RowBox[{"i", "+", "1"}]}], ",", "j", ",", "k"}], "t"]}], "-", 
           SubsuperscriptBox["\[CapitalXi]", 
            RowBox[{
             RowBox[{"3", ";", 
              RowBox[{"i", "+", "2"}]}], ",", "j", ",", "k"}], "t"]}], 
          ")"}]}]},
       {
        RowBox[{"+", 
         RowBox[{"(", 
          RowBox[{
           SubsuperscriptBox["\[CapitalXi]", 
            RowBox[{
             RowBox[{"2", ";", 
              RowBox[{"i", "-", "2"}]}], ",", "j", ",", "k"}], "t"], "-", 
           RowBox[{"8", 
            SubsuperscriptBox["\[CapitalXi]", 
             RowBox[{
              RowBox[{"2", ";", 
               RowBox[{"i", "-", "1"}]}], ",", "j", ",", "k"}], "t"]}], "+", 
           RowBox[{"8", 
            SubsuperscriptBox["\[CapitalXi]", 
             RowBox[{
              RowBox[{"2", ";", 
               RowBox[{"i", "+", "1"}]}], ",", "j", ",", "k"}], "t"]}], "-", 
           SubsuperscriptBox["\[CapitalXi]", 
            RowBox[{
             RowBox[{"2", ";", 
              RowBox[{"i", "+", "2"}]}], ",", "j", ",", "k"}], "t"]}], ")"}]}]}
      }], ")"}]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"c", " ", 
       RowBox[{"\[CapitalDelta]t", "/", 
        SqrtBox["g"]}]}], 
      RowBox[{"12", 
       SuperscriptBox["\[CapitalDelta]x", "2"]}]]}], 
    RowBox[{"(", GridBox[{
       {
        RowBox[{"+", 
         RowBox[{"(", 
          RowBox[{
           SubsuperscriptBox["\[CapitalXi]", 
            RowBox[{
             RowBox[{"3", ";", "i"}], ",", 
             RowBox[{"j", "-", "2"}], ",", "k"}], "t"], "-", 
           RowBox[{"8", 
            SubsuperscriptBox["\[CapitalXi]", 
             RowBox[{
              RowBox[{"3", ";", "i"}], ",", 
              RowBox[{"j", "-", "1"}], ",", "k"}], "t"]}], "+", 
           RowBox[{"8", 
            SubsuperscriptBox["\[CapitalXi]", 
             RowBox[{
              RowBox[{"3", ";", "i"}], ",", 
              RowBox[{"j", "+", "1"}], ",", "k"}], "t"]}], "-", 
           SubsuperscriptBox["\[CapitalXi]", 
            RowBox[{
             RowBox[{"3", ";", "i"}], ",", 
             RowBox[{"j", "+", "2"}], ",", "k"}], "t"]}], ")"}]}]},
       {"0"},
       {
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           SubsuperscriptBox["\[CapitalXi]", 
            RowBox[{
             RowBox[{"1", ";", "i"}], ",", 
             RowBox[{"j", "-", "2"}], ",", "k"}], "t"], "-", 
           RowBox[{"8", 
            SubsuperscriptBox["\[CapitalXi]", 
             RowBox[{
              RowBox[{"1", ";", "i"}], ",", 
              RowBox[{"j", "-", "1"}], ",", "k"}], "t"]}], "+", 
           RowBox[{"8", 
            SubsuperscriptBox["\[CapitalXi]", 
             RowBox[{
              RowBox[{"1", ";", "i"}], ",", 
              RowBox[{"j", "+", "1"}], ",", "k"}], "t"]}], "-", 
           SubsuperscriptBox["\[CapitalXi]", 
            RowBox[{
             RowBox[{"1", ";", "i"}], ",", 
             RowBox[{"j", "+", "2"}], ",", "k"}], "t"]}], ")"}]}]}
      }], ")"}]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"c", " ", 
       RowBox[{"\[CapitalDelta]t", "/", 
        SqrtBox["g"]}]}], 
      RowBox[{"12", 
       SuperscriptBox["\[CapitalDelta]x", "3"]}]]}], 
    RowBox[{"(", GridBox[{
       {
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           SubsuperscriptBox["\[CapitalXi]", 
            RowBox[{
             RowBox[{"2", ";", "i"}], ",", "j", ",", 
             RowBox[{"k", "-", "2"}]}], "t"], "-", 
           RowBox[{"8", 
            SubsuperscriptBox["\[CapitalXi]", 
             RowBox[{
              RowBox[{"2", ";", "i"}], ",", "j", ",", 
              RowBox[{"k", "-", "1"}]}], "t"]}], "+", 
           RowBox[{"8", 
            SubsuperscriptBox["\[CapitalXi]", 
             RowBox[{
              RowBox[{"2", ";", "i"}], ",", "j", ",", 
              RowBox[{"k", "+", "1"}]}], "t"]}], "-", 
           SubsuperscriptBox["\[CapitalXi]", 
            RowBox[{
             RowBox[{"2", ";", "i"}], ",", "j", ",", 
             RowBox[{"k", "+", "2"}]}], "t"]}], ")"}]}]},
       {
        RowBox[{"+", 
         RowBox[{"(", 
          RowBox[{
           SubsuperscriptBox["\[CapitalXi]", 
            RowBox[{
             RowBox[{"1", ";", "i"}], ",", "j", ",", 
             RowBox[{"k", "-", "2"}]}], "t"], "-", 
           RowBox[{"8", 
            SubsuperscriptBox["\[CapitalXi]", 
             RowBox[{
              RowBox[{"1", ";", "i"}], ",", "j", ",", 
              RowBox[{"k", "-", "1"}]}], "t"]}], "+", 
           RowBox[{"8", 
            SubsuperscriptBox["\[CapitalXi]", 
             RowBox[{
              RowBox[{"1", ";", "i"}], ",", "j", ",", 
              RowBox[{"k", "+", "1"}]}], "t"]}], "-", 
           SubsuperscriptBox["\[CapitalXi]", 
            RowBox[{
             RowBox[{"1", ";", "i"}], ",", "j", ",", 
             RowBox[{"k", "+", "2"}]}], "t"]}], ")"}]}]},
       {"0"}
      }], ")"}]}], TraditionalForm]}],ExpressionUUID->
  "884174c9-cd1d-4668-8ecd-e7a8e9bf4ee9"]
}], "Text",ExpressionUUID->"fb2d4edc-eda1-4307-8c64-474c05d75a69"],

Cell[TextData[{
 "After update, calculate covariant components:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[CapitalOmega]", "i"], "=", 
    RowBox[{
     SuperscriptBox["\[CapitalOmega]", "j"], 
     SubscriptBox["g", 
      RowBox[{"i", "\[VeryThinSpace]", "j"}]]}]}], TraditionalForm]],
  ExpressionUUID->"62319f47-b2b5-42fc-a11e-3e311fc70e5a"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["\[CapitalOmega]", "1"]},
       {
        SubscriptBox["\[CapitalOmega]", "2"]},
       {
        SubscriptBox["\[CapitalOmega]", "3"]}
      }], ")"}], "=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         RowBox[{
          SubscriptBox["g", "11"], 
          SuperscriptBox["\[CapitalOmega]", "1"]}], "+", 
         RowBox[{
          SubscriptBox["g", "12"], 
          SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
         RowBox[{
          SubscriptBox["g", "13"], 
          SuperscriptBox["\[CapitalOmega]", "3"]}]}]},
       {
        RowBox[{
         RowBox[{
          SubscriptBox["g", "21"], 
          SuperscriptBox["\[CapitalOmega]", "1"]}], "+", 
         RowBox[{
          SubscriptBox["g", "22"], 
          SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
         RowBox[{
          SubscriptBox["g", "23"], 
          SuperscriptBox["\[CapitalOmega]", "3"]}]}]},
       {
        RowBox[{
         RowBox[{
          SubscriptBox["g", "31"], 
          SuperscriptBox["\[CapitalOmega]", "1"]}], "+", 
         RowBox[{
          SubscriptBox["g", "32"], 
          SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
         RowBox[{
          SubscriptBox["g", "33"], 
          SuperscriptBox["\[CapitalOmega]", "3"]}]}]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "0b7e3b26-c7b8-405e-a56c-6ffb66a9b596"],
 ";\nand cartesian components:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["\[CapitalOmega]", "x"]},
       {
        SubscriptBox["\[CapitalOmega]", "y"]},
       {
        SubscriptBox["\[CapitalOmega]", "z"]}
      }], ")"}], "=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         RowBox[{
          SuperscriptBox["\[CapitalOmega]", "1"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "x"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalOmega]", "2"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "x"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalOmega]", "3"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "x"]}]}]}]},
       {
        RowBox[{
         RowBox[{
          SuperscriptBox["\[CapitalOmega]", "1"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "y"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalOmega]", "2"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "y"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalOmega]", "3"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "y"]}]}]}]},
       {
        RowBox[{
         RowBox[{
          SuperscriptBox["\[CapitalOmega]", "1"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "z"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalOmega]", "2"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "z"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalOmega]", "3"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "z"]}]}]}]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "dcd55b4b-44b2-46db-b2e9-d7ba9a830115"]
}], "Text",ExpressionUUID->"879b91dd-0e71-4c17-8b01-91413d2296b4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Electric field update", "Subsubsection",ExpressionUUID->"3fd80d18-93a5-4473-a862-324c8acc4478"],

Cell[TextData[Cell[BoxData[{
 FormBox[
  RowBox[{
   RowBox[{"(", GridBox[{
      {
       RowBox[{
        SuperscriptBox["\[CapitalDelta]\[CapitalXi]", "1"], "/", 
        "\[CapitalDelta]t"}]},
      {
       RowBox[{
        SuperscriptBox["\[CapitalDelta]\[CapitalXi]", "2"], "/", 
        "\[CapitalDelta]t"}]},
      {
       RowBox[{
        SuperscriptBox["\[CapitalDelta]\[CapitalXi]", "3"], "/", 
        "\[CapitalDelta]t"}]}
     }], ")"}], "=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], "1"]},
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], "2"]},
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], "3"]}
       }], ")"}]}], "+", 
    RowBox[{
     FractionBox["c", 
      SqrtBox["g"]], 
     RowBox[{"(", GridBox[{
        {
         RowBox[{
          RowBox[{
           SubsuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "3", 
            RowBox[{"t", "+", 
             RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "/", 
           SuperscriptBox["\[CapitalDelta]x", "2"]}], "-", 
          RowBox[{
           SubsuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "2", 
            RowBox[{"t", "+", 
             RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "/", 
           SuperscriptBox["\[CapitalDelta]x", "3"]}]}]},
        {
         RowBox[{
          RowBox[{
           SubsuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "1", 
            RowBox[{"t", "+", 
             RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "/", 
           SuperscriptBox["\[CapitalDelta]x", "3"]}], "-", 
          RowBox[{
           SubsuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "3", 
            RowBox[{"t", "+", 
             RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "/", 
           SuperscriptBox["\[CapitalDelta]x", "1"]}]}]},
        {
         RowBox[{
          RowBox[{
           SubsuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "2", 
            RowBox[{"t", "+", 
             RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "/", 
           SuperscriptBox["\[CapitalDelta]x", "1"]}], "-", 
          RowBox[{
           SubsuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "1", 
            RowBox[{"t", "+", 
             RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "/", 
           SuperscriptBox["\[CapitalDelta]x", "2"]}]}]}
       }], ")"}]}]}]}], TraditionalForm], "\[IndentingNewLine]", 
 FormBox[
  RowBox[{"=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], "1"]},
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], "2"]},
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], "3"]}
       }], ")"}]}], "+", 
    RowBox[{
     FractionBox["c", 
      SqrtBox["g"]], 
     RowBox[{"(", GridBox[{
        {"0"},
        {
         RowBox[{
          RowBox[{"-", 
           SubsuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "3", 
            RowBox[{"t", "+", 
             RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], "/", 
          SuperscriptBox["\[CapitalDelta]x", "1"]}]},
        {
         RowBox[{
          SubsuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "2", 
           RowBox[{"t", "+", 
            RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "/", 
          SuperscriptBox["\[CapitalDelta]x", "1"]}]}
       }], ")"}]}], "+", 
    RowBox[{
     FractionBox["c", 
      SqrtBox["g"]], 
     RowBox[{"(", GridBox[{
        {
         RowBox[{
          SubsuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "3", 
           RowBox[{"t", "+", 
            RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "/", 
          SuperscriptBox["\[CapitalDelta]x", "2"]}]},
        {"0"},
        {
         RowBox[{
          RowBox[{"-", 
           SubsuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "1", 
            RowBox[{"t", "+", 
             RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], "/", 
          SuperscriptBox["\[CapitalDelta]x", "2"]}]}
       }], ")"}]}], "+", 
    RowBox[{
     FractionBox["c", 
      SqrtBox["g"]], 
     RowBox[{"(", GridBox[{
        {
         RowBox[{
          RowBox[{"-", 
           SubsuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "2", 
            RowBox[{"t", "+", 
             RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], "/", 
          SuperscriptBox["\[CapitalDelta]x", "3"]}]},
        {
         RowBox[{
          SubsuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "1", 
           RowBox[{"t", "+", 
            RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "/", 
          SuperscriptBox["\[CapitalDelta]x", "3"]}]},
        {"0"}
       }], ")"}]}]}]}], 
  TraditionalForm]}],ExpressionUUID->"406620f1-e044-4431-a7c9-d1d78e5b4c44"]],\
 "Text",ExpressionUUID->"b1b21436-00fc-42b2-8cee-4b54db7bc78e"],

Cell[TextData[{
 "Staggered grid:\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["\[CapitalXi]", 
         RowBox[{"t", "+", "\[CapitalDelta]t"}], 
         RowBox[{
          RowBox[{"1", ";", "i"}], ",", "j", ",", "k"}]]},
       {
        SubsuperscriptBox["\[CapitalXi]", 
         RowBox[{"t", "+", "\[CapitalDelta]t"}], 
         RowBox[{
          RowBox[{"2", ";", "i"}], ",", "j", ",", "k"}]]},
       {
        SubsuperscriptBox["\[CapitalXi]", 
         RowBox[{"t", "+", "\[CapitalDelta]t"}], 
         RowBox[{
          RowBox[{"3", ";", "i"}], ",", "j", ",", "k"}]]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["\[CapitalXi]", "t", 
          RowBox[{
           RowBox[{"1", ";", "i"}], ",", "j", ",", "k"}]]},
        {
         SubsuperscriptBox["\[CapitalXi]", "t", 
          RowBox[{
           RowBox[{"2", ";", "i"}], ",", "j", ",", "k"}]]},
        {
         SubsuperscriptBox["\[CapitalXi]", "t", 
          RowBox[{
           RowBox[{"3", ";", "i"}], ",", "j", ",", "k"}]]}
       }], ")"}], "-", 
     RowBox[{"\[CapitalDelta]t", "(", GridBox[{
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
          RowBox[{
           RowBox[{"1", ";", "i"}], ",", "j", ",", "k"}]]},
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
          RowBox[{
           RowBox[{"2", ";", "i"}], ",", "j", ",", "k"}]]},
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
          RowBox[{
           RowBox[{"3", ";", "i"}], ",", "j", ",", "k"}]]}
       }], ")"}]}]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{"+", 
     FractionBox[
      RowBox[{"c", " ", "\[CapitalDelta]t"}], 
      RowBox[{"4", 
       SqrtBox["g"], 
       SuperscriptBox["\[CapitalDelta]x", "1"]}]]}], 
    RowBox[{"(", GridBox[{
       {"0"},
       {
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"3", ";", "i"}], ",", "j", ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"3", ";", "i"}], ",", "j", ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"3", ";", "i"}], ",", 
                 RowBox[{"j", "-", "1"}], ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"3", ";", "i"}], ",", 
                 RowBox[{"j", "-", "1"}], ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}], ")"}], 
           "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"3", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", "j", ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"3", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", "j", ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"3", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", 
                 RowBox[{"j", "-", "1"}], ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"3", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", 
                 RowBox[{"j", "-", "1"}], ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}], 
            ")"}]}], ")"}]}]},
       {
        RowBox[{"+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"2", ";", "i"}], ",", "j", ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"2", ";", "i"}], ",", "j", ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"2", ";", "i"}], ",", 
                 RowBox[{"j", "-", "1"}], ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"2", ";", "i"}], ",", 
                 RowBox[{"j", "-", "1"}], ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}], ")"}], 
           "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"2", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", "j", ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"2", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", "j", ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"2", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", 
                 RowBox[{"j", "-", "1"}], ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"2", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", 
                 RowBox[{"j", "-", "1"}], ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}], 
            ")"}]}], ")"}]}]}
      }], ")"}]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{"+", 
     FractionBox[
      RowBox[{"c", " ", "\[CapitalDelta]t"}], 
      RowBox[{"4", 
       SqrtBox["g"], 
       SuperscriptBox["\[CapitalDelta]x", "2"]}]]}], 
    RowBox[{"(", GridBox[{
       {
        RowBox[{"+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"3", ";", "i"}], ",", "j", ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"3", ";", "i"}], ",", "j", ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"3", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", "j", ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"3", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", "j", ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}], ")"}], 
           "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"3", ";", "i"}], ",", 
                 RowBox[{"j", "-", "1"}], ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"3", ";", "i"}], ",", 
                 RowBox[{"j", "-", "1"}], ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"3", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", 
                 RowBox[{"j", "-", "1"}], ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"3", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", 
                 RowBox[{"j", "-", "1"}], ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}], 
            ")"}]}], ")"}]}]},
       {"0"},
       {
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"1", ";", "i"}], ",", "j", ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"1", ";", "i"}], ",", "j", ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"1", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", "j", ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"1", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", "j", ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}], ")"}], 
           "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"1", ";", "i"}], ",", 
                 RowBox[{"j", "-", "1"}], ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"1", ";", "i"}], ",", 
                 RowBox[{"j", "-", "1"}], ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"1", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", 
                 RowBox[{"j", "-", "1"}], ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"1", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", 
                 RowBox[{"j", "-", "1"}], ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}], 
            ")"}]}], ")"}]}]}
      }], ")"}]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{"+", 
     FractionBox[
      RowBox[{"c", " ", "\[CapitalDelta]t"}], 
      RowBox[{"4", 
       SqrtBox["g"], 
       SuperscriptBox["\[CapitalDelta]x", "3"]}]]}], 
    RowBox[{"(", GridBox[{
       {
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"2", ";", "i"}], ",", "j", ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"2", ";", "i"}], ",", 
                 RowBox[{"j", "-", "1"}], ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"2", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", "j", ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"2", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", 
                 RowBox[{"j", "-", "1"}], ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}], ")"}], 
           "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"2", ";", "i"}], ",", "j", ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"2", ";", "i"}], ",", 
                 RowBox[{"j", "-", "1"}], ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"2", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", "j", ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"2", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", 
                 RowBox[{"j", "-", "1"}], ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}], 
            ")"}]}], ")"}]}]},
       {
        RowBox[{"+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"1", ";", "i"}], ",", "j", ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"1", ";", "i"}], ",", 
                 RowBox[{"j", "-", "1"}], ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"1", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", "j", ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"1", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", 
                 RowBox[{"j", "-", "1"}], ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}], ")"}], 
           "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"1", ";", "i"}], ",", "j", ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"1", ";", "i"}], ",", 
                 RowBox[{"j", "-", "1"}], ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"1", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", "j", ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"1", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", 
                 RowBox[{"j", "-", "1"}], ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}], 
            ")"}]}], ")"}]}]},
       {"0"}
      }], ")"}]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["\[CapitalXi]", "t", 
          RowBox[{
           RowBox[{"1", ";", "i"}], ",", "j", ",", "k"}]]},
        {
         SubsuperscriptBox["\[CapitalXi]", "t", 
          RowBox[{
           RowBox[{"2", ";", "i"}], ",", "j", ",", "k"}]]},
        {
         SubsuperscriptBox["\[CapitalXi]", "t", 
          RowBox[{
           RowBox[{"3", ";", "i"}], ",", "j", ",", "k"}]]}
       }], ")"}], "-", 
     RowBox[{"\[CapitalDelta]t", "(", GridBox[{
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
          RowBox[{
           RowBox[{"1", ";", "i"}], ",", "j", ",", "k"}]]},
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
          RowBox[{
           RowBox[{"2", ";", "i"}], ",", "j", ",", "k"}]]},
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
          RowBox[{
           RowBox[{"3", ";", "i"}], ",", "j", ",", "k"}]]}
       }], ")"}]}]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{"+", 
     FractionBox[
      RowBox[{"c", " ", "\[CapitalDelta]t"}], 
      RowBox[{"4", 
       SqrtBox["g"], 
       SuperscriptBox["\[CapitalDelta]x", "1"]}]]}], 
    RowBox[{"(", GridBox[{
       {"0"},
       {
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"3", ";", "i"}], ",", "j", ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"3", ";", "i"}], ",", "j", ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"3", ";", "i"}], ",", 
                 RowBox[{"j", "-", "1"}], ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"3", ";", "i"}], ",", 
                 RowBox[{"j", "-", "1"}], ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}], ")"}], 
           "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"3", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", "j", ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"3", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", "j", ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"3", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", 
                 RowBox[{"j", "-", "1"}], ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"3", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", 
                 RowBox[{"j", "-", "1"}], ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}], 
            ")"}]}], ")"}]}]},
       {
        RowBox[{"+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"2", ";", "i"}], ",", "j", ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"2", ";", "i"}], ",", "j", ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"2", ";", "i"}], ",", 
                 RowBox[{"j", "-", "1"}], ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"2", ";", "i"}], ",", 
                 RowBox[{"j", "-", "1"}], ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}], ")"}], 
           "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"2", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", "j", ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"2", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", "j", ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"2", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", 
                 RowBox[{"j", "-", "1"}], ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"2", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", 
                 RowBox[{"j", "-", "1"}], ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}], 
            ")"}]}], ")"}]}]}
      }], ")"}]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{"+", 
     FractionBox[
      RowBox[{"c", " ", "\[CapitalDelta]t"}], 
      RowBox[{"4", 
       SqrtBox["g"], 
       SuperscriptBox["\[CapitalDelta]x", "2"]}]]}], 
    RowBox[{"(", GridBox[{
       {
        RowBox[{"+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"3", ";", "i"}], ",", "j", ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"3", ";", "i"}], ",", "j", ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}], "-", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"3", ";", "i"}], ",", 
                 RowBox[{"j", "-", "1"}], ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"3", ";", "i"}], ",", 
                 RowBox[{"j", "-", "1"}], ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}], ")"}], 
           "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"3", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", "j", ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"3", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", "j", ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}], "-", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"3", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", 
                 RowBox[{"j", "-", "1"}], ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"3", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", 
                 RowBox[{"j", "-", "1"}], ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}], 
            ")"}]}], ")"}]}]},
       {"0"},
       {
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"1", ";", "i"}], ",", "j", ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"1", ";", "i"}], ",", "j", ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}], "-", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"1", ";", "i"}], ",", 
                 RowBox[{"j", "-", "1"}], ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"1", ";", "i"}], ",", 
                 RowBox[{"j", "-", "1"}], ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}], ")"}], 
           "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"1", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", "j", ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"1", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", "j", ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}], "-", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"1", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", 
                 RowBox[{"j", "-", "1"}], ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "+", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"1", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", 
                 RowBox[{"j", "-", "1"}], ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}], 
            ")"}]}], ")"}]}]}
      }], ")"}]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{"+", 
     FractionBox[
      RowBox[{"c", " ", "\[CapitalDelta]t"}], 
      RowBox[{"4", 
       SqrtBox["g"], 
       SuperscriptBox["\[CapitalDelta]x", "3"]}]]}], 
    RowBox[{"(", GridBox[{
       {
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"2", ";", "i"}], ",", "j", ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "-", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"2", ";", "i"}], ",", "j", ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"2", ";", "i"}], ",", 
                 RowBox[{"j", "-", "1"}], ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "-", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"2", ";", "i"}], ",", 
                 RowBox[{"j", "-", "1"}], ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}], ")"}], 
           "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"2", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", "j", ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "-", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"2", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", "j", ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"2", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", 
                 RowBox[{"j", "-", "1"}], ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "-", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"2", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", 
                 RowBox[{"j", "-", "1"}], ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}], 
            ")"}]}], ")"}]}]},
       {
        RowBox[{"+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"1", ";", "i"}], ",", "j", ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "-", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"1", ";", "i"}], ",", "j", ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"1", ";", "i"}], ",", 
                 RowBox[{"j", "-", "1"}], ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "-", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"1", ";", "i"}], ",", 
                 RowBox[{"j", "-", "1"}], ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}], ")"}], 
           "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"1", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", "j", ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "-", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"1", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", "j", ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}], "+", 
             RowBox[{"(", 
              RowBox[{
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"1", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", 
                 RowBox[{"j", "-", "1"}], ",", "k"}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "-", 
               SubsuperscriptBox["\[CapitalOmega]", 
                RowBox[{
                 RowBox[{"1", ";", 
                  RowBox[{"i", "-", "1"}]}], ",", 
                 RowBox[{"j", "-", "1"}], ",", 
                 RowBox[{"k", "-", "1"}]}], 
                RowBox[{"t", "+", 
                 RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}], 
            ")"}]}], ")"}]}]},
       {"0"}
      }], ")"}]}], TraditionalForm]}],ExpressionUUID->
  "67e1b4ca-65a0-4f62-8e9f-e09784807afa"]
}], "Text",ExpressionUUID->"40120859-edbc-4c5f-a4cb-185d316c6176"],

Cell[TextData[{
 "Collocated grid:\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["\[CapitalXi]", 
         RowBox[{"t", "+", "\[CapitalDelta]t"}], 
         RowBox[{
          RowBox[{"1", ";", "i"}], ",", "j", ",", "k"}]]},
       {
        SubsuperscriptBox["\[CapitalXi]", 
         RowBox[{"t", "+", "\[CapitalDelta]t"}], 
         RowBox[{
          RowBox[{"2", ";", "i"}], ",", "j", ",", "k"}]]},
       {
        SubsuperscriptBox["\[CapitalXi]", 
         RowBox[{"t", "+", "\[CapitalDelta]t"}], 
         RowBox[{
          RowBox[{"3", ";", "i"}], ",", "j", ",", "k"}]]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["\[CapitalXi]", "t", 
          RowBox[{
           RowBox[{"1", ";", "i"}], ",", "j", ",", "k"}]]},
        {
         SubsuperscriptBox["\[CapitalXi]", "t", 
          RowBox[{
           RowBox[{"2", ";", "i"}], ",", "j", ",", "k"}]]},
        {
         SubsuperscriptBox["\[CapitalXi]", "t", 
          RowBox[{
           RowBox[{"3", ";", "i"}], ",", "j", ",", "k"}]]}
       }], ")"}], "-", 
     RowBox[{"\[CapitalDelta]t", "(", GridBox[{
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
          RowBox[{
           RowBox[{"1", ";", "i"}], ",", "j", ",", "k"}]]},
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
          RowBox[{
           RowBox[{"2", ";", "i"}], ",", "j", ",", "k"}]]},
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
          RowBox[{
           RowBox[{"3", ";", "i"}], ",", "j", ",", "k"}]]}
       }], ")"}]}]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{"+", 
     FractionBox[
      RowBox[{"c", " ", 
       RowBox[{"\[CapitalDelta]t", "/", 
        SqrtBox["g"]}]}], 
      RowBox[{"12", 
       SuperscriptBox["\[CapitalDelta]x", "1"]}]]}], 
    RowBox[{"(", GridBox[{
       {"0"},
       {
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           SubsuperscriptBox["\[CapitalOmega]", 
            RowBox[{
             RowBox[{"3", ";", 
              RowBox[{"i", "-", "2"}]}], ",", "j", ",", "k"}], 
            RowBox[{"t", "+", 
             RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "-", 
           RowBox[{"8", 
            SubsuperscriptBox["\[CapitalOmega]", 
             RowBox[{
              RowBox[{"3", ";", 
               RowBox[{"i", "-", "1"}]}], ",", "j", ",", "k"}], 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], "+", 
           RowBox[{"8", 
            SubsuperscriptBox["\[CapitalOmega]", 
             RowBox[{
              RowBox[{"3", ";", 
               RowBox[{"i", "+", "1"}]}], ",", "j", ",", "k"}], 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], "-", 
           SubsuperscriptBox["\[CapitalOmega]", 
            RowBox[{
             RowBox[{"3", ";", 
              RowBox[{"i", "+", "2"}]}], ",", "j", ",", "k"}], 
            RowBox[{"t", "+", 
             RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}]},
       {
        RowBox[{"+", 
         RowBox[{"(", 
          RowBox[{
           SubsuperscriptBox["\[CapitalOmega]", 
            RowBox[{
             RowBox[{"2", ";", 
              RowBox[{"i", "-", "2"}]}], ",", "j", ",", "k"}], 
            RowBox[{"t", "+", 
             RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "-", 
           RowBox[{"8", 
            SubsuperscriptBox["\[CapitalOmega]", 
             RowBox[{
              RowBox[{"2", ";", 
               RowBox[{"i", "-", "1"}]}], ",", "j", ",", "k"}], 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], "+", 
           RowBox[{"8", 
            SubsuperscriptBox["\[CapitalOmega]", 
             RowBox[{
              RowBox[{"2", ";", 
               RowBox[{"i", "+", "1"}]}], ",", "j", ",", "k"}], 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], "-", 
           SubsuperscriptBox["\[CapitalOmega]", 
            RowBox[{
             RowBox[{"2", ";", 
              RowBox[{"i", "+", "2"}]}], ",", "j", ",", "k"}], 
            RowBox[{"t", "+", 
             RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}]}
      }], ")"}]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{"+", 
     FractionBox[
      RowBox[{"c", " ", 
       RowBox[{"\[CapitalDelta]t", "/", 
        SqrtBox["g"]}]}], 
      RowBox[{"12", 
       SuperscriptBox["\[CapitalDelta]x", "2"]}]]}], 
    RowBox[{"(", GridBox[{
       {
        RowBox[{"+", 
         RowBox[{"(", 
          RowBox[{
           SubsuperscriptBox["\[CapitalOmega]", 
            RowBox[{
             RowBox[{"3", ";", "i"}], ",", 
             RowBox[{"j", "-", "2"}], ",", "k"}], 
            RowBox[{"t", "+", 
             RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "-", 
           RowBox[{"8", 
            SubsuperscriptBox["\[CapitalOmega]", 
             RowBox[{
              RowBox[{"3", ";", "i"}], ",", 
              RowBox[{"j", "-", "1"}], ",", "k"}], 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], "+", 
           RowBox[{"8", 
            SubsuperscriptBox["\[CapitalOmega]", 
             RowBox[{
              RowBox[{"3", ";", "i"}], ",", 
              RowBox[{"j", "+", "1"}], ",", "k"}], 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], "-", 
           SubsuperscriptBox["\[CapitalOmega]", 
            RowBox[{
             RowBox[{"3", ";", "i"}], ",", 
             RowBox[{"j", "+", "2"}], ",", "k"}], 
            RowBox[{"t", "+", 
             RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}]},
       {"0"},
       {
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           SubsuperscriptBox["\[CapitalOmega]", 
            RowBox[{
             RowBox[{"1", ";", "i"}], ",", 
             RowBox[{"j", "-", "2"}], ",", "k"}], 
            RowBox[{"t", "+", 
             RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "-", 
           RowBox[{"8", 
            SubsuperscriptBox["\[CapitalOmega]", 
             RowBox[{
              RowBox[{"1", ";", "i"}], ",", 
              RowBox[{"j", "-", "1"}], ",", "k"}], 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], "+", 
           RowBox[{"8", 
            SubsuperscriptBox["\[CapitalOmega]", 
             RowBox[{
              RowBox[{"1", ";", "i"}], ",", 
              RowBox[{"j", "+", "1"}], ",", "k"}], 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], "-", 
           SubsuperscriptBox["\[CapitalOmega]", 
            RowBox[{
             RowBox[{"1", ";", "i"}], ",", 
             RowBox[{"j", "+", "2"}], ",", "k"}], 
            RowBox[{"t", "+", 
             RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}]}
      }], ")"}]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{"+", 
     FractionBox[
      RowBox[{"c", " ", 
       RowBox[{"\[CapitalDelta]t", "/", 
        SqrtBox["g"]}]}], 
      RowBox[{"12", 
       SuperscriptBox["\[CapitalDelta]x", "3"]}]]}], 
    RowBox[{"(", GridBox[{
       {
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           SubsuperscriptBox["\[CapitalOmega]", 
            RowBox[{
             RowBox[{"2", ";", "i"}], ",", "j", ",", 
             RowBox[{"k", "-", "2"}]}], 
            RowBox[{"t", "+", 
             RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "-", 
           RowBox[{"8", 
            SubsuperscriptBox["\[CapitalOmega]", 
             RowBox[{
              RowBox[{"2", ";", "i"}], ",", "j", ",", 
              RowBox[{"k", "-", "1"}]}], 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], "+", 
           RowBox[{"8", 
            SubsuperscriptBox["\[CapitalOmega]", 
             RowBox[{
              RowBox[{"2", ";", "i"}], ",", "j", ",", 
              RowBox[{"k", "+", "1"}]}], 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], "-", 
           SubsuperscriptBox["\[CapitalOmega]", 
            RowBox[{
             RowBox[{"2", ";", "i"}], ",", "j", ",", 
             RowBox[{"k", "+", "2"}]}], 
            RowBox[{"t", "+", 
             RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}]},
       {
        RowBox[{"+", 
         RowBox[{"(", 
          RowBox[{
           SubsuperscriptBox["\[CapitalOmega]", 
            RowBox[{
             RowBox[{"1", ";", "i"}], ",", "j", ",", 
             RowBox[{"k", "-", "2"}]}], 
            RowBox[{"t", "+", 
             RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "-", 
           RowBox[{"8", 
            SubsuperscriptBox["\[CapitalOmega]", 
             RowBox[{
              RowBox[{"1", ";", "i"}], ",", "j", ",", 
              RowBox[{"k", "-", "1"}]}], 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], "+", 
           RowBox[{"8", 
            SubsuperscriptBox["\[CapitalOmega]", 
             RowBox[{
              RowBox[{"1", ";", "i"}], ",", "j", ",", 
              RowBox[{"k", "+", "1"}]}], 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], "-", 
           SubsuperscriptBox["\[CapitalOmega]", 
            RowBox[{
             RowBox[{"1", ";", "i"}], ",", "j", ",", 
             RowBox[{"k", "+", "2"}]}], 
            RowBox[{"t", "+", 
             RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}]},
       {"0"}
      }], ")"}]}], TraditionalForm]}],ExpressionUUID->
  "5d458be4-a3bc-4253-9cac-ad4ce482eefb"]
}], "Text",ExpressionUUID->"fdb5ab80-6aa4-41be-b363-0f7fe536d172"],

Cell[TextData[{
 "After update, calculate covariant components:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[CapitalXi]", "i"], "=", 
    RowBox[{
     SuperscriptBox["\[CapitalXi]", "j"], 
     SubscriptBox["g", 
      RowBox[{"i", "\[VeryThinSpace]", "j"}]]}]}], TraditionalForm]],
  ExpressionUUID->"4f92712e-1ff6-425f-b4be-424c3fcdd460"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["\[CapitalXi]", "1"]},
       {
        SubscriptBox["\[CapitalXi]", "2"]},
       {
        SubscriptBox["\[CapitalXi]", "3"]}
      }], ")"}], "=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         RowBox[{
          SubscriptBox["g", "11"], 
          SuperscriptBox["\[CapitalXi]", "1"]}], "+", 
         RowBox[{
          SubscriptBox["g", "12"], 
          SuperscriptBox["\[CapitalXi]", "2"]}], "+", 
         RowBox[{
          SubscriptBox["g", "13"], 
          SuperscriptBox["\[CapitalXi]", "3"]}]}]},
       {
        RowBox[{
         RowBox[{
          SubscriptBox["g", "21"], 
          SuperscriptBox["\[CapitalXi]", "1"]}], "+", 
         RowBox[{
          SubscriptBox["g", "22"], 
          SuperscriptBox["\[CapitalXi]", "2"]}], "+", 
         RowBox[{
          SubscriptBox["g", "23"], 
          SuperscriptBox["\[CapitalXi]", "3"]}]}]},
       {
        RowBox[{
         RowBox[{
          SubscriptBox["g", "31"], 
          SuperscriptBox["\[CapitalXi]", "1"]}], "+", 
         RowBox[{
          SubscriptBox["g", "32"], 
          SuperscriptBox["\[CapitalXi]", "2"]}], "+", 
         RowBox[{
          SubscriptBox["g", "33"], 
          SuperscriptBox["\[CapitalXi]", "3"]}]}]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "5da492dd-bcc8-4020-b90c-290b748b6b23"],
 ";\nand cartesian components:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["\[CapitalXi]", "x"]},
       {
        SubscriptBox["\[CapitalXi]", "y"]},
       {
        SubscriptBox["\[CapitalXi]", "z"]}
      }], ")"}], "=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         RowBox[{
          SuperscriptBox["\[CapitalXi]", "1"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "x"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalXi]", "2"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "x"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalXi]", "3"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "x"]}]}]}]},
       {
        RowBox[{
         RowBox[{
          SuperscriptBox["\[CapitalXi]", "1"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "y"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalXi]", "2"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "y"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalXi]", "3"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "y"]}]}]}]},
       {
        RowBox[{
         RowBox[{
          SuperscriptBox["\[CapitalXi]", "1"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "z"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalXi]", "2"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "z"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalXi]", "3"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "z"]}]}]}]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "db1791c9-31d4-450a-9d44-3bc1c9adcde7"]
}], "Text",ExpressionUUID->"80d4ea19-c2ef-4164-b5b7-9139120d47a8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cold fluid update", "Subsubsection",ExpressionUUID->"9b24c58e-01ec-4089-8f00-5fa6e94f06d7"],

Cell[TextData[{
 "Staggered grid:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"\[CapitalDelta]", "(", 
      RowBox[{
       SubscriptBox["\[Delta]n", "f"], "/", 
       SubscriptBox["n", 
        RowBox[{"f", ",", "0"}]]}], ")"}], "\[CapitalDelta]t"], "=", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       SqrtBox["g"]]}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"\[CapitalDelta]", "(", 
         RowBox[{
          SqrtBox["g"], 
          SubsuperscriptBox["V", 
           RowBox[{"f", ";", 
            RowBox[{"t", "+", 
             RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], "1"]}], ")"}], 
        SuperscriptBox["\[CapitalDelta]x", "1"]], "+", 
       FractionBox[
        RowBox[{"\[CapitalDelta]", "(", 
         RowBox[{
          SqrtBox["g"], 
          SubsuperscriptBox["V", 
           RowBox[{"f", ";", 
            RowBox[{"t", "+", 
             RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], "2"]}], ")"}], 
        SuperscriptBox["\[CapitalDelta]x", "2"]], "+", 
       FractionBox[
        RowBox[{"\[CapitalDelta]", "(", 
         RowBox[{
          SqrtBox["g"], 
          SubsuperscriptBox["V", 
           RowBox[{"f", ";", 
            RowBox[{"t", "+", 
             RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], "3"]}], ")"}], 
        SuperscriptBox["\[CapitalDelta]x", "3"]]}], ")"}]}]}], 
   TraditionalForm]],ExpressionUUID->"60f519a4-0268-4ef2-8b86-4d8478d993ce"],
 " \[DoubleRightArrow] \n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    FractionBox[
     SubsuperscriptBox["\[Delta]n", 
      RowBox[{
       RowBox[{"f", ";", "i"}], ",", "j", ",", "k"}], 
      RowBox[{"t", "+", "\[CapitalDelta]t"}]], 
     SubscriptBox["n", 
      RowBox[{"f", ",", "0"}]]], "=", 
    FractionBox[
     SubsuperscriptBox["\[Delta]n", 
      RowBox[{
       RowBox[{"f", ";", "i"}], ",", "j", ",", "k"}], "t"], 
     SubscriptBox["n", 
      RowBox[{"f", ",", "0"}]]]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"8", "\[CapitalDelta]t"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SqrtBox[
              SubscriptBox["g", 
               RowBox[{
                RowBox[{"i", "+", "1"}], ",", 
                RowBox[{"j", "+", "1"}], ",", 
                RowBox[{"k", "+", "1"}]}]]], "+", 
             SqrtBox[
              SubscriptBox["g", 
               RowBox[{"i", ",", 
                RowBox[{"j", "+", "1"}], ",", 
                RowBox[{"k", "+", "1"}]}]]]}], ")"}], "+", 
           RowBox[{"(", 
            RowBox[{
             SqrtBox[
              SubscriptBox["g", 
               RowBox[{
                RowBox[{"i", "+", "1"}], ",", "j", ",", 
                RowBox[{"k", "+", "1"}]}]]], "+", 
             SqrtBox[
              SubscriptBox["g", 
               RowBox[{"i", ",", "j", ",", 
                RowBox[{"k", "+", "1"}]}]]]}], ")"}]}], ")"}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SqrtBox[
              SubscriptBox["g", 
               RowBox[{
                RowBox[{"i", "+", "1"}], ",", 
                RowBox[{"j", "+", "1"}], ",", "k"}]]], "+", 
             SqrtBox[
              SubscriptBox["g", 
               RowBox[{"i", ",", 
                RowBox[{"j", "+", "1"}], ",", "k"}]]]}], ")"}], "+", 
           RowBox[{"(", 
            RowBox[{
             SqrtBox[
              SubscriptBox["g", 
               RowBox[{
                RowBox[{"i", "+", "1"}], ",", "j", ",", "k"}]]], "+", 
             SqrtBox[
              SubscriptBox["g", 
               RowBox[{"i", ",", "j", ",", "k"}]]]}], ")"}]}], ")"}]}], ")"}],
        "4", 
       SuperscriptBox["\[CapitalDelta]x", "1"]}]]}], "\[Times]", 
    "\[IndentingNewLine]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SqrtBox[
            SubscriptBox["g", 
             RowBox[{
              RowBox[{"i", "+", "1"}], ",", 
              RowBox[{"j", "+", "1"}], ",", 
              RowBox[{"k", "+", "1"}]}]]], 
           SubsuperscriptBox["V", 
            RowBox[{"f", ";", 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
            RowBox[{
             RowBox[{"1", ";", 
              RowBox[{"i", "+", "1"}]}], ",", 
             RowBox[{"j", "+", "1"}], ",", 
             RowBox[{"k", "+", "1"}]}]]}], "+", 
          RowBox[{
           SqrtBox[
            SubscriptBox["g", 
             RowBox[{
              RowBox[{"i", "+", "1"}], ",", 
              RowBox[{"j", "+", "1"}], ",", "k"}]]], 
           SubsuperscriptBox["V", 
            RowBox[{"f", ";", 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
            RowBox[{
             RowBox[{"1", ";", 
              RowBox[{"i", "+", "1"}]}], ",", 
             RowBox[{"j", "+", "1"}], ",", "k"}]]}]}], ")"}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SqrtBox[
            SubscriptBox["g", 
             RowBox[{
              RowBox[{"i", "+", "1"}], ",", "j", ",", 
              RowBox[{"k", "+", "1"}]}]]], 
           SubsuperscriptBox["V", 
            RowBox[{"f", ";", 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
            RowBox[{
             RowBox[{"1", ";", 
              RowBox[{"i", "+", "1"}]}], ",", "j", ",", 
             RowBox[{"k", "+", "1"}]}]]}], "+", 
          RowBox[{
           SqrtBox[
            SubscriptBox["g", 
             RowBox[{
              RowBox[{"i", "+", "1"}], ",", "j", ",", "k"}]]], 
           SubsuperscriptBox["V", 
            RowBox[{"f", ";", 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
            RowBox[{
             RowBox[{"1", ";", 
              RowBox[{"i", "+", "1"}]}], ",", "j", ",", "k"}]]}]}], ")"}]}], 
       ")"}], "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SqrtBox[
            SubscriptBox["g", 
             RowBox[{"i", ",", 
              RowBox[{"j", "+", "1"}], ",", 
              RowBox[{"k", "+", "1"}]}]]], 
           SubsuperscriptBox["V", 
            RowBox[{"f", ";", 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
            RowBox[{
             RowBox[{"1", ";", "i"}], ",", 
             RowBox[{"j", "+", "1"}], ",", 
             RowBox[{"k", "+", "1"}]}]]}], "+", 
          RowBox[{
           SqrtBox[
            SubscriptBox["g", 
             RowBox[{"i", ",", 
              RowBox[{"j", "+", "1"}], ",", "k"}]]], 
           SubsuperscriptBox["V", 
            RowBox[{"f", ";", 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
            RowBox[{
             RowBox[{"1", ";", "i"}], ",", 
             RowBox[{"j", "+", "1"}], ",", "k"}]]}]}], ")"}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SqrtBox[
            SubscriptBox["g", 
             RowBox[{"i", ",", "j", ",", 
              RowBox[{"k", "+", "1"}]}]]], 
           SubsuperscriptBox["V", 
            RowBox[{"f", ";", 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
            RowBox[{
             RowBox[{"1", ";", "i"}], ",", "j", ",", 
             RowBox[{"k", "+", "1"}]}]]}], "+", 
          RowBox[{
           SqrtBox[
            SubscriptBox["g", 
             RowBox[{"i", ",", "j", ",", "k"}]]], 
           SubsuperscriptBox["V", 
            RowBox[{"f", ";", 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
            RowBox[{
             RowBox[{"1", ";", "i"}], ",", "j", ",", "k"}]]}]}], ")"}]}], 
       ")"}]}], ")"}]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"8", "\[CapitalDelta]t"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SqrtBox[
              SubscriptBox["g", 
               RowBox[{
                RowBox[{"i", "+", "1"}], ",", 
                RowBox[{"j", "+", "1"}], ",", 
                RowBox[{"k", "+", "1"}]}]]], "+", 
             SqrtBox[
              SubscriptBox["g", 
               RowBox[{"i", ",", 
                RowBox[{"j", "+", "1"}], ",", 
                RowBox[{"k", "+", "1"}]}]]]}], ")"}], "+", 
           RowBox[{"(", 
            RowBox[{
             SqrtBox[
              SubscriptBox["g", 
               RowBox[{
                RowBox[{"i", "+", "1"}], ",", "j", ",", 
                RowBox[{"k", "+", "1"}]}]]], "+", 
             SqrtBox[
              SubscriptBox["g", 
               RowBox[{"i", ",", "j", ",", 
                RowBox[{"k", "+", "1"}]}]]]}], ")"}]}], ")"}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SqrtBox[
              SubscriptBox["g", 
               RowBox[{
                RowBox[{"i", "+", "1"}], ",", 
                RowBox[{"j", "+", "1"}], ",", "k"}]]], "+", 
             SqrtBox[
              SubscriptBox["g", 
               RowBox[{"i", ",", 
                RowBox[{"j", "+", "1"}], ",", "k"}]]]}], ")"}], "+", 
           RowBox[{"(", 
            RowBox[{
             SqrtBox[
              SubscriptBox["g", 
               RowBox[{
                RowBox[{"i", "+", "1"}], ",", "j", ",", "k"}]]], "+", 
             SqrtBox[
              SubscriptBox["g", 
               RowBox[{"i", ",", "j", ",", "k"}]]]}], ")"}]}], ")"}]}], ")"}],
        "4", 
       SuperscriptBox["\[CapitalDelta]x", "2"]}]]}], "\[Times]", 
    "\[IndentingNewLine]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SqrtBox[
            SubscriptBox["g", 
             RowBox[{
              RowBox[{"i", "+", "1"}], ",", 
              RowBox[{"j", "+", "1"}], ",", 
              RowBox[{"k", "+", "1"}]}]]], 
           SubsuperscriptBox["V", 
            RowBox[{"f", ";", 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
            RowBox[{
             RowBox[{"2", ";", 
              RowBox[{"i", "+", "1"}]}], ",", 
             RowBox[{"j", "+", "1"}], ",", 
             RowBox[{"k", "+", "1"}]}]]}], "+", 
          RowBox[{
           SqrtBox[
            SubscriptBox["g", 
             RowBox[{
              RowBox[{"i", "+", "1"}], ",", 
              RowBox[{"j", "+", "1"}], ",", "k"}]]], 
           SubsuperscriptBox["V", 
            RowBox[{"f", ";", 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
            RowBox[{
             RowBox[{"2", ";", 
              RowBox[{"i", "+", "1"}]}], ",", 
             RowBox[{"j", "+", "1"}], ",", "k"}]]}]}], ")"}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SqrtBox[
            SubscriptBox["g", 
             RowBox[{"i", ",", 
              RowBox[{"j", "+", "1"}], ",", 
              RowBox[{"k", "+", "1"}]}]]], 
           SubsuperscriptBox["V", 
            RowBox[{"f", ";", 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
            RowBox[{
             RowBox[{"2", ";", "i"}], ",", 
             RowBox[{"j", "+", "1"}], ",", 
             RowBox[{"k", "+", "1"}]}]]}], "+", 
          RowBox[{
           SqrtBox[
            SubscriptBox["g", 
             RowBox[{"i", ",", 
              RowBox[{"j", "+", "1"}], ",", "k"}]]], 
           SubsuperscriptBox["V", 
            RowBox[{"f", ";", 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
            RowBox[{
             RowBox[{"2", ";", "i"}], ",", 
             RowBox[{"j", "+", "1"}], ",", "k"}]]}]}], ")"}]}], ")"}], "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SqrtBox[
            SubscriptBox["g", 
             RowBox[{
              RowBox[{"i", "+", "1"}], ",", "j", ",", 
              RowBox[{"k", "+", "1"}]}]]], 
           SubsuperscriptBox["V", 
            RowBox[{"f", ";", 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
            RowBox[{
             RowBox[{"2", ";", 
              RowBox[{"i", "+", "1"}]}], ",", "j", ",", 
             RowBox[{"k", "+", "1"}]}]]}], "+", 
          RowBox[{
           SqrtBox[
            SubscriptBox["g", 
             RowBox[{
              RowBox[{"i", "+", "1"}], ",", "j", ",", "k"}]]], 
           SubsuperscriptBox["V", 
            RowBox[{"f", ";", 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
            RowBox[{
             RowBox[{"2", ";", 
              RowBox[{"i", "+", "1"}]}], ",", "j", ",", "k"}]]}]}], ")"}], 
        "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SqrtBox[
            SubscriptBox["g", 
             RowBox[{"i", ",", "j", ",", 
              RowBox[{"k", "+", "1"}]}]]], 
           SubsuperscriptBox["V", 
            RowBox[{"f", ";", 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
            RowBox[{
             RowBox[{"2", ";", "i"}], ",", "j", ",", 
             RowBox[{"k", "+", "1"}]}]]}], "+", 
          RowBox[{
           SqrtBox[
            SubscriptBox["g", 
             RowBox[{"i", ",", "j", ",", "k"}]]], 
           SubsuperscriptBox["V", 
            RowBox[{"f", ";", 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
            RowBox[{
             RowBox[{"2", ";", "i"}], ",", "j", ",", "k"}]]}]}], ")"}]}], 
       ")"}]}], ")"}]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"8", "\[CapitalDelta]t"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SqrtBox[
              SubscriptBox["g", 
               RowBox[{
                RowBox[{"i", "+", "1"}], ",", 
                RowBox[{"j", "+", "1"}], ",", 
                RowBox[{"k", "+", "1"}]}]]], "+", 
             SqrtBox[
              SubscriptBox["g", 
               RowBox[{"i", ",", 
                RowBox[{"j", "+", "1"}], ",", 
                RowBox[{"k", "+", "1"}]}]]]}], ")"}], "+", 
           RowBox[{"(", 
            RowBox[{
             SqrtBox[
              SubscriptBox["g", 
               RowBox[{
                RowBox[{"i", "+", "1"}], ",", "j", ",", 
                RowBox[{"k", "+", "1"}]}]]], "+", 
             SqrtBox[
              SubscriptBox["g", 
               RowBox[{"i", ",", "j", ",", 
                RowBox[{"k", "+", "1"}]}]]]}], ")"}]}], ")"}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SqrtBox[
              SubscriptBox["g", 
               RowBox[{
                RowBox[{"i", "+", "1"}], ",", 
                RowBox[{"j", "+", "1"}], ",", "k"}]]], "+", 
             SqrtBox[
              SubscriptBox["g", 
               RowBox[{"i", ",", 
                RowBox[{"j", "+", "1"}], ",", "k"}]]]}], ")"}], "+", 
           RowBox[{"(", 
            RowBox[{
             SqrtBox[
              SubscriptBox["g", 
               RowBox[{
                RowBox[{"i", "+", "1"}], ",", "j", ",", "k"}]]], "+", 
             SqrtBox[
              SubscriptBox["g", 
               RowBox[{"i", ",", "j", ",", "k"}]]]}], ")"}]}], ")"}]}], ")"}],
        "4", 
       SuperscriptBox["\[CapitalDelta]x", "3"]}]]}], "\[Times]", 
    "\[IndentingNewLine]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SqrtBox[
            SubscriptBox["g", 
             RowBox[{
              RowBox[{"i", "+", "1"}], ",", 
              RowBox[{"j", "+", "1"}], ",", 
              RowBox[{"k", "+", "1"}]}]]], 
           SubsuperscriptBox["V", 
            RowBox[{"f", ";", 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
            RowBox[{
             RowBox[{"3", ";", 
              RowBox[{"i", "+", "1"}]}], ",", 
             RowBox[{"j", "+", "1"}], ",", 
             RowBox[{"k", "+", "1"}]}]]}], "+", 
          RowBox[{
           SqrtBox[
            SubscriptBox["g", 
             RowBox[{
              RowBox[{"i", "+", "1"}], ",", "j", ",", 
              RowBox[{"k", "+", "1"}]}]]], 
           SubsuperscriptBox["V", 
            RowBox[{"f", ";", 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
            RowBox[{
             RowBox[{"3", ";", 
              RowBox[{"i", "+", "1"}]}], ",", "j", ",", 
             RowBox[{"k", "+", "1"}]}]]}]}], ")"}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SqrtBox[
            SubscriptBox["g", 
             RowBox[{"i", ",", 
              RowBox[{"j", "+", "1"}], ",", 
              RowBox[{"k", "+", "1"}]}]]], 
           SubsuperscriptBox["V", 
            RowBox[{"f", ";", 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
            RowBox[{
             RowBox[{"3", ";", "i"}], ",", 
             RowBox[{"j", "+", "1"}], ",", 
             RowBox[{"k", "+", "1"}]}]]}], "+", 
          RowBox[{
           SqrtBox[
            SubscriptBox["g", 
             RowBox[{"i", ",", "j", ",", 
              RowBox[{"k", "+", "1"}]}]]], 
           SubsuperscriptBox["V", 
            RowBox[{"f", ";", 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
            RowBox[{
             RowBox[{"3", ";", "i"}], ",", "j", ",", 
             RowBox[{"k", "+", "1"}]}]]}]}], ")"}]}], ")"}], "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SqrtBox[
            SubscriptBox["g", 
             RowBox[{
              RowBox[{"i", "+", "1"}], ",", 
              RowBox[{"j", "+", "1"}], ",", "k"}]]], 
           SubsuperscriptBox["V", 
            RowBox[{"f", ";", 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
            RowBox[{
             RowBox[{"3", ";", 
              RowBox[{"i", "+", "1"}]}], ",", 
             RowBox[{"j", "+", "1"}], ",", "k"}]]}], "+", 
          RowBox[{
           SqrtBox[
            SubscriptBox["g", 
             RowBox[{
              RowBox[{"i", "+", "1"}], ",", "j", ",", "k"}]]], 
           SubsuperscriptBox["V", 
            RowBox[{"f", ";", 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
            RowBox[{
             RowBox[{"3", ";", 
              RowBox[{"i", "+", "1"}]}], ",", "j", ",", "k"}]]}]}], ")"}], 
        "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SqrtBox[
            SubscriptBox["g", 
             RowBox[{"i", ",", 
              RowBox[{"j", "+", "1"}], ",", "k"}]]], 
           SubsuperscriptBox["V", 
            RowBox[{"f", ";", 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
            RowBox[{
             RowBox[{"3", ";", "i"}], ",", 
             RowBox[{"j", "+", "1"}], ",", "k"}]]}], "+", 
          RowBox[{
           SqrtBox[
            SubscriptBox["g", 
             RowBox[{"i", ",", "j", ",", "k"}]]], 
           SubsuperscriptBox["V", 
            RowBox[{"f", ";", 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
            RowBox[{
             RowBox[{"3", ";", "i"}], ",", "j", ",", "k"}]]}]}], ")"}]}], 
       ")"}]}], ")"}]}], TraditionalForm]}],ExpressionUUID->
  "4013971b-157b-4adb-af4e-ec50eb638008"]
}], "Text",ExpressionUUID->"86e4c864-bab1-4511-92f5-f0bb049731de"],

Cell[TextData[{
 "Collocated grid:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"\[CapitalDelta]", "(", 
      RowBox[{
       SubscriptBox["\[Delta]n", "f"], "/", 
       SubscriptBox["n", 
        RowBox[{"f", ",", "0"}]]}], ")"}], "\[CapitalDelta]t"], "=", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       SqrtBox["g"]]}], 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"\[CapitalDelta]", "(", 
         RowBox[{
          SqrtBox["g"], 
          SubsuperscriptBox["V", 
           RowBox[{"f", ";", 
            RowBox[{"t", "+", 
             RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], "1"]}], ")"}], 
        SuperscriptBox["\[CapitalDelta]x", "1"]], "+", 
       FractionBox[
        RowBox[{"\[CapitalDelta]", "(", 
         RowBox[{
          SqrtBox["g"], 
          SubsuperscriptBox["V", 
           RowBox[{"f", ";", 
            RowBox[{"t", "+", 
             RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], "2"]}], ")"}], 
        SuperscriptBox["\[CapitalDelta]x", "2"]], "+", 
       FractionBox[
        RowBox[{"\[CapitalDelta]", "(", 
         RowBox[{
          SqrtBox["g"], 
          SubsuperscriptBox["V", 
           RowBox[{"f", ";", 
            RowBox[{"t", "+", 
             RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], "3"]}], ")"}], 
        SuperscriptBox["\[CapitalDelta]x", "3"]]}], ")"}]}]}], 
   TraditionalForm]],ExpressionUUID->"a30f3a48-2f90-45a2-b6a0-f86ea1948f3e"],
 " \[DoubleRightArrow] \n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    FractionBox[
     SubsuperscriptBox["\[Delta]n", 
      RowBox[{
       RowBox[{"f", ";", "i"}], ",", "j", ",", "k"}], 
      RowBox[{"t", "+", "\[CapitalDelta]t"}]], 
     SubscriptBox["n", 
      RowBox[{"f", ",", "0"}]]], "=", 
    FractionBox[
     SubsuperscriptBox["\[Delta]n", 
      RowBox[{
       RowBox[{"f", ";", "i"}], ",", "j", ",", "k"}], "t"], 
     SubscriptBox["n", 
      RowBox[{"f", ",", "0"}]]]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"\[CapitalDelta]t", "/", 
       SqrtBox[
        SubscriptBox["g", 
         RowBox[{"i", ",", "j", ",", "k"}]]]}], 
      RowBox[{"12", 
       SuperscriptBox["\[CapitalDelta]x", "1"]}]]}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SqrtBox[
        SubscriptBox["g", 
         RowBox[{
          RowBox[{"i", "-", "2"}], ",", "j", ",", "k"}]]], 
       SubsuperscriptBox["V", 
        RowBox[{"f", ";", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
        RowBox[{
         RowBox[{"1", ";", 
          RowBox[{"i", "-", "2"}]}], ",", "j", ",", "k"}]]}], "-", 
      RowBox[{"8", 
       SqrtBox[
        SubscriptBox["g", 
         RowBox[{
          RowBox[{"i", "-", "1"}], ",", "j", ",", "k"}]]], 
       SubsuperscriptBox["V", 
        RowBox[{"f", ";", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
        RowBox[{
         RowBox[{"1", ";", 
          RowBox[{"i", "-", "1"}]}], ",", "j", ",", "k"}]]}], "+", 
      RowBox[{"8", 
       SqrtBox[
        SubscriptBox["g", 
         RowBox[{
          RowBox[{"i", "+", "1"}], ",", "j", ",", "k"}]]], 
       SubsuperscriptBox["V", 
        RowBox[{"f", ";", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
        RowBox[{
         RowBox[{"1", ";", 
          RowBox[{"i", "+", "1"}]}], ",", "j", ",", "k"}]]}], "-", 
      RowBox[{
       SqrtBox[
        SubscriptBox["g", 
         RowBox[{
          RowBox[{"i", "+", "2"}], ",", "j", ",", "k"}]]], 
       SubsuperscriptBox["V", 
        RowBox[{"f", ";", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
        RowBox[{
         RowBox[{"1", ";", 
          RowBox[{"i", "+", "2"}]}], ",", "j", ",", "k"}]]}]}], ")"}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"\[CapitalDelta]t", "/", 
       SqrtBox[
        SubscriptBox["g", 
         RowBox[{"i", ",", "j", ",", "k"}]]]}], 
      RowBox[{"12", 
       SuperscriptBox["\[CapitalDelta]x", "2"]}]]}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SqrtBox[
        SubscriptBox["g", 
         RowBox[{"i", ",", 
          RowBox[{"j", "-", "2"}], ",", "k"}]]], 
       SubsuperscriptBox["V", 
        RowBox[{"f", ";", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
        RowBox[{
         RowBox[{"2", ";", "i"}], ",", 
         RowBox[{"j", "-", "2"}], ",", "k"}]]}], "-", 
      RowBox[{"8", 
       SqrtBox[
        SubscriptBox["g", 
         RowBox[{"i", ",", 
          RowBox[{"j", "-", "1"}], ",", "k"}]]], 
       SubsuperscriptBox["V", 
        RowBox[{"f", ";", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
        RowBox[{
         RowBox[{"2", ";", "i"}], ",", 
         RowBox[{"j", "-", "1"}], ",", "k"}]]}], "+", 
      RowBox[{"8", 
       SqrtBox[
        SubscriptBox["g", 
         RowBox[{"i", ",", 
          RowBox[{"j", "+", "1"}], ",", "k"}]]], 
       SubsuperscriptBox["V", 
        RowBox[{"f", ";", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
        RowBox[{
         RowBox[{"2", ";", "i"}], ",", 
         RowBox[{"j", "+", "1"}], ",", "k"}]]}], "-", 
      RowBox[{
       SqrtBox[
        SubscriptBox["g", 
         RowBox[{"i", ",", 
          RowBox[{"j", "+", "2"}], ",", "k"}]]], 
       SubsuperscriptBox["V", 
        RowBox[{"f", ";", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
        RowBox[{
         RowBox[{"2", ";", "i"}], ",", 
         RowBox[{"j", "+", "2"}], ",", "k"}]]}]}], ")"}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"\[CapitalDelta]t", "/", 
       SqrtBox[
        SubscriptBox["g", 
         RowBox[{"i", ",", "j", ",", "k"}]]]}], 
      RowBox[{"12", 
       SuperscriptBox["\[CapitalDelta]x", "3"]}]]}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SqrtBox[
        SubscriptBox["g", 
         RowBox[{"i", ",", "j", ",", 
          RowBox[{"k", "-", "2"}]}]]], 
       SubsuperscriptBox["V", 
        RowBox[{"f", ";", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
        RowBox[{
         RowBox[{"3", ";", "i"}], ",", "j", ",", 
         RowBox[{"k", "-", "2"}]}]]}], "-", 
      RowBox[{"8", 
       SqrtBox[
        SubscriptBox["g", 
         RowBox[{"i", ",", "j", ",", 
          RowBox[{"k", "-", "1"}]}]]], 
       SubsuperscriptBox["V", 
        RowBox[{"f", ";", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
        RowBox[{
         RowBox[{"3", ";", "i"}], ",", "j", ",", 
         RowBox[{"k", "-", "1"}]}]]}], "+", 
      RowBox[{"8", 
       SqrtBox[
        SubscriptBox["g", 
         RowBox[{"i", ",", "j", ",", 
          RowBox[{"k", "+", "1"}]}]]], 
       SubsuperscriptBox["V", 
        RowBox[{"f", ";", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
        RowBox[{
         RowBox[{"3", ";", "i"}], ",", "j", ",", 
         RowBox[{"k", "+", "1"}]}]]}], "-", 
      RowBox[{
       SqrtBox[
        SubscriptBox["g", 
         RowBox[{"i", ",", "j", ",", 
          RowBox[{"k", "+", "2"}]}]]], 
       SubsuperscriptBox["V", 
        RowBox[{"f", ";", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}]}], 
        RowBox[{
         RowBox[{"3", ";", "i"}], ",", "j", ",", 
         RowBox[{"k", "+", "2"}]}]]}]}], ")"}]}], TraditionalForm]}],
  ExpressionUUID->"9ab04b9b-a676-45d7-b87f-9413a8807801"]
}], "Text",ExpressionUUID->"c290a6d5-6d21-4b39-8935-2b159b8a9447"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Position update", "Subsubsection",ExpressionUUID->"e095697b-fa84-415e-9f91-22e10365ec3b"],

Cell[TextData[{
 "Cartesian to curvilinear:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SuperscriptBox["v", "1"]},
       {
        SuperscriptBox["v", "2"]},
       {
        SuperscriptBox["v", "3"]}
      }], ")"}], "=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         RowBox[{
          SubscriptBox["v", "x"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "x"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"]}]}], "+", 
         RowBox[{
          SubscriptBox["v", "y"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "y"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"]}]}], "+", 
         RowBox[{
          SubscriptBox["v", "z"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "z"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"]}]}]}]},
       {
        RowBox[{
         RowBox[{
          SubscriptBox["v", "x"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "x"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"]}]}], "+", 
         RowBox[{
          SubscriptBox["v", "y"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "y"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"]}]}], "+", 
         RowBox[{
          SubscriptBox["v", "z"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "z"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"]}]}]}]},
       {
        RowBox[{
         RowBox[{
          SubscriptBox["v", "x"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "x"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"]}]}], "+", 
         RowBox[{
          SubscriptBox["v", "y"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "y"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"]}]}], "+", 
         RowBox[{
          SubscriptBox["v", "z"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "z"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"]}]}]}]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "797c471c-001d-443a-a7da-8fda01dfac0d"]
}], "Text",ExpressionUUID->"c34d9577-3ec3-4649-915c-b9b359f35ad0"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["x", 
     RowBox[{"t", "+", "\[CapitalDelta]t"}], "1"], "=", 
    RowBox[{
     SubsuperscriptBox["x", "t", "1"], "+", 
     RowBox[{"\[CapitalDelta]t", " ", 
      SubsuperscriptBox["v", 
       RowBox[{"t", "+", 
        RowBox[{"\[CapitalDelta]t", "/", "2"}]}], "1"]}]}]}], 
   TraditionalForm]],ExpressionUUID->"f9168655-4cec-4507-be77-a5ea61dc1c34"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["x", 
     RowBox[{"t", "+", "\[CapitalDelta]t"}], "2"], "=", 
    RowBox[{
     SubsuperscriptBox["x", "t", "2"], "+", 
     RowBox[{"\[CapitalDelta]t", " ", 
      SubsuperscriptBox["v", 
       RowBox[{"t", "+", 
        RowBox[{"\[CapitalDelta]t", "/", "2"}]}], "2"]}]}]}], 
   TraditionalForm]],ExpressionUUID->"5639ce7b-6afa-47ab-98ff-4bd266e5e9a6"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["x", 
     RowBox[{"t", "+", "\[CapitalDelta]t"}], "3"], "=", 
    RowBox[{
     SubsuperscriptBox["x", "t", "3"], "+", 
     RowBox[{"\[CapitalDelta]t", " ", 
      SubsuperscriptBox["v", 
       RowBox[{"t", "+", 
        RowBox[{"\[CapitalDelta]t", "/", "2"}]}], "3"]}]}]}], 
   TraditionalForm]],ExpressionUUID->"7b6a4c2a-f27c-4e0f-b5cd-5c121ef00765"],
 "."
}], "Text",ExpressionUUID->"8d343955-6fe7-4eba-9d46-2a86941bd879"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Velocity update in cartesian coordinate", "Subsubsection",ExpressionUUID->"3ca03ab2-b7fc-416e-8f69-fc4a8674c595"],

Cell[TextData[{
 "Step 0 - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         SubscriptBox["\[CapitalXi]", "x"], "[", 
         RowBox[{
          SubsuperscriptBox["x", "t", "1"], ",", 
          SubsuperscriptBox["x", "t", "2"], ",", 
          SubsuperscriptBox["x", "t", "3"]}], "]"}]},
       {
        RowBox[{
         SubscriptBox["\[CapitalXi]", "y"], "[", 
         RowBox[{
          SubsuperscriptBox["x", "t", "1"], ",", 
          SubsuperscriptBox["x", "t", "2"], ",", 
          SubsuperscriptBox["x", "t", "3"]}], "]"}]},
       {
        RowBox[{
         SubscriptBox["\[CapitalXi]", "z"], "[", 
         RowBox[{
          SubsuperscriptBox["x", "t", "1"], ",", 
          SubsuperscriptBox["x", "t", "2"], ",", 
          SubsuperscriptBox["x", "t", "3"]}], "]"}]}
      }], ")"}], "=", 
    RowBox[{
     SubscriptBox["\[Sum]", 
      RowBox[{"i", ",", "j", ",", "k"}]], 
     RowBox[{
      RowBox[{"(", GridBox[{
         {
          SubsuperscriptBox["\[CapitalXi]", 
           RowBox[{
            RowBox[{"x", ";", "i"}], ",", "j", ",", "k"}], "t"]},
         {
          SubsuperscriptBox["\[CapitalXi]", 
           RowBox[{
            RowBox[{"y", ";", "i"}], ",", "j", ",", "k"}], "t"]},
         {
          SubsuperscriptBox["\[CapitalXi]", 
           RowBox[{
            RowBox[{"z", ";", "i"}], ",", "j", ",", "k"}], "t"]}
        }], ")"}], 
      RowBox[{"S", "[", 
       RowBox[{
        SubsuperscriptBox["x", "t", "1"], "-", 
        SuperscriptBox["x", 
         RowBox[{"1", ";", "i"}]]}], "]"}], 
      RowBox[{"S", "[", 
       RowBox[{
        SubsuperscriptBox["x", "t", "2"], "-", 
        SuperscriptBox["x", 
         RowBox[{"2", ";", "j"}]]}], "]"}], 
      RowBox[{"S", "[", 
       RowBox[{
        SubsuperscriptBox["x", "t", "3"], "-", 
        SuperscriptBox["x", 
         RowBox[{"3", ";", "k"}]]}], "]"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"94aecf00-5f1a-47a3-8bb2-dafd969b4396"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         SubscriptBox["\[CapitalOmega]", "x"], "[", 
         RowBox[{
          SubsuperscriptBox["x", "t", "1"], ",", 
          SubsuperscriptBox["x", "t", "2"], ",", 
          SubsuperscriptBox["x", "t", "3"]}], "]"}]},
       {
        RowBox[{
         SubscriptBox["\[CapitalOmega]", "y"], "[", 
         RowBox[{
          SubsuperscriptBox["x", "t", "1"], ",", 
          SubsuperscriptBox["x", "t", "2"], ",", 
          SubsuperscriptBox["x", "t", "3"]}], "]"}]},
       {
        RowBox[{
         SubscriptBox["\[CapitalOmega]", "z"], "[", 
         RowBox[{
          SubsuperscriptBox["x", "t", "1"], ",", 
          SubsuperscriptBox["x", "t", "2"], ",", 
          SubsuperscriptBox["x", "t", "3"]}], "]"}]}
      }], ")"}], "=", 
    RowBox[{
     SubscriptBox["\[Sum]", 
      RowBox[{"i", ",", "j", ",", "k"}]], 
     RowBox[{
      RowBox[{"(", GridBox[{
         {
          SubsuperscriptBox["\[CapitalOmega]", 
           RowBox[{
            RowBox[{"x", ";", "i"}], ",", "j", ",", "k"}], "t"]},
         {
          SubsuperscriptBox["\[CapitalOmega]", 
           RowBox[{
            RowBox[{"y", ";", "i"}], ",", "j", ",", "k"}], "t"]},
         {
          SubsuperscriptBox["\[CapitalOmega]", 
           RowBox[{
            RowBox[{"z", ";", "i"}], ",", "j", ",", "k"}], "t"]}
        }], ")"}], 
      RowBox[{"S", "[", 
       RowBox[{
        SubsuperscriptBox["x", "t", "1"], "-", 
        RowBox[{
         SuperscriptBox["\[CapitalDelta]x", "1"], "/", "2"}], "-", 
        SuperscriptBox["x", 
         RowBox[{"1", ";", "i"}]]}], "]"}], 
      RowBox[{"S", "[", 
       RowBox[{
        SubsuperscriptBox["x", "t", "2"], "-", 
        RowBox[{
         SuperscriptBox["\[CapitalDelta]x", "2"], "/", "2"}], "-", 
        SuperscriptBox["x", 
         RowBox[{"2", ";", "j"}]]}], "]"}], 
      RowBox[{"S", "[", 
       RowBox[{
        SubsuperscriptBox["x", "t", "3"], "-", 
        RowBox[{
         SuperscriptBox["\[CapitalDelta]x", "3"], "/", "2"}], "-", 
        SuperscriptBox["x", 
         RowBox[{"3", ";", "k"}]]}], "]"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"b88091dc-88a2-4ebf-90be-5b21b8cedcb9"],
 ",\nStep 1 - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["v", "x", "-"]},
       {
        SubsuperscriptBox["v", "y", "-"]},
       {
        SubsuperscriptBox["v", "z", "-"]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["v", "x", 
          RowBox[{"t", "-", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]},
        {
         SubsuperscriptBox["v", "y", 
          RowBox[{"t", "-", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]},
        {
         SubsuperscriptBox["v", "z", 
          RowBox[{"t", "-", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}
       }], ")"}], "+", 
     RowBox[{
      FractionBox[
       SubscriptBox["\[CapitalOmega]", "s"], 
       SubscriptBox["\[CapitalOmega]", "0"]], 
      FractionBox[
       RowBox[{"c", " ", "\[CapitalDelta]t"}], "2"], 
      RowBox[{"(", GridBox[{
         {
          SubsuperscriptBox["\[CapitalXi]", "x", "t"]},
         {
          SubsuperscriptBox["\[CapitalXi]", "y", "t"]},
         {
          SubsuperscriptBox["\[CapitalXi]", "z", "t"]}
        }], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "f2ed2350-359a-4c43-849f-2e217fe1c470"],
 ",\nStep 2 - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["v", "x", "0"]},
       {
        SubsuperscriptBox["v", "y", "0"]},
       {
        SubsuperscriptBox["v", "z", "0"]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["v", "x", "-"]},
        {
         SubsuperscriptBox["v", "y", "-"]},
        {
         SubsuperscriptBox["v", "z", "-"]}
       }], ")"}], "+", 
     RowBox[{
      FractionBox[
       SubscriptBox["\[CapitalOmega]", "s"], 
       SubscriptBox["\[CapitalOmega]", "0"]], 
      FractionBox["\[CapitalDelta]t", "2"], 
      RowBox[{"(", GridBox[{
         {
          RowBox[{
           RowBox[{
            SubsuperscriptBox["v", "y", "-"], 
            SubsuperscriptBox["\[CapitalOmega]", "z", "t"]}], "-", 
           RowBox[{
            SubsuperscriptBox["v", "z", "-"], 
            SubsuperscriptBox["\[CapitalOmega]", "y", "t"]}]}]},
         {
          RowBox[{
           RowBox[{
            SubsuperscriptBox["v", "z", "-"], 
            SubsuperscriptBox["\[CapitalOmega]", "x", "t"]}], "-", 
           RowBox[{
            SubsuperscriptBox["v", "x", "-"], 
            SubsuperscriptBox["\[CapitalOmega]", "z", "t"]}]}]},
         {
          RowBox[{
           RowBox[{
            SubsuperscriptBox["v", "x", "-"], 
            SubsuperscriptBox["\[CapitalOmega]", "y", "t"]}], "-", 
           RowBox[{
            SubsuperscriptBox["v", "y", "-"], 
            SubsuperscriptBox["\[CapitalOmega]", "x", "t"]}]}]}
        }], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "23f9375b-2ffd-4f65-942c-a2ce72b2fae0"],
 ",\nStep 3 - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["v", "x", "+"]},
       {
        SubsuperscriptBox["v", "y", "+"]},
       {
        SubsuperscriptBox["v", "z", "+"]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["v", "x", "-"]},
        {
         SubsuperscriptBox["v", "y", "-"]},
        {
         SubsuperscriptBox["v", "z", "-"]}
       }], ")"}], "+", 
     RowBox[{
      FractionBox[
       SubscriptBox["\[CapitalOmega]", "s"], 
       SubscriptBox["\[CapitalOmega]", "0"]], 
      FractionBox["\[CapitalDelta]t", "2"], 
      FractionBox["2", 
       RowBox[{"1", "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             SubscriptBox["\[CapitalOmega]", "s"], 
             SubscriptBox["\[CapitalOmega]", "0"]], 
            FractionBox["\[CapitalDelta]t", "2"]}], ")"}], "2"], 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             SubsuperscriptBox["\[CapitalOmega]", "x", "t"], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             SubsuperscriptBox["\[CapitalOmega]", "y", "t"], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             SubsuperscriptBox["\[CapitalOmega]", "z", "t"], ")"}], "2"]}], 
          ")"}]}]}]], 
      RowBox[{"(", GridBox[{
         {
          RowBox[{
           RowBox[{
            SubsuperscriptBox["v", "y", "0"], 
            SubsuperscriptBox["\[CapitalOmega]", "z", "t"]}], "-", 
           RowBox[{
            SubsuperscriptBox["v", "z", "0"], 
            SubsuperscriptBox["\[CapitalOmega]", "y", "t"]}]}]},
         {
          RowBox[{
           RowBox[{
            SubsuperscriptBox["v", "z", "0"], 
            SubsuperscriptBox["\[CapitalOmega]", "x", "t"]}], "-", 
           RowBox[{
            SubsuperscriptBox["v", "x", "0"], 
            SubsuperscriptBox["\[CapitalOmega]", "z", "t"]}]}]},
         {
          RowBox[{
           RowBox[{
            SubsuperscriptBox["v", "x", "0"], 
            SubsuperscriptBox["\[CapitalOmega]", "y", "t"]}], "-", 
           RowBox[{
            SubsuperscriptBox["v", "y", "0"], 
            SubsuperscriptBox["\[CapitalOmega]", "x", "t"]}]}]}
        }], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "dba61641-5305-4923-a64a-4b9d3494ddbb"],
 ", and\nStep 4 - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["v", "x", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]},
       {
        SubsuperscriptBox["v", "y", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]},
       {
        SubsuperscriptBox["v", "z", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["v", "x", "+"]},
        {
         SubsuperscriptBox["v", "y", "+"]},
        {
         SubsuperscriptBox["v", "z", "+"]}
       }], ")"}], "+", 
     RowBox[{
      FractionBox[
       SubscriptBox["\[CapitalOmega]", "s"], 
       SubscriptBox["\[CapitalOmega]", "0"]], 
      FractionBox[
       RowBox[{"c", " ", "\[CapitalDelta]t"}], "2"], 
      RowBox[{"(", GridBox[{
         {
          SubsuperscriptBox["\[CapitalXi]", "x", "t"]},
         {
          SubsuperscriptBox["\[CapitalXi]", "y", "t"]},
         {
          SubsuperscriptBox["\[CapitalXi]", "z", "t"]}
        }], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "840d6133-13d5-41aa-97fe-7bf64682c695"],
 "."
}], "Text",ExpressionUUID->"545bd01b-fb66-41d6-8ac5-fbf64bcbaf35"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Moments: from particle to grid", "Subsubsection",ExpressionUUID->"b2aecc36-9604-497d-87cf-892c4fb6d61f"],

Cell[TextData[{
 "Number density (zeroth velocity moment) at ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],ExpressionUUID->
  "c3bd28b5-9493-47c9-a83c-91cd27496536"],
 "th grid point:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["n", 
     RowBox[{"t", ";", "s"}], 
     RowBox[{"i", ",", "j", ",", "k"}]], "=", 
    RowBox[{
     RowBox[{
      SubsuperscriptBox["n", 
       RowBox[{"0", ";", "s"}], 
       RowBox[{"i", ",", "j", ",", "k"}]], 
      FractionBox[
       RowBox[{
        SubscriptBox["\[Sum]", "p"], 
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{
           SubsuperscriptBox["x", 
            RowBox[{"t", ";", "s"}], 
            RowBox[{"1", ";", "p"}]], "-", 
           SuperscriptBox["x", 
            RowBox[{"1", ";", "i"}]]}], "]"}], 
         RowBox[{"S", "[", 
          RowBox[{
           SubsuperscriptBox["x", 
            RowBox[{"t", ";", "s"}], 
            RowBox[{"2", ";", "p"}]], "-", 
           SuperscriptBox["x", 
            RowBox[{"2", ";", "j"}]]}], "]"}], 
         RowBox[{"S", "[", 
          RowBox[{
           SubsuperscriptBox["x", 
            RowBox[{"t", ";", "s"}], 
            RowBox[{"3", ";", "p"}]], "-", 
           SuperscriptBox["x", 
            RowBox[{"3", ";", "k"}]]}], "]"}]}]}], 
       SubsuperscriptBox["N", 
        RowBox[{"c", ";", "s"}], 
        RowBox[{
         RowBox[{"0", ";", "i"}], ",", "j", ",", "k"}]]]}], "=", 
     RowBox[{
      SubscriptBox["n", 
       RowBox[{"0", ";", "s"}]], 
      FractionBox[
       RowBox[{
        SubscriptBox["\[Sum]", "p"], 
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{
           SubsuperscriptBox["x", 
            RowBox[{"t", ";", "s"}], 
            RowBox[{"1", ";", "p"}]], "-", 
           SuperscriptBox["x", 
            RowBox[{"1", ";", "i"}]]}], "]"}], 
         RowBox[{"S", "[", 
          RowBox[{
           SubsuperscriptBox["x", 
            RowBox[{"t", ";", "s"}], 
            RowBox[{"2", ";", "p"}]], "-", 
           SuperscriptBox["x", 
            RowBox[{"2", ";", "j"}]]}], "]"}], 
         RowBox[{"S", "[", 
          RowBox[{
           SubsuperscriptBox["x", 
            RowBox[{"t", ";", "s"}], 
            RowBox[{"3", ";", "p"}]], "-", 
           SuperscriptBox["x", 
            RowBox[{"3", ";", "k"}]]}], "]"}]}]}], 
       SubscriptBox["N", 
        RowBox[{"c", ";", "s"}]]]}]}]}], TraditionalForm]],ExpressionUUID->
  "1df8ae94-93aa-420a-8e0c-689bfabfae44"],
 ", where ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["N", 
    RowBox[{"c", ";", "s"}], "0"], TraditionalForm]],ExpressionUUID->
  "af5d546f-c238-49c4-a5b4-ec4b3f08ccbd"],
 " is the initial number of simulation particles of species ",
 Cell[BoxData[
  FormBox["s", TraditionalForm]],ExpressionUUID->
  "fa62cfcc-0d5e-4cff-bf1c-ab4d2c1c69d0"],
 " at a reference cell; ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", 
    RowBox[{"0", ";", "s"}]], TraditionalForm]],ExpressionUUID->
  "2ed186ae-96b7-4790-8761-a78f3e33ca49"],
 " is the initial number density of the species ",
 Cell[BoxData[
  FormBox["s", TraditionalForm]],ExpressionUUID->
  "25f99386-e928-4f77-b9f8-199f36c2cd00"],
 " at that cell; ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["N", 
    RowBox[{"c", ";", "s"}], 
    RowBox[{
     RowBox[{"0", ";", "i"}], ",", "j", ",", "k"}]], TraditionalForm]],
  ExpressionUUID->"480e7121-9c40-41ef-b81d-926f7d055821"],
 " is the initial number of simulation particles at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["q", "i"], ",", 
     SuperscriptBox["q", "j"], ",", 
     SuperscriptBox["q", "k"]}], ")"}], TraditionalForm]],ExpressionUUID->
  "c2ad5ef8-3de8-4497-8b3b-88b4479a82ed"],
 " cell; and ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["n", 
    RowBox[{"0", ";", "s"}], 
    RowBox[{"i", ",", "j", ",", "k"}]], TraditionalForm]],ExpressionUUID->
  "dc728eeb-b7a7-4626-840a-ca8f2234f40e"],
 " is the initial number density at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["q", "i"], ",", 
     SuperscriptBox["q", "j"], ",", 
     SuperscriptBox["q", "k"]}], ")"}], TraditionalForm]],ExpressionUUID->
  "29769997-8b1d-46ca-9238-e253888c5e0b"],
 " cell.\nCharge density at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["q", "i"], ",", 
     SuperscriptBox["q", "j"], ",", 
     SuperscriptBox["q", "k"]}], ")"}], TraditionalForm]],ExpressionUUID->
  "a7a97507-762f-4dc4-8fad-e2b81d95ff6f"],
 " cell is:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["\[CapitalPi]", "t", 
     RowBox[{"i", ",", "j", ",", "k"}]], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Sum]", "s"], 
      RowBox[{
       FractionBox[
        SubscriptBox["\[CapitalOmega]", "0"], 
        SubscriptBox["\[CapitalOmega]", "s"]], 
       SubsuperscriptBox["\[Omega]", 
        RowBox[{
         RowBox[{"s", ";", "i"}], ",", "j", ",", "k"}], "2"], 
       FractionBox[
        RowBox[{
         SubscriptBox["\[Sum]", "p"], 
         RowBox[{
          RowBox[{"S", "[", 
           RowBox[{
            SubsuperscriptBox["x", 
             RowBox[{"t", ";", "s"}], 
             RowBox[{"1", ";", "p"}]], "-", 
            SuperscriptBox["x", 
             RowBox[{"1", ";", "i"}]]}], "]"}], 
          RowBox[{"S", "[", 
           RowBox[{
            SubsuperscriptBox["x", 
             RowBox[{"t", ";", "s"}], 
             RowBox[{"2", ";", "p"}]], "-", 
            SuperscriptBox["x", 
             RowBox[{"2", ";", "j"}]]}], "]"}], 
          RowBox[{"S", "[", 
           RowBox[{
            SubsuperscriptBox["x", 
             RowBox[{"t", ";", "s"}], 
             RowBox[{"3", ";", "p"}]], "-", 
            SuperscriptBox["x", 
             RowBox[{"3", ";", "k"}]]}], "]"}]}]}], 
        SubsuperscriptBox["N", 
         RowBox[{"c", ";", "s"}], 
         RowBox[{
          RowBox[{"0", ";", "i"}], ",", "j", ",", "k"}]]]}]}], "=", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Sum]", "s"], 
       RowBox[{
        FractionBox[
         SubscriptBox["\[CapitalOmega]", "0"], 
         SubscriptBox["\[CapitalOmega]", "s"]], 
        SubsuperscriptBox["\[Omega]", 
         RowBox[{"s", ";", "0"}], "2"], 
        FractionBox[
         RowBox[{
          SubscriptBox["\[Sum]", "p"], 
          RowBox[{
           RowBox[{"S", "[", 
            RowBox[{
             SubsuperscriptBox["x", 
              RowBox[{"t", ";", "s"}], 
              RowBox[{"1", ";", "p"}]], "-", 
             SuperscriptBox["x", 
              RowBox[{"1", ";", "i"}]]}], "]"}], 
           RowBox[{"S", "[", 
            RowBox[{
             SubsuperscriptBox["x", 
              RowBox[{"t", ";", "s"}], 
              RowBox[{"2", ";", "p"}]], "-", 
             SuperscriptBox["x", 
              RowBox[{"2", ";", "j"}]]}], "]"}], 
           RowBox[{"S", "[", 
            RowBox[{
             SubsuperscriptBox["x", 
              RowBox[{"t", ";", "s"}], 
              RowBox[{"3", ";", "p"}]], "-", 
             SuperscriptBox["x", 
              RowBox[{"3", ";", "k"}]]}], "]"}]}]}], 
         SubsuperscriptBox["N", 
          RowBox[{"c", ";", "s"}], "0"]]}]}], "=", 
      RowBox[{
       SubscriptBox["\[Sum]", "s"], 
       RowBox[{
        FractionBox[
         SubscriptBox["\[CapitalOmega]", "0"], 
         SubscriptBox["\[CapitalOmega]", "s"]], 
        SubsuperscriptBox["\[Omega]", 
         RowBox[{"s", ";", "0"}], "2"], 
        FractionBox[
         SubsuperscriptBox["n", 
          RowBox[{"t", ";", "s"}], 
          RowBox[{"i", ",", "j", ",", "k"}]], 
         SubscriptBox["n", 
          RowBox[{"0", ";", "s"}]]]}]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"0485d10f-5754-4497-bb72-7f265d0dd636"],
 ",\nwhere ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Omega]", 
    RowBox[{"s", ";", "0"}]], TraditionalForm]],ExpressionUUID->
  "e592aabe-7e06-4c13-986f-6343dc5ccc49"],
 " is the initial plasma frequency at the reference cell; and ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[Omega]", 
    RowBox[{
     RowBox[{"s", ";", "i"}], ",", "j", ",", "k"}], "2"], TraditionalForm]],
  ExpressionUUID->"94fb18f9-e59c-4985-9f5a-d77c9574448f"],
 " is the initial plasma frequency at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["q", "i"], ",", 
     SuperscriptBox["q", "j"], ",", 
     SuperscriptBox["q", "k"]}], ")"}], TraditionalForm]],ExpressionUUID->
  "733b5559-cc1b-4fca-9b8d-6be790878865"],
 " cell."
}], "Text",ExpressionUUID->"7b0d86de-0ae0-4b69-b8b0-bb8340810167"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Nc", "=", "100"}], ",", 
     RowBox[{"Nx", "=", "2"}], ",", 
     RowBox[{"n0", "=", "1."}], ",", 
     RowBox[{"S", "=", 
      RowBox[{"Function", "[", 
       RowBox[{"x", 
        RowBox[{"(*", 
         RowBox[{"0", "\[LessEqual]", "x", "\[LessEqual]", "1"}], "*)"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "-", "x"}], ",", "x"}], "}"}], "//", "N"}]}], 
       "]"}]}]}], "}"}], ",", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"x", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", 
         RowBox[{"Nc", "*", "Nx"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Plus", "@@@", 
         RowBox[{"S", "[", "x", "]"}]}], ")"}], "/", "Nc"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "]"}]], "Input",ExpressionUUID->"ee4bd973-\
9558-42d9-b990-439034bc1334"],

Cell[TextData[{
 "Average flow speed weighted by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["n", 
     RowBox[{"t", ";", "s"}], 
     RowBox[{"i", ",", "j", ",", "k"}]], "/", 
    SubscriptBox["n", 
     RowBox[{"0", ";", "s"}]]}], TraditionalForm]],ExpressionUUID->
  "7a436112-a596-4e39-9207-f3fe7774fa23"],
 ":\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["V", 
         RowBox[{
          RowBox[{"x", ";", "i"}], ",", "j", ",", "k"}], 
         RowBox[{"t", ";", "s"}]]},
       {
        SubsuperscriptBox["V", 
         RowBox[{
          RowBox[{"y", ";", "i"}], ",", "j", ",", "k"}], 
         RowBox[{"t", ";", "s"}]]},
       {
        SubsuperscriptBox["V", 
         RowBox[{
          RowBox[{"z", ";", "i"}], ",", "j", ",", "k"}], 
         RowBox[{"t", ";", "s"}]]}
      }], ")"}], "=", 
    RowBox[{
     SubscriptBox["\[Sum]", "p"], 
     RowBox[{
      RowBox[{"(", GridBox[{
         {
          SubsuperscriptBox["v", 
           RowBox[{"x", ";", "p"}], 
           RowBox[{"t", ";", "s"}]]},
         {
          SubsuperscriptBox["v", 
           RowBox[{"y", ";", "p"}], 
           RowBox[{"t", ";", "s"}]]},
         {
          SubsuperscriptBox["v", 
           RowBox[{"z", ";", "p"}], 
           RowBox[{"t", ";", "s"}]]}
        }], ")"}], 
      FractionBox[
       RowBox[{
        RowBox[{"S", "[", 
         RowBox[{
          SubsuperscriptBox["x", 
           RowBox[{"t", ";", "s"}], 
           RowBox[{"1", ";", "p"}]], "-", 
          SuperscriptBox["x", 
           RowBox[{"1", ";", "i"}]]}], "]"}], 
        RowBox[{"S", "[", 
         RowBox[{
          SubsuperscriptBox["x", 
           RowBox[{"t", ";", "s"}], 
           RowBox[{"2", ";", "p"}]], "-", 
          SuperscriptBox["x", 
           RowBox[{"2", ";", "j"}]]}], "]"}], 
        RowBox[{"S", "[", 
         RowBox[{
          SubsuperscriptBox["x", 
           RowBox[{"t", ";", "s"}], 
           RowBox[{"3", ";", "p"}]], "-", 
          SuperscriptBox["x", 
           RowBox[{"3", ";", "k"}]]}], "]"}]}], 
       SubsuperscriptBox["N", 
        RowBox[{"c", ";", "s"}], "0"]]}]}]}], TraditionalForm]],
  ExpressionUUID->"8ef86071-a99f-4d93-ba79-079ea85af634"],
 "\nAverage flow speed is given by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["V", 
         RowBox[{
          RowBox[{"x", ";", "i"}], ",", "j", ",", "k"}], 
         RowBox[{"t", ";", "s"}]]},
       {
        SubsuperscriptBox["V", 
         RowBox[{
          RowBox[{"y", ";", "i"}], ",", "j", ",", "k"}], 
         RowBox[{"t", ";", "s"}]]},
       {
        SubsuperscriptBox["V", 
         RowBox[{
          RowBox[{"z", ";", "i"}], ",", "j", ",", "k"}], 
         RowBox[{"t", ";", "s"}]]}
      }], ")"}], "/", 
    FractionBox[
     SubsuperscriptBox["n", 
      RowBox[{"t", ";", "s"}], 
      RowBox[{"i", ",", "j", ",", "k"}]], 
     SubscriptBox["n", 
      RowBox[{"0", ";", "s"}]]]}], TraditionalForm]],ExpressionUUID->
  "5f0cbe8f-d73b-4daa-8aec-9fb9a98f28e1"],
 ".\nCurrent density:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["\[ScriptCapitalJ]", 
         RowBox[{
          RowBox[{"x", ";", "i"}], ",", "j", ",", "k"}], 
         RowBox[{"t", ";", "s"}]]},
       {
        SubsuperscriptBox["\[ScriptCapitalJ]", 
         RowBox[{
          RowBox[{"y", ";", "i"}], ",", "j", ",", "k"}], 
         RowBox[{"t", ";", "s"}]]},
       {
        SubsuperscriptBox["\[ScriptCapitalJ]", 
         RowBox[{
          RowBox[{"z", ";", "i"}], ",", "j", ",", "k"}], 
         RowBox[{"t", ";", "s"}]]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{
      FractionBox[
       SubscriptBox["\[CapitalOmega]", "0"], 
       SubscriptBox["\[CapitalOmega]", "s"]], 
      FractionBox[
       SubsuperscriptBox["\[Omega]", 
        RowBox[{
         RowBox[{"s", ";", "i"}], ",", "j", ",", "k"}], "2"], "c"], 
      RowBox[{
       SubscriptBox["\[Sum]", "p"], 
       RowBox[{
        RowBox[{"(", GridBox[{
           {
            SubsuperscriptBox["v", 
             RowBox[{"x", ";", "p"}], 
             RowBox[{"t", ";", "s"}]]},
           {
            SubsuperscriptBox["v", 
             RowBox[{"y", ";", "p"}], 
             RowBox[{"t", ";", "s"}]]},
           {
            SubsuperscriptBox["v", 
             RowBox[{"z", ";", "p"}], 
             RowBox[{"t", ";", "s"}]]}
          }], ")"}], 
        FractionBox[
         RowBox[{
          RowBox[{"S", "[", 
           RowBox[{
            SubsuperscriptBox["x", 
             RowBox[{"t", ";", "s"}], 
             RowBox[{"1", ";", "p"}]], "-", 
            SuperscriptBox["x", 
             RowBox[{"1", ";", "i"}]]}], "]"}], 
          RowBox[{"S", "[", 
           RowBox[{
            SubsuperscriptBox["x", 
             RowBox[{"t", ";", "s"}], 
             RowBox[{"2", ";", "p"}]], "-", 
            SuperscriptBox["x", 
             RowBox[{"2", ";", "j"}]]}], "]"}], 
          RowBox[{"S", "[", 
           RowBox[{
            SubsuperscriptBox["x", 
             RowBox[{"t", ";", "s"}], 
             RowBox[{"3", ";", "p"}]], "-", 
            SuperscriptBox["x", 
             RowBox[{"3", ";", "k"}]]}], "]"}]}], 
         SubsuperscriptBox["N", 
          RowBox[{"c", ";", "s"}], 
          RowBox[{
           RowBox[{"0", ";", "i"}], ",", "j", ",", "k"}]]]}]}]}], "=", 
     RowBox[{
      RowBox[{
       FractionBox[
        SubscriptBox["\[CapitalOmega]", "0"], 
        SubscriptBox["\[CapitalOmega]", "s"]], 
       FractionBox[
        SubsuperscriptBox["\[Omega]", 
         RowBox[{"s", ";", "0"}], "2"], "c"], 
       RowBox[{
        SubscriptBox["\[Sum]", "p"], 
        RowBox[{
         RowBox[{"(", GridBox[{
            {
             SubsuperscriptBox["v", 
              RowBox[{"x", ";", "p"}], 
              RowBox[{"t", ";", "s"}]]},
            {
             SubsuperscriptBox["v", 
              RowBox[{"y", ";", "p"}], 
              RowBox[{"t", ";", "s"}]]},
            {
             SubsuperscriptBox["v", 
              RowBox[{"z", ";", "p"}], 
              RowBox[{"t", ";", "s"}]]}
           }], ")"}], 
         FractionBox[
          RowBox[{
           RowBox[{"S", "[", 
            RowBox[{
             SubsuperscriptBox["x", 
              RowBox[{"t", ";", "s"}], 
              RowBox[{"1", ";", "p"}]], "-", 
             SuperscriptBox["x", 
              RowBox[{"1", ";", "i"}]]}], "]"}], 
           RowBox[{"S", "[", 
            RowBox[{
             SubsuperscriptBox["x", 
              RowBox[{"t", ";", "s"}], 
              RowBox[{"2", ";", "p"}]], "-", 
             SuperscriptBox["x", 
              RowBox[{"2", ";", "j"}]]}], "]"}], 
           RowBox[{"S", "[", 
            RowBox[{
             SubsuperscriptBox["x", 
              RowBox[{"t", ";", "s"}], 
              RowBox[{"3", ";", "p"}]], "-", 
             SuperscriptBox["x", 
              RowBox[{"3", ";", "k"}]]}], "]"}]}], 
          SubsuperscriptBox["N", 
           RowBox[{"c", ";", "s"}], "0"]]}]}]}], "=", 
      RowBox[{
       FractionBox[
        SubscriptBox["\[CapitalOmega]", "0"], 
        SubscriptBox["\[CapitalOmega]", "s"]], 
       FractionBox[
        SubsuperscriptBox["\[Omega]", 
         RowBox[{"s", ";", "0"}], "2"], "c"], 
       RowBox[{"(", GridBox[{
          {
           SubsuperscriptBox["V", 
            RowBox[{
             RowBox[{"x", ";", "i"}], ",", "j", ",", "k"}], 
            RowBox[{"t", ";", "s"}]]},
          {
           SubsuperscriptBox["V", 
            RowBox[{
             RowBox[{"y", ";", "i"}], ",", "j", ",", "k"}], 
            RowBox[{"t", ";", "s"}]]},
          {
           SubsuperscriptBox["V", 
            RowBox[{
             RowBox[{"z", ";", "i"}], ",", "j", ",", "k"}], 
            RowBox[{"t", ";", "s"}]]}
         }], ")"}]}]}]}]}], TraditionalForm]],ExpressionUUID->
  "0a82451c-4a31-4eb0-b71c-de308bcf2eeb"],
 "\nCartesian to curvilinear:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SuperscriptBox["\[ScriptCapitalJ]", "1"]},
       {
        SuperscriptBox["\[ScriptCapitalJ]", "2"]},
       {
        SuperscriptBox["\[ScriptCapitalJ]", "3"]}
      }], ")"}], "=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         RowBox[{
          SubscriptBox["\[ScriptCapitalJ]", "x"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "x"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"]}]}], "+", 
         RowBox[{
          SubscriptBox["\[ScriptCapitalJ]", "y"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "y"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"]}]}], "+", 
         RowBox[{
          SubscriptBox["\[ScriptCapitalJ]", "z"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "z"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"]}]}]}]},
       {
        RowBox[{
         RowBox[{
          SubscriptBox["\[ScriptCapitalJ]", "x"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "x"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"]}]}], "+", 
         RowBox[{
          SubscriptBox["\[ScriptCapitalJ]", "y"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "y"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"]}]}], "+", 
         RowBox[{
          SubscriptBox["\[ScriptCapitalJ]", "z"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "z"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"]}]}]}]},
       {
        RowBox[{
         RowBox[{
          SubscriptBox["\[ScriptCapitalJ]", "x"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "x"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"]}]}], "+", 
         RowBox[{
          SubscriptBox["\[ScriptCapitalJ]", "y"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "y"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"]}]}], "+", 
         RowBox[{
          SubscriptBox["\[ScriptCapitalJ]", "z"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "z"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"]}]}]}]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "02d15836-c1fa-4634-bc94-785390b48642"]
}], "Text",ExpressionUUID->"8d1b0747-5cd3-4dbc-95ea-80ff79c53cfe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "icdf", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"icdf", ":=", 
  RowBox[{"icdf", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"cdf", "=", 
        RowBox[{"Function", "[", 
         RowBox[{"v", ",", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             RowBox[{"2", " ", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"-", 
                SuperscriptBox["v", "2"]}]], " ", "v"}], 
             SqrtBox["\[Pi]"]]}], "+", 
           RowBox[{"Erf", "[", "v", "]"}]}]}], "]"}]}], ",", 
       RowBox[{"n", "=", "1000"}], ",", 
       RowBox[{"vmax", "=", "4."}]}], "}"}], ",", 
     RowBox[{"Interpolation", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"cdf", "[", 
           RowBox[{"vmax", " ", 
            RowBox[{"i", "/", "n"}]}], "]"}], ",", 
          RowBox[{"vmax", " ", 
           RowBox[{"i", "/", "n"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "n"}], "}"}]}], "]"}], "]"}]}], 
    "]"}]}]}]}], "Input",ExpressionUUID->"5edeacd7-5f83-4a68-8e66-\
b70c04d10082"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"icdf", "[", "i", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",ExpressionUUID->\
"640cc276-4801-49cc-bc72-5ff849dffdf6"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Nc", "=", "1000"}], ",", 
     RowBox[{"Nx", "=", "2"}], ",", 
     RowBox[{"n0", "=", "1."}], ",", 
     RowBox[{"\[Theta]", "=", "1."}], ",", 
     RowBox[{"S", "=", 
      RowBox[{"Function", "[", 
       RowBox[{"x", 
        RowBox[{"(*", 
         RowBox[{"0", "\[LessEqual]", "x", "\[LessEqual]", "1"}], "*)"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "-", "x"}], ",", "x"}], "}"}], "//", "N"}]}], 
       "]"}]}]}], "}"}], ",", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "rng", ",", "x", ",", "v", ",", "vx", ",", "vy", ",", "vz", ",", 
       "\[Psi]"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rng", ":=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", 
         RowBox[{"Nc", "*", "Nx"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"x", "=", "rng"}], ";", "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{
        RowBox[{"icdf", "[", "rng", "]"}], "\[Theta]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vx", "=", 
       RowBox[{"v", " ", 
        RowBox[{"(", 
         RowBox[{"\[Psi]", "=", 
          RowBox[{"1", "-", 
           RowBox[{"2", "rng"}]}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"v", " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[Psi]", "2"]}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vy", "=", 
       RowBox[{"v", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Psi]", "=", 
          RowBox[{"2", "\[Pi]", " ", "rng"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vz", "=", 
       RowBox[{"v", " ", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"TableForm", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"v", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"v", "//", "Mean"}], ",", 
             RowBox[{
              RowBox[{"Mean", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Total", "[", 
                    RowBox[{"v", "#"}], "]"}], "&"}], "/@", 
                  RowBox[{"S", "[", "x", "]"}]}], ")"}], "/", "Nc"}], "]"}], 
              "n0"}]}], "}"}]}], "]"}], "/@", 
         RowBox[{"{", 
          RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}]}], ",", 
        RowBox[{"TableHeadings", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SubscriptBox[\(v\), \(x\)]\)\>\"", ",", 
             "\"\<\!\(\*SubscriptBox[\(v\), \(y\)]\)\>\"", ",", 
             "\"\<\!\(\*SubscriptBox[\(v\), \(z\)]\)\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\[LeftAngleBracket]\[DoubleStruckV]\[RightAngleBracket]\>\"",
              ",", "\"\<2nd Mom \[Times] \!\(\*SubsuperscriptBox[\(n\), \
\(s\), \(0\)]\)\>\""}], "}"}]}], "}"}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "]"}]], "Input",ExpressionUUID->"fb9653f6-533e-4fdd-9e41-\
b055f0e61d20"],

Cell[TextData[{
 "Average second velocity moment weighted by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["n", 
     RowBox[{"t", ";", "s"}], 
     RowBox[{"i", ",", "j", ",", "k"}]], "/", 
    SubscriptBox["n", 
     RowBox[{"0", ";", "s"}]]}], TraditionalForm]],ExpressionUUID->
  "fc17c9ef-0c50-49ed-bbc6-23887d0c8eb2"],
 ":\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"2", 
      SubscriptBox["\[DoubleStruckW]", "s"]}], 
     SubscriptBox["m", "s"]], "=", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       SubsuperscriptBox["\[DoubleStruckV]", 
        RowBox[{"i", ",", "j", ",", "k"}], 
        RowBox[{"t", ";", "s"}]], 
       SubsuperscriptBox["\[DoubleStruckV]", 
        RowBox[{"i", ",", "j", ",", "k"}], 
        RowBox[{"t", ";", "s"}]]}], "\[RightAngleBracket]"}], "=", 
     RowBox[{
      RowBox[{
       SubsuperscriptBox["n", 
        RowBox[{"0", ";", "s"}], 
        RowBox[{"i", ",", "j", ",", "k"}]], 
       RowBox[{
        SubscriptBox["\[Sum]", "p"], 
        RowBox[{
         SubsuperscriptBox["\[DoubleStruckV]", "p", 
          RowBox[{"t", ";", "s"}]], 
         SubsuperscriptBox["\[DoubleStruckV]", "p", 
          RowBox[{"t", ";", "s"}]], 
         FractionBox[
          RowBox[{
           RowBox[{"S", "[", 
            RowBox[{
             SubsuperscriptBox["x", 
              RowBox[{"t", ";", "s"}], 
              RowBox[{"1", ";", "p"}]], "-", 
             SuperscriptBox["x", 
              RowBox[{"1", ";", "i"}]]}], "]"}], 
           RowBox[{"S", "[", 
            RowBox[{
             SubsuperscriptBox["x", 
              RowBox[{"t", ";", "s"}], 
              RowBox[{"2", ";", "p"}]], "-", 
             SuperscriptBox["x", 
              RowBox[{"2", ";", "j"}]]}], "]"}], 
           RowBox[{"S", "[", 
            RowBox[{
             SubsuperscriptBox["x", 
              RowBox[{"t", ";", "s"}], 
              RowBox[{"3", ";", "p"}]], "-", 
             SuperscriptBox["x", 
              RowBox[{"3", ";", "k"}]]}], "]"}]}], 
          SubsuperscriptBox["N", 
           RowBox[{"c", ";", "s"}], 
           RowBox[{
            RowBox[{"0", ";", "i"}], ",", "j", ",", "k"}]]]}]}]}], "=", 
      RowBox[{
       SubscriptBox["n", 
        RowBox[{"0", ";", "s"}]], 
       RowBox[{
        SubscriptBox["\[Sum]", "p"], 
        RowBox[{
         SubsuperscriptBox["\[DoubleStruckV]", "p", 
          RowBox[{"t", ";", "s"}]], 
         SubsuperscriptBox["\[DoubleStruckV]", "p", 
          RowBox[{"t", ";", "s"}]], 
         FractionBox[
          RowBox[{
           RowBox[{"S", "[", 
            RowBox[{
             SubsuperscriptBox["x", 
              RowBox[{"t", ";", "s"}], 
              RowBox[{"1", ";", "p"}]], "-", 
             SuperscriptBox["x", 
              RowBox[{"1", ";", "i"}]]}], "]"}], 
           RowBox[{"S", "[", 
            RowBox[{
             SubsuperscriptBox["x", 
              RowBox[{"t", ";", "s"}], 
              RowBox[{"2", ";", "p"}]], "-", 
             SuperscriptBox["x", 
              RowBox[{"2", ";", "j"}]]}], "]"}], 
           RowBox[{"S", "[", 
            RowBox[{
             SubsuperscriptBox["x", 
              RowBox[{"t", ";", "s"}], 
              RowBox[{"3", ";", "p"}]], "-", 
             SuperscriptBox["x", 
              RowBox[{"3", ";", "k"}]]}], "]"}]}], 
          SubsuperscriptBox["N", 
           RowBox[{"c", ";", "s"}], "0"]]}]}]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"345da7ed-1a9f-4b96-b45a-05bd29e0ce37"],
 ".\nKinetic energy density (equivalent to pressure):\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["\[CurlyEpsilon]", 
     RowBox[{"i", ",", "j", ",", "k"}], 
     RowBox[{"t", ";", "s"}]], "=", 
    RowBox[{
     RowBox[{
      FractionBox[
       SubsuperscriptBox["\[CapitalOmega]", "0", "2"], 
       SubsuperscriptBox["\[CapitalOmega]", "s", "2"]], 
      FractionBox[
       SubsuperscriptBox["\[Omega]", 
        RowBox[{
         RowBox[{"s", ";", "i"}], ",", "j", ",", "k"}], "2"], 
       SuperscriptBox["c", "2"]], 
      RowBox[{
       SubscriptBox["\[Sum]", "p"], 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"(", GridBox[{
           {
            SubsuperscriptBox["v", 
             RowBox[{"x", ";", "p"}], "2"]},
           {
            SubsuperscriptBox["v", 
             RowBox[{"y", ";", "p"}], "2"]},
           {
            SubsuperscriptBox["v", 
             RowBox[{"z", ";", "p"}], "2"]}
          }], ")"}], 
        FractionBox[
         RowBox[{
          RowBox[{"S", "[", 
           RowBox[{
            SubsuperscriptBox["x", 
             RowBox[{"t", ";", "s"}], 
             RowBox[{"1", ";", "p"}]], "-", 
            SuperscriptBox["x", 
             RowBox[{"1", ";", "i"}]]}], "]"}], 
          RowBox[{"S", "[", 
           RowBox[{
            SubsuperscriptBox["x", 
             RowBox[{"t", ";", "s"}], 
             RowBox[{"2", ";", "p"}]], "-", 
            SuperscriptBox["x", 
             RowBox[{"2", ";", "j"}]]}], "]"}], 
          RowBox[{"S", "[", 
           RowBox[{
            SubsuperscriptBox["x", 
             RowBox[{"t", ";", "s"}], 
             RowBox[{"3", ";", "p"}]], "-", 
            SuperscriptBox["x", 
             RowBox[{"3", ";", "k"}]]}], "]"}]}], 
         SubsuperscriptBox["N", 
          RowBox[{"c", ";", "s"}], 
          RowBox[{
           RowBox[{"0", ";", "i"}], ",", "j", ",", "k"}]]]}]}]}], "=", 
     RowBox[{
      FractionBox[
       SubsuperscriptBox["\[CapitalOmega]", "0", "2"], 
       SubsuperscriptBox["\[CapitalOmega]", "s", "2"]], 
      FractionBox[
       SubsuperscriptBox["\[Omega]", 
        RowBox[{"s", ";", "0"}], "2"], 
       SuperscriptBox["c", "2"]], 
      RowBox[{
       SubscriptBox["\[Sum]", "p"], 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"(", GridBox[{
           {
            SubsuperscriptBox["v", 
             RowBox[{"x", ";", "p"}], "2"]},
           {
            SubsuperscriptBox["v", 
             RowBox[{"y", ";", "p"}], "2"]},
           {
            SubsuperscriptBox["v", 
             RowBox[{"z", ";", "p"}], "2"]}
          }], ")"}], 
        FractionBox[
         RowBox[{
          RowBox[{"S", "[", 
           RowBox[{
            SubsuperscriptBox["x", 
             RowBox[{"t", ";", "s"}], 
             RowBox[{"1", ";", "p"}]], "-", 
            SuperscriptBox["x", 
             RowBox[{"1", ";", "i"}]]}], "]"}], 
          RowBox[{"S", "[", 
           RowBox[{
            SubsuperscriptBox["x", 
             RowBox[{"t", ";", "s"}], 
             RowBox[{"2", ";", "p"}]], "-", 
            SuperscriptBox["x", 
             RowBox[{"2", ";", "j"}]]}], "]"}], 
          RowBox[{"S", "[", 
           RowBox[{
            SubsuperscriptBox["x", 
             RowBox[{"t", ";", "s"}], 
             RowBox[{"3", ";", "p"}]], "-", 
            SuperscriptBox["x", 
             RowBox[{"3", ";", "k"}]]}], "]"}]}], 
         SubsuperscriptBox["N", 
          RowBox[{"c", ";", "s"}], "0"]]}]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"dd33f017-6d3f-47fc-9e6e-e85885978aa9"],
 ".\nThermal speed squared:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["\[CapitalDelta]v", 
          RowBox[{"x", ",", 
           RowBox[{"s", ";", "i"}], ",", "j", ",", "k"}], "2"]},
        {
         SubsuperscriptBox["\[CapitalDelta]v", 
          RowBox[{"y", ",", 
           RowBox[{"s", ";", "i"}], ",", "j", ",", "k"}], "2"]},
        {
         SubsuperscriptBox["\[CapitalDelta]v", 
          RowBox[{"z", ",", 
           RowBox[{"s", ";", "i"}], ",", "j", ",", "k"}], "2"]}
       }], ")"}], "\[RightAngleBracket]"}], "=", 
    RowBox[{
     FractionBox[
      SubscriptBox["n", 
       RowBox[{"0", ";", "s"}]], 
      SubsuperscriptBox["n", 
       RowBox[{"t", ";", "s"}], 
       RowBox[{"i", ",", "j", ",", "k"}]]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Sum]", "p"], 
        RowBox[{
         RowBox[{"(", GridBox[{
            {
             SubsuperscriptBox["v", 
              RowBox[{"x", ";", "p"}], "2"]},
            {
             SubsuperscriptBox["v", 
              RowBox[{"y", ";", "p"}], "2"]},
            {
             SubsuperscriptBox["v", 
              RowBox[{"z", ";", "p"}], "2"]}
           }], ")"}], 
         FractionBox[
          RowBox[{
           RowBox[{"S", "[", 
            RowBox[{
             SubsuperscriptBox["x", 
              RowBox[{"t", ";", "s"}], 
              RowBox[{"1", ";", "p"}]], "-", 
             SuperscriptBox["x", 
              RowBox[{"1", ";", "i"}]]}], "]"}], 
           RowBox[{"S", "[", 
            RowBox[{
             SubsuperscriptBox["x", 
              RowBox[{"t", ";", "s"}], 
              RowBox[{"2", ";", "p"}]], "-", 
             SuperscriptBox["x", 
              RowBox[{"2", ";", "j"}]]}], "]"}], 
           RowBox[{"S", "[", 
            RowBox[{
             SubsuperscriptBox["x", 
              RowBox[{"t", ";", "s"}], 
              RowBox[{"3", ";", "p"}]], "-", 
             SuperscriptBox["x", 
              RowBox[{"3", ";", "k"}]]}], "]"}]}], 
          SubsuperscriptBox["N", 
           RowBox[{"c", ";", "s"}], "0"]]}]}], "-", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", GridBox[{
            {
             SubsuperscriptBox["V", 
              RowBox[{
               RowBox[{"x", ";", "i"}], ",", "j", ",", "k"}], 
              RowBox[{"t", ";", "s"}]]},
            {
             SubsuperscriptBox["V", 
              RowBox[{
               RowBox[{"y", ";", "i"}], ",", "j", ",", "k"}], 
              RowBox[{"t", ";", "s"}]]},
            {
             SubsuperscriptBox["V", 
              RowBox[{
               RowBox[{"z", ";", "i"}], ",", "j", ",", "k"}], 
              RowBox[{"t", ";", "s"}]]}
           }], ")"}], "2"], "/", 
        FractionBox[
         SubsuperscriptBox["n", 
          RowBox[{"t", ";", "s"}], "i"], 
         SubscriptBox["n", 
          RowBox[{"0", ";", "s"}]]]}]}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"9b0bf10b-7e0a-4f75-9070-a785c870e31e"],
 "."
}], "Text",ExpressionUUID->"47919e03-de1d-4d19-b407-4447e4bc5c63"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Nc", "=", "1000"}], ",", 
     RowBox[{"Nx", "=", "2"}], ",", 
     RowBox[{"n0", "=", "1."}], ",", 
     RowBox[{"\[Theta]", "=", "1."}], ",", 
     RowBox[{"S", "=", 
      RowBox[{"Function", "[", 
       RowBox[{"x", 
        RowBox[{"(*", 
         RowBox[{"0", "\[LessEqual]", "x", "\[LessEqual]", "1"}], "*)"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "-", "x"}], ",", "x"}], "}"}], "//", "N"}]}], 
       "]"}]}]}], "}"}], ",", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "rng", ",", "x", ",", "v", ",", "vx", ",", "vy", ",", "vz", ",", 
       "\[Psi]"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rng", ":=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", 
         RowBox[{"Nc", "*", "Nx"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"x", "=", "rng"}], ";", "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{
        RowBox[{"icdf", "[", "rng", "]"}], "\[Theta]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vx", "=", 
       RowBox[{"v", " ", 
        RowBox[{"(", 
         RowBox[{"\[Psi]", "=", 
          RowBox[{"1", "-", 
           RowBox[{"2", "rng"}]}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"v", " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[Psi]", "2"]}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vy", "=", 
       RowBox[{"v", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Psi]", "=", 
          RowBox[{"2", "\[Pi]", " ", "rng"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vz", "=", 
       RowBox[{"v", " ", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{"Flatten", "[", 
           SuperscriptBox[
            RowBox[{"{", 
             RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}], "2"], "]"}], "]"}], 
         "/", "2"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Total", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["vx", "2"], "+", 
                 SuperscriptBox["vy", "2"], "+", 
                 SuperscriptBox["vz", "2"]}], ")"}], 
               RowBox[{"#", "/", "2"}]}], "]"}], "/", "Nc"}], "&"}], "/@", 
           RowBox[{"S", "[", "x", "]"}]}], "]"}], "*", "Nc"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "]"}]], "Input",ExpressionUUID->"66903457-\
22cf-4784-b97c-90d8ac63beec"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1307, 1179},
WindowMargins->{{Automatic, 352}, {1, Automatic}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (June 19, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"df4277a1-8672-4142-81d9-78c5edd95384"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 89, 0, 67, "Section",ExpressionUUID->"98f60438-238c-49f7-a2be-78fd60abd294"],
Cell[CellGroupData[{
Cell[694, 26, 95, 0, 54, "Subsection",ExpressionUUID->"60be49ab-8d81-409d-8bc9-7546a121a65e"],
Cell[792, 28, 1812, 56, 150, "Text",ExpressionUUID->"1dd6616b-e8f8-4544-b951-5a3556ea34ed"],
Cell[2607, 86, 476, 14, 58, "Text",ExpressionUUID->"ea9a4192-2aec-4b1d-9375-1e75ca196da4"],
Cell[3086, 102, 1180, 36, 114, "Text",ExpressionUUID->"e928ad21-de0c-4bba-a819-0bfb41a39a27"],
Cell[4269, 140, 4668, 145, 289, "Text",ExpressionUUID->"10531d08-595c-4099-b84b-0cc8da1a8ca6"],
Cell[8940, 287, 8133, 263, 545, "Text",ExpressionUUID->"3de990f7-fe78-4ab8-b34d-c60118674253"],
Cell[17076, 552, 1175, 32, 94, "Text",ExpressionUUID->"1ead1ffe-99f7-483d-b7ad-d2eb1efebd58"],
Cell[18254, 586, 4095, 127, 253, "Text",ExpressionUUID->"18c9f654-f3f0-4e24-928a-48ada1cbef30"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22386, 718, 87, 0, 54, "Subsection",ExpressionUUID->"5593d14d-ab98-4ecd-b232-518d25807eeb"],
Cell[22476, 720, 2370, 73, 214, "Text",ExpressionUUID->"1d55d8c6-05c5-496e-826e-e1177ab9951c"],
Cell[24849, 795, 2217, 68, 174, "Text",ExpressionUUID->"e9b742c7-f260-4742-ad46-d525c2ba769d"],
Cell[27069, 865, 548, 16, 61, "Text",ExpressionUUID->"f86f895a-40f7-4d01-bfd3-cd70821d3cc6"],
Cell[27620, 883, 1088, 32, 94, "Text",ExpressionUUID->"2e76a4f2-0040-4ba3-944c-44be0134b9f1"],
Cell[28711, 917, 1791, 54, 125, "Text",ExpressionUUID->"f030f6e9-193f-45c5-b50c-c8c165382755"],
Cell[30505, 973, 3745, 111, 192, "Text",ExpressionUUID->"dd318524-e19a-4180-a048-ecf72f601003"],
Cell[34253, 1086, 1569, 45, 110, "Text",ExpressionUUID->"661cd1e9-44aa-4fdb-a829-31ad6568d022"],
Cell[35825, 1133, 9529, 279, 483, "Text",ExpressionUUID->"d672e2e5-c36d-47b5-be7a-f804f3394e79"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45391, 1417, 88, 0, 54, "Subsection",ExpressionUUID->"6a963e5d-0959-4a3a-868c-45bf1604788d"],
Cell[45482, 1419, 3128, 100, 203, "Text",ExpressionUUID->"f3a02e4a-0eb5-4ec4-b469-b1d92045ef38"],
Cell[48613, 1521, 681, 22, 69, "Text",ExpressionUUID->"db8fc41e-20bb-4548-837a-de969032a7f4"],
Cell[49297, 1545, 1060, 32, 101, "Text",ExpressionUUID->"8e8d5028-b4c7-4bf5-8d0d-3f5df7bba8b0"],
Cell[50360, 1579, 4074, 121, 192, "Text",ExpressionUUID->"59dae126-f10e-4ef6-bdaf-20485f8adbf5"],
Cell[54437, 1702, 5332, 168, 397, "Text",ExpressionUUID->"cec5d88b-531b-43c0-aa28-51756645b720"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59806, 1875, 125, 0, 54, "Subsection",ExpressionUUID->"df5d4812-b343-47b6-abcc-5ef8bb1677b0"],
Cell[59934, 1877, 7402, 226, 242, "Text",ExpressionUUID->"72a699aa-bea1-4ecc-8f67-f6289b35b09b"],
Cell[CellGroupData[{
Cell[67361, 2107, 9661, 250, 19, "Input",ExpressionUUID->"7063d1bc-e7bb-4976-8aac-764234e1fca9",
 CellOpen->False],
Cell[77025, 2359, 5781, 109, 302, "Output",ExpressionUUID->"987154df-fe5e-4d49-84ef-58e2a6c496ad"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[82855, 2474, 95, 0, 54, "Subsection",ExpressionUUID->"71d8df89-8dc7-43a7-9bbb-27460bfeaee1"],
Cell[82953, 2476, 7471, 226, 242, "Text",ExpressionUUID->"47cb1a90-c3b6-494c-86c1-f829b47b5941"],
Cell[CellGroupData[{
Cell[90449, 2706, 9661, 250, 19, "Input",ExpressionUUID->"24ececd0-d501-46c2-9a01-d07868be0773",
 CellOpen->False],
Cell[100113, 2958, 5781, 109, 302, "Output",ExpressionUUID->"0f7a4f9f-9606-4e71-aa67-4315e7203019"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[105955, 3074, 88, 0, 67, "Section",ExpressionUUID->"735867a3-e5a7-485e-b7a9-2fffb01620a9"],
Cell[106046, 3076, 7500, 237, 253, "Text",ExpressionUUID->"0bf41702-681c-4068-a283-fb1deffc92cf"],
Cell[113549, 3315, 1781, 54, 69, "Text",ExpressionUUID->"2ea5d700-e6d5-4547-8f10-2b540adbf53f"],
Cell[115333, 3371, 2679, 90, 179, "Text",ExpressionUUID->"2709995f-79b9-4654-8c6e-dcd02d4f5c07"],
Cell[118015, 3463, 747, 26, 75, "Text",ExpressionUUID->"d1b200e7-1954-45b9-934e-d608b39f9cb8"],
Cell[118765, 3491, 829, 26, 67, "Text",ExpressionUUID->"0dbd8797-54ad-4d0b-b1dc-521dd05056a1"],
Cell[CellGroupData[{
Cell[119619, 3521, 247, 7, 54, "Subsection",ExpressionUUID->"a2142f9e-1dc8-48da-bfef-f8b9da8f4271"],
Cell[CellGroupData[{
Cell[119891, 3532, 95, 0, 35, "Subsubsection",ExpressionUUID->"aa8594cd-0dd9-4de3-b629-1ed52bfa1b3c"],
Cell[119989, 3534, 975, 27, 63, "Text",ExpressionUUID->"f247c1ea-359f-40a1-aac7-f8a14703cfa7"],
Cell[CellGroupData[{
Cell[120989, 3565, 11670, 285, 19, "Input",ExpressionUUID->"2b6ee556-d754-41ba-bf75-3397923095ea",
 CellOpen->False],
Cell[132662, 3852, 21217, 466, 192, "Output",ExpressionUUID->"ca24214f-1985-47c4-a74b-20b8a98f1321"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[153928, 4324, 96, 0, 35, "Subsubsection",ExpressionUUID->"0ca0ed9f-2370-4971-adc5-e8154968cad4"],
Cell[154027, 4326, 111, 0, 30, "Text",ExpressionUUID->"78dc4e21-d9c1-41d8-a836-e9bdda1687e8"],
Cell[CellGroupData[{
Cell[154163, 4330, 9507, 237, 19, "Input",ExpressionUUID->"96981617-fb2d-4c2d-b571-35745fe4bd52",
 CellOpen->False],
Cell[163673, 4569, 19618, 497, 240, "Output",ExpressionUUID->"00ee22ef-4580-4b53-ab5f-f963095ce234"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[183340, 5072, 101, 0, 35, "Subsubsection",ExpressionUUID->"fb6b39f5-8799-4aa8-a8ce-21e0009a5abe"],
Cell[183444, 5074, 3377, 106, 177, "Text",ExpressionUUID->"ea180c80-1d45-4c8e-b169-0a13ac3cec31"],
Cell[186824, 5182, 4149, 125, 177, "Text",ExpressionUUID->"b035bbbd-9d60-4cde-9f68-70df00c38835"],
Cell[190976, 5309, 4752, 143, 207, "Text",ExpressionUUID->"5a9fed65-c44e-47db-939e-da9302f55582"]
}, Open  ]],
Cell[CellGroupData[{
Cell[195765, 5457, 101, 0, 35, "Subsubsection",ExpressionUUID->"41eaf251-6f3e-47eb-ae80-da78b37dbb03"],
Cell[195869, 5459, 4642, 138, 177, "Text",ExpressionUUID->"484bfdcd-5ff3-4130-b6e2-7731b48e9897"],
Cell[200514, 5599, 5778, 165, 177, "Text",ExpressionUUID->"738dd1ec-eff3-4631-bf86-9489a7c71b10"],
Cell[206295, 5766, 4674, 143, 207, "Text",ExpressionUUID->"09a334d1-0b00-4340-ad74-e61e7a711d23"]
}, Open  ]],
Cell[CellGroupData[{
Cell[211006, 5914, 97, 0, 35, "Subsubsection",ExpressionUUID->"b0c75cdb-01cb-479a-9090-089265b05490"],
Cell[211106, 5916, 2349, 75, 120, "Text",ExpressionUUID->"d2811ea1-3d92-4826-9024-55551c9205d5"],
Cell[213458, 5993, 2939, 92, 116, "Text",ExpressionUUID->"7458d1ba-90dd-478e-89e7-284a5c5c8def"]
}, Open  ]],
Cell[CellGroupData[{
Cell[216434, 6090, 95, 0, 35, "Subsubsection",ExpressionUUID->"9702f1ed-9629-406b-9309-30a50865f5fa"],
Cell[216532, 6092, 2774, 85, 108, "Text",ExpressionUUID->"15fc059f-3db7-454a-b869-6d8c724caef5"],
Cell[219309, 6179, 504, 14, 34, "Text",ExpressionUUID->"802f5501-9506-4b3d-8d00-ab35752ed2e9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[219850, 6198, 119, 0, 35, "Subsubsection",ExpressionUUID->"65487bfb-867e-421b-b381-db68cd6843d9"],
Cell[219972, 6200, 9677, 308, 374, "Text",ExpressionUUID->"c3990e72-d5ea-4e55-af7d-409b5977a4a6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[229686, 6513, 110, 0, 35, "Subsubsection",ExpressionUUID->"cd1c9823-f092-41bb-8582-ab06a06d2c09"],
Cell[229799, 6515, 5748, 176, 200, "Text",ExpressionUUID->"3c7b42f0-d3c1-414b-8a7f-4fd101de6620"],
Cell[235550, 6693, 1113, 33, 80, "Input",ExpressionUUID->"dac6d09b-7866-4b87-81e2-0ec0db3c2d41"],
Cell[236666, 6728, 8735, 275, 388, "Text",ExpressionUUID->"4b8e7b31-f5c5-49da-9836-8538cf778466"],
Cell[245404, 7005, 1232, 36, 79, "Input",ExpressionUUID->"410b688e-e2f3-4e15-b714-2fa7a2629dfb"],
Cell[246639, 7043, 278, 7, 28, "Input",ExpressionUUID->"1cd6d324-5f1a-4d4d-8958-67d03364ea74"],
Cell[246920, 7052, 3346, 91, 220, "Input",ExpressionUUID->"ce0adfe1-a58f-4f6b-bdce-c11947e83776"],
Cell[250269, 7145, 7057, 217, 278, "Text",ExpressionUUID->"c269a811-6c20-4ec2-9138-4d3b98812bc8"],
Cell[257329, 7364, 2883, 81, 242, "Input",ExpressionUUID->"4796ec80-888a-4512-954f-8a6f09a2344e"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[260261, 7451, 293, 9, 38, "Subsection",ExpressionUUID->"b7812201-bd18-4907-b203-b99955572430"],
Cell[CellGroupData[{
Cell[260579, 7464, 95, 0, 35, "Subsubsection",ExpressionUUID->"6462dce5-1685-4dac-898e-7544962e9b38"],
Cell[260677, 7466, 975, 27, 63, "Text",ExpressionUUID->"9be42b0f-8b28-4f92-81b7-03a7b5345aa5"],
Cell[CellGroupData[{
Cell[261677, 7497, 12272, 299, 19, "Input",ExpressionUUID->"16af3c49-03b9-46dc-9830-277ad7f17903",
 CellOpen->False],
Cell[273952, 7798, 24086, 514, 480, "Output",ExpressionUUID->"19081a74-64e8-4920-a0f1-4d886a95947b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[298087, 8318, 96, 0, 35, "Subsubsection",ExpressionUUID->"3acc5477-ed49-453e-a1fa-6be59f5eb892"],
Cell[298186, 8320, 111, 0, 30, "Text",ExpressionUUID->"8cf8ce31-049d-4179-ba45-2291d3ae4c3c"],
Cell[CellGroupData[{
Cell[298322, 8324, 10264, 255, 19, "Input",ExpressionUUID->"02fd0990-e5aa-4cfe-b2a1-be37eedc9a90",
 CellOpen->False],
Cell[308589, 8581, 26168, 621, 528, "Output",ExpressionUUID->"72b17c62-75ab-440a-bf58-e313a513100b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[334806, 9208, 101, 0, 35, "Subsubsection",ExpressionUUID->"4a14bfee-67cd-41cf-b8f9-0ff48b4600a7"],
Cell[334910, 9210, 7180, 206, 177, "Text",ExpressionUUID->"71dd6534-88ee-4f77-b585-a0871fd1c7be"],
Cell[342093, 9418, 6871, 198, 177, "Text",ExpressionUUID->"36013628-fe85-42dd-a15b-610d333f3ddd"],
Cell[348967, 9618, 4752, 143, 207, "Text",ExpressionUUID->"ec1a98ec-a38d-4d68-8f40-dfff4cdc89d3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[353756, 9766, 101, 0, 35, "Subsubsection",ExpressionUUID->"23e261f9-4f3f-4280-a06b-4cccde14ee40"],
Cell[353860, 9768, 9862, 270, 177, "Text",ExpressionUUID->"de0dd5ee-859e-4eaa-a654-7fcee3abb3a2"],
Cell[363725, 10040, 9505, 262, 177, "Text",ExpressionUUID->"7c7421d9-8a6f-4e6e-b740-c3542a8ee789"],
Cell[373233, 10304, 4674, 143, 207, "Text",ExpressionUUID->"06fdc702-55b4-4b4f-bb84-6feee923bc2a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[377944, 10452, 97, 0, 35, "Subsubsection",ExpressionUUID->"25693883-e3df-4ab8-953c-bac84cbdf2a6"],
Cell[378044, 10454, 6944, 221, 201, "Text",ExpressionUUID->"fcd8dee0-ec11-4ab6-8a3d-d5174515d896"],
Cell[384991, 10677, 5410, 175, 200, "Text",ExpressionUUID->"dc97685c-bdbc-43a6-a0bb-711e3072f802"]
}, Open  ]],
Cell[CellGroupData[{
Cell[390438, 10857, 95, 0, 35, "Subsubsection",ExpressionUUID->"371ad179-8aa9-4123-bd48-b786e6c6f78d"],
Cell[390536, 10859, 2774, 85, 108, "Text",ExpressionUUID->"d4bd98e6-bc8d-4c06-9462-f153b84ae9d9"],
Cell[393313, 10946, 929, 27, 57, "Text",ExpressionUUID->"e176e514-7268-48b2-8886-6145a6a64883"]
}, Open  ]],
Cell[CellGroupData[{
Cell[394279, 10978, 119, 0, 35, "Subsubsection",ExpressionUUID->"89ac2bf6-54bc-4121-9438-9b0a318cfecb"],
Cell[394401, 10980, 10969, 345, 374, "Text",ExpressionUUID->"be81b364-834e-47ae-bb10-f0b168d8837d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[405407, 11330, 110, 0, 35, "Subsubsection",ExpressionUUID->"98ccbfc0-4eda-4fe5-96cd-5594d4529875"],
Cell[405520, 11332, 7343, 226, 202, "Text",ExpressionUUID->"00d5de90-68ea-44e8-b25c-e078a7294345"],
Cell[412866, 11560, 1113, 33, 80, "Input",ExpressionUUID->"9182bf70-3ed0-4026-a43b-96e67113f93c"],
Cell[413982, 11595, 10057, 315, 390, "Text",ExpressionUUID->"08de6e68-6832-4afd-8303-0173c6d708d4"],
Cell[424042, 11912, 1232, 36, 79, "Input",ExpressionUUID->"f7387adc-b2c6-4a42-bc32-9cfa30b8e50c"],
Cell[425277, 11950, 278, 7, 28, "Input",ExpressionUUID->"d0759c65-a16d-4938-92f7-9bdae3a511cd"],
Cell[425558, 11959, 3346, 91, 220, "Input",ExpressionUUID->"349b68c8-fc43-4719-bf0f-c80f44eab938"],
Cell[428907, 12052, 8871, 269, 280, "Text",ExpressionUUID->"59fc32ea-eade-4306-a38e-8ba6362e937b"],
Cell[437781, 12323, 2883, 81, 242, "Input",ExpressionUUID->"dd0a03e8-94b4-45d0-abc3-4e919c4edb8f"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[440713, 12410, 329, 10, 38, "Subsection",ExpressionUUID->"d32e5f04-a70d-46df-91b1-209d254e0177"],
Cell[CellGroupData[{
Cell[441067, 12424, 95, 0, 45, "Subsubsection",ExpressionUUID->"4fda6b53-7a37-422e-99c8-5a58a99d174b"],
Cell[441165, 12426, 975, 27, 64, "Text",ExpressionUUID->"51cb748a-0b20-4044-bd39-6bf9ff1cb549"],
Cell[CellGroupData[{
Cell[442165, 12457, 12272, 299, 19, "Input",ExpressionUUID->"1f5bcfe9-cae3-40dd-8970-0f492c259f27",
 CellOpen->False],
Cell[454440, 12758, 24086, 514, 482, "Output",ExpressionUUID->"9a80ce38-d2c9-4df6-8fd6-41208d4fc72a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[478575, 13278, 96, 0, 45, "Subsubsection",ExpressionUUID->"9efd36d5-80ea-4ab2-a658-830f702c6892"],
Cell[478674, 13280, 111, 0, 35, "Text",ExpressionUUID->"1476d000-42ea-4eec-a0e0-e7a85268dc8c"],
Cell[CellGroupData[{
Cell[478810, 13284, 10264, 255, 19, "Input",ExpressionUUID->"2f744134-13d6-4bed-a8ce-49fd1311bf4d",
 CellOpen->False],
Cell[489077, 13541, 26168, 621, 530, "Output",ExpressionUUID->"0eb1e3e0-54e2-4a72-bebd-800c14a41388"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[515294, 14168, 101, 0, 45, "Subsubsection",ExpressionUUID->"1dae012a-764d-4823-989f-9132e3b05eb5"],
Cell[515398, 14170, 3257, 96, 87, "Text",ExpressionUUID->"4a32c144-2bed-460c-b504-1817619480a4"],
Cell[518658, 14268, 29667, 784, 708, "Text",ExpressionUUID->"f68f0d5a-5530-43f3-8bb1-99641057959b"],
Cell[548328, 15054, 7595, 215, 364, "Text",ExpressionUUID->"fb2d4edc-eda1-4307-8c64-474c05d75a69"],
Cell[555926, 15271, 4752, 143, 225, "Text",ExpressionUUID->"879b91dd-0e71-4c17-8b01-91413d2296b4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[560715, 15419, 101, 0, 45, "Subsubsection",ExpressionUUID->"3fd80d18-93a5-4473-a862-324c8acc4478"],
Cell[560819, 15421, 5265, 150, 171, "Text",ExpressionUUID->"b1b21436-00fc-42b2-8cee-4b54db7bc78e"],
Cell[566087, 15573, 39459, 1001, 720, "Text",ExpressionUUID->"40120859-edbc-4c5f-a4cb-185d316c6176"],
Cell[605549, 16576, 10072, 274, 370, "Text",ExpressionUUID->"fdb5ab80-6aa4-41be-b363-0f7fe536d172"],
Cell[615624, 16852, 4674, 143, 225, "Text",ExpressionUUID->"80d4ea19-c2ef-4164-b5b7-9139120d47a8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[620335, 17000, 97, 0, 45, "Subsubsection",ExpressionUUID->"9b24c58e-01ec-4089-8f00-5fa6e94f06d7"],
Cell[620435, 17002, 20385, 600, 333, "Text",ExpressionUUID->"86e4c864-bab1-4511-92f5-f0bb049731de"],
Cell[640823, 17604, 7853, 245, 238, "Text",ExpressionUUID->"c290a6d5-6d21-4b39-8935-2b159b8a9447"]
}, Open  ]],
Cell[CellGroupData[{
Cell[648713, 17854, 95, 0, 45, "Subsubsection",ExpressionUUID->"e095697b-fa84-415e-9f91-22e10365ec3b"],
Cell[648811, 17856, 2774, 85, 115, "Text",ExpressionUUID->"c34d9577-3ec3-4649-915c-b9b359f35ad0"],
Cell[651588, 17943, 1354, 40, 87, "Text",ExpressionUUID->"8d343955-6fe7-4eba-9d46-2a86941bd879"]
}, Open  ]],
Cell[CellGroupData[{
Cell[652979, 17988, 119, 0, 45, "Subsubsection",ExpressionUUID->"3ca03ab2-b7fc-416e-8f69-fc4a8674c595"],
Cell[653101, 17990, 10987, 342, 381, "Text",ExpressionUUID->"545bd01b-fb66-41d6-8ac5-fbf64bcbaf35"]
}, Open  ]],
Cell[CellGroupData[{
Cell[664125, 18337, 110, 0, 45, "Subsubsection",ExpressionUUID->"b2aecc36-9604-497d-87cf-892c4fb6d61f"],
Cell[664238, 18339, 8588, 258, 210, "Text",ExpressionUUID->"7b0d86de-0ae0-4b69-b8b0-bb8340810167"],
Cell[672829, 18599, 1113, 33, 94, "Input",ExpressionUUID->"ee4bd973-9558-42d9-b990-439034bc1334"],
Cell[673945, 18634, 10963, 336, 412, "Text",ExpressionUUID->"8d1b0747-5cd3-4dbc-95ea-80ff79c53cfe"],
Cell[684911, 18972, 1232, 36, 84, "Input",ExpressionUUID->"5edeacd7-5f83-4a68-8e66-b70c04d10082"],
Cell[686146, 19010, 278, 7, 30, "Input",ExpressionUUID->"640cc276-4801-49cc-bc72-5ff849dffdf6"],
Cell[686427, 19019, 3346, 91, 240, "Input",ExpressionUUID->"fb9653f6-533e-4fdd-9e41-b055f0e61d20"],
Cell[689776, 19112, 10297, 304, 297, "Text",ExpressionUUID->"47919e03-de1d-4d19-b407-4447e4bc5c63"],
Cell[700076, 19418, 2883, 81, 263, "Input",ExpressionUUID->"66903457-22cf-4784-b97c-90d8ac63beec"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

