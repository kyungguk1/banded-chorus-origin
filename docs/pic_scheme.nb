(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    198022,       5836]
NotebookOptionsPosition[    191019,       5722]
NotebookOutlinePosition[    191469,       5740]
CellTagsIndexPosition[    191426,       5737]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Basic Equations", "Section",ExpressionUUID->"98f60438-238c-49f7-a2be-78fd60abd294"],

Cell[CellGroupData[{

Cell["In cgs unit system", "Subsection",ExpressionUUID->"60be49ab-8d81-409d-8bc9-7546a121a65e"],

Cell[TextData[{
 "Maxwell's equations:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[PartialD]", "\[DoubleStruckCapitalE]"}], "/", 
     RowBox[{"\[PartialD]", "t"}]}], "=", 
    RowBox[{
     RowBox[{"c", 
      RowBox[{"\[Del]", "\[Times]", "\[DoubleStruckCapitalB]"}]}], "-", 
     RowBox[{"4", "\[Pi]", 
      RowBox[{"\[Sum]", "\[DoubleStruckJ]"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"1f97031b-2d12-4686-9ae5-0d44827febfc"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[PartialD]", "\[DoubleStruckCapitalB]"}], "/", 
     RowBox[{"\[PartialD]", "t"}]}], "=", 
    RowBox[{
     RowBox[{"-", "c"}], 
     RowBox[{"\[Del]", "\[Times]", "\[DoubleStruckCapitalE]"}]}]}], 
   TraditionalForm]],ExpressionUUID->"88c25ca6-708c-4d7d-bad6-b9ea0b27f4a8"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Del]", "\[CenterDot]", "\[DoubleStruckCapitalE]"}], "=", 
    RowBox[{"4", "\[Pi]", " ", "\[Rho]"}]}], TraditionalForm]],ExpressionUUID->
  "0472f8d2-72b0-41a8-96ff-78cbe797e2e3"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Del]", "\[CenterDot]", "\[DoubleStruckCapitalB]"}], "=", "0"}],
    TraditionalForm]],ExpressionUUID->
  "6c8d9788-0766-4dd8-91aa-eb5bb4550adb"],
 ",\nwhere ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[DoubleStruckJ]", "=", 
    RowBox[{
     SubscriptBox["\[Sum]", "s"], 
     SubscriptBox["\[DoubleStruckJ]", "s"]}]}], TraditionalForm]],
  ExpressionUUID->"251f4995-21c4-4b5c-8983-f658eb3a604a"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Rho]", "=", 
    RowBox[{
     SubscriptBox["\[Sum]", "s"], 
     SubscriptBox["\[Rho]", "s"]}]}], TraditionalForm]],ExpressionUUID->
  "f33fbd5b-e9f5-4668-91d9-776fe15476a0"],
 "."
}], "Text",ExpressionUUID->"1dd6616b-e8f8-4544-b951-5a3556ea34ed"],

Cell[TextData[{
 "Continuity equation:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[Del]", "\[CenterDot]", 
      SubscriptBox["\[DoubleStruckJ]", "s"]}], "+", 
     RowBox[{
      RowBox[{"\[PartialD]", 
       SubscriptBox["\[Rho]", "s"]}], "/", 
      RowBox[{"\[PartialD]", "t"}]}]}], "=", "0"}], TraditionalForm]],
  ExpressionUUID->"9f8f385b-4bb0-4ec5-ac00-2a3223404ea6"],
 "."
}], "Text",ExpressionUUID->"ea9a4192-2aec-4b1d-9375-1e75ca196da4"],

Cell[TextData[{
 "Equations of motion (non-relativistic):\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[PartialD]", 
      SubscriptBox["\[DoubleStruckX]", "p"]}], "/", 
     RowBox[{"\[PartialD]", "t"}]}], "=", 
    SubscriptBox["\[DoubleStruckV]", "p"]}], TraditionalForm]],ExpressionUUID->
  "a08b66d6-62d5-494f-80f2-2fed880c43c1"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[PartialD]", 
      SubscriptBox["\[DoubleStruckV]", "p"]}], "/", 
     RowBox[{"\[PartialD]", "t"}]}], "=", 
    RowBox[{
     FractionBox[
      SubscriptBox["q", "s"], 
      RowBox[{
       SubscriptBox["m", "s"], "c"}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", "\[DoubleStruckCapitalE]"}], "+", 
       RowBox[{
        SubscriptBox["\[DoubleStruckV]", "p"], "\[Cross]", 
        "\[DoubleStruckCapitalB]"}]}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"873e64f8-4346-440f-8ea4-13994f415d2c"],
 ",\nwhere ",
 Cell[BoxData[
  FormBox["p", TraditionalForm]],ExpressionUUID->
  "8206badf-4989-4ef8-8115-c0b1a267b901"],
 " runs through the particles."
}], "Text",ExpressionUUID->"e928ad21-de0c-4bba-a819-0bfb41a39a27"],

Cell[TextData[{
 "Equations of motion (relativistic):\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[PartialD]", 
      SubscriptBox["\[DoubleStruckX]", "p"]}], "/", 
     RowBox[{"\[PartialD]", "t"}]}], "=", 
    SubscriptBox["\[DoubleStruckV]", "p"]}], TraditionalForm]],ExpressionUUID->
  "fedb157c-077c-432b-ae97-bb2e5dbb3be6"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[PartialD]", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["\[Gamma]", "p"], 
        SubscriptBox["\[DoubleStruckV]", "p"]}], ")"}]}], "/", 
     RowBox[{"\[PartialD]", "t"}]}], "=", 
    RowBox[{
     FractionBox[
      SubscriptBox["q", "s"], 
      RowBox[{
       SubscriptBox["m", "s"], "c"}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", "\[DoubleStruckCapitalE]"}], "+", 
       RowBox[{
        SubscriptBox["\[DoubleStruckV]", "p"], "\[Times]", 
        "\[DoubleStruckCapitalB]"}]}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"33f496f5-fdde-4011-89a8-9aee386c3ecf"],
 ",\nwhere ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["m", "s"], TraditionalForm]],ExpressionUUID->
  "6d43cb9e-8b4b-40fe-a509-739cf54493f9"],
 " is the rest mass of species and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Gamma]", "p"], TraditionalForm]],ExpressionUUID->
  "304018ff-bd7a-4161-94ca-be159ee33b2d"],
 " is the Lorentz factor given by\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Gamma]", "p"], "=", 
    RowBox[{"1", "/", 
     SqrtBox[
      RowBox[{"1", "-", 
       RowBox[{
        SubscriptBox["\[DoubleStruckV]", "p"], "\[CenterDot]", 
        RowBox[{
         SubscriptBox["\[DoubleStruckV]", "p"], "/", 
         SuperscriptBox["c", "2"]}]}]}]]}]}], TraditionalForm]],
  ExpressionUUID->"75f439b3-2fc5-4dcf-8dec-de4bd8fd246d"],
 ".\nDefine ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[DoubleStruckU]", "p"], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Gamma]", "p"], 
      SubscriptBox["\[DoubleStruckV]", "p"]}], "=", 
     RowBox[{
      RowBox[{"c", "/", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["c", "2"], "-", 
         RowBox[{
          SubscriptBox["\[DoubleStruckV]", "p"], "\[CenterDot]", 
          SubscriptBox["\[DoubleStruckV]", "p"]}]}]]}], 
      SubscriptBox["\[DoubleStruckV]", "p"]}]}]}], TraditionalForm]],
  ExpressionUUID->"5eced062-fbf7-4400-8896-11de7a467a04"],
 ", then ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[DoubleStruckV]", "p"], "=", 
    RowBox[{
     RowBox[{"c", "/", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["c", "2"], "+", 
        RowBox[{
         SubscriptBox["\[DoubleStruckU]", "p"], "\[CenterDot]", 
         SubscriptBox["\[DoubleStruckU]", "p"]}]}]]}], 
     SubscriptBox["\[DoubleStruckU]", "p"]}]}], TraditionalForm]],
  ExpressionUUID->"7cd4ccbf-4fd5-4136-bf2d-b4e420bbbb58"],
 ".\nTherefore, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Gamma]", "p"], "=", 
    SqrtBox[
     RowBox[{"1", "+", 
      RowBox[{
       SubscriptBox["\[DoubleStruckU]", "p"], "\[CenterDot]", 
       RowBox[{
        SubscriptBox["\[DoubleStruckU]", "p"], "/", 
        SuperscriptBox["c", "2"]}]}]}]]}], TraditionalForm]],ExpressionUUID->
  "a4668b4c-f62a-4d14-837a-c6e9aa721166"],
 ".\nRewriting the Lorentz force,\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[PartialD]", 
      SubscriptBox["\[DoubleStruckU]", "p"]}], "/", 
     RowBox[{"\[PartialD]", "t"}]}], "=", 
    RowBox[{
     RowBox[{
      FractionBox[
       SubscriptBox["q", "s"], 
       SubscriptBox["m", "s"]], 
      RowBox[{"(", 
       RowBox[{"\[DoubleStruckCapitalE]", "+", 
        RowBox[{
         SubscriptBox["\[DoubleStruckU]", "p"], "\[Times]", 
         RowBox[{"\[DoubleStruckCapitalB]", "/", 
          SubscriptBox["\[Gamma]", "p"]}]}]}], ")"}]}], "=", 
     RowBox[{
      FractionBox[
       SubscriptBox["q", "s"], 
       RowBox[{
        SubscriptBox["m", "s"], "c"}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", " ", "\[DoubleStruckCapitalE]"}], "+", 
        RowBox[{
         SubscriptBox["\[DoubleStruckU]", "p"], "\[Times]", 
         SubscriptBox["\[DoubleStruckCapitalB]", "p"]}]}], ")"}]}]}]}], 
   TraditionalForm]],ExpressionUUID->"67a6b5a2-006e-4fa2-bfad-5e0cd878a8ab"],
 ",\nwhere ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[DoubleStruckCapitalB]", "p"], "=", 
    RowBox[{"\[DoubleStruckCapitalB]", "/", 
     SubscriptBox["\[Gamma]", "p"]}]}], TraditionalForm]],ExpressionUUID->
  "c3b48520-b507-41f1-ae21-fa09cbdc09fa"],
 "."
}], "Text",ExpressionUUID->"10531d08-595c-4099-b84b-0cc8da1a8ca6"],

Cell[TextData[{
 "Energy density of fields:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"u", "=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"4", "\[Pi]"}]], 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        SuperscriptBox["\[DoubleStruckCapitalE]", "2"], "2"], "+", 
       FractionBox[
        SuperscriptBox["\[DoubleStruckCapitalB]", "2"], "2"]}], ")"}]}]}], 
   TraditionalForm]],ExpressionUUID->"571e4457-7727-4316-9d20-a294bda4dd0f"],
 ".\nKinetic energy density of particles of species, ",
 Cell[BoxData[
  FormBox["s", TraditionalForm]],ExpressionUUID->
  "f46c3cb9-7fcd-4dd9-a51d-25c0b977975e"],
 ":\nConsider there are ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["N", "s"], TraditionalForm]],ExpressionUUID->
  "42d5a078-691b-4d9a-90ea-b19191eb8c63"],
 " particles of species ",
 Cell[BoxData[
  FormBox["s", TraditionalForm]],ExpressionUUID->
  "305ad988-761b-49ab-aed3-4517a5d07cd1"],
 " in a volume ",
 Cell[BoxData[
  FormBox["V", TraditionalForm]],ExpressionUUID->
  "6d66bfdf-1375-4ef8-bf82-7cae859360f9"],
 ".\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["w", "s"], "=", 
    RowBox[{
     RowBox[{
      FractionBox["1", "V"], 
      RowBox[{
       SubsuperscriptBox["\[Sum]", 
        RowBox[{"p", "=", "1"}], 
        SubscriptBox["N", "s"]], 
       FractionBox[
        RowBox[{
         SubscriptBox["m", "s"], 
         SubsuperscriptBox["\[DoubleStruckV]", "p", "2"]}], "2"]}]}], "=", 
     RowBox[{
      FractionBox[
       SubscriptBox["m", "s"], "2"], 
      FractionBox["1", "V"], 
      RowBox[{
       SubsuperscriptBox["\[Sum]", 
        RowBox[{"p", "=", "1"}], 
        SubscriptBox["N", "s"]], 
       SubsuperscriptBox["\[DoubleStruckV]", "p", "2"]}]}]}]}], 
   TraditionalForm]],ExpressionUUID->"e8d57656-4c9c-4d72-94a0-2f47488f0fd4"],
 ".\nFor a given velocity distribution ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["f", "s"], "(", 
    RowBox[{"\[DoubleStruckV]", ",", "\[DoubleStruckX]"}], ")"}], 
   TraditionalForm]],ExpressionUUID->"ae811d89-5943-409c-8865-4b73c40abc8d"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox["1", "V"], 
     RowBox[{
      SubsuperscriptBox["\[Sum]", 
       RowBox[{"p", "=", "1"}], 
       SubscriptBox["N", "s"]], 
      SubsuperscriptBox["\[DoubleStruckV]", "p", "2"]}]}], "=", 
    RowBox[{
     RowBox[{"\[Integral]", 
      RowBox[{
       SuperscriptBox["\[DoubleStruckV]", "2"], 
       RowBox[{
        SubscriptBox["f", "s"], "(", 
        RowBox[{"\[DoubleStruckV]", ",", "\[DoubleStruckX]"}], ")"}], 
       RowBox[{"\[DifferentialD]", "\[DoubleStruckV]"}]}]}], "=", 
     RowBox[{"\[LeftAngleBracket]", 
      SubsuperscriptBox["\[DoubleStruckV]", "s", "2"], 
      "\[RightAngleBracket]"}]}]}], TraditionalForm]],ExpressionUUID->
  "effbe52f-7ef0-4adf-b92a-64cce47003a9"],
 ".\nTotal particle kinetic energy density:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"w", "=", 
    RowBox[{
     SubscriptBox["\[Sum]", "s"], 
     SubscriptBox["w", "s"]}]}], TraditionalForm]],ExpressionUUID->
  "1ec37c13-70c0-4bbc-b217-bf99a6dc7518"],
 ".\nThen the total energy in the system is\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"U", "=", 
    RowBox[{
     SubscriptBox["\[Integral]", "V"], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"u", "+", "w"}], ")"}], 
      RowBox[{"\[DifferentialD]", "V"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"69e015ef-d5a5-4e28-9777-690dd6e8df34"],
 ".\n\nFor the relativistic case, the total energy of a particle is ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["E", "p"], "=", 
    RowBox[{
     SubscriptBox["\[Gamma]", "p"], 
     SubscriptBox["m", "s"], 
     SuperscriptBox["c", "2"]}]}], TraditionalForm]],ExpressionUUID->
  "dd45ccc1-23df-4e15-b8f6-fe562e36b68b"],
 ".\nHence,\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    SubscriptBox["w", "s"], "=", 
    RowBox[{
     FractionBox["1", "V"], 
     RowBox[{
      SubsuperscriptBox["\[Sum]", 
       RowBox[{"p", "=", "1"}], 
       SubscriptBox["N", "s"]], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[Gamma]", "p"], "-", "1"}], ")"}], 
       SubscriptBox["m", "s"], 
       SuperscriptBox["c", "2"]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     SubscriptBox["m", "s"], 
     SuperscriptBox["c", "2"], 
     FractionBox["1", "V"], 
     RowBox[{
      SubsuperscriptBox["\[Sum]", 
       RowBox[{"p", "=", "1"}], 
       SubscriptBox["N", "s"]], 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["\[Gamma]", "p"], "-", "1"}], ")"}]}]}]}], 
   TraditionalForm]}],ExpressionUUID->
  "fb9c85d1-f935-44e8-a1d9-ab47edad218e"],
 ".\nFor a given velocity distribution ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["f", "s"], "(", 
    RowBox[{"\[DoubleStruckV]", ",", "\[DoubleStruckX]"}], ")"}], 
   TraditionalForm]],ExpressionUUID->"0a996172-d6f8-4d50-be38-c24dbbed94c6"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox["1", "V"], 
     RowBox[{
      SubsuperscriptBox["\[Sum]", 
       RowBox[{"p", "=", "1"}], 
       SubscriptBox["N", "s"]], 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["\[Gamma]", "p"], "-", "1"}], ")"}]}]}], "=", 
    RowBox[{
     RowBox[{"\[Integral]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Gamma]", "(", "u", ")"}], "-", "1"}], ")"}], 
       RowBox[{
        SubscriptBox["f", "s"], "(", 
        RowBox[{"\[DoubleStruckU]", ",", "\[DoubleStruckX]"}], ")"}], 
       RowBox[{"\[DifferentialD]", "\[DoubleStruckU]"}]}]}], "=", 
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{"\[Gamma]", "-", "1"}], "\[RightAngleBracket]"}]}]}], 
   TraditionalForm]],ExpressionUUID->"2227de2d-d687-442b-a84b-8a797c176b05"],
 "."
}], "Text",ExpressionUUID->"3de990f7-fe78-4ab8-b34d-c60118674253"],

Cell[TextData[{
 "Poynting theorem:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      FractionBox["1", 
       RowBox[{"8", "\[Pi]"}]], 
      FractionBox[
       RowBox[{"\[PartialD]", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[DoubleStruckCapitalE]", "2"], "+", 
          SuperscriptBox["\[DoubleStruckCapitalB]", "2"]}], ")"}]}], 
       RowBox[{"\[PartialD]", "t"}]]}], "+", 
     RowBox[{"\[Del]", "\[CenterDot]", "\[DoubleStruckCapitalS]"}]}], "=", 
    RowBox[{
     RowBox[{"-", "\[DoubleStruckJ]"}], "\[CenterDot]", 
     "\[DoubleStruckCapitalE]"}]}], TraditionalForm]],ExpressionUUID->
  "d506a5fe-b03e-45b5-a659-d4d0a8e73587"],
 ", where ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[DoubleStruckCapitalS]", "=", 
    RowBox[{
     FractionBox["c", 
      RowBox[{"4", "\[Pi]"}]], "\[DoubleStruckCapitalE]", "\[Times]", 
     "\[DoubleStruckCapitalB]"}]}], TraditionalForm]],ExpressionUUID->
  "0f776f43-aa39-4527-ae96-2cd3b7ce5b20"],
 ".\nThe first term is the electromagnetic field energy density, and the \
third term is the mechanical energy."
}], "Text",ExpressionUUID->"1ead1ffe-99f7-483d-b7ad-d2eb1efebd58"],

Cell[TextData[{
 "Cold Fluid (Tao, 2014):\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"\[PartialD]", 
      SubscriptBox["\[DoubleStruckCapitalV]", "f"]}], 
     RowBox[{"\[PartialD]", "t"}]], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[DoubleStruckCapitalV]", "f"], "\[CenterDot]", 
         "\[Del]"}], ")"}]}], 
      SubscriptBox["\[DoubleStruckCapitalV]", "f"]}], "+", 
     RowBox[{
      FractionBox[
       SubscriptBox["q", "f"], 
       SubscriptBox["m", "f"]], 
      RowBox[{"(", 
       RowBox[{"\[DoubleStruckCapitalE]", "+", 
        RowBox[{
         FractionBox[
          SubscriptBox["\[DoubleStruckCapitalV]", "f"], "c"], "\[Times]", 
         "\[DoubleStruckCapitalB]"}]}], ")"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"bfad132c-84be-4516-88bc-3adc0860ce25"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"\[PartialD]", 
      SubscriptBox["n", "f"]}], 
     RowBox[{"\[PartialD]", "t"}]], "=", 
    RowBox[{"-", 
     RowBox[{"\[Del]", "\[CenterDot]", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["n", "f"], 
        SubscriptBox["\[DoubleStruckCapitalV]", "f"]}], ")"}]}]}]}], 
   TraditionalForm]],ExpressionUUID->"08011b5d-473e-4a42-8665-71b2923477ac"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[DoubleStruckCapitalJ]", "f"], "=", 
    RowBox[{
     SubscriptBox["q", "f"], 
     SubscriptBox["n", "f"], 
     SubscriptBox["\[DoubleStruckCapitalV]", "f"]}]}], TraditionalForm]],
  ExpressionUUID->"8df0cbf1-e797-4dad-86d5-1cf713209fef"],
 ".\nAssuming that the nonlinear effect of cold species is not essential to \
the dynamics, use linearized equations:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"\[PartialD]", 
      SubscriptBox["\[DoubleStruckCapitalV]", "f"]}], 
     RowBox[{"\[PartialD]", "t"}]], "=", 
    RowBox[{
     FractionBox[
      SubscriptBox["q", "f"], 
      SubscriptBox["m", "f"]], 
     RowBox[{"(", 
      RowBox[{"\[DoubleStruckCapitalE]", "+", 
       RowBox[{
        FractionBox[
         SubscriptBox["\[DoubleStruckCapitalV]", "f"], "c"], "\[Times]", 
        SubscriptBox["\[DoubleStruckCapitalB]", "0"]}]}], ")"}]}]}], 
   TraditionalForm]],ExpressionUUID->"b7133557-5edd-47cb-a05e-e624fa480e3b"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"\[PartialD]", 
      SubscriptBox["\[Delta]n", "f"]}], 
     RowBox[{"\[PartialD]", "t"}]], "=", 
    RowBox[{
     RowBox[{"-", 
      SubscriptBox["n", 
       RowBox[{"f", ",", "0"}]]}], 
     RowBox[{"\[Del]", "\[CenterDot]", 
      SubscriptBox["\[DoubleStruckCapitalV]", "f"]}]}]}], TraditionalForm]],
  ExpressionUUID->"8977feb2-bec4-4c32-95b4-5c27ed6277d6"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[DoubleStruckCapitalJ]", "f"], "=", 
    RowBox[{
     SubscriptBox["q", "f"], 
     SubscriptBox["n", 
      RowBox[{"f", ",", "0"}]], 
     SubscriptBox["\[DoubleStruckCapitalV]", "f"]}]}], TraditionalForm]],
  ExpressionUUID->"0a45ec56-1600-4e6e-9410-b229a9df1ea4"],
 ",\nwhere ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["n", "f"], "=", 
    RowBox[{
     SubscriptBox["n", 
      RowBox[{"f", ",", "0"}]], "+", 
     SubscriptBox["\[Delta]n", "f"]}]}], TraditionalForm]],ExpressionUUID->
  "f54c7258-5071-4ddb-944e-4bf0187d8fb0"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", 
    RowBox[{"f", ",", "0"}]], TraditionalForm]],ExpressionUUID->
  "679de866-3775-4266-97fb-0183b0b20f79"],
 " is the equilibrium number density."
}], "Text",ExpressionUUID->"18c9f654-f3f0-4e24-928a-48ada1cbef30"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simulation unit system", "Subsection",ExpressionUUID->"5593d14d-ab98-4ecd-b232-518d25807eeb"],

Cell[TextData[{
 "Change of variables:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox[
      SubscriptBox["q", "0"], 
      RowBox[{
       SubscriptBox["m", "0"], "c"}]], "E"}], "=", "\[CapitalXi]"}], 
   TraditionalForm]],ExpressionUUID->"bf8c42ac-e07f-4d68-8531-afc81b1b18c4"],
 " (frequency unit),\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox[
      SubscriptBox["q", "0"], 
      RowBox[{
       SubscriptBox["m", "0"], "c"}]], "B"}], "=", "\[CapitalOmega]"}], 
   TraditionalForm]],ExpressionUUID->"c6ad2475-7bc2-4f0a-8107-4473d2936041"],
 " (frequency unit),\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"4", "\[Pi]", " ", 
       SubscriptBox["q", "0"]}], 
      RowBox[{
       SubscriptBox["m", "0"], "c"}]], 
     SubscriptBox["J", "s"]}], "=", 
    SubscriptBox["\[ScriptCapitalJ]", "s"]}], TraditionalForm]],
  ExpressionUUID->"e3922eeb-61d6-465a-a5be-6ec046f8cf2c"],
 " (frequency squared unit),\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"4", "\[Pi]", " ", 
       SubscriptBox["q", "0"]}], 
      SubscriptBox["m", "0"]], 
     SubscriptBox["\[Rho]", "s"]}], "=", 
    SubscriptBox["\[CapitalPi]", "s"]}], TraditionalForm]],ExpressionUUID->
  "021f92c9-f5d0-4725-9927-230544b4373c"],
 " (frequency squared unit),\nwhere ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[CapitalOmega]", "0"], TraditionalForm]],ExpressionUUID->
  "ba4c1135-61b8-4f1c-a632-98eaef1899f5"],
 " is magnitude of the background magnetic field, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[CapitalOmega]", "s"], TraditionalForm]],ExpressionUUID->
  "7880f88d-29a4-4255-bc9e-626c7e58711b"],
 " is the species cyclotron frequency and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Omega]", "s"], TraditionalForm]],ExpressionUUID->
  "1188f7a0-ee8d-4a0c-933e-1d228d64fe01"],
 " is the (initial) species plasma frequency.\nHere ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["\[Omega]", "s", "2"], "=", 
    RowBox[{
     FractionBox[
      SubscriptBox["\[CapitalOmega]", "s"], 
      SubscriptBox["\[CapitalOmega]", "0"]], 
     SubscriptBox["\[CapitalPi]", "s"]}]}], TraditionalForm]],ExpressionUUID->
  "a4221057-16b1-4ebf-820e-c92653838246"],
 "."
}], "Text",ExpressionUUID->"1d55d8c6-05c5-496e-826e-e1177ab9951c"],

Cell[TextData[{
 "Maxwells equations:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[PartialD]", 
      OverscriptBox["\[CapitalXi]", "\[RightVector]"]}], "/", 
     RowBox[{"\[PartialD]", "t"}]}], "=", 
    RowBox[{
     RowBox[{"c", 
      RowBox[{"\[Del]", "\[Times]", 
       OverscriptBox["\[CapitalOmega]", "\[RightVector]"]}]}], "-", 
     OverscriptBox["\[ScriptCapitalJ]", "\[RightVector]"]}]}], 
   TraditionalForm]],ExpressionUUID->"304d2d98-429f-4a76-acc6-c5f03f200253"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[PartialD]", 
      OverscriptBox["\[CapitalOmega]", "\[RightVector]"]}], "/", 
     RowBox[{"\[PartialD]", "t"}]}], "=", 
    RowBox[{
     RowBox[{"-", "c"}], 
     RowBox[{"\[Del]", "\[Times]", 
      OverscriptBox["\[CapitalXi]", "\[RightVector]"]}]}]}], 
   TraditionalForm]],ExpressionUUID->"134328a2-25c0-4ac4-9837-c87f27adcac7"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"c", 
     RowBox[{"\[Del]", "\[CenterDot]", 
      OverscriptBox["\[CapitalXi]", "\[RightVector]"]}]}], "=", 
    "\[CapitalPi]"}], TraditionalForm]],ExpressionUUID->
  "8a281d9b-ad9f-48e9-9120-7e2f3e6283cc"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"c", 
     RowBox[{"\[Del]", "\[CenterDot]", 
      OverscriptBox["\[CapitalOmega]", "\[RightVector]"]}]}], "=", "0"}], 
   TraditionalForm]],ExpressionUUID->"26c19f42-687b-407f-9a57-d493a6be6e09"],
 ",\nwhere ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox["\[ScriptCapitalJ]", "\[RightVector]"], "=", 
    RowBox[{
     SubscriptBox["\[Sum]", "s"], 
     OverscriptBox[
      SubscriptBox["\[ScriptCapitalJ]", "s"], "\[RightVector]"]}]}], 
   TraditionalForm]],ExpressionUUID->"1e6ad028-812a-4d96-8c88-66ae43d1c049"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalPi]", "=", 
    RowBox[{
     SubscriptBox["\[Sum]", "s"], 
     SubscriptBox["\[CapitalPi]", "s"]}]}], TraditionalForm]],ExpressionUUID->
  "639061d8-9ca0-4ed4-867d-dbf8e5ed0f11"],
 " of the species ",
 Cell[BoxData[
  FormBox["s", TraditionalForm]],ExpressionUUID->
  "e0a16cb1-4967-4d03-94f1-83de67b1f747"],
 "."
}], "Text",ExpressionUUID->"e9b742c7-f260-4742-ad46-d525c2ba769d"],

Cell[TextData[{
 "Continuity equation:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"c", 
      RowBox[{"\[Del]", "\[CenterDot]", 
       OverscriptBox[
        SubscriptBox["\[ScriptCapitalJ]", "s"], "\[RightVector]"]}]}], "+", 
     RowBox[{
      RowBox[{"\[PartialD]", 
       SubscriptBox["\[CapitalPi]", "s"]}], "/", 
      RowBox[{"\[PartialD]", "t"}]}]}], "=", "0"}], TraditionalForm]],
  ExpressionUUID->"85576618-e0f0-4c90-ac4b-47a23dd1ee14"],
 "."
}], "Text",ExpressionUUID->"f86f895a-40f7-4d01-bfd3-cd70821d3cc6"],

Cell[TextData[{
 "Equations of motion (non-relativistic):\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[PartialD]", 
      SubscriptBox["\[DoubleStruckX]", "p"]}], "/", 
     RowBox[{"\[PartialD]", "t"}]}], "=", 
    SubscriptBox["\[DoubleStruckV]", "p"]}], TraditionalForm]],ExpressionUUID->
  "328b484f-9147-4c5a-8065-e549300b3e06"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[PartialD]", 
      SubscriptBox["\[DoubleStruckV]", "p"]}], "/", 
     RowBox[{"\[PartialD]", "t"}]}], "=", 
    RowBox[{
     FractionBox[
      SubscriptBox["\[CapitalOmega]", "s"], 
      SubscriptBox["\[CapitalOmega]", "0"]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", 
        OverscriptBox["\[CapitalXi]", "\[RightVector]"]}], "+", 
       RowBox[{
        SubscriptBox["\[DoubleStruckV]", "p"], "\[Times]", 
        OverscriptBox["\[CapitalOmega]", "\[RightVector]"]}]}], ")"}]}]}], 
   TraditionalForm]],ExpressionUUID->"e0b7bc7d-fa05-49b0-b296-879bd2958989"],
 "."
}], "Text",ExpressionUUID->"2e76a4f2-0040-4ba3-944c-44be0134b9f1"],

Cell[TextData[{
 "Equations of motion (relativistic):\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[PartialD]", 
      SubscriptBox["\[DoubleStruckX]", "p"]}], "/", 
     RowBox[{"\[PartialD]", "t"}]}], "=", 
    SubscriptBox["\[DoubleStruckV]", "p"]}], TraditionalForm]],ExpressionUUID->
  "ca83c5f1-284e-4850-a42a-88e624a3f255"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[PartialD]", 
      SubscriptBox["\[DoubleStruckU]", "p"]}], "/", 
     RowBox[{"\[PartialD]", "t"}]}], "=", 
    RowBox[{
     FractionBox[
      SubscriptBox["\[CapitalOmega]", "s"], 
      SubscriptBox["\[CapitalOmega]", "0"]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", 
        OverscriptBox["\[CapitalXi]", "\[RightVector]"]}], "+", 
       RowBox[{
        SubscriptBox["\[DoubleStruckU]", "p"], "\[Times]", 
        FractionBox[
         OverscriptBox["\[CapitalOmega]", "\[RightVector]"], 
         SubscriptBox["\[Gamma]", "p"]]}]}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"39e9dc4f-724b-43e4-b087-4dd5cc9ad92e"],
 "."
}], "Text",ExpressionUUID->"f030f6e9-193f-45c5-b50c-c8c165382755"],

Cell[TextData[{
 "Energy density of fields:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[CurlyEpsilon]", "EM"], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[CapitalXi]", "2"], "+", 
       SuperscriptBox["\[CapitalOmega]", "2"]}], ")"}], "/", "2"}]}], 
   TraditionalForm]],ExpressionUUID->"ce5e03fb-573c-4548-90a4-bb1940ee98d1"],
 ", where ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[CurlyEpsilon]", "EM"], "=", 
    RowBox[{
     FractionBox[
      RowBox[{"4", "\[Pi]", " ", 
       SubsuperscriptBox["q", "0", "2"]}], 
      RowBox[{
       SubsuperscriptBox["m", "0", "2"], 
       SuperscriptBox["c", "2"]}]], "u"}]}], TraditionalForm]],ExpressionUUID->
  "9aba7dd6-ef9f-4266-9952-091ed898bad3"],
 " (frequency squared).\nLikewise, we define kinetic energy density of \
particles of species, ",
 Cell[BoxData[
  FormBox["s", TraditionalForm]],ExpressionUUID->
  "ec10a617-74a3-4476-96ef-ba8bf7de613d"],
 ":\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[CurlyEpsilon]", "KE"], "=", 
    RowBox[{
     SubscriptBox["\[Sum]", "s"], 
     SubscriptBox["\[CurlyEpsilon]", "s"]}]}], TraditionalForm]],
  ExpressionUUID->"e65aec5f-4263-429f-bb03-30b1a0c77cf0"],
 " (frequency squared unit), where \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[CurlyEpsilon]", "s"], "=", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"4", "\[Pi]", " ", 
        SubsuperscriptBox["q", "0", "2"]}], 
       RowBox[{
        SubsuperscriptBox["m", "0", "2"], 
        SuperscriptBox["c", "2"]}]], 
      SubscriptBox["w", "s"]}], "=", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{"4", "\[Pi]", " ", 
         SubsuperscriptBox["q", "0", "2"]}], 
        RowBox[{
         SubsuperscriptBox["m", "0", "2"], 
         SuperscriptBox["c", "2"]}]], 
       RowBox[{"\[LeftAngleBracket]", 
        FractionBox[
         RowBox[{
          SubscriptBox["m", "s"], 
          SubsuperscriptBox["\[DoubleStruckV]", "p", "2"]}], "2"], 
        "\[RightAngleBracket]"}]}], "=", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"4", "\[Pi]", " ", 
          SubsuperscriptBox["q", "s", "2"]}], 
         RowBox[{
          SubscriptBox["m", "s"], 
          SuperscriptBox["c", "2"]}]], 
        FractionBox[
         SubsuperscriptBox["\[CapitalOmega]", "0", "2"], 
         SubsuperscriptBox["\[CapitalOmega]", "s", "2"]], 
        RowBox[{"\[LeftAngleBracket]", 
         FractionBox[
          SubsuperscriptBox["\[DoubleStruckV]", "p", "2"], "2"], 
         "\[RightAngleBracket]"}]}], "=", 
       RowBox[{
        FractionBox[
         SubsuperscriptBox["\[CapitalOmega]", "0", "2"], 
         SubsuperscriptBox["\[CapitalOmega]", "s", "2"]], 
        FractionBox[
         SubsuperscriptBox["\[Omega]", "s", "2"], 
         SuperscriptBox["c", "2"]], 
        FractionBox[
         RowBox[{
          SubsuperscriptBox["\[Sum]", "p", 
           SuperscriptBox["N", "t"]], 
          RowBox[{
           SubsuperscriptBox["\[DoubleStruckV]", "p", "2"], "/", "2"}]}], 
         SuperscriptBox["N", "0"]]}]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"603ed1b1-4304-4e29-ba80-c325e9ec9874"],
 ".\nIn relativistic regime,\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[CurlyEpsilon]", "s"], "=", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"4", "\[Pi]", " ", 
        SubsuperscriptBox["q", "0", "2"]}], 
       RowBox[{
        SubsuperscriptBox["m", "0", "2"], 
        SuperscriptBox["c", "2"]}]], 
      SubscriptBox["w", "s"]}], "=", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{"4", "\[Pi]", " ", 
         SubsuperscriptBox["q", "0", "2"]}], 
        RowBox[{
         SubsuperscriptBox["m", "0", "2"], 
         SuperscriptBox["c", "2"]}]], 
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{
         SubscriptBox["m", "s"], 
         RowBox[{
          SuperscriptBox["c", "2"], "(", 
          RowBox[{
           SubscriptBox["\[Gamma]", "s"], "-", "1"}], ")"}]}], 
        "\[RightAngleBracket]"}]}], "=", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"4", "\[Pi]", " ", 
          SubsuperscriptBox["q", "s", "2"]}], 
         RowBox[{
          SubscriptBox["m", "s"], 
          SuperscriptBox["c", "2"]}]], 
        FractionBox[
         SubsuperscriptBox["\[CapitalOmega]", "0", "2"], 
         SubsuperscriptBox["\[CapitalOmega]", "s", "2"]], 
        RowBox[{"\[LeftAngleBracket]", 
         RowBox[{
          SuperscriptBox["c", "2"], "(", 
          RowBox[{
           SubscriptBox["\[Gamma]", "s"], "-", "1"}], ")"}], 
         "\[RightAngleBracket]"}]}], "=", 
       RowBox[{
        FractionBox[
         SubsuperscriptBox["\[CapitalOmega]", "0", "2"], 
         SubsuperscriptBox["\[CapitalOmega]", "s", "2"]], 
        FractionBox[
         SubsuperscriptBox["\[Omega]", "s", "2"], 
         SuperscriptBox["c", "2"]], 
        FractionBox[
         RowBox[{
          SuperscriptBox["c", "2"], 
          RowBox[{
           SubsuperscriptBox["\[Sum]", "p", 
            SuperscriptBox["N", "t"]], 
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["\[Gamma]", "p"], "-", "1"}], ")"}]}]}], 
         SuperscriptBox["N", "0"]]}]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"019d86fb-e40f-4670-a826-221ace9bc6a4"],
 ".\nThen the total energy in the system is\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[ScriptCapitalE]", "=", 
    RowBox[{
     SubscriptBox["\[Integral]", "V"], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["\[CurlyEpsilon]", "EM"], "+", 
        SubscriptBox["\[CurlyEpsilon]", "KE"]}], ")"}], 
      RowBox[{"\[DifferentialD]", "V"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"706bf737-d8ed-4c4f-8898-067c2beda9d2"],
 "."
}], "Text",ExpressionUUID->"dd318524-e19a-4180-a048-ecf72f601003"],

Cell[TextData[{
 "Poynting theorem:\nDefine the Poynting vector: ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"4", "\[Pi]", " ", 
       SubsuperscriptBox["q", "0", "2"]}], 
      RowBox[{
       SubsuperscriptBox["m", "0", "2"], 
       SuperscriptBox["c", "2"]}]], "S"}], "=", "\[ScriptCapitalS]"}], 
   TraditionalForm]],ExpressionUUID->"a88ad649-318f-41ec-8f3c-a7f39346c12e"],
 ".\nThen ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox["\[ScriptCapitalS]", "\[RightVector]"], "=", 
    RowBox[{"c", " ", 
     OverscriptBox["\[CapitalXi]", "\[RightVector]"], "\[Times]", 
     OverscriptBox["\[CapitalOmega]", "\[RightVector]"]}]}], 
   TraditionalForm]],ExpressionUUID->"8dbeca68-46d5-4081-90f0-3c96fafe29cc"],
 ", and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], 
      FractionBox[
       RowBox[{"\[PartialD]", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[CapitalXi]", "2"], "+", 
          SuperscriptBox["\[CapitalOmega]", "2"]}], ")"}]}], 
       RowBox[{"\[PartialD]", "t"}]]}], "+", 
     RowBox[{"\[Del]", "\[CenterDot]", 
      OverscriptBox["\[ScriptCapitalS]", "\[RightVector]"]}]}], "=", 
    RowBox[{
     RowBox[{"-", 
      OverscriptBox["\[ScriptCapitalJ]", "\[RightVector]"]}], "\[CenterDot]", 
     
     OverscriptBox["\[CapitalXi]", "\[RightVector]"]}]}], TraditionalForm]],
  ExpressionUUID->"691c5dfb-fcb9-4139-9b45-bd81ac825512"],
 "."
}], "Text",ExpressionUUID->"661cd1e9-44aa-4fdb-a829-31ad6568d022"],

Cell[TextData[{
 "Cold Fluid;\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"\[PartialD]", 
      SubscriptBox["\[DoubleStruckCapitalV]", "f"]}], 
     RowBox[{"\[PartialD]", "t"}]], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["\[DoubleStruckCapitalV]", "f"], "\[CenterDot]", 
         "\[Del]"}], ")"}]}], 
      SubscriptBox["\[DoubleStruckCapitalV]", "f"]}], "+", 
     RowBox[{
      FractionBox[
       SubscriptBox["\[CapitalOmega]", "f"], 
       SubscriptBox["\[CapitalOmega]", "0"]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", " ", 
         OverscriptBox["\[CapitalXi]", "\[RightVector]"]}], "+", 
        RowBox[{
         SubscriptBox["\[DoubleStruckCapitalV]", "f"], "\[Times]", 
         OverscriptBox["\[CapitalOmega]", "\[RightVector]"]}]}], ")"}]}]}]}], 
   TraditionalForm]],ExpressionUUID->"981ea67d-2f89-4c38-860a-debf26b69851"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"\[PartialD]", 
      SubscriptBox["n", "f"]}], 
     RowBox[{"\[PartialD]", "t"}]], "=", 
    RowBox[{"-", 
     RowBox[{"\[Del]", "\[CenterDot]", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["n", "f"], 
        SubscriptBox["\[DoubleStruckCapitalV]", "f"]}], ")"}]}]}]}], 
   TraditionalForm]],ExpressionUUID->"a7376188-a6b1-423b-836b-53b6e56cf533"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox[
     SubscriptBox["\[ScriptCapitalJ]", "f"], "\[RightVector]"], "=", 
    RowBox[{
     SubscriptBox["\[CapitalPi]", "f"], 
     FractionBox[
      SubscriptBox["\[DoubleStruckCapitalV]", "f"], "c"]}]}], 
   TraditionalForm]],ExpressionUUID->"a7e9d47a-9d6c-4532-b2f9-2b15596ddbf3"],
 ".\nAssuming that the nonlinear effect of cold species is not essential to \
the dynamics, use linearized equations:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"\[PartialD]", 
      SubscriptBox["\[DoubleStruckCapitalV]", "f"]}], 
     RowBox[{"\[PartialD]", "t"}]], "=", 
    RowBox[{
     FractionBox[
      SubscriptBox["\[CapitalOmega]", 
       RowBox[{"f", ",", "0"}]], 
      SubscriptBox["\[CapitalOmega]", "0"]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", 
        OverscriptBox["\[CapitalXi]", "\[RightVector]"]}], "+", 
       RowBox[{
        SubscriptBox["\[DoubleStruckCapitalV]", "f"], "\[Times]", 
        SubscriptBox[
         OverscriptBox["\[CapitalOmega]", "\[RightVector]"], "0"]}]}], 
      ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "f5a6cf4d-baa6-495a-b0c1-31ddff4d4477"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"\[PartialD]", 
      SubscriptBox["\[Delta]n", "f"]}], 
     RowBox[{"\[PartialD]", "t"}]], "=", 
    RowBox[{
     RowBox[{"-", 
      SubscriptBox["n", 
       RowBox[{"f", ",", "0"}]]}], 
     RowBox[{"\[Del]", "\[CenterDot]", 
      SubscriptBox["\[DoubleStruckCapitalV]", "f"]}]}]}], TraditionalForm]],
  ExpressionUUID->"4d8efb10-878b-4273-b3cc-a6ba9c2c2112"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     OverscriptBox["\[ScriptCapitalJ]", "\[RightVector]"], "f"], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[CapitalPi]", 
       RowBox[{"f", ",", "0"}]], 
      FractionBox[
       SubscriptBox["\[DoubleStruckCapitalV]", "f"], "c"]}], "=", 
     RowBox[{
      SubsuperscriptBox["\[Omega]", "f", "2"], 
      FractionBox[
       SubscriptBox["\[CapitalOmega]", "0"], 
       SubscriptBox["\[CapitalOmega]", 
        RowBox[{"f", ",", "0"}]]], 
      FractionBox[
       SubscriptBox["\[DoubleStruckCapitalV]", "f"], "c"]}]}]}], 
   TraditionalForm]],ExpressionUUID->"9bc07c94-7285-44fc-84d5-a7a08ed93623"],
 ",\nwhere ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[Omega]", "f", "2"], TraditionalForm]],ExpressionUUID->
  "aeb005cd-f4fd-475a-ac04-4fdc1036b325"],
 " is the plasma frequency corresponding to the equilibrium density, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", 
    RowBox[{"f", ",", "0"}]], TraditionalForm]],ExpressionUUID->
  "2a34d469-deaa-416b-ae0f-07172896bc81"],
 ", not the reference value."
}], "Text",ExpressionUUID->"d672e2e5-c36d-47b5-be7a-f804f3394e79"]
}, Open  ]],

Cell[CellGroupData[{

Cell["In generalized curvilinear coordinates", "Subsection",ExpressionUUID->"6a963e5d-0959-4a3a-868c-45bf1604788d"],

Cell[TextData[{
 "Maxwells equations:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"\[PartialD]", 
      SuperscriptBox["\[CapitalXi]", "i"]}], 
     RowBox[{"\[PartialD]", "t"}]], "=", 
    RowBox[{
     RowBox[{"c", " ", 
      SuperscriptBox["e", 
       RowBox[{"i", "\[VeryThinSpace]", "j", "\[VeryThinSpace]", "k"}]], 
      FractionBox[
       RowBox[{"\[PartialD]", 
        SubscriptBox["\[CapitalOmega]", "k"]}], 
       RowBox[{"\[PartialD]", 
        SuperscriptBox["x", "j"]}]]}], "-", 
     SuperscriptBox["\[ScriptCapitalJ]", "i"]}]}], TraditionalForm]],
  ExpressionUUID->"e2476ba7-9140-4ff4-8a17-04d36cef9c7c"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"\[PartialD]", 
      SuperscriptBox["\[CapitalOmega]", "i"]}], 
     RowBox[{"\[PartialD]", "t"}]], "=", 
    RowBox[{
     RowBox[{"-", "c"}], " ", 
     SuperscriptBox["e", 
      RowBox[{"i", "\[VeryThinSpace]", "j", "\[VeryThinSpace]", "k"}]], 
     FractionBox[
      RowBox[{"\[PartialD]", 
       SubscriptBox["\[CapitalXi]", "k"]}], 
      RowBox[{"\[PartialD]", 
       SuperscriptBox["x", "j"]}]]}]}], TraditionalForm]],ExpressionUUID->
  "38583d67-b693-460b-951f-0be3df926dfa"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"c", 
     FractionBox["1", 
      SqrtBox["g"]], 
     RowBox[{
      FractionBox["\[PartialD]", 
       RowBox[{"\[PartialD]", 
        SuperscriptBox["x", "i"]}]], 
      RowBox[{"(", 
       RowBox[{
        SqrtBox["g"], 
        SuperscriptBox["\[CapitalXi]", "i"]}], ")"}]}]}], "=", 
    "\[CapitalPi]"}], TraditionalForm]],ExpressionUUID->
  "d92a8813-81dd-4f20-9ee2-3c3023c5cafd"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"c", 
     FractionBox["1", 
      SqrtBox["g"]], 
     RowBox[{
      FractionBox["\[PartialD]", 
       RowBox[{"\[PartialD]", 
        SuperscriptBox["x", "i"]}]], 
      RowBox[{"(", 
       RowBox[{
        SqrtBox["g"], 
        SuperscriptBox["\[CapitalOmega]", "i"]}], ")"}]}]}], "=", "0"}], 
   TraditionalForm]],ExpressionUUID->"b2de9054-8e7c-47e3-a2fd-56e217a86272"],
 ",\nwhere ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[ScriptCapitalJ]", "i"], "=", 
    RowBox[{
     SubscriptBox["\[Sum]", "s"], 
     SuperscriptBox[
      SubscriptBox["\[ScriptCapitalJ]", "s"], "i"]}]}], TraditionalForm]],
  ExpressionUUID->"141cd5ff-677d-4099-bf43-c86a5ef12167"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalPi]", "=", 
    RowBox[{
     SubscriptBox["\[Sum]", "s"], 
     SubscriptBox["\[CapitalPi]", "s"]}]}], TraditionalForm]],ExpressionUUID->
  "3ba90224-397f-446c-81bb-b66145cda145"],
 " of the species ",
 Cell[BoxData[
  FormBox["s", TraditionalForm]],ExpressionUUID->
  "ccf4173b-10a9-437d-9d24-65a25829c88c"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["e", 
     RowBox[{"i", "\[VeryThinSpace]", "j", "\[VeryThinSpace]", "k"}]], "=", 
    RowBox[{
     SuperscriptBox["\[Epsilon]", 
      RowBox[{"i", "\[VeryThinSpace]", "j", "\[VeryThinSpace]", "k"}]], "/", 
     SqrtBox["g"]}]}], TraditionalForm]],ExpressionUUID->
  "954be811-b38b-4f29-aaaa-53e3db21fdbf"],
 ", and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"g", "=", 
    RowBox[{"\[LeftBracketingBar]", 
     SubscriptBox["g", 
      RowBox[{"i", "\[VeryThinSpace]", "j"}]], "\[RightBracketingBar]"}]}], 
   TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "a1411d40-f8d0-44d5-9c68-fbb7136e5b61"],
 "."
}], "Text",ExpressionUUID->"f3a02e4a-0eb5-4ec4-b469-b1d92045ef38"],

Cell[TextData[{
 "Continuity equation:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"c", 
      FractionBox["1", 
       SqrtBox["g"]], 
      RowBox[{
       FractionBox["\[PartialD]", 
        RowBox[{"\[PartialD]", 
         SuperscriptBox["x", "i"]}]], 
       RowBox[{"(", 
        RowBox[{
         SqrtBox["g"], 
         SuperscriptBox[
          SubscriptBox["\[ScriptCapitalJ]", "s"], "i"]}], ")"}]}]}], "+", 
     FractionBox[
      RowBox[{"\[PartialD]", 
       SubscriptBox["\[CapitalPi]", "s"]}], 
      RowBox[{"\[PartialD]", "t"}]]}], "=", "0"}], TraditionalForm]],
  ExpressionUUID->"1c4ff8b7-5665-4ef2-90b1-c4735127faff"],
 "."
}], "Text",ExpressionUUID->"db8fc41e-20bb-4548-837a-de969032a7f4"],

Cell[TextData[{
 "Equations of motion (non-relativistic):\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"\[PartialD]", 
      SuperscriptBox["x", "i"]}], 
     RowBox[{"\[PartialD]", "t"}]], "=", 
    SuperscriptBox["v", "i"]}], TraditionalForm]],ExpressionUUID->
  "cecacc3f-3055-4e76-940b-3f7b0da62a1a"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"\[PartialD]", 
      SubscriptBox["\[DoubleStruckV]", "p"]}], "/", 
     RowBox[{"\[PartialD]", "t"}]}], "=", 
    RowBox[{
     FractionBox[
      SubscriptBox["\[CapitalOmega]", "s"], 
      SubscriptBox["\[CapitalOmega]", "0"]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", 
        OverscriptBox["\[CapitalXi]", "\[RightVector]"]}], "+", 
       RowBox[{
        SubscriptBox["\[DoubleStruckV]", "p"], "\[Cross]", 
        OverscriptBox["\[CapitalOmega]", "\[RightVector]"]}]}], ")"}]}]}], 
   TraditionalForm]],ExpressionUUID->"e707d38e-0000-4ca3-b58c-341c5fe4f1cd"],
 "."
}], "Text",ExpressionUUID->"8e8d5028-b4c7-4bf5-8d0d-3f5df7bba8b0"],

Cell[TextData[{
 "Energy density of fields:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[CurlyEpsilon]", "EM"], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[CapitalXi]", "2"], "+", 
        SuperscriptBox["\[CapitalOmega]", "2"]}], ")"}], "/", "2"}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[CapitalXi]", "i"], 
         SubscriptBox["\[CapitalXi]", "i"]}], "+", 
        RowBox[{
         SuperscriptBox["\[CapitalOmega]", "i"], 
         SubscriptBox["\[CapitalOmega]", "i"]}]}], ")"}], "/", "2"}]}]}], 
   TraditionalForm]],ExpressionUUID->"0a25a4be-4389-44a8-b56d-0657fac4c6a6"],
 ", where ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[CurlyEpsilon]", "EM"], "=", 
    RowBox[{
     FractionBox[
      RowBox[{"4", "\[Pi]", " ", 
       SubsuperscriptBox["q", "0", "2"]}], 
      RowBox[{
       SubsuperscriptBox["m", "0", "2"], 
       SuperscriptBox["c", "2"]}]], "u"}]}], TraditionalForm]],ExpressionUUID->
  "5c752c99-9b39-44e7-8cfc-d0b4caefbbd2"],
 " (frequency squared).\nLikewise, we define kinetic energy density of \
particles of species, ",
 Cell[BoxData[
  FormBox["s", TraditionalForm]],ExpressionUUID->
  "965b8668-82b9-48ce-9031-c5a6e5885686"],
 ":\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[CurlyEpsilon]", "KE"], "=", 
    RowBox[{
     SubscriptBox["\[Sum]", "s"], 
     SubscriptBox["\[CurlyEpsilon]", "s"]}]}], TraditionalForm]],
  ExpressionUUID->"1daa398c-fb1d-4bd2-b916-0360b49baa12"],
 " (frequency squared unit), where ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[CurlyEpsilon]", "s"], "=", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"4", "\[Pi]", " ", 
        SubsuperscriptBox["q", "0", "2"]}], 
       RowBox[{
        SubsuperscriptBox["m", "0", "2"], 
        SuperscriptBox["c", "2"]}]], 
      SubscriptBox["w", "s"]}], "=", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{"4", "\[Pi]", " ", 
         SubsuperscriptBox["q", "0", "2"]}], 
        RowBox[{
         SubsuperscriptBox["m", "0", "2"], 
         SuperscriptBox["c", "2"]}]], 
       RowBox[{"\[LeftAngleBracket]", 
        FractionBox[
         RowBox[{
          SubscriptBox["m", "s"], 
          SubsuperscriptBox["\[DoubleStruckV]", "p", "2"]}], "2"], 
        "\[RightAngleBracket]"}]}], "=", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"4", "\[Pi]", " ", 
          SubsuperscriptBox["q", "s", "2"]}], 
         RowBox[{
          SubscriptBox["m", "s"], 
          SuperscriptBox["c", "2"]}]], 
        FractionBox[
         SubsuperscriptBox["\[CapitalOmega]", "0", "2"], 
         SubsuperscriptBox["\[CapitalOmega]", "s", "2"]], 
        RowBox[{"\[LeftAngleBracket]", 
         FractionBox[
          SubsuperscriptBox["\[DoubleStruckV]", "p", "2"], "2"], 
         "\[RightAngleBracket]"}]}], "=", 
       RowBox[{
        FractionBox[
         SubsuperscriptBox["\[CapitalOmega]", "0", "2"], 
         SubsuperscriptBox["\[CapitalOmega]", "s", "2"]], 
        FractionBox[
         SubsuperscriptBox["\[Omega]", "s", "2"], 
         SuperscriptBox["c", "2"]], 
        FractionBox[
         RowBox[{
          SubsuperscriptBox["\[Sum]", "p", 
           SuperscriptBox["N", "t"]], 
          RowBox[{
           SubsuperscriptBox["\[DoubleStruckV]", "p", "2"], "/", "2"}]}], 
         SuperscriptBox["N", "0"]]}]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"3c06decf-e467-4f7d-92ae-575905391ae1"],
 ".\nThen the total energy in the system is\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[ScriptCapitalE]", "=", 
    RowBox[{
     SubscriptBox["\[Integral]", "V"], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["\[CurlyEpsilon]", "EM"], "+", 
        SubscriptBox["\[CurlyEpsilon]", "KE"]}], ")"}], 
      RowBox[{"\[DifferentialD]", "V"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"ffa841bc-e864-41a1-bf7d-fcc73434faa1"],
 "."
}], "Text",ExpressionUUID->"59dae126-f10e-4ef6-bdaf-20485f8adbf5"],

Cell[TextData[{
 "Cold Fluid:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"\[PartialD]", 
      SubscriptBox["\[DoubleStruckCapitalV]", "f"]}], 
     RowBox[{"\[PartialD]", "t"}]], "=", 
    RowBox[{
     FractionBox[
      SubscriptBox["\[CapitalOmega]", 
       RowBox[{"f", ",", "0"}]], 
      SubscriptBox["\[CapitalOmega]", "0"]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", " ", 
        OverscriptBox["\[CapitalXi]", "\[RightVector]"]}], "+", 
       RowBox[{
        SubscriptBox["\[DoubleStruckCapitalV]", "f"], "\[Times]", 
        SubscriptBox[
         OverscriptBox["\[CapitalOmega]", "\[RightVector]"], "0"]}]}], 
      ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "6a6f4b78-1561-4786-8910-a218412ffcf5"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"\[PartialD]", 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["\[Delta]n", "f"], "/", 
        SubscriptBox["n", 
         RowBox[{"f", ",", "0"}]]}], ")"}]}], 
     RowBox[{"\[PartialD]", "t"}]], "=", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       SqrtBox["g"]]}], 
     RowBox[{
      FractionBox["\[PartialD]", 
       RowBox[{"\[PartialD]", 
        SuperscriptBox["x", "i"]}]], 
      RowBox[{"(", 
       RowBox[{
        SqrtBox["g"], 
        SuperscriptBox[
         SubscriptBox["V", "f"], "i"]}], ")"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"36a42ebe-88ef-4e8a-966d-f7c060e30c57"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     SubscriptBox["\[ScriptCapitalJ]", "f"], "i"], "=", 
    RowBox[{
     SubsuperscriptBox["\[Omega]", "f", "2"], 
     FractionBox[
      SubscriptBox["\[CapitalOmega]", "0"], 
      SubscriptBox["\[CapitalOmega]", 
       RowBox[{"f", ",", "0"}]]], 
     FractionBox[
      SuperscriptBox[
       SubscriptBox["V", "f"], "i"], "c"]}]}], TraditionalForm]],
  ExpressionUUID->"0619b8d9-6b82-4d74-88cc-cb47a2463dfa"],
 ",\nwhere ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[Omega]", "f", "2"], TraditionalForm]],ExpressionUUID->
  "fa9fc69d-e89d-41e4-a3b7-970a37188762"],
 " is the plasma frequency corresponding to the equilibrium density, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", 
    RowBox[{"f", ",", "0"}]], TraditionalForm]],ExpressionUUID->
  "fe97c977-69ed-49d4-ae7f-e5809d286a7c"],
 ", not the reference value.\n\nTo make the interface consistent with \
particles, weighted moments are updated:\nmom0 - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox["\[PartialD]", 
      RowBox[{"\[PartialD]", "t"}]], 
     RowBox[{"(", 
      FractionBox[
       RowBox[{
        SubscriptBox["n", 
         RowBox[{"f", ",", "0"}]], "+", 
        SubscriptBox["\[Delta]n", "f"]}], 
       SubscriptBox["n", 
        RowBox[{"f", ",", "ref"}]]], ")"}]}], "=", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       SqrtBox["g"]]}], 
     RowBox[{
      FractionBox["\[PartialD]", 
       RowBox[{"\[PartialD]", 
        SuperscriptBox["x", "i"]}]], 
      SqrtBox["g"]}], 
     SuperscriptBox[
      SubscriptBox["V", "f"], "i"]}]}], TraditionalForm]],ExpressionUUID->
  "e1926f76-e6db-40e6-8f66-236f7e347081"],
 ";\nmom1 - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox[
      SubscriptBox["n", 
       RowBox[{"f", ",", "0"}]], 
      SubscriptBox["n", 
       RowBox[{"f", ",", "ref"}]]], 
     FractionBox[
      RowBox[{"\[PartialD]", 
       SubscriptBox["\[DoubleStruckCapitalV]", "f"]}], 
      RowBox[{"\[PartialD]", "t"}]]}], "=", 
    RowBox[{
     FractionBox[
      SubscriptBox["\[CapitalOmega]", 
       RowBox[{"f", ",", "0"}]], 
      SubscriptBox["\[CapitalOmega]", "0"]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", 
        FractionBox[
         SubscriptBox["n", 
          RowBox[{"f", ",", "0"}]], 
         SubscriptBox["n", 
          RowBox[{"f", ",", "ref"}]]], 
        OverscriptBox["\[CapitalXi]", "\[RightVector]"]}], "+", 
       RowBox[{
        FractionBox[
         SubscriptBox["n", 
          RowBox[{"f", ",", "0"}]], 
         SubscriptBox["n", 
          RowBox[{"f", ",", "ref"}]]], 
        SubscriptBox["\[DoubleStruckCapitalV]", "f"], "\[Times]", 
        SubscriptBox[
         OverscriptBox["\[CapitalOmega]", "\[RightVector]"], "0"]}]}], 
      ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "a6bc7457-6ca2-43dd-86f7-90b1de3a551c"],
 ";\nmom2 - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox[
      SubscriptBox["n", 
       RowBox[{"f", ",", "0"}]], 
      SubscriptBox["n", 
       RowBox[{"f", ",", "ref"}]]], 
     SubscriptBox["\[DoubleStruckV]", "f"], 
     SubscriptBox["\[DoubleStruckV]", "f"]}], "=", 
    RowBox[{
     FractionBox[
      SubscriptBox["n", 
       RowBox[{"f", ",", "0"}]], 
      SubscriptBox["n", 
       RowBox[{"f", ",", "ref"}]]], 
     SubscriptBox["\[DoubleStruckCapitalV]", "f"], 
     SubscriptBox["\[DoubleStruckCapitalV]", "f"]}]}], TraditionalForm]],
  ExpressionUUID->"3fbc9192-f4a1-4491-8cf0-c5c5b4045999"],
 "."
}], "Text",ExpressionUUID->"cec5d88b-531b-43c0-aa28-51756645b720"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Update Cycle (Original Kaijun\[CloseCurlyQuote]s PIC)", "Subsection",ExpressionUUID->"df5d4812-b343-47b6-abcc-5ef8bb1677b0"],

Cell[TextData[{
 "1. Advance ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalOmega]", 
    RowBox[{"t", "-", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"3cd646b8-aa86-451b-8c61-98bb7ee09901"],
 " by ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalDelta]t", "/", "2"}], TraditionalForm]],ExpressionUUID->
  "17fa050d-f754-425c-ba94-89b797577846"],
 " to ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalOmega]", "t"], TraditionalForm]],ExpressionUUID->
  "83430538-b0a3-417b-95d8-832780df4aff"],
 " using ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalXi]", "t"], TraditionalForm]],ExpressionUUID->
  "4f676efb-b14a-4892-9b81-ecb2bea933e7"],
 ".\n2. Advance ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckV]", 
    RowBox[{"t", "-", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"4d332d65-1f6a-4fb4-a103-7e5394a19fb0"],
 " to ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckV]", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"5a31ca3d-516e-46ad-abca-0ed52d392353"],
 " using ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckX]", "t"], TraditionalForm]],ExpressionUUID->
  "dc7797f3-c863-4fe3-b5a9-b5382a9c2f11"],
 ", ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalOmega]", "t"], TraditionalForm]],ExpressionUUID->
  "284e80df-0b0b-4eeb-81f3-fc332cf27f4e"],
 ", and ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalXi]", "t"], TraditionalForm]],ExpressionUUID->
  "21dba77a-757c-4bfc-a2ce-fc8020f037dc"],
 ".\n2.1 Advance ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[DoubleStruckCapitalV]", "f", 
    RowBox[{"t", "-", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"73e18b0c-51a4-47f4-ad51-50450e75f18d"],
 " to ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[DoubleStruckCapitalV]", "f", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"eca78e71-d72f-4301-a741-2973d5dcb4a8"],
 " using ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalOmega]", "t"], TraditionalForm]],ExpressionUUID->
  "61c573f0-1186-499b-b1d4-9708e5596ffd"],
 " and ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalXi]", "t"], TraditionalForm]],ExpressionUUID->
  "f5468e15-62c1-4c04-a393-87134dc24337"],
 ".\n2.2 Advance ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[Delta]n", "f", "t"], TraditionalForm]],ExpressionUUID->
  "ab404d6e-a040-491b-ba9f-7905ab306b68"],
 " to ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[Delta]n", "f", 
    RowBox[{"t", "+", "\[CapitalDelta]t"}]], TraditionalForm]],ExpressionUUID->
  "ce06dfe5-dd2a-4cf6-839c-9c4b28423f98"],
 " using ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[DoubleStruckCapitalV]", "f", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"f5917abc-509f-4095-b04b-17314b5409e3"],
 ".\n3. Advance ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalOmega]", "t"], TraditionalForm]],ExpressionUUID->
  "877c60fd-a591-4646-ae8e-07a57578b4c1"],
 " by another ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalDelta]t", "/", "2"}], TraditionalForm]],ExpressionUUID->
  "c6c9db8b-0e52-46ef-b572-2e407210c357"],
 " to ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalOmega]", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"d4a41a2f-332e-43c7-9292-a5aa4a255fef"],
 " using ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalXi]", "t"], TraditionalForm]],ExpressionUUID->
  "730f7a05-433e-4dc0-bd50-2ddb6fd53565"],
 ".\n4. Advance ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckX]", "t"], TraditionalForm]],ExpressionUUID->
  "56be2e57-0223-4082-90d9-cb953caaef9b"],
 " by ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalDelta]t", "/", "2"}], TraditionalForm]],ExpressionUUID->
  "7e72b279-211f-4a11-b984-558f704d2bb4"],
 " to ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckX]", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"316f3641-9d2f-459a-b53c-6e93010f5cd0"],
 " using ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckV]", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"4b444911-f50c-4137-98ce-bd70cea4e853"],
 ".\n5. Collect ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ScriptCapitalJ]", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"c5c14d01-2309-4439-b730-9e7be1a6d452"],
 " from the particle positions ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckX]", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"6a28fc77-a81f-4a0e-bc27-2ae161381f31"],
 " and velocities ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckV]", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"db6d896b-544e-4d25-b9a1-51f3ffd1c587"],
 ". \n5.1 Collect ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ScriptCapitalJ]", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"9802e233-d4be-4fef-91e6-8b762f137b84"],
 " from ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[DoubleStruckCapitalV]", "f", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"267948c1-8bd5-4403-8844-3a8f85aa705d"],
 ".\n6. Advance ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckX]", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"0ade8d7b-3120-429b-a8ed-6736b0ae14a4"],
 " by another ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalDelta]t", "/", "2"}], TraditionalForm]],ExpressionUUID->
  "9a8c99e2-f027-40e0-b15c-7801d85140fe"],
 " to ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["x", 
    RowBox[{"t", "+", "\[CapitalDelta]t"}]], TraditionalForm]],ExpressionUUID->
  "5a9e3df2-b0e7-4829-a9b8-a04b5fc052ed"],
 " using ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckV]", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"2468a115-cbbf-4ce5-9637-cf34fc53efba"],
 ". \n7. Advance ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalXi]", "t"], TraditionalForm]],ExpressionUUID->
  "8a416130-f3c1-40a6-a780-a88eacfa8b9d"],
 " to ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalXi]", 
    RowBox[{"t", "+", "\[CapitalDelta]t"}]], TraditionalForm]],ExpressionUUID->
  "bf556ec6-e721-40b7-92bf-a4e682601b8d"],
 " using ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalOmega]", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"67a5fcd9-b3d4-4de7-90da-5c0cb38b4225"],
 " and ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ScriptCapitalJ]", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"f552f83e-7b41-4c11-8dda-989731784e4c"],
 "."
}], "Text",ExpressionUUID->"72a699aa-bea1-4ecc-8f67-f6289b35b09b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", "}"}], ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Text", "[", 
          RowBox[{"#2", ",", 
           RowBox[{"{", 
            RowBox[{"#", ",", "1.5"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "&"}], "@@@", 
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "1"}], "/", "2"}], ",", 
             RowBox[{"3", "/", "2"}], ",", 
             RowBox[{"1", "/", "2"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SuperscriptBox[\(\[CapitalOmega]\), \(t - \
\[CapitalDelta]t/2\)]\)\\n\!\(\*SuperscriptBox[\(\[DoubleStruckV]\), \(t - \
\[CapitalDelta]t/2\)]\)\\n\!\(\*SuperscriptBox[\(\[ScriptCapitalJ]\), \(t - \
\[CapitalDelta]t/2\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[CapitalOmega]\), \(t\)]\)\>\"", 
             ",", "\"\<\!\(\*SuperscriptBox[\(\[CapitalOmega]\), \(t + \
\[CapitalDelta]t/2\)]\)\\n\!\(\*SuperscriptBox[\(\[DoubleStruckV]\), \(t + \
\[CapitalDelta]t/2\)]\)\\n\!\(\*SuperscriptBox[\(\[ScriptCapitalJ]\), \(t + \
\[CapitalDelta]t/2\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[CapitalOmega]\), \(t + \
\[CapitalDelta]t\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[CapitalOmega]\), \(t + 3  \
\[CapitalDelta]t/2\)]\)\\n\!\(\*SuperscriptBox[\(\[DoubleStruckV]\), \(t + 3  \
\[CapitalDelta]t/2\)]\)\\n\!\(\*SuperscriptBox[\(\[ScriptCapitalJ]\), \(t + 3 \
 \[CapitalDelta]t/2\)]\)\>\""}], "}"}]}], "}"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Text", "[", 
          RowBox[{"#2", ",", 
           RowBox[{"{", 
            RowBox[{"#", ",", ".5"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "&"}], "@@@", 
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"1", "/", "2"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SuperscriptBox[\(\[DoubleStruckX]\), \(t - \
\[CapitalDelta]t\)]\)\\n\!\(\*SuperscriptBox[\(\[CapitalXi]\), \(t - \
\[CapitalDelta]t\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[DoubleStruckX]\), \(t - \
\[CapitalDelta]t/2\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[DoubleStruckX]\), \
\(t\)]\)\\n\!\(\*SuperscriptBox[\(\[CapitalXi]\), \(t\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[DoubleStruckX]\), \(t + \
\[CapitalDelta]t/2\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[DoubleStruckX]\), \(t + \
\[CapitalDelta]t\)]\)\\n\!\(\*SuperscriptBox[\(\[CapitalXi]\), \(t + \
\[CapitalDelta]t\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[DoubleStruckX]\), \(t + 3  \
\[CapitalDelta]t/2\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[DoubleStruckX]\), \(t + 2  \
\[CapitalDelta]t\)]\)\\n\!\(\*SuperscriptBox[\(\[CapitalXi]\), \(t + 2  \
\[CapitalDelta]t\)]\)\>\""}], "}"}]}], "}"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Arrowheads", "[", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"Medium", ",", ".55"}], "}"}], "}"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Arrow", "@", 
            RowBox[{"BezierCurve", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#", ",", "1.5"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "+", ".5"}], ",", "2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "+", "1"}], ",", "1.5"}], "}"}]}], "}"}], 
             "]"}]}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "2"}], "]"}], "-", ".5"}], ")"}]}], 
         ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Arrow", "@", 
            RowBox[{"BezierCurve", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#", ",", ".5"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "+", ".5"}], ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "+", "1"}], ",", ".5"}], "}"}]}], "}"}], 
             "]"}]}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Dashed", ",", 
         RowBox[{"Arrowheads", "[", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"Medium", ",", ".55"}], "}"}], "}"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Arrow", "@", 
            RowBox[{"BezierCurve", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#", ",", "1.5"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "+", ".25"}], ",", "1.75"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "+", ".5"}], ",", "1.5"}], "}"}]}], "}"}], 
             "]"}]}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"-", "1"}], ",", 
             RowBox[{"3", "/", "2"}], ",", 
             RowBox[{"1", "/", "2"}]}], "]"}], ")"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Arrow", "@", 
            RowBox[{"BezierCurve", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#", ",", ".5"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "+", ".25"}], ",", ".75"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "+", ".5"}], ",", ".5"}], "}"}]}], "}"}], 
             "]"}]}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            RowBox[{"3", "/", "2"}], ",", 
            RowBox[{"1", "/", "2"}]}], "]"}]}]}], "}"}]}], 
      "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "2"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{".5", ",", "\"\<\[DoubleStruckX],\[CapitalXi]\>\""}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "1.5", ",", 
              "\"\<\[DoubleStruckV],\[ScriptCapitalJ],\[CapitalOmega]\>\""}], 
             "}"}]}], "}"}], ",", "None"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "\"\<t-\[CapitalDelta]t\>\""}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "1"}], "/", "2"}], ",", 
              "\"\<t-\[CapitalDelta]t/2\>\""}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "\"\<t\>\""}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1", "/", "2"}], ",", "\"\<t+\[CapitalDelta]t/2\>\""}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "\"\<t+\[CapitalDelta]t\>\""}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"3", "/", "2"}], ",", "\"\<t+3\[CapitalDelta]t/2\>\""}],
              "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "\"\<t+2\[CapitalDelta]t\>\""}], "}"}]}], 
           "}"}], ",", "None"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", 
     RowBox[{"GridLines", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "2", ",", 
          RowBox[{"1", "/", "2"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{".5", ",", "1.5"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"GridLinesStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Dotted", ",", "Gray"}], "]"}]}], ",", 
     RowBox[{"PlotRangePadding", "\[Rule]", 
      RowBox[{"Scaled", "[", ".04", "]"}]}], ",", 
     RowBox[{"PlotRangeClipping", "\[Rule]", "True"}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", "15"}]}], "]"}]}], "]"}]], "Input",
 Editable->False,
 CellOpen->False,ExpressionUUID->"7063d1bc-e7bb-4976-8aac-764234e1fca9"],

Cell[BoxData[
 GraphicsBox[{{
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[CapitalOmega]\\), \\(t - \
\[CapitalDelta]t/2\\)]\\)\\n\\!\\(\\*SuperscriptBox[\\(\[DoubleStruckV]\\), \
\\(t - \[CapitalDelta]t/2\\)]\\)\\n\\!\\(\\*SuperscriptBox[\\(\
\[ScriptCapitalJ]\\), \\(t - \[CapitalDelta]t/2\\)]\\)\"\>", 
     NCache[{Rational[-1, 2], 1.5}, {-0.5, 1.5}], {0, 1}], 
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[CapitalOmega]\\), \
\\(t\\)]\\)\"\>", {0, 1.5}, {0, 1}], 
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[CapitalOmega]\\), \\(t + \
\[CapitalDelta]t/2\\)]\\)\\n\\!\\(\\*SuperscriptBox[\\(\[DoubleStruckV]\\), \
\\(t + \[CapitalDelta]t/2\\)]\\)\\n\\!\\(\\*SuperscriptBox[\\(\
\[ScriptCapitalJ]\\), \\(t + \[CapitalDelta]t/2\\)]\\)\"\>", 
     NCache[{Rational[1, 2], 1.5}, {0.5, 1.5}], {0, 1}], 
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[CapitalOmega]\\), \\(t + \
\[CapitalDelta]t\\)]\\)\"\>", {1, 1.5}, {0, 1}], 
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[CapitalOmega]\\), \\(t + 3  \
\[CapitalDelta]t/2\\)]\\)\\n\\!\\(\\*SuperscriptBox[\\(\[DoubleStruckV]\\), \
\\(t + 3  \[CapitalDelta]t/2\\)]\\)\\n\\!\\(\\*SuperscriptBox[\\(\
\[ScriptCapitalJ]\\), \\(t + 3  \[CapitalDelta]t/2\\)]\\)\"\>", 
     NCache[{Rational[3, 2], 1.5}, {1.5, 1.5}], {0, 1}]}, {
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[DoubleStruckX]\\), \\(t - \
\[CapitalDelta]t\\)]\\)\\n\\!\\(\\*SuperscriptBox[\\(\[CapitalXi]\\), \\(t - \
\[CapitalDelta]t\\)]\\)\"\>", {-1, 0.5}, {0, 1}], 
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[DoubleStruckX]\\), \\(t - \
\[CapitalDelta]t/2\\)]\\)\"\>", 
     NCache[{Rational[-1, 2], 0.5}, {-0.5, 0.5}], {0, 1}], 
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[DoubleStruckX]\\), \\(t\\)]\\)\
\\n\\!\\(\\*SuperscriptBox[\\(\[CapitalXi]\\), \\(t\\)]\\)\"\>", {0, 0.5}, \
{0, 1}], InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[DoubleStruckX]\\), \\(t + \
\[CapitalDelta]t/2\\)]\\)\"\>", 
     NCache[{Rational[1, 2], 0.5}, {0.5, 0.5}], {0, 1}], 
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[DoubleStruckX]\\), \\(t + \
\[CapitalDelta]t\\)]\\)\\n\\!\\(\\*SuperscriptBox[\\(\[CapitalXi]\\), \\(t + \
\[CapitalDelta]t\\)]\\)\"\>", {1, 0.5}, {0, 1}], 
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[DoubleStruckX]\\), \\(t + 3  \
\[CapitalDelta]t/2\\)]\\)\"\>", 
     NCache[{Rational[3, 2], 0.5}, {1.5, 0.5}], {0, 1}], 
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[DoubleStruckX]\\), \\(t + 2  \
\[CapitalDelta]t\\)]\\)\\n\\!\\(\\*SuperscriptBox[\\(\[CapitalXi]\\), \\(t + \
2  \[CapitalDelta]t\\)]\\)\"\>", {2, 0.5}, {0, 1}]}, 
   {Arrowheads[{{Medium, 0.55}}], {
     ArrowBox[BezierCurveBox[{{-1.5, 1.5}, {-1., 2}, {-0.5, 1.5}}]], 
     ArrowBox[BezierCurveBox[{{-0.5, 1.5}, {0., 2}, {0.5, 1.5}}]], 
     ArrowBox[BezierCurveBox[{{0.5, 1.5}, {1., 2}, {1.5, 1.5}}]], 
     ArrowBox[BezierCurveBox[{{1.5, 1.5}, {2., 2}, {2.5, 1.5}}]]}, {
     ArrowBox[BezierCurveBox[{{-1, 0.5}, {-0.5, 1}, {0, 0.5}}]], 
     ArrowBox[BezierCurveBox[{{0, 0.5}, {0.5, 1}, {1, 0.5}}]], 
     ArrowBox[BezierCurveBox[{{1, 0.5}, {1.5, 1}, {2, 0.5}}]]}}, 
   {Dashing[{Small, Small}], 
    Arrowheads[{{Medium, 0.55}}], {
     ArrowBox[BezierCurveBox[{{-1, 1.5}, {-0.75, 1.75}, {-0.5, 1.5}}]], 
     ArrowBox[BezierCurveBox[
      NCache[{{Rational[-1, 2], 1.5}, {-0.25, 1.75}, {0., 1.5}}, {{-0.5, 
       1.5}, {-0.25, 1.75}, {0., 1.5}}]]], 
     ArrowBox[BezierCurveBox[{{0, 1.5}, {0.25, 1.75}, {0.5, 1.5}}]], 
     ArrowBox[BezierCurveBox[
      NCache[{{Rational[1, 2], 1.5}, {0.75, 1.75}, {1., 1.5}}, {{0.5, 1.5}, {
       0.75, 1.75}, {1., 1.5}}]]], 
     ArrowBox[BezierCurveBox[{{1, 1.5}, {1.25, 1.75}, {1.5, 1.5}}]], 
     ArrowBox[BezierCurveBox[
      NCache[{{Rational[3, 2], 1.5}, {1.75, 1.75}, {2., 1.5}}, {{1.5, 1.5}, {
       1.75, 1.75}, {2., 1.5}}]]]}, {
     ArrowBox[BezierCurveBox[{{-1, 0.5}, {-0.75, 0.75}, {-0.5, 0.5}}]], 
     ArrowBox[BezierCurveBox[
      NCache[{{Rational[-1, 2], 0.5}, {-0.25, 0.75}, {0., 0.5}}, {{-0.5, 
       0.5}, {-0.25, 0.75}, {0., 0.5}}]]], 
     ArrowBox[BezierCurveBox[{{0, 0.5}, {0.25, 0.75}, {0.5, 0.5}}]], 
     ArrowBox[BezierCurveBox[
      NCache[{{Rational[1, 2], 0.5}, {0.75, 0.75}, {1., 0.5}}, {{0.5, 0.5}, {
       0.75, 0.75}, {1., 0.5}}]]], 
     ArrowBox[BezierCurveBox[{{1, 0.5}, {1.25, 0.75}, {1.5, 0.5}}]], 
     ArrowBox[BezierCurveBox[
      NCache[{{Rational[3, 2], 0.5}, {1.75, 0.75}, {2., 0.5}}, {{1.5, 0.5}, {
       1.75, 0.75}, {2., 0.5}}]]]}}},
  AspectRatio->NCache[
    Rational[1, 2], 0.5],
  BaseStyle->15,
  Frame->{{True, False}, {True, False}},
  FrameTicks->{{{{0.5, 
       FormBox["\"\[DoubleStruckX],\[CapitalXi]\"", TraditionalForm]}, {1.5, 
       FormBox[
       "\"\[DoubleStruckV],\[ScriptCapitalJ],\[CapitalOmega]\"", 
        TraditionalForm]}}, None}, {{{-1, 
       FormBox["\"t-\[CapitalDelta]t\"", TraditionalForm]}, {
       NCache[
        Rational[-1, 2], -0.5], 
       FormBox["\"t-\[CapitalDelta]t/2\"", TraditionalForm]}, {0, 
       FormBox["\"t\"", TraditionalForm]}, {
       NCache[
        Rational[1, 2], 0.5], 
       FormBox["\"t+\[CapitalDelta]t/2\"", TraditionalForm]}, {1, 
       FormBox["\"t+\[CapitalDelta]t\"", TraditionalForm]}, {
       NCache[
        Rational[3, 2], 1.5], 
       FormBox["\"t+3\[CapitalDelta]t/2\"", TraditionalForm]}, {2, 
       FormBox["\"t+2\[CapitalDelta]t\"", TraditionalForm]}}, None}},
  GridLines->NCache[{{-1, 
      Rational[-1, 2], 0, 
      Rational[1, 2], 1, 
      Rational[3, 2], 2}, {0.5, 1.5}}, {{-1, -0.5, 0, 0.5, 1, 1.5, 2}, {0.5, 
     1.5}}],
  GridLinesStyle->Directive[
    Dashing[{0, Small}], 
    GrayLevel[0.5]],
  ImageSize->Large,
  PlotRange->{{-1, 2}, {0, 2}},
  PlotRangeClipping->True,
  PlotRangePadding->Scaled[0.04]]], "Output",ExpressionUUID->"987154df-fe5e-\
4d49-84ef-58e2a6c496ad"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Update Cycle (Modified)", "Subsection",ExpressionUUID->"71d8df89-8dc7-43a7-9bbb-27460bfeaee1"],

Cell[TextData[{
 "1. Advance ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalOmega]", 
    RowBox[{"t", "-", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"75a50ca0-07a9-4a7f-8c3a-848b04f39387"],
 " by ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalDelta]t", "/", "2"}], TraditionalForm]],ExpressionUUID->
  "5a714b6b-c040-4fda-bd6f-d26cf1ac8cf7"],
 " to ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalOmega]", "t"], TraditionalForm]],ExpressionUUID->
  "79046d2d-1f02-4f67-a395-c873253f01bd"],
 " using ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalXi]", "t"], TraditionalForm]],ExpressionUUID->
  "805ea1f4-5c24-4697-b2fe-71847414656b"],
 ".\n2. Advance ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckV]", 
    RowBox[{"t", "-", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"605fd04f-c3e0-44a9-9f7e-041b09a3b4b2"],
 " to ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckV]", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"bec5ce1d-399f-4b47-a36a-4ffa53444c8a"],
 " using ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckX]", "t"], TraditionalForm]],ExpressionUUID->
  "4b8a74aa-1ccc-46b5-89d5-e1f3bb387ed2"],
 ", ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalOmega]", "t"], TraditionalForm]],ExpressionUUID->
  "0ae5cff1-a276-4227-a620-989057e0dc1e"],
 ", and ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalXi]", "t"], TraditionalForm]],ExpressionUUID->
  "24fb2b0a-63ce-4d6d-9218-14a3b9666847"],
 ". \n2.1 Advance ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[DoubleStruckCapitalV]", "f", 
    RowBox[{"t", "-", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"94dac478-2dae-45c7-b081-27142f12b185"],
 " to ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[DoubleStruckCapitalV]", "f", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"7e93de7d-6a9d-4d92-ab17-b966b7f565c4"],
 " using ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalOmega]", "t"], TraditionalForm]],ExpressionUUID->
  "4c586e97-dbaa-48c7-9e8a-80dcb412863e"],
 " and ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalXi]", "t"], TraditionalForm]],ExpressionUUID->
  "b373a1b6-3e98-43a9-a84b-720b2d2cfcaa"],
 ".\n2.2 Advance ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[Delta]n", "f", "t"], TraditionalForm]],ExpressionUUID->
  "b0f672c3-7bb0-4f17-9bc5-dbe87590ec49"],
 " to ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[Delta]n", "f", 
    RowBox[{"t", "+", "\[CapitalDelta]t"}]], TraditionalForm]],ExpressionUUID->
  "cddfe032-e477-4666-b86b-4255f85c6a97"],
 " using ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[DoubleStruckCapitalV]", "f", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"68211b0d-6a90-4ce6-a5d3-28fea6a3094b"],
 ".\n3. Advance ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalOmega]", "t"], TraditionalForm]],ExpressionUUID->
  "bb040a56-d5cb-43d4-b659-7db072c3742c"],
 " by another ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalDelta]t", "/", "2"}], TraditionalForm]],ExpressionUUID->
  "a6c5d4cd-d029-482b-8abb-c05a642b55d7"],
 " to ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalOmega]", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"5429e067-770e-4636-83f8-c6a805b6e235"],
 " using ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalXi]", "t"], TraditionalForm]],ExpressionUUID->
  "e98a7a2c-304d-46e7-922b-27ecb6b1ce10"],
 ".\n4. Collect ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ScriptCapitalJ]", "-"], TraditionalForm]],ExpressionUUID->
  "a285b756-8725-4263-9446-2de33a16ba5e"],
 " from the particle positions ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckX]", "t"], TraditionalForm]],ExpressionUUID->
  "96eac3f3-bc0b-4760-84b8-c0afabde5dd3"],
 " and velocities ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckV]", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"3af42a80-4c7d-4e8e-990f-f5ad7d918b12"],
 ".\n5. Advance ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckX]", "t"], TraditionalForm]],ExpressionUUID->
  "ee8705eb-f7c3-4d26-a251-38e8681bbea9"],
 " by ",
 Cell[BoxData[
  FormBox["\[CapitalDelta]t", TraditionalForm]],ExpressionUUID->
  "5417a6e7-f144-4384-ad02-a54d8dc451a0"],
 " to ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckX]", 
    RowBox[{"t", "+", "\[CapitalDelta]t"}]], TraditionalForm]],ExpressionUUID->
  "cec1208a-6042-4b0c-bacb-7fbe7020b442"],
 " using ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckV]", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"5f725bc8-939f-4fbd-9e9c-8ec03c0d58c7"],
 ".\n6. Collect ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ScriptCapitalJ]", "+"], TraditionalForm]],ExpressionUUID->
  "7ffeb00e-5ef5-4ab5-8355-92b9cb0bbc0b"],
 " from the particle positions ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckX]", 
    RowBox[{"t", "+", "\[CapitalDelta]t"}]], TraditionalForm]],ExpressionUUID->
  "1cb91399-9064-46a6-95c6-42a49d795e41"],
 " and velocities ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckV]", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"7c676a4c-e3ff-46a9-acd7-066de101169f"],
 ", and calculate ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[ScriptCapitalJ]", 
     RowBox[{"t", "+", 
      RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ScriptCapitalJ]", "-"], "+", 
       SuperscriptBox["\[ScriptCapitalJ]", "+"]}], ")"}], "/", "2"}]}], 
   TraditionalForm]],ExpressionUUID->"5c00857f-93b1-4a76-b46d-79ad9c82c4c4"],
 ".\n6.1 Collect ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ScriptCapitalJ]", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"5618ad57-8406-4160-9c08-9135479957c8"],
 " from ",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[DoubleStruckCapitalV]", "f", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"d94bdf24-7c9b-4470-84e0-f58b16aa81a6"],
 ".\n7. Advance ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalXi]", "t"], TraditionalForm]],ExpressionUUID->
  "5ea1c025-912f-4643-a615-ddbe7db3083f"],
 " to ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalXi]", 
    RowBox[{"t", "+", "\[CapitalDelta]t"}]], TraditionalForm]],ExpressionUUID->
  "c9ae8f86-c3c6-4ae8-be45-7aac6c309725"],
 " using ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalOmega]", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"1dd76fbf-0e73-458d-87b4-099148b9a556"],
 " and ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ScriptCapitalJ]", 
    RowBox[{"t", "+", 
     RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], TraditionalForm]],
  ExpressionUUID->"7ab53fe1-6810-4e5e-b4c3-3a63a49bb17d"],
 "."
}], "Text",ExpressionUUID->"47cb1a90-c3b6-494c-86c1-f829b47b5941"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", "}"}], ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Text", "[", 
          RowBox[{"#2", ",", 
           RowBox[{"{", 
            RowBox[{"#", ",", "1.5"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "&"}], "@@@", 
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "1"}], "/", "2"}], ",", 
             RowBox[{"3", "/", "2"}], ",", 
             RowBox[{"1", "/", "2"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SuperscriptBox[\(\[CapitalOmega]\), \(t - \
\[CapitalDelta]t/2\)]\)\\n\!\(\*SuperscriptBox[\(\[DoubleStruckV]\), \(t - \
\[CapitalDelta]t/2\)]\)\\n\!\(\*SuperscriptBox[\(\[ScriptCapitalJ]\), \(t - \
\[CapitalDelta]t/2\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[CapitalOmega]\), \(t\)]\)\>\"", 
             ",", "\"\<\!\(\*SuperscriptBox[\(\[CapitalOmega]\), \(t + \
\[CapitalDelta]t/2\)]\)\\n\!\(\*SuperscriptBox[\(\[DoubleStruckV]\), \(t + \
\[CapitalDelta]t/2\)]\)\\n\!\(\*SuperscriptBox[\(\[ScriptCapitalJ]\), \(t + \
\[CapitalDelta]t/2\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[CapitalOmega]\), \(t + \
\[CapitalDelta]t\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[CapitalOmega]\), \(t + 3  \
\[CapitalDelta]t/2\)]\)\\n\!\(\*SuperscriptBox[\(\[DoubleStruckV]\), \(t + 3  \
\[CapitalDelta]t/2\)]\)\\n\!\(\*SuperscriptBox[\(\[ScriptCapitalJ]\), \(t + 3 \
 \[CapitalDelta]t/2\)]\)\>\""}], "}"}]}], "}"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Text", "[", 
          RowBox[{"#2", ",", 
           RowBox[{"{", 
            RowBox[{"#", ",", ".5"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "&"}], "@@@", 
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "2", ",", 
             RowBox[{"1", "/", "2"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SuperscriptBox[\(\[DoubleStruckX]\), \(t - \
\[CapitalDelta]t\)]\)\\n\!\(\*SuperscriptBox[\(\[CapitalXi]\), \(t - \
\[CapitalDelta]t\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[DoubleStruckX]\), \(t - \
\[CapitalDelta]t/2\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[DoubleStruckX]\), \
\(t\)]\)\\n\!\(\*SuperscriptBox[\(\[CapitalXi]\), \(t\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[DoubleStruckX]\), \(t + \
\[CapitalDelta]t/2\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[DoubleStruckX]\), \(t + \
\[CapitalDelta]t\)]\)\\n\!\(\*SuperscriptBox[\(\[CapitalXi]\), \(t + \
\[CapitalDelta]t\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[DoubleStruckX]\), \(t + 3  \
\[CapitalDelta]t/2\)]\)\>\"", ",", 
             "\"\<\!\(\*SuperscriptBox[\(\[DoubleStruckX]\), \(t + 2  \
\[CapitalDelta]t\)]\)\\n\!\(\*SuperscriptBox[\(\[CapitalXi]\), \(t + 2  \
\[CapitalDelta]t\)]\)\>\""}], "}"}]}], "}"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Arrowheads", "[", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"Medium", ",", ".55"}], "}"}], "}"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Arrow", "@", 
            RowBox[{"BezierCurve", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#", ",", "1.5"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "+", ".5"}], ",", "2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "+", "1"}], ",", "1.5"}], "}"}]}], "}"}], 
             "]"}]}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "2"}], "]"}], "-", ".5"}], ")"}]}], 
         ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Arrow", "@", 
            RowBox[{"BezierCurve", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#", ",", ".5"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "+", ".5"}], ",", "1"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "+", "1"}], ",", ".5"}], "}"}]}], "}"}], 
             "]"}]}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Dashed", ",", 
         RowBox[{"Arrowheads", "[", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"Medium", ",", ".55"}], "}"}], "}"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Arrow", "@", 
            RowBox[{"BezierCurve", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#", ",", "1.5"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "+", ".25"}], ",", "1.75"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "+", ".5"}], ",", "1.5"}], "}"}]}], "}"}], 
             "]"}]}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"-", "1"}], ",", 
             RowBox[{"3", "/", "2"}], ",", 
             RowBox[{"1", "/", "2"}]}], "]"}], ")"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Arrow", "@", 
            RowBox[{"BezierCurve", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"#", ",", ".5"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "+", ".25"}], ",", ".75"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "+", ".5"}], ",", ".5"}], "}"}]}], "}"}], 
             "]"}]}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            RowBox[{"3", "/", "2"}], ",", 
            RowBox[{"1", "/", "2"}]}], "]"}]}]}], "}"}]}], 
      "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "2"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{".5", ",", "\"\<\[DoubleStruckX],\[CapitalXi]\>\""}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "1.5", ",", 
              "\"\<\[DoubleStruckV],\[ScriptCapitalJ],\[CapitalOmega]\>\""}], 
             "}"}]}], "}"}], ",", "None"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "\"\<t-\[CapitalDelta]t\>\""}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "1"}], "/", "2"}], ",", 
              "\"\<t-\[CapitalDelta]t/2\>\""}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "\"\<t\>\""}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1", "/", "2"}], ",", "\"\<t+\[CapitalDelta]t/2\>\""}], 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "\"\<t+\[CapitalDelta]t\>\""}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"3", "/", "2"}], ",", "\"\<t+3\[CapitalDelta]t/2\>\""}],
              "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "\"\<t+2\[CapitalDelta]t\>\""}], "}"}]}], 
           "}"}], ",", "None"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", 
     RowBox[{"GridLines", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "2", ",", 
          RowBox[{"1", "/", "2"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{".5", ",", "1.5"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"GridLinesStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Dotted", ",", "Gray"}], "]"}]}], ",", 
     RowBox[{"PlotRangePadding", "\[Rule]", 
      RowBox[{"Scaled", "[", ".04", "]"}]}], ",", 
     RowBox[{"PlotRangeClipping", "\[Rule]", "True"}], ",", 
     RowBox[{"BaseStyle", "\[Rule]", "15"}]}], "]"}]}], "]"}]], "Input",
 Editable->False,
 CellOpen->False,ExpressionUUID->"24ececd0-d501-46c2-9a01-d07868be0773"],

Cell[BoxData[
 GraphicsBox[{{
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[CapitalOmega]\\), \\(t - \
\[CapitalDelta]t/2\\)]\\)\\n\\!\\(\\*SuperscriptBox[\\(\[DoubleStruckV]\\), \
\\(t - \[CapitalDelta]t/2\\)]\\)\\n\\!\\(\\*SuperscriptBox[\\(\
\[ScriptCapitalJ]\\), \\(t - \[CapitalDelta]t/2\\)]\\)\"\>", 
     NCache[{Rational[-1, 2], 1.5}, {-0.5, 1.5}], {0, 1}], 
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[CapitalOmega]\\), \
\\(t\\)]\\)\"\>", {0, 1.5}, {0, 1}], 
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[CapitalOmega]\\), \\(t + \
\[CapitalDelta]t/2\\)]\\)\\n\\!\\(\\*SuperscriptBox[\\(\[DoubleStruckV]\\), \
\\(t + \[CapitalDelta]t/2\\)]\\)\\n\\!\\(\\*SuperscriptBox[\\(\
\[ScriptCapitalJ]\\), \\(t + \[CapitalDelta]t/2\\)]\\)\"\>", 
     NCache[{Rational[1, 2], 1.5}, {0.5, 1.5}], {0, 1}], 
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[CapitalOmega]\\), \\(t + \
\[CapitalDelta]t\\)]\\)\"\>", {1, 1.5}, {0, 1}], 
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[CapitalOmega]\\), \\(t + 3  \
\[CapitalDelta]t/2\\)]\\)\\n\\!\\(\\*SuperscriptBox[\\(\[DoubleStruckV]\\), \
\\(t + 3  \[CapitalDelta]t/2\\)]\\)\\n\\!\\(\\*SuperscriptBox[\\(\
\[ScriptCapitalJ]\\), \\(t + 3  \[CapitalDelta]t/2\\)]\\)\"\>", 
     NCache[{Rational[3, 2], 1.5}, {1.5, 1.5}], {0, 1}]}, {
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[DoubleStruckX]\\), \\(t - \
\[CapitalDelta]t\\)]\\)\\n\\!\\(\\*SuperscriptBox[\\(\[CapitalXi]\\), \\(t - \
\[CapitalDelta]t\\)]\\)\"\>", {-1, 0.5}, {0, 1}], 
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[DoubleStruckX]\\), \\(t - \
\[CapitalDelta]t/2\\)]\\)\"\>", 
     NCache[{Rational[-1, 2], 0.5}, {-0.5, 0.5}], {0, 1}], 
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[DoubleStruckX]\\), \\(t\\)]\\)\
\\n\\!\\(\\*SuperscriptBox[\\(\[CapitalXi]\\), \\(t\\)]\\)\"\>", {0, 0.5}, \
{0, 1}], InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[DoubleStruckX]\\), \\(t + \
\[CapitalDelta]t/2\\)]\\)\"\>", 
     NCache[{Rational[1, 2], 0.5}, {0.5, 0.5}], {0, 1}], 
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[DoubleStruckX]\\), \\(t + \
\[CapitalDelta]t\\)]\\)\\n\\!\\(\\*SuperscriptBox[\\(\[CapitalXi]\\), \\(t + \
\[CapitalDelta]t\\)]\\)\"\>", {1, 0.5}, {0, 1}], 
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[DoubleStruckX]\\), \\(t + 3  \
\[CapitalDelta]t/2\\)]\\)\"\>", 
     NCache[{Rational[3, 2], 0.5}, {1.5, 0.5}], {0, 1}], 
    InsetBox["\<\"\\!\\(\\*SuperscriptBox[\\(\[DoubleStruckX]\\), \\(t + 2  \
\[CapitalDelta]t\\)]\\)\\n\\!\\(\\*SuperscriptBox[\\(\[CapitalXi]\\), \\(t + \
2  \[CapitalDelta]t\\)]\\)\"\>", {2, 0.5}, {0, 1}]}, 
   {Arrowheads[{{Medium, 0.55}}], {
     ArrowBox[BezierCurveBox[{{-1.5, 1.5}, {-1., 2}, {-0.5, 1.5}}]], 
     ArrowBox[BezierCurveBox[{{-0.5, 1.5}, {0., 2}, {0.5, 1.5}}]], 
     ArrowBox[BezierCurveBox[{{0.5, 1.5}, {1., 2}, {1.5, 1.5}}]], 
     ArrowBox[BezierCurveBox[{{1.5, 1.5}, {2., 2}, {2.5, 1.5}}]]}, {
     ArrowBox[BezierCurveBox[{{-1, 0.5}, {-0.5, 1}, {0, 0.5}}]], 
     ArrowBox[BezierCurveBox[{{0, 0.5}, {0.5, 1}, {1, 0.5}}]], 
     ArrowBox[BezierCurveBox[{{1, 0.5}, {1.5, 1}, {2, 0.5}}]]}}, 
   {Dashing[{Small, Small}], 
    Arrowheads[{{Medium, 0.55}}], {
     ArrowBox[BezierCurveBox[{{-1, 1.5}, {-0.75, 1.75}, {-0.5, 1.5}}]], 
     ArrowBox[BezierCurveBox[
      NCache[{{Rational[-1, 2], 1.5}, {-0.25, 1.75}, {0., 1.5}}, {{-0.5, 
       1.5}, {-0.25, 1.75}, {0., 1.5}}]]], 
     ArrowBox[BezierCurveBox[{{0, 1.5}, {0.25, 1.75}, {0.5, 1.5}}]], 
     ArrowBox[BezierCurveBox[
      NCache[{{Rational[1, 2], 1.5}, {0.75, 1.75}, {1., 1.5}}, {{0.5, 1.5}, {
       0.75, 1.75}, {1., 1.5}}]]], 
     ArrowBox[BezierCurveBox[{{1, 1.5}, {1.25, 1.75}, {1.5, 1.5}}]], 
     ArrowBox[BezierCurveBox[
      NCache[{{Rational[3, 2], 1.5}, {1.75, 1.75}, {2., 1.5}}, {{1.5, 1.5}, {
       1.75, 1.75}, {2., 1.5}}]]]}, {
     ArrowBox[BezierCurveBox[{{-1, 0.5}, {-0.75, 0.75}, {-0.5, 0.5}}]], 
     ArrowBox[BezierCurveBox[
      NCache[{{Rational[-1, 2], 0.5}, {-0.25, 0.75}, {0., 0.5}}, {{-0.5, 
       0.5}, {-0.25, 0.75}, {0., 0.5}}]]], 
     ArrowBox[BezierCurveBox[{{0, 0.5}, {0.25, 0.75}, {0.5, 0.5}}]], 
     ArrowBox[BezierCurveBox[
      NCache[{{Rational[1, 2], 0.5}, {0.75, 0.75}, {1., 0.5}}, {{0.5, 0.5}, {
       0.75, 0.75}, {1., 0.5}}]]], 
     ArrowBox[BezierCurveBox[{{1, 0.5}, {1.25, 0.75}, {1.5, 0.5}}]], 
     ArrowBox[BezierCurveBox[
      NCache[{{Rational[3, 2], 0.5}, {1.75, 0.75}, {2., 0.5}}, {{1.5, 0.5}, {
       1.75, 0.75}, {2., 0.5}}]]]}}},
  AspectRatio->NCache[
    Rational[1, 2], 0.5],
  BaseStyle->15,
  Frame->{{True, False}, {True, False}},
  FrameTicks->{{{{0.5, 
       FormBox["\"\[DoubleStruckX],\[CapitalXi]\"", TraditionalForm]}, {1.5, 
       FormBox[
       "\"\[DoubleStruckV],\[ScriptCapitalJ],\[CapitalOmega]\"", 
        TraditionalForm]}}, None}, {{{-1, 
       FormBox["\"t-\[CapitalDelta]t\"", TraditionalForm]}, {
       NCache[
        Rational[-1, 2], -0.5], 
       FormBox["\"t-\[CapitalDelta]t/2\"", TraditionalForm]}, {0, 
       FormBox["\"t\"", TraditionalForm]}, {
       NCache[
        Rational[1, 2], 0.5], 
       FormBox["\"t+\[CapitalDelta]t/2\"", TraditionalForm]}, {1, 
       FormBox["\"t+\[CapitalDelta]t\"", TraditionalForm]}, {
       NCache[
        Rational[3, 2], 1.5], 
       FormBox["\"t+3\[CapitalDelta]t/2\"", TraditionalForm]}, {2, 
       FormBox["\"t+2\[CapitalDelta]t\"", TraditionalForm]}}, None}},
  GridLines->NCache[{{-1, 
      Rational[-1, 2], 0, 
      Rational[1, 2], 1, 
      Rational[3, 2], 2}, {0.5, 1.5}}, {{-1, -0.5, 0, 0.5, 1, 1.5, 2}, {0.5, 
     1.5}}],
  GridLinesStyle->Directive[
    Dashing[{0, Small}], 
    GrayLevel[0.5]],
  ImageSize->Large,
  PlotRange->{{-1, 2}, {0, 2}},
  PlotRangeClipping->True,
  PlotRangePadding->Scaled[0.04]]], "Output",ExpressionUUID->"0f7a4f9f-9606-\
4e71-aa67-4315e7203019"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Discretization", "Section",ExpressionUUID->"735867a3-e5a7-485e-b7a9-2fffb01620a9"],

Cell[TextData[{
 "Maxwells equations:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         RowBox[{"\[PartialD]", 
          SuperscriptBox["\[CapitalXi]", "1"]}], "/", 
         RowBox[{"\[PartialD]", "t"}]}]},
       {
        RowBox[{
         RowBox[{"\[PartialD]", 
          SuperscriptBox["\[CapitalXi]", "2"]}], "/", 
         RowBox[{"\[PartialD]", "t"}]}]},
       {
        RowBox[{
         RowBox[{"\[PartialD]", 
          SuperscriptBox["\[CapitalXi]", "3"]}], "/", 
         RowBox[{"\[PartialD]", "t"}]}]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{
      FractionBox["c", 
       SqrtBox["g"]], 
      RowBox[{"(", GridBox[{
         {
          RowBox[{
           RowBox[{
            RowBox[{"\[PartialD]", 
             SubscriptBox["\[CapitalOmega]", "3"]}], "/", 
            RowBox[{"\[PartialD]", 
             SuperscriptBox["x", "2"]}]}], "-", 
           RowBox[{
            RowBox[{"\[PartialD]", 
             SubscriptBox["\[CapitalOmega]", "2"]}], "/", 
            RowBox[{"\[PartialD]", 
             SuperscriptBox["x", "3"]}]}]}]},
         {
          RowBox[{
           RowBox[{
            RowBox[{"\[PartialD]", 
             SubscriptBox["\[CapitalOmega]", "1"]}], "/", 
            RowBox[{"\[PartialD]", 
             SuperscriptBox["x", "3"]}]}], "-", 
           RowBox[{
            RowBox[{"\[PartialD]", 
             SubscriptBox["\[CapitalOmega]", "3"]}], "/", 
            RowBox[{"\[PartialD]", 
             SuperscriptBox["x", "1"]}]}]}]},
         {
          RowBox[{
           RowBox[{
            RowBox[{"\[PartialD]", 
             SubscriptBox["\[CapitalOmega]", "2"]}], "/", 
            RowBox[{"\[PartialD]", 
             SuperscriptBox["x", "1"]}]}], "-", 
           RowBox[{
            RowBox[{"\[PartialD]", 
             SubscriptBox["\[CapitalOmega]", "1"]}], "/", 
            RowBox[{"\[PartialD]", 
             SuperscriptBox["x", "2"]}]}]}]}
        }], ")"}]}], "-", 
     RowBox[{"(", GridBox[{
        {
         SuperscriptBox["\[ScriptCapitalJ]", "1"]},
        {
         SuperscriptBox["\[ScriptCapitalJ]", "2"]},
        {
         SuperscriptBox["\[ScriptCapitalJ]", "3"]}
       }], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "53b3bc64-2498-4d05-8e44-43faaefcd2e4"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         RowBox[{"\[PartialD]", 
          SuperscriptBox["\[CapitalOmega]", "1"]}], "/", 
         RowBox[{"\[PartialD]", "t"}]}]},
       {
        RowBox[{
         RowBox[{"\[PartialD]", 
          SuperscriptBox["\[CapitalOmega]", "2"]}], "/", 
         RowBox[{"\[PartialD]", "t"}]}]},
       {
        RowBox[{
         RowBox[{"\[PartialD]", 
          SuperscriptBox["\[CapitalOmega]", "3"]}], "/", 
         RowBox[{"\[PartialD]", "t"}]}]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["c", 
       SqrtBox["g"]]}], 
     RowBox[{"(", GridBox[{
        {
         RowBox[{
          RowBox[{
           RowBox[{"\[PartialD]", 
            SubscriptBox["\[CapitalXi]", "3"]}], "/", 
           RowBox[{"\[PartialD]", 
            SuperscriptBox["x", "2"]}]}], "-", 
          RowBox[{
           RowBox[{"\[PartialD]", 
            SubscriptBox["\[CapitalXi]", "2"]}], "/", 
           RowBox[{"\[PartialD]", 
            SuperscriptBox["x", "3"]}]}]}]},
        {
         RowBox[{
          RowBox[{
           RowBox[{"\[PartialD]", 
            SubscriptBox["\[CapitalXi]", "1"]}], "/", 
           RowBox[{"\[PartialD]", 
            SuperscriptBox["x", "3"]}]}], "-", 
          RowBox[{
           RowBox[{"\[PartialD]", 
            SubscriptBox["\[CapitalXi]", "3"]}], "/", 
           RowBox[{"\[PartialD]", 
            SuperscriptBox["x", "1"]}]}]}]},
        {
         RowBox[{
          RowBox[{
           RowBox[{"\[PartialD]", 
            SubscriptBox["\[CapitalXi]", "2"]}], "/", 
           RowBox[{"\[PartialD]", 
            SuperscriptBox["x", "1"]}]}], "-", 
          RowBox[{
           RowBox[{"\[PartialD]", 
            SubscriptBox["\[CapitalXi]", "1"]}], "/", 
           RowBox[{"\[PartialD]", 
            SuperscriptBox["x", "2"]}]}]}]}
       }], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "c5917e72-36df-4808-ab1a-620f15fb816a"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"c", "(", 
      RowBox[{
       RowBox[{
        RowBox[{"\[PartialD]", 
         SuperscriptBox["\[CapitalXi]", "1"]}], "/", 
        RowBox[{"\[PartialD]", 
         SuperscriptBox["x", "1"]}]}], "+", 
       RowBox[{
        RowBox[{"\[PartialD]", 
         SuperscriptBox["\[CapitalXi]", "2"]}], "/", 
        RowBox[{"\[PartialD]", 
         SuperscriptBox["x", "2"]}]}], "+", 
       RowBox[{
        RowBox[{"\[PartialD]", 
         SuperscriptBox["\[CapitalXi]", "3"]}], "/", 
        RowBox[{"\[PartialD]", 
         SuperscriptBox["x", "3"]}]}]}], ")"}], "+", 
     RowBox[{
      FractionBox["c", 
       SqrtBox["g"]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[CapitalXi]", "1"], 
         RowBox[{
          RowBox[{"\[PartialD]", 
           SqrtBox["g"]}], "/", 
          RowBox[{"\[PartialD]", 
           SuperscriptBox["x", "1"]}]}]}], "+", 
        RowBox[{
         SuperscriptBox["\[CapitalXi]", "2"], 
         RowBox[{
          RowBox[{"\[PartialD]", 
           SqrtBox["g"]}], "/", 
          RowBox[{"\[PartialD]", 
           SuperscriptBox["x", "2"]}]}]}], "+", 
        RowBox[{
         SuperscriptBox["\[CapitalXi]", "3"], 
         RowBox[{
          RowBox[{"\[PartialD]", 
           SqrtBox["g"]}], "/", 
          RowBox[{"\[PartialD]", 
           SuperscriptBox["x", "3"]}]}]}]}], ")"}]}]}], "=", "\[CapitalPi]"}],
    TraditionalForm]],ExpressionUUID->
  "fcaa7110-364d-4077-ace1-8a4f1e1a3526"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"c", "(", 
      RowBox[{
       RowBox[{
        RowBox[{"\[PartialD]", 
         SuperscriptBox["\[CapitalOmega]", "1"]}], "/", 
        RowBox[{"\[PartialD]", 
         SuperscriptBox["x", "1"]}]}], "+", 
       RowBox[{
        RowBox[{"\[PartialD]", 
         SuperscriptBox["\[CapitalOmega]", "2"]}], "/", 
        RowBox[{"\[PartialD]", 
         SuperscriptBox["x", "2"]}]}], "+", 
       RowBox[{
        RowBox[{"\[PartialD]", 
         SuperscriptBox["\[CapitalOmega]", "3"]}], "/", 
        RowBox[{"\[PartialD]", 
         SuperscriptBox["x", "3"]}]}]}], ")"}], "+", 
     RowBox[{
      FractionBox["c", 
       SqrtBox["g"]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[CapitalOmega]", "1"], 
         RowBox[{
          RowBox[{"\[PartialD]", 
           SqrtBox["g"]}], "/", 
          RowBox[{"\[PartialD]", 
           SuperscriptBox["x", "1"]}]}]}], "+", 
        RowBox[{
         SuperscriptBox["\[CapitalOmega]", "2"], 
         RowBox[{
          RowBox[{"\[PartialD]", 
           SqrtBox["g"]}], "/", 
          RowBox[{"\[PartialD]", 
           SuperscriptBox["x", "2"]}]}]}], "+", 
        RowBox[{
         SuperscriptBox["\[CapitalOmega]", "3"], 
         RowBox[{
          RowBox[{"\[PartialD]", 
           SqrtBox["g"]}], "/", 
          RowBox[{"\[PartialD]", 
           SuperscriptBox["x", "3"]}]}]}]}], ")"}]}]}], "=", "0"}], 
   TraditionalForm]],ExpressionUUID->"c0bdb7d0-e8a5-4e60-b1b2-47a7eff4edc1"],
 "."
}], "Text",ExpressionUUID->"0bf41702-681c-4068-a283-fb1deffc92cf"],

Cell[TextData[{
 "Continuity equation:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"c", "(", 
      RowBox[{
       RowBox[{
        RowBox[{"\[PartialD]", 
         SuperscriptBox["\[ScriptCapitalJ]", "1"]}], "/", 
        RowBox[{"\[PartialD]", 
         SuperscriptBox["x", "1"]}]}], "+", 
       RowBox[{
        RowBox[{"\[PartialD]", 
         SuperscriptBox["\[ScriptCapitalJ]", "2"]}], "/", 
        RowBox[{"\[PartialD]", 
         SuperscriptBox["x", "2"]}]}], "+", 
       RowBox[{
        RowBox[{"\[PartialD]", 
         SuperscriptBox["\[ScriptCapitalJ]", "3"]}], "/", 
        RowBox[{"\[PartialD]", 
         SuperscriptBox["x", "3"]}]}]}], ")"}], "+", 
     RowBox[{
      FractionBox["c", 
       SqrtBox["g"]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[ScriptCapitalJ]", "1"], 
         RowBox[{
          RowBox[{"\[PartialD]", 
           SqrtBox["g"]}], "/", 
          RowBox[{"\[PartialD]", 
           SuperscriptBox["x", "1"]}]}]}], "+", 
        RowBox[{
         SuperscriptBox["\[ScriptCapitalJ]", "2"], 
         RowBox[{
          RowBox[{"\[PartialD]", 
           SqrtBox["g"]}], "/", 
          RowBox[{"\[PartialD]", 
           SuperscriptBox["x", "2"]}]}]}], "+", 
        RowBox[{
         SuperscriptBox["\[ScriptCapitalJ]", "3"], 
         RowBox[{
          RowBox[{"\[PartialD]", 
           SqrtBox["g"]}], "/", 
          RowBox[{"\[PartialD]", 
           SuperscriptBox["x", "3"]}]}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"\[PartialD]", "\[CapitalPi]"}], "/", 
      RowBox[{"\[PartialD]", "t"}]}]}], "=", "0"}], TraditionalForm]],
  ExpressionUUID->"64f595de-e56e-4fbd-9df3-1c7279fdf2de"],
 "."
}], "Text",ExpressionUUID->"2ea5d700-e6d5-4547-8f10-2b540adbf53f"],

Cell[TextData[{
 "Equation of motion (non-relativistic):\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         RowBox[{"\[PartialD]", 
          SuperscriptBox["x", "1"]}], "/", 
         RowBox[{"\[PartialD]", "t"}]}]},
       {
        RowBox[{
         RowBox[{"\[PartialD]", 
          SuperscriptBox["x", "2"]}], "/", 
         RowBox[{"\[PartialD]", "t"}]}]},
       {
        RowBox[{
         RowBox[{"\[PartialD]", 
          SuperscriptBox["x", "3"]}], "/", 
         RowBox[{"\[PartialD]", "t"}]}]}
      }], ")"}], "=", 
    RowBox[{"(", GridBox[{
       {
        SuperscriptBox["v", "1"]},
       {
        SuperscriptBox["v", "2"]},
       {
        SuperscriptBox["v", "3"]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "10136991-9f74-4bbb-b97c-aaa3965fe776"],
 ",\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         RowBox[{"\[PartialD]", 
          SubscriptBox["v", "x"]}], "/", 
         RowBox[{"\[PartialD]", "t"}]}]},
       {
        RowBox[{
         RowBox[{"\[PartialD]", 
          SubscriptBox["v", "y"]}], "/", 
         RowBox[{"\[PartialD]", "t"}]}]},
       {
        RowBox[{
         RowBox[{"\[PartialD]", 
          SubscriptBox["v", "z"]}], "/", 
         RowBox[{"\[PartialD]", "t"}]}]}
      }], ")"}], "=", 
    RowBox[{
     FractionBox[
      SubscriptBox["\[CapitalOmega]", "s"], 
      SubscriptBox["\[CapitalOmega]", "0"]], 
     RowBox[{"(", GridBox[{
        {
         RowBox[{
          RowBox[{"c", " ", 
           SubscriptBox["\[CapitalXi]", "x"]}], "+", 
          RowBox[{
           SubscriptBox["v", "y"], 
           SubscriptBox["\[CapitalOmega]", "z"]}], "-", 
          RowBox[{
           SubscriptBox["v", "z"], 
           SubscriptBox["\[CapitalOmega]", "y"]}]}]},
        {
         RowBox[{
          RowBox[{"c", " ", 
           SubscriptBox["\[CapitalXi]", "y"]}], "+", 
          RowBox[{
           SubscriptBox["v", "z"], 
           SubscriptBox["\[CapitalOmega]", "x"]}], "-", 
          RowBox[{
           SubscriptBox["v", "x"], 
           SubscriptBox["\[CapitalOmega]", "z"]}]}]},
        {
         RowBox[{
          RowBox[{"c", " ", 
           SubscriptBox["\[CapitalXi]", "z"]}], "+", 
          RowBox[{
           SubscriptBox["v", "x"], 
           SubscriptBox["\[CapitalOmega]", "y"]}], "-", 
          RowBox[{
           SubscriptBox["v", "y"], 
           SubscriptBox["\[CapitalOmega]", "x"]}]}]}
       }], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "edcc57f9-8c96-4c17-8f69-9262a22e1f1a"],
 "."
}], "Text",ExpressionUUID->"2709995f-79b9-4654-8c6e-dcd02d4f5c07"],

Cell[CellGroupData[{

Cell[TextData[{
 "1D in ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["x", "1"], TraditionalForm]],ExpressionUUID->
  "aad5311a-8039-4024-9cee-110f38e13513"],
 " coordinate"
}], "Subsection",ExpressionUUID->"a2142f9e-1dc8-48da-bfef-f8b9da8f4271"],

Cell[CellGroupData[{

Cell["Simulation domain", "Subsubsection",ExpressionUUID->"1f0683d3-9e38-4868-81e5-da16eac4a98a"],

Cell[TextData[{
 "Full integer grid: ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["\[CapitalXi]", "\[RightVector]"], TraditionalForm]],
  ExpressionUUID->"96ea4f5b-9685-42f5-b7d3-2380d7e6b0c2"],
 ", ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["\[ScriptCapitalJ]", "\[RightVector]"], TraditionalForm]],
  ExpressionUUID->"a21bd15a-4d31-4e49-8900-8e3819cf2d4d"],
 ", all discrete particle moments, and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[DoubleStruckCapitalV]", "f"], TraditionalForm]],
  ExpressionUUID->"90607150-f828-4ff2-b88d-3ac8dd209afb"],
 ".\nHalf integer grid: ",
 Cell[BoxData[
  FormBox[
   OverscriptBox["\[CapitalOmega]", "\[RightVector]"], TraditionalForm]],
  ExpressionUUID->"64bd1a49-3cb0-4b00-a49b-44e152811a75"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Delta]n", "f"], TraditionalForm]],ExpressionUUID->
  "9c9f5ba2-6f13-49cb-94cd-1b3454ccedfa"],
 ".\nLegend below:\n- Red: Full grid\n- Blue: Half grid\n- Open circle: Ghost \
grid point\n- Rectangle: Simulation box"
}], "Text",ExpressionUUID->"f247c1ea-359f-40a1-aac7-f8a14703cfa7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"L", "=", "3"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Graphics", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"EdgeForm", "[", 
           RowBox[{"Directive", "[", "Black", "]"}], "]"}], ",", 
          RowBox[{"FaceForm", "[", 
           RowBox[{"Directive", "[", 
            RowBox[{"Opacity", "[", "0", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Rectangle", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"-", ".4"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"L", ",", ".4"}], "}"}]}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Red", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Disk", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"#", ",", "0"}], "}"}], ",", ".1"}], "]"}], "&"}], "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"0", ",", 
             RowBox[{"L", "-", "1"}]}], "]"}]}], ",", 
          RowBox[{"Circle", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", ".1"}], "]"}], ",", 
          
          RowBox[{"Circle", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"L", ",", "0"}], "}"}], ",", ".1"}], "]"}]}], "}"}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Red", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Text", "[", 
             RowBox[{"#", ",", 
              RowBox[{"{", 
               RowBox[{"#", ",", 
                RowBox[{"+", ".1"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"-", "1"}]}], "}"}]}], "]"}], "&"}], "/@", 
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "L"}], "]"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Blue", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Disk", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"#", "+", ".5"}], ",", "0"}], "}"}], ",", ".1"}], 
             "]"}], "&"}], "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"0", ",", 
             RowBox[{"L", "-", "1"}]}], "]"}]}], ",", 
          RowBox[{"Circle", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "1"}], "+", ".5"}], ",", "0"}], "}"}], ",", 
            ".1"}], "]"}], ",", 
          RowBox[{"Circle", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"L", "+", ".5"}], ",", "0"}], "}"}], ",", ".1"}], 
           "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"Blue", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Text", "[", 
             RowBox[{"#", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"#", "+", ".5"}], ",", ".1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"-", "1"}]}], "}"}]}], "]"}], "&"}], "/@", 
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "L"}], "]"}]}]}], "}"}]}], 
       "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Axes", "->", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Ticks", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "\"\<\\!\\(x=0\\)\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"L", ",", "\"\<\\!\\(x=L\\)\>\""}], "}"}]}], "}"}], ",", 
        "None"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"BaseStyle", "->", "13"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 Editable->False,
 CellOpen->False,
 CellLabel->"In[46]:=",ExpressionUUID->"2b6ee556-d754-41ba-bf75-3397923095ea"],

Cell[BoxData[
 GraphicsBox[{
   {EdgeForm[GrayLevel[0]], FaceForm[Opacity[0]], 
    RectangleBox[{0, -0.4}, {3, 0.4}]}, 
   {RGBColor[
    1, 0, 0], {DiskBox[{0, 0}, 0.1], DiskBox[{1, 0}, 0.1], 
     DiskBox[{2, 0}, 0.1]}, CircleBox[{-1, 0}, 0.1], 
    CircleBox[{3, 0}, 0.1]}, 
   {RGBColor[1, 0, 0], InsetBox[
     RowBox[{"-", "1"}], {-1, 0.1}, ImageScaled[{Rational[1, 2], 0}]], 
    InsetBox["0", {0, 0.1}, ImageScaled[{Rational[1, 2], 0}]], 
    InsetBox["1", {1, 0.1}, ImageScaled[{Rational[1, 2], 0}]], 
    InsetBox["2", {2, 0.1}, ImageScaled[{Rational[1, 2], 0}]], 
    InsetBox["3", {3, 0.1}, ImageScaled[{Rational[1, 2], 0}]]}, 
   {RGBColor[
    0, 0, 1], {DiskBox[{0.5, 0}, 0.1], DiskBox[{1.5, 0}, 0.1], 
     DiskBox[{2.5, 0}, 0.1]}, CircleBox[{-0.5, 0}, 0.1], 
    CircleBox[{3.5, 0}, 0.1]}, 
   {RGBColor[0, 0, 1], InsetBox[
     RowBox[{"-", "1"}], {-0.5, 0.1}, ImageScaled[{Rational[1, 2], 0}]], 
    InsetBox["0", {0.5, 0.1}, ImageScaled[{Rational[1, 2], 0}]], 
    InsetBox["1", {1.5, 0.1}, ImageScaled[{Rational[1, 2], 0}]], 
    InsetBox["2", {2.5, 0.1}, ImageScaled[{Rational[1, 2], 0}]], 
    InsetBox["3", {3.5, 0.1}, ImageScaled[{Rational[1, 2], 0}]]}},
  Axes->{True, False},
  BaseStyle->13,
  Ticks->{{{0, 
      FormBox["\"\\!\\(x=0\\)\"", TraditionalForm]}, {3, 
      FormBox["\"\\!\\(x=L\\)\"", TraditionalForm]}}, None}]], "Output",
 CellLabel->"Out[46]=",ExpressionUUID->"2028200f-a510-4da7-88db-a5a4eba484e7"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Magnetic field update", "Subsubsection",ExpressionUUID->"fb6b39f5-8799-4aa8-a8ce-21e0009a5abe"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         SuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "1"], "/", 
         "\[CapitalDelta]t"}]},
       {
        RowBox[{
         SuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "2"], "/", 
         "\[CapitalDelta]t"}]},
       {
        RowBox[{
         SuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "3"], "/", 
         "\[CapitalDelta]t"}]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["c", 
       SqrtBox["g"]]}], 
     RowBox[{"(", GridBox[{
        {"0"},
        {
         RowBox[{
          RowBox[{"-", 
           SubsuperscriptBox["\[CapitalDelta]\[CapitalXi]", "3", "t"]}], "/", 
          
          SuperscriptBox["\[CapitalDelta]x", "1"]}]},
        {
         RowBox[{
          RowBox[{"+", 
           SubsuperscriptBox["\[CapitalDelta]\[CapitalXi]", "2", "t"]}], "/", 
          
          SuperscriptBox["\[CapitalDelta]x", "1"]}]}
       }], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "0af257e7-317a-41aa-84ed-90803a142db7"],
 " \[DoubleRightArrow] \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["\[CapitalOmega]", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
         RowBox[{"1", ";", "i"}]]},
       {
        SubsuperscriptBox["\[CapitalOmega]", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
         RowBox[{"2", ";", "i"}]]},
       {
        SubsuperscriptBox["\[CapitalOmega]", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
         RowBox[{"3", ";", "i"}]]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["\[CapitalOmega]", 
          RowBox[{"t", "-", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
          RowBox[{"1", ";", "i"}]]},
        {
         SubsuperscriptBox["\[CapitalOmega]", 
          RowBox[{"t", "-", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
          RowBox[{"2", ";", "i"}]]},
        {
         SubsuperscriptBox["\[CapitalOmega]", 
          RowBox[{"t", "-", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
          RowBox[{"3", ";", "i"}]]}
       }], ")"}], "-", 
     RowBox[{
      FractionBox[
       RowBox[{"c", " ", "\[CapitalDelta]t"}], 
       RowBox[{
        SqrtBox["g"], 
        SuperscriptBox["\[CapitalDelta]x", "1"]}]], 
      RowBox[{"(", GridBox[{
         {"0"},
         {
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             SubsuperscriptBox["\[CapitalXi]", 
              RowBox[{"3", ";", 
               RowBox[{"i", "+", "1"}]}], "t"], "-", 
             SubsuperscriptBox["\[CapitalXi]", 
              RowBox[{"3", ";", "i"}], "t"]}], ")"}]}]},
         {
          RowBox[{"+", 
           RowBox[{"(", 
            RowBox[{
             SubsuperscriptBox["\[CapitalXi]", 
              RowBox[{"2", ";", 
               RowBox[{"i", "+", "1"}]}], "t"], "-", 
             SubsuperscriptBox["\[CapitalXi]", 
              RowBox[{"2", ";", "i"}], "t"]}], ")"}]}]}
        }], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "f7f19ee1-af55-4362-ab92-86d2676d8ed4"]
}], "Text",ExpressionUUID->"ea180c80-1d45-4c8e-b169-0a13ac3cec31"],

Cell[TextData[{
 "After update, calculate covariant components:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[CapitalOmega]", "i"], "=", 
    RowBox[{
     SuperscriptBox["\[CapitalOmega]", "j"], 
     SubscriptBox["g", 
      RowBox[{"i", "\[VeryThinSpace]", "j"}]]}]}], TraditionalForm]],
  ExpressionUUID->"dd3908cf-4e25-43e2-bc00-6052e5d57090"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["\[CapitalOmega]", "1"]},
       {
        SubscriptBox["\[CapitalOmega]", "2"]},
       {
        SubscriptBox["\[CapitalOmega]", "3"]}
      }], ")"}], "=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         RowBox[{
          SubscriptBox["g", "11"], 
          SuperscriptBox["\[CapitalOmega]", "1"]}], "+", 
         RowBox[{
          SubscriptBox["g", "12"], 
          SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
         RowBox[{
          SubscriptBox["g", "13"], 
          SuperscriptBox["\[CapitalOmega]", "3"]}]}]},
       {
        RowBox[{
         RowBox[{
          SubscriptBox["g", "21"], 
          SuperscriptBox["\[CapitalOmega]", "1"]}], "+", 
         RowBox[{
          SubscriptBox["g", "22"], 
          SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
         RowBox[{
          SubscriptBox["g", "23"], 
          SuperscriptBox["\[CapitalOmega]", "3"]}]}]},
       {
        RowBox[{
         RowBox[{
          SubscriptBox["g", "31"], 
          SuperscriptBox["\[CapitalOmega]", "1"]}], "+", 
         RowBox[{
          SubscriptBox["g", "32"], 
          SuperscriptBox["\[CapitalOmega]", "2"]}], "+", 
         RowBox[{
          SubscriptBox["g", "33"], 
          SuperscriptBox["\[CapitalOmega]", "3"]}]}]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "ba5e94eb-4f1a-42fa-98ec-1140340a252a"],
 ";\nand Cartesian components:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["\[CapitalOmega]", "x"]},
       {
        SubscriptBox["\[CapitalOmega]", "y"]},
       {
        SubscriptBox["\[CapitalOmega]", "z"]}
      }], ")"}], "=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         RowBox[{
          SuperscriptBox["\[CapitalOmega]", "1"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "x"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalOmega]", "2"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "x"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalOmega]", "3"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "x"]}]}]}]},
       {
        RowBox[{
         RowBox[{
          SuperscriptBox["\[CapitalOmega]", "1"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "y"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalOmega]", "2"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "y"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalOmega]", "3"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "y"]}]}]}]},
       {
        RowBox[{
         RowBox[{
          SuperscriptBox["\[CapitalOmega]", "1"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "z"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalOmega]", "2"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "z"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalOmega]", "3"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "z"]}]}]}]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "55c8a377-f373-4eb2-81bf-f7de8bd7a4b2"]
}], "Text",ExpressionUUID->"5a9fed65-c44e-47db-939e-da9302f55582"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Electric field update", "Subsubsection",ExpressionUUID->"41eaf251-6f3e-47eb-ae80-da78b37dbb03"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         SuperscriptBox["\[CapitalDelta]\[CapitalXi]", "1"], "/", 
         "\[CapitalDelta]t"}]},
       {
        RowBox[{
         SuperscriptBox["\[CapitalDelta]\[CapitalXi]", "2"], "/", 
         "\[CapitalDelta]t"}]},
       {
        RowBox[{
         SuperscriptBox["\[CapitalDelta]\[CapitalXi]", "3"], "/", 
         "\[CapitalDelta]t"}]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{
      FractionBox["c", 
       SqrtBox["g"]], 
      RowBox[{"(", GridBox[{
         {"0"},
         {
          RowBox[{
           RowBox[{"-", 
            SubsuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "3", 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], "/", 
           SuperscriptBox["\[CapitalDelta]x", "1"]}]},
         {
          RowBox[{
           RowBox[{"+", 
            SubsuperscriptBox["\[CapitalDelta]\[CapitalOmega]", "2", 
             RowBox[{"t", "+", 
              RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], "/", 
           SuperscriptBox["\[CapitalDelta]x", "1"]}]}
        }], ")"}]}], "-", 
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], "1"]},
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], "2"]},
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], "3"]}
       }], ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "a0905b0c-71e5-4cef-b5fa-4f7be6836c81"],
 " \[DoubleRightArrow] \n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["\[CapitalXi]", 
         RowBox[{"t", "+", "\[CapitalDelta]t"}], 
         RowBox[{"1", ";", "i"}]]},
       {
        SubsuperscriptBox["\[CapitalXi]", 
         RowBox[{"t", "+", "\[CapitalDelta]t"}], 
         RowBox[{"2", ";", "i"}]]},
       {
        SubsuperscriptBox["\[CapitalXi]", 
         RowBox[{"t", "+", "\[CapitalDelta]t"}], 
         RowBox[{"3", ";", "i"}]]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["\[CapitalXi]", "t", 
          RowBox[{"1", ";", "i"}]]},
        {
         SubsuperscriptBox["\[CapitalXi]", "t", 
          RowBox[{"2", ";", "i"}]]},
        {
         SubsuperscriptBox["\[CapitalXi]", "t", 
          RowBox[{"3", ";", "i"}]]}
       }], ")"}], "-", 
     RowBox[{"\[CapitalDelta]t", "(", GridBox[{
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
          RowBox[{"1", ";", "i"}]]},
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
          RowBox[{"2", ";", "i"}]]},
        {
         SubsuperscriptBox["\[ScriptCapitalJ]", 
          RowBox[{"t", "+", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}], 
          RowBox[{"3", ";", "i"}]]}
       }], ")"}], "+", 
     RowBox[{
      FractionBox[
       RowBox[{"c", " ", "\[CapitalDelta]t"}], 
       RowBox[{
        SqrtBox["g"], 
        SuperscriptBox["\[CapitalDelta]x", "1"]}]], 
      RowBox[{"(", GridBox[{
         {"0"},
         {
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             SubsuperscriptBox["\[CapitalOmega]", 
              RowBox[{"3", ";", "i"}], 
              RowBox[{"t", "+", 
               RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "-", 
             SubsuperscriptBox["\[CapitalOmega]", 
              RowBox[{"3", ";", 
               RowBox[{"i", "-", "1"}]}], 
              RowBox[{"t", "+", 
               RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}]},
         {
          RowBox[{"+", 
           RowBox[{"(", 
            RowBox[{
             SubsuperscriptBox["\[CapitalOmega]", 
              RowBox[{"2", ";", "i"}], 
              RowBox[{"t", "+", 
               RowBox[{"\[CapitalDelta]t", "/", "2"}]}]], "-", 
             SubsuperscriptBox["\[CapitalOmega]", 
              RowBox[{"2", ";", 
               RowBox[{"i", "-", "1"}]}], 
              RowBox[{"t", "+", 
               RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}], ")"}]}]}
        }], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "da6de087-7620-438d-a80c-130a673551d5"]
}], "Text",ExpressionUUID->"484bfdcd-5ff3-4130-b6e2-7731b48e9897"],

Cell[TextData[{
 "After update, calculate covariant components:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[CapitalXi]", "i"], "=", 
    RowBox[{
     SuperscriptBox["\[CapitalXi]", "j"], 
     SubscriptBox["g", 
      RowBox[{"i", "\[VeryThinSpace]", "j"}]]}]}], TraditionalForm]],
  ExpressionUUID->"cc5f8f9c-bbef-4ddf-98d4-79f9e8629954"],
 ";\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["\[CapitalXi]", "1"]},
       {
        SubscriptBox["\[CapitalXi]", "2"]},
       {
        SubscriptBox["\[CapitalXi]", "3"]}
      }], ")"}], "=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         RowBox[{
          SubscriptBox["g", "11"], 
          SuperscriptBox["\[CapitalXi]", "1"]}], "+", 
         RowBox[{
          SubscriptBox["g", "12"], 
          SuperscriptBox["\[CapitalXi]", "2"]}], "+", 
         RowBox[{
          SubscriptBox["g", "13"], 
          SuperscriptBox["\[CapitalXi]", "3"]}]}]},
       {
        RowBox[{
         RowBox[{
          SubscriptBox["g", "21"], 
          SuperscriptBox["\[CapitalXi]", "1"]}], "+", 
         RowBox[{
          SubscriptBox["g", "22"], 
          SuperscriptBox["\[CapitalXi]", "2"]}], "+", 
         RowBox[{
          SubscriptBox["g", "23"], 
          SuperscriptBox["\[CapitalXi]", "3"]}]}]},
       {
        RowBox[{
         RowBox[{
          SubscriptBox["g", "31"], 
          SuperscriptBox["\[CapitalXi]", "1"]}], "+", 
         RowBox[{
          SubscriptBox["g", "32"], 
          SuperscriptBox["\[CapitalXi]", "2"]}], "+", 
         RowBox[{
          SubscriptBox["g", "33"], 
          SuperscriptBox["\[CapitalXi]", "3"]}]}]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "54148420-7a80-4baf-9b7c-1da31f78b5e6"],
 ";\nand Cartesian components:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubscriptBox["\[CapitalXi]", "x"]},
       {
        SubscriptBox["\[CapitalXi]", "y"]},
       {
        SubscriptBox["\[CapitalXi]", "z"]}
      }], ")"}], "=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         RowBox[{
          SuperscriptBox["\[CapitalXi]", "1"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "x"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalXi]", "2"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "x"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalXi]", "3"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "x"]}]}]}]},
       {
        RowBox[{
         RowBox[{
          SuperscriptBox["\[CapitalXi]", "1"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "y"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalXi]", "2"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "y"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalXi]", "3"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "y"]}]}]}]},
       {
        RowBox[{
         RowBox[{
          SuperscriptBox["\[CapitalXi]", "1"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "z"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalXi]", "2"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "z"]}]}], "+", 
         RowBox[{
          SuperscriptBox["\[CapitalXi]", "3"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"], "\[CenterDot]", 
           SubscriptBox[
            OverscriptBox["e", "^"], "z"]}]}]}]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "fbf7de8d-eb3c-4800-8960-9f84799b3fd5"]
}], "Text",ExpressionUUID->"09a334d1-0b00-4340-ad74-e61e7a711d23"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Position update", "Subsubsection",ExpressionUUID->"9702f1ed-9629-406b-9309-30a50865f5fa"],

Cell[TextData[{
 "Cartesian to curvilinear:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SuperscriptBox["v", "1"]},
       {
        SuperscriptBox["v", "2"]},
       {
        SuperscriptBox["v", "3"]}
      }], ")"}], "=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         RowBox[{
          SubscriptBox["v", "x"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "x"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"]}]}], "+", 
         RowBox[{
          SubscriptBox["v", "y"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "y"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"]}]}], "+", 
         RowBox[{
          SubscriptBox["v", "z"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "z"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"]}]}]}]},
       {
        RowBox[{
         RowBox[{
          SubscriptBox["v", "x"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "x"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"]}]}], "+", 
         RowBox[{
          SubscriptBox["v", "y"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "y"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"]}]}], "+", 
         RowBox[{
          SubscriptBox["v", "z"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "z"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"]}]}]}]},
       {
        RowBox[{
         RowBox[{
          SubscriptBox["v", "x"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "x"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"]}]}], "+", 
         RowBox[{
          SubscriptBox["v", "y"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "y"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"]}]}], "+", 
         RowBox[{
          SubscriptBox["v", "z"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "z"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"]}]}]}]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "93301a69-0c2e-4e38-9518-6cacbafd4cae"]
}], "Text",ExpressionUUID->"15fc059f-3db7-454a-b869-6d8c724caef5"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["x", 
     RowBox[{"t", "+", "\[CapitalDelta]t"}], "1"], "=", 
    RowBox[{
     SubsuperscriptBox["x", "t", "1"], "+", 
     RowBox[{"\[CapitalDelta]t", " ", 
      SubsuperscriptBox["v", 
       RowBox[{"t", "+", 
        RowBox[{"\[CapitalDelta]t", "/", "2"}]}], "1"]}]}]}], 
   TraditionalForm]],ExpressionUUID->"1689cc2d-1496-4ce5-9d10-bc41fd98c06a"],
 "."
}], "Text",ExpressionUUID->"802f5501-9506-4b3d-8d00-ab35752ed2e9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Velocity and cold fluid update in Cartesian coordinate system\
\>", "Subsubsection",ExpressionUUID->"65487bfb-867e-421b-b381-db68cd6843d9"],

Cell[TextData[{
 "Non-relativistic regime:\nStep 0 - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         SubscriptBox["\[CapitalXi]", "x"], "[", 
         SubsuperscriptBox["x", "t", "1"], "]"}]},
       {
        RowBox[{
         SubscriptBox["\[CapitalXi]", "y"], "[", 
         SubsuperscriptBox["x", "t", "1"], "]"}]},
       {
        RowBox[{
         SubscriptBox["\[CapitalXi]", "z"], "[", 
         SubsuperscriptBox["x", "t", "1"], "]"}]}
      }], ")"}], "=", 
    RowBox[{
     SubscriptBox["\[Sum]", 
      RowBox[{"i", ",", "j"}]], 
     RowBox[{
      RowBox[{"(", GridBox[{
         {
          SubsuperscriptBox["\[CapitalXi]", 
           RowBox[{"x", ";", "i"}], "t"]},
         {
          SubsuperscriptBox["\[CapitalXi]", 
           RowBox[{"y", ";", "i"}], "t"]},
         {
          SubsuperscriptBox["\[CapitalXi]", 
           RowBox[{"z", ";", "i"}], "t"]}
        }], ")"}], 
      RowBox[{"S", "[", 
       RowBox[{
        SubsuperscriptBox["x", "t", "1"], "-", 
        SuperscriptBox["x", 
         RowBox[{"1", ";", "i"}]]}], "]"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"87d306ea-3744-4788-8284-6421194d72f4"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         SubscriptBox["\[CapitalOmega]", "x"], "[", 
         SubsuperscriptBox["x", "t", "1"], "]"}]},
       {
        RowBox[{
         SubscriptBox["\[CapitalOmega]", "y"], "[", 
         SubsuperscriptBox["x", "t", "1"], "]"}]},
       {
        RowBox[{
         SubscriptBox["\[CapitalOmega]", "z"], "[", 
         SubsuperscriptBox["x", "t", "1"], "]"}]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         RowBox[{
          SubsuperscriptBox["\[CapitalOmega]", "x", "0"], "[", 
          SubsuperscriptBox["x", "t", "1"], "]"}]},
        {
         RowBox[{
          SubsuperscriptBox["\[CapitalOmega]", "y", "0"], "[", 
          SubsuperscriptBox["x", "t", "1"], "]"}]},
        {
         RowBox[{
          SubsuperscriptBox["\[CapitalOmega]", "z", "0"], "[", 
          SubsuperscriptBox["x", "t", "1"], "]"}]}
       }], ")"}], "+", 
     RowBox[{
      SubscriptBox["\[Sum]", "i"], 
      RowBox[{
       RowBox[{"(", GridBox[{
          {
           SubsuperscriptBox["\[Delta]\[CapitalOmega]", 
            RowBox[{"x", ";", "i"}], "t"]},
          {
           SubsuperscriptBox["\[Delta]\[CapitalOmega]", 
            RowBox[{"y", ";", "i"}], "t"]},
          {
           SubsuperscriptBox["\[Delta]\[CapitalOmega]", 
            RowBox[{"z", ";", "i"}], "t"]}
         }], ")"}], 
       RowBox[{"S", "[", 
        RowBox[{
         SubsuperscriptBox["x", "t", "1"], "-", 
         RowBox[{
          SuperscriptBox["\[CapitalDelta]x", "1"], "/", "2"}], "-", 
         SuperscriptBox["x", 
          RowBox[{"1", ";", "i"}]]}], "]"}]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"e7fed2f9-79a9-4dc2-9169-b7fb00a1eb18"],
 ",\nStep 1 - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["v", "x", "-"]},
       {
        SubsuperscriptBox["v", "y", "-"]},
       {
        SubsuperscriptBox["v", "z", "-"]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["v", "x", 
          RowBox[{"t", "-", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]},
        {
         SubsuperscriptBox["v", "y", 
          RowBox[{"t", "-", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]},
        {
         SubsuperscriptBox["v", "z", 
          RowBox[{"t", "-", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}
       }], ")"}], "+", 
     RowBox[{
      FractionBox[
       SubscriptBox["\[CapitalOmega]", "s"], 
       SubscriptBox["\[CapitalOmega]", "0"]], 
      FractionBox[
       RowBox[{"c", " ", "\[CapitalDelta]t"}], "2"], 
      RowBox[{"(", GridBox[{
         {
          SubsuperscriptBox["\[CapitalXi]", "x", "t"]},
         {
          SubsuperscriptBox["\[CapitalXi]", "y", "t"]},
         {
          SubsuperscriptBox["\[CapitalXi]", "z", "t"]}
        }], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "9a01a5ff-6159-48c7-8c37-3a01afda69a2"],
 ",\nStep 2 - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["v", "x", "0"]},
       {
        SubsuperscriptBox["v", "y", "0"]},
       {
        SubsuperscriptBox["v", "z", "0"]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["v", "x", "-"]},
        {
         SubsuperscriptBox["v", "y", "-"]},
        {
         SubsuperscriptBox["v", "z", "-"]}
       }], ")"}], "+", 
     RowBox[{
      FractionBox[
       SubscriptBox["\[CapitalOmega]", "s"], 
       SubscriptBox["\[CapitalOmega]", "0"]], 
      FractionBox["\[CapitalDelta]t", "2"], 
      RowBox[{"(", GridBox[{
         {
          RowBox[{
           RowBox[{
            SubsuperscriptBox["v", "y", "-"], 
            SubsuperscriptBox["\[CapitalOmega]", "z", "t"]}], "-", 
           RowBox[{
            SubsuperscriptBox["v", "z", "-"], 
            SubsuperscriptBox["\[CapitalOmega]", "y", "t"]}]}]},
         {
          RowBox[{
           RowBox[{
            SubsuperscriptBox["v", "z", "-"], 
            SubsuperscriptBox["\[CapitalOmega]", "x", "t"]}], "-", 
           RowBox[{
            SubsuperscriptBox["v", "x", "-"], 
            SubsuperscriptBox["\[CapitalOmega]", "z", "t"]}]}]},
         {
          RowBox[{
           RowBox[{
            SubsuperscriptBox["v", "x", "-"], 
            SubsuperscriptBox["\[CapitalOmega]", "y", "t"]}], "-", 
           RowBox[{
            SubsuperscriptBox["v", "y", "-"], 
            SubsuperscriptBox["\[CapitalOmega]", "x", "t"]}]}]}
        }], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "d19bc3f2-0de1-410a-a1d3-e22b05518844"],
 ",\nStep 3 - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["v", "x", "+"]},
       {
        SubsuperscriptBox["v", "y", "+"]},
       {
        SubsuperscriptBox["v", "z", "+"]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["v", "x", "-"]},
        {
         SubsuperscriptBox["v", "y", "-"]},
        {
         SubsuperscriptBox["v", "z", "-"]}
       }], ")"}], "+", 
     RowBox[{
      FractionBox[
       SubscriptBox["\[CapitalOmega]", "s"], 
       SubscriptBox["\[CapitalOmega]", "0"]], 
      FractionBox["\[CapitalDelta]t", "2"], 
      FractionBox["2", 
       RowBox[{"1", "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             SubscriptBox["\[CapitalOmega]", "s"], 
             SubscriptBox["\[CapitalOmega]", "0"]], 
            FractionBox["\[CapitalDelta]t", "2"]}], ")"}], "2"], 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             SubsuperscriptBox["\[CapitalOmega]", "x", "t"], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             SubsuperscriptBox["\[CapitalOmega]", "y", "t"], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             SubsuperscriptBox["\[CapitalOmega]", "z", "t"], ")"}], "2"]}], 
          ")"}]}]}]], 
      RowBox[{"(", GridBox[{
         {
          RowBox[{
           RowBox[{
            SubsuperscriptBox["v", "y", "0"], 
            SubsuperscriptBox["\[CapitalOmega]", "z", "t"]}], "-", 
           RowBox[{
            SubsuperscriptBox["v", "z", "0"], 
            SubsuperscriptBox["\[CapitalOmega]", "y", "t"]}]}]},
         {
          RowBox[{
           RowBox[{
            SubsuperscriptBox["v", "z", "0"], 
            SubsuperscriptBox["\[CapitalOmega]", "x", "t"]}], "-", 
           RowBox[{
            SubsuperscriptBox["v", "x", "0"], 
            SubsuperscriptBox["\[CapitalOmega]", "z", "t"]}]}]},
         {
          RowBox[{
           RowBox[{
            SubsuperscriptBox["v", "x", "0"], 
            SubsuperscriptBox["\[CapitalOmega]", "y", "t"]}], "-", 
           RowBox[{
            SubsuperscriptBox["v", "y", "0"], 
            SubsuperscriptBox["\[CapitalOmega]", "x", "t"]}]}]}
        }], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "ccc7453a-76d9-4d86-a35c-6b5dacdc4639"],
 ", and\nStep 4 - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["v", "x", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]},
       {
        SubsuperscriptBox["v", "y", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]},
       {
        SubsuperscriptBox["v", "z", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["v", "x", "+"]},
        {
         SubsuperscriptBox["v", "y", "+"]},
        {
         SubsuperscriptBox["v", "z", "+"]}
       }], ")"}], "+", 
     RowBox[{
      FractionBox[
       SubscriptBox["\[CapitalOmega]", "s"], 
       SubscriptBox["\[CapitalOmega]", "0"]], 
      FractionBox[
       RowBox[{"c", " ", "\[CapitalDelta]t"}], "2"], 
      RowBox[{"(", GridBox[{
         {
          SubsuperscriptBox["\[CapitalXi]", "x", "t"]},
         {
          SubsuperscriptBox["\[CapitalXi]", "y", "t"]},
         {
          SubsuperscriptBox["\[CapitalXi]", "z", "t"]}
        }], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "0c2ecebe-6ebd-4931-8acc-dac97cfddf36"],
 "."
}], "Text",ExpressionUUID->"c3990e72-d5ea-4e55-af7d-409b5977a4a6"],

Cell[TextData[{
 "Relativistic regime:\nStep 0 - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         SubscriptBox["\[CapitalXi]", "x"], "[", 
         SubsuperscriptBox["x", "t", "1"], "]"}]},
       {
        RowBox[{
         SubscriptBox["\[CapitalXi]", "y"], "[", 
         SubsuperscriptBox["x", "t", "1"], "]"}]},
       {
        RowBox[{
         SubscriptBox["\[CapitalXi]", "z"], "[", 
         SubsuperscriptBox["x", "t", "1"], "]"}]}
      }], ")"}], "=", 
    RowBox[{
     SubscriptBox["\[Sum]", 
      RowBox[{"i", ",", "j"}]], 
     RowBox[{
      RowBox[{"(", GridBox[{
         {
          SubsuperscriptBox["\[CapitalXi]", 
           RowBox[{"x", ";", "i"}], "t"]},
         {
          SubsuperscriptBox["\[CapitalXi]", 
           RowBox[{"y", ";", "i"}], "t"]},
         {
          SubsuperscriptBox["\[CapitalXi]", 
           RowBox[{"z", ";", "i"}], "t"]}
        }], ")"}], 
      RowBox[{"S", "[", 
       RowBox[{
        SubsuperscriptBox["x", "t", "1"], "-", 
        SuperscriptBox["x", 
         RowBox[{"1", ";", "i"}]]}], "]"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"4e662f20-a85d-4a46-a826-3643e2b8045f"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         SubscriptBox["\[CapitalOmega]", "x"], "[", 
         SubsuperscriptBox["x", "t", "1"], "]"}]},
       {
        RowBox[{
         SubscriptBox["\[CapitalOmega]", "y"], "[", 
         SubsuperscriptBox["x", "t", "1"], "]"}]},
       {
        RowBox[{
         SubscriptBox["\[CapitalOmega]", "z"], "[", 
         SubsuperscriptBox["x", "t", "1"], "]"}]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         RowBox[{
          SubsuperscriptBox["\[CapitalOmega]", "x", "0"], "[", 
          SubsuperscriptBox["x", "t", "1"], "]"}]},
        {
         RowBox[{
          SubsuperscriptBox["\[CapitalOmega]", "y", "0"], "[", 
          SubsuperscriptBox["x", "t", "1"], "]"}]},
        {
         RowBox[{
          SubsuperscriptBox["\[CapitalOmega]", "z", "0"], "[", 
          SubsuperscriptBox["x", "t", "1"], "]"}]}
       }], ")"}], "+", 
     RowBox[{
      SubscriptBox["\[Sum]", "i"], 
      RowBox[{
       RowBox[{"(", GridBox[{
          {
           SubsuperscriptBox["\[Delta]\[CapitalOmega]", 
            RowBox[{"x", ";", "i"}], "t"]},
          {
           SubsuperscriptBox["\[Delta]\[CapitalOmega]", 
            RowBox[{"y", ";", "i"}], "t"]},
          {
           SubsuperscriptBox["\[Delta]\[CapitalOmega]", 
            RowBox[{"z", ";", "i"}], "t"]}
         }], ")"}], 
       RowBox[{"S", "[", 
        RowBox[{
         SubsuperscriptBox["x", "t", "1"], "-", 
         RowBox[{
          SuperscriptBox["\[CapitalDelta]x", "1"], "/", "2"}], "-", 
         SuperscriptBox["x", 
          RowBox[{"1", ";", "i"}]]}], "]"}]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"d8df4fa4-7507-41ca-bfbf-b7c592d4a5fd"],
 ",\nStep 1 - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["u", "x", "-"]},
       {
        SubsuperscriptBox["u", "y", "-"]},
       {
        SubsuperscriptBox["u", "z", "-"]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["u", "x", 
          RowBox[{"t", "-", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]},
        {
         SubsuperscriptBox["u", "y", 
          RowBox[{"t", "-", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]},
        {
         SubsuperscriptBox["u", "z", 
          RowBox[{"t", "-", 
           RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}
       }], ")"}], "+", 
     RowBox[{
      FractionBox[
       SubscriptBox["\[CapitalOmega]", "s"], 
       SubscriptBox["\[CapitalOmega]", "0"]], 
      FractionBox[
       RowBox[{"c", " ", "\[CapitalDelta]t"}], "2"], 
      RowBox[{"(", GridBox[{
         {
          SubsuperscriptBox["\[CapitalXi]", "x", "t"]},
         {
          SubsuperscriptBox["\[CapitalXi]", "y", "t"]},
         {
          SubsuperscriptBox["\[CapitalXi]", "z", "t"]}
        }], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "ff13d4de-c6e4-457a-82a1-bc82ea78be6f"],
 ", where ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[DoubleStruckU]", "=", 
    RowBox[{"\[Gamma]", " ", "\[DoubleStruckV]"}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "04d8d328-8dfd-45ab-b637-0eee6b7b9920"],
 ".\nStep 2 - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["u", "x", "0"]},
       {
        SubsuperscriptBox["u", "y", "0"]},
       {
        SubsuperscriptBox["u", "z", "0"]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["u", "x", "-"]},
        {
         SubsuperscriptBox["u", "y", "-"]},
        {
         SubsuperscriptBox["u", "z", "-"]}
       }], ")"}], "+", 
     RowBox[{
      FractionBox[
       SubscriptBox["\[CapitalOmega]", "s"], 
       SubscriptBox["\[CapitalOmega]", "0"]], 
      FractionBox["\[CapitalDelta]t", "2"], 
      RowBox[{"(", GridBox[{
         {
          RowBox[{
           RowBox[{
            SubsuperscriptBox["u", "y", "-"], 
            SubsuperscriptBox["\[CapitalOmega]", "z", "-"]}], "-", 
           RowBox[{
            SubsuperscriptBox["u", "z", "-"], 
            SubsuperscriptBox["\[CapitalOmega]", "y", "-"]}]}]},
         {
          RowBox[{
           RowBox[{
            SubsuperscriptBox["v", "z", "-"], 
            SubsuperscriptBox["\[CapitalOmega]", "x", "-"]}], "-", 
           RowBox[{
            SubsuperscriptBox["v", "x", "-"], 
            SubsuperscriptBox["\[CapitalOmega]", "z", "-"]}]}]},
         {
          RowBox[{
           RowBox[{
            SubsuperscriptBox["v", "x", "-"], 
            SubsuperscriptBox["\[CapitalOmega]", "y", "-"]}], "-", 
           RowBox[{
            SubsuperscriptBox["v", "y", "-"], 
            SubsuperscriptBox["\[CapitalOmega]", "x", "-"]}]}]}
        }], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "d9bcbfaa-08fb-46c9-8bbb-4f7d32ca1e44"],
 ", where ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[CapitalOmega]", "-"], "=", 
    RowBox[{
     SuperscriptBox["\[CapitalOmega]", "t"], "/", 
     SuperscriptBox["\[Gamma]", "-"]}]}], TraditionalForm]],
  FormatType->TraditionalForm,ExpressionUUID->
  "d86f982f-2380-4f5f-a1d6-ac5687d24360"],
 ".\nStep 3 - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["u", "x", "+"]},
       {
        SubsuperscriptBox["u", "y", "+"]},
       {
        SubsuperscriptBox["u", "z", "+"]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["u", "x", "-"]},
        {
         SubsuperscriptBox["u", "y", "-"]},
        {
         SubsuperscriptBox["u", "z", "-"]}
       }], ")"}], "+", 
     RowBox[{
      FractionBox[
       SubscriptBox["\[CapitalOmega]", "s"], 
       SubscriptBox["\[CapitalOmega]", "0"]], 
      FractionBox["\[CapitalDelta]t", "2"], 
      FractionBox["2", 
       RowBox[{"1", "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             SubscriptBox["\[CapitalOmega]", "s"], 
             SubscriptBox["\[CapitalOmega]", "0"]], 
            FractionBox["\[CapitalDelta]t", "2"]}], ")"}], "2"], 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             SubsuperscriptBox["\[CapitalOmega]", "x", "-"], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             SubsuperscriptBox["\[CapitalOmega]", "y", "-"], ")"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             SubsuperscriptBox["\[CapitalOmega]", "z", "-"], ")"}], "2"]}], 
          ")"}]}]}]], 
      RowBox[{"(", GridBox[{
         {
          RowBox[{
           RowBox[{
            SubsuperscriptBox["v", "y", "0"], 
            SubsuperscriptBox["\[CapitalOmega]", "z", "-"]}], "-", 
           RowBox[{
            SubsuperscriptBox["v", "z", "0"], 
            SubsuperscriptBox["\[CapitalOmega]", "y", "-"]}]}]},
         {
          RowBox[{
           RowBox[{
            SubsuperscriptBox["v", "z", "0"], 
            SubsuperscriptBox["\[CapitalOmega]", "x", "-"]}], "-", 
           RowBox[{
            SubsuperscriptBox["v", "x", "0"], 
            SubsuperscriptBox["\[CapitalOmega]", "z", "-"]}]}]},
         {
          RowBox[{
           RowBox[{
            SubsuperscriptBox["v", "x", "0"], 
            SubsuperscriptBox["\[CapitalOmega]", "y", "-"]}], "-", 
           RowBox[{
            SubsuperscriptBox["v", "y", "0"], 
            SubsuperscriptBox["\[CapitalOmega]", "x", "-"]}]}]}
        }], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "ac4bd744-e214-412f-878d-10fe907db9e1"],
 ", and\nStep 4 - ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["u", "x", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]},
       {
        SubsuperscriptBox["u", "y", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]},
       {
        SubsuperscriptBox["u", "z", 
         RowBox[{"t", "+", 
          RowBox[{"\[CapitalDelta]t", "/", "2"}]}]]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["u", "x", "+"]},
        {
         SubsuperscriptBox["u", "y", "+"]},
        {
         SubsuperscriptBox["u", "z", "+"]}
       }], ")"}], "+", 
     RowBox[{
      FractionBox[
       SubscriptBox["\[CapitalOmega]", "s"], 
       SubscriptBox["\[CapitalOmega]", "0"]], 
      FractionBox[
       RowBox[{"c", " ", "\[CapitalDelta]t"}], "2"], 
      RowBox[{"(", GridBox[{
         {
          SubsuperscriptBox["\[CapitalXi]", "x", "t"]},
         {
          SubsuperscriptBox["\[CapitalXi]", "y", "t"]},
         {
          SubsuperscriptBox["\[CapitalXi]", "z", "t"]}
        }], ")"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "05156081-abf6-4a25-a554-29ef8ddd6708"],
 "."
}], "Text",ExpressionUUID->"dd6487c6-7f2f-4c02-ab85-e3b06526af0b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Moments: from particle to grid", "Subsubsection",ExpressionUUID->"cd1c9823-f092-41bb-8582-ab06a06d2c09"],

Cell[TextData[{
 "Number density (zeroth velocity moment) at ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]],ExpressionUUID->
  "cdc6f31b-181f-4713-96ba-8370daa4e26b"],
 "th grid point:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["n", 
     RowBox[{"t", ";", "s"}], "i"], "=", 
    RowBox[{
     RowBox[{
      SubsuperscriptBox["n", 
       RowBox[{"0", ";", "s"}], "i"], 
      FractionBox[
       RowBox[{
        SubscriptBox["\[Sum]", "p"], 
        RowBox[{"S", "[", 
         RowBox[{
          SubsuperscriptBox["x", 
           RowBox[{"t", ";", "s"}], 
           RowBox[{"1", ";", "p"}]], "-", 
          SuperscriptBox["x", 
           RowBox[{"1", ";", "i"}]]}], "]"}]}], 
       SubsuperscriptBox["N", 
        RowBox[{"c", ";", "s"}], 
        RowBox[{"0", ";", "i"}]]]}], "=", 
     RowBox[{
      SubscriptBox["n", 
       RowBox[{"0", ";", "s"}]], 
      FractionBox[
       RowBox[{
        SubscriptBox["\[Sum]", "p"], 
        RowBox[{"S", "[", 
         RowBox[{
          SubsuperscriptBox["x", 
           RowBox[{"t", ";", "s"}], 
           RowBox[{"1", ";", "p"}]], "-", 
          SuperscriptBox["x", 
           RowBox[{"1", ";", "i"}]]}], "]"}]}], 
       SubscriptBox["N", 
        RowBox[{"c", ";", "s"}]]]}]}]}], TraditionalForm]],ExpressionUUID->
  "cb005f14-a944-44a5-9abf-737fefb241f1"],
 ", \nwhere \n",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["N", 
    RowBox[{"c", ";", "s"}], "0"], TraditionalForm]],ExpressionUUID->
  "f6f9ae12-3ece-49d8-b370-b6536f910401"],
 " is the initial number of simulation particles of species ",
 Cell[BoxData[
  FormBox["s", TraditionalForm]],ExpressionUUID->
  "82fab8c1-8e26-42c9-879b-7106750667cb"],
 " at a reference cell; \n",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", 
    RowBox[{"0", ";", "s"}]], TraditionalForm]],ExpressionUUID->
  "7eac9088-b832-4e32-8dea-ad955e12f263"],
 " is the initial number density of the species ",
 Cell[BoxData[
  FormBox["s", TraditionalForm]],ExpressionUUID->
  "15c457d6-0c4c-4cb6-b5ea-d574733715e8"],
 " at a reference cell; \n",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["N", 
    RowBox[{"c", ";", "s"}], 
    RowBox[{"0", ";", "i"}]], TraditionalForm]],ExpressionUUID->
  "bb192f29-6a3a-41c6-97c3-48ae9752f54a"],
 " is the initial number of simulation particles at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    SuperscriptBox["q", "i"], ")"}], TraditionalForm]],ExpressionUUID->
  "58b61ec4-87a4-4dfa-9be5-1f495fc41435"],
 " cell; and \n",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["n", 
    RowBox[{"0", ";", "s"}], "i"], TraditionalForm]],ExpressionUUID->
  "304540e3-6d28-47dc-9763-4b106cfc86a0"],
 " is the initial number density at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    SuperscriptBox["q", "i"], ")"}], TraditionalForm]],ExpressionUUID->
  "ecb85ed6-a9be-4bb7-ac65-bba71a12446f"],
 " cell.\nCharge density at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    SuperscriptBox["q", "i"], ")"}], TraditionalForm]],ExpressionUUID->
  "84fe7c61-6ae2-4a94-bda2-482404ab7768"],
 " cell is:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["\[CapitalPi]", "t", "i"], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Sum]", "s"], 
      RowBox[{
       FractionBox[
        SubscriptBox["\[CapitalOmega]", "0"], 
        SubscriptBox["\[CapitalOmega]", "s"]], 
       SubsuperscriptBox["\[Omega]", 
        RowBox[{"s", ";", "i"}], "2"], 
       FractionBox[
        RowBox[{
         SubscriptBox["\[Sum]", "p"], 
         RowBox[{"S", "[", 
          RowBox[{
           SubsuperscriptBox["x", 
            RowBox[{"t", ";", "s"}], 
            RowBox[{"1", ";", "p"}]], "-", 
           SuperscriptBox["x", 
            RowBox[{"1", ";", "i"}]]}], "]"}]}], 
        SubsuperscriptBox["N", 
         RowBox[{"c", ";", "s"}], 
         RowBox[{"0", ";", "i"}]]]}]}], "=", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Sum]", "s"], 
       RowBox[{
        FractionBox[
         SubscriptBox["\[CapitalOmega]", "0"], 
         SubscriptBox["\[CapitalOmega]", "s"]], 
        SubsuperscriptBox["\[Omega]", 
         RowBox[{"s", ";", "0"}], "2"], 
        FractionBox[
         RowBox[{
          SubscriptBox["\[Sum]", "p"], 
          RowBox[{"S", "[", 
           RowBox[{
            SubsuperscriptBox["x", 
             RowBox[{"t", ";", "s"}], 
             RowBox[{"1", ";", "p"}]], "-", 
            SuperscriptBox["x", 
             RowBox[{"1", ";", "i"}]]}], "]"}]}], 
         SubsuperscriptBox["N", 
          RowBox[{"c", ";", "s"}], "0"]]}]}], "=", 
      RowBox[{
       SubscriptBox["\[Sum]", "s"], 
       RowBox[{
        FractionBox[
         SubscriptBox["\[CapitalOmega]", "0"], 
         SubscriptBox["\[CapitalOmega]", "s"]], 
        SubsuperscriptBox["\[Omega]", 
         RowBox[{"s", ";", "0"}], "2"], 
        FractionBox[
         SubsuperscriptBox["n", 
          RowBox[{"t", ";", "s"}], "i"], 
         SubscriptBox["n", 
          RowBox[{"0", ";", "s"}]]]}]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"48490104-c5c0-470c-b4f3-6c349893793f"],
 ",\nwhere \n",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Omega]", 
    RowBox[{"s", ";", "0"}]], TraditionalForm]],ExpressionUUID->
  "8b9ad351-ea51-495d-b3ea-da811517fc6b"],
 " is the initial plasma frequency at the reference cell; and \n",
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox["\[Omega]", 
    RowBox[{"s", ";", "i"}], "2"], TraditionalForm]],ExpressionUUID->
  "645f0eaf-0233-4aeb-973d-69e2ecf8263d"],
 " is the initial plasma frequency at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    SuperscriptBox["q", "i"], ")"}], TraditionalForm]],ExpressionUUID->
  "5b442d27-f6e9-4cb9-9b4c-4c6de54fd9cb"],
 " cell."
}], "Text",ExpressionUUID->"3c7b42f0-d3c1-414b-8a7f-4fd101de6620"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Nc", "=", "100"}], ",", 
     RowBox[{"Nx", "=", "2"}], ",", 
     RowBox[{"n0", "=", "1."}], ",", 
     RowBox[{"S", "=", 
      RowBox[{"Function", "[", 
       RowBox[{"x", 
        RowBox[{"(*", 
         RowBox[{"0", "\[LessEqual]", "x", "\[LessEqual]", "1"}], "*)"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "-", "x"}], ",", "x"}], "}"}], "//", "N"}]}], 
       "]"}]}]}], "}"}], ",", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "x", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"x", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", 
         RowBox[{"Nc", "*", "Nx"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Plus", "@@@", 
         RowBox[{"S", "[", "x", "]"}]}], ")"}], "/", "Nc"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "]"}]], "Input",ExpressionUUID->"dac6d09b-\
7866-4b87-81e2-0ec0db3c2d41"],

Cell[TextData[{
 "Average flow speed weighted by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["n", 
     RowBox[{"t", ";", "s"}], "i"], "/", 
    SubscriptBox["n", 
     RowBox[{"0", ";", "s"}]]}], TraditionalForm]],ExpressionUUID->
  "f01a8c8f-6b98-4e3b-a992-609f01c22c92"],
 ":\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["V", 
         RowBox[{"x", ";", "i"}], 
         RowBox[{"t", ";", "s"}]]},
       {
        SubsuperscriptBox["V", 
         RowBox[{"y", ";", "i"}], 
         RowBox[{"t", ";", "s"}]]},
       {
        SubsuperscriptBox["V", 
         RowBox[{"z", ";", "i"}], 
         RowBox[{"t", ";", "s"}]]}
      }], ")"}], "=", 
    RowBox[{
     SubscriptBox["\[Sum]", "p"], 
     RowBox[{
      RowBox[{"(", GridBox[{
         {
          SubsuperscriptBox["v", 
           RowBox[{"x", ";", "p"}], 
           RowBox[{"t", ";", "s"}]]},
         {
          SubsuperscriptBox["v", 
           RowBox[{"y", ";", "p"}], 
           RowBox[{"t", ";", "s"}]]},
         {
          SubsuperscriptBox["v", 
           RowBox[{"z", ";", "p"}], 
           RowBox[{"t", ";", "s"}]]}
        }], ")"}], 
      FractionBox[
       RowBox[{"S", "[", 
        RowBox[{
         SubsuperscriptBox["x", 
          RowBox[{"t", ";", "s"}], 
          RowBox[{"1", ";", "p"}]], "-", 
         SuperscriptBox["x", 
          RowBox[{"1", ";", "i"}]]}], "]"}], 
       SubsuperscriptBox["N", 
        RowBox[{"c", ";", "s"}], "0"]]}]}]}], TraditionalForm]],
  ExpressionUUID->"42da0afb-206b-434a-8f43-86ba157e469b"],
 "\nAverage flow speed is given by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["V", 
         RowBox[{"x", ";", "i"}], 
         RowBox[{"t", ";", "s"}]]},
       {
        SubsuperscriptBox["V", 
         RowBox[{"y", ";", "i"}], 
         RowBox[{"t", ";", "s"}]]},
       {
        SubsuperscriptBox["V", 
         RowBox[{"z", ";", "i"}], 
         RowBox[{"t", ";", "s"}]]}
      }], ")"}], "/", 
    FractionBox[
     SubsuperscriptBox["n", 
      RowBox[{"t", ";", "s"}], "i"], 
     SubscriptBox["n", 
      RowBox[{"0", ";", "s"}]]]}], TraditionalForm]],ExpressionUUID->
  "b553aaaa-966c-46ec-b06c-4c791fb54968"],
 ".\nCurrent density:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SubsuperscriptBox["\[ScriptCapitalJ]", 
         RowBox[{"x", ";", "i"}], 
         RowBox[{"t", ";", "s"}]]},
       {
        SubsuperscriptBox["\[ScriptCapitalJ]", 
         RowBox[{"y", ";", "i"}], 
         RowBox[{"t", ";", "s"}]]},
       {
        SubsuperscriptBox["\[ScriptCapitalJ]", 
         RowBox[{"z", ";", "i"}], 
         RowBox[{"t", ";", "s"}]]}
      }], ")"}], "=", 
    RowBox[{
     RowBox[{
      FractionBox[
       SubscriptBox["\[CapitalOmega]", "0"], 
       SubscriptBox["\[CapitalOmega]", "s"]], 
      FractionBox[
       SubsuperscriptBox["\[Omega]", 
        RowBox[{"s", ";", "i"}], "2"], "c"], 
      RowBox[{
       SubscriptBox["\[Sum]", "p"], 
       RowBox[{
        RowBox[{"(", GridBox[{
           {
            SubsuperscriptBox["v", 
             RowBox[{"x", ";", "p"}], 
             RowBox[{"t", ";", "s"}]]},
           {
            SubsuperscriptBox["v", 
             RowBox[{"y", ";", "p"}], 
             RowBox[{"t", ";", "s"}]]},
           {
            SubsuperscriptBox["v", 
             RowBox[{"z", ";", "p"}], 
             RowBox[{"t", ";", "s"}]]}
          }], ")"}], 
        FractionBox[
         RowBox[{"S", "[", 
          RowBox[{
           SubsuperscriptBox["x", 
            RowBox[{"t", ";", "s"}], 
            RowBox[{"1", ";", "p"}]], "-", 
           SuperscriptBox["x", 
            RowBox[{"1", ";", "i"}]]}], "]"}], 
         SubsuperscriptBox["N", 
          RowBox[{"c", ";", "s"}], 
          RowBox[{"0", ";", "i"}]]]}]}]}], "=", 
     RowBox[{
      RowBox[{
       FractionBox[
        SubscriptBox["\[CapitalOmega]", "0"], 
        SubscriptBox["\[CapitalOmega]", "s"]], 
       FractionBox[
        SubsuperscriptBox["\[Omega]", 
         RowBox[{"s", ";", "0"}], "2"], "c"], 
       RowBox[{
        SubscriptBox["\[Sum]", "p"], 
        RowBox[{
         RowBox[{"(", GridBox[{
            {
             SubsuperscriptBox["v", 
              RowBox[{"x", ";", "p"}], 
              RowBox[{"t", ";", "s"}]]},
            {
             SubsuperscriptBox["v", 
              RowBox[{"y", ";", "p"}], 
              RowBox[{"t", ";", "s"}]]},
            {
             SubsuperscriptBox["v", 
              RowBox[{"z", ";", "p"}], 
              RowBox[{"t", ";", "s"}]]}
           }], ")"}], 
         FractionBox[
          RowBox[{"S", "[", 
           RowBox[{
            SubsuperscriptBox["x", 
             RowBox[{"t", ";", "s"}], 
             RowBox[{"1", ";", "p"}]], "-", 
            SuperscriptBox["x", 
             RowBox[{"1", ";", "i"}]]}], "]"}], 
          SubsuperscriptBox["N", 
           RowBox[{"c", ";", "s"}], "0"]]}]}]}], "=", 
      RowBox[{
       FractionBox[
        SubscriptBox["\[CapitalOmega]", "0"], 
        SubscriptBox["\[CapitalOmega]", "s"]], 
       FractionBox[
        SubsuperscriptBox["\[Omega]", 
         RowBox[{"s", ";", "0"}], "2"], "c"], 
       RowBox[{"(", GridBox[{
          {
           SubsuperscriptBox["V", 
            RowBox[{"x", ";", "i"}], 
            RowBox[{"t", ";", "s"}]]},
          {
           SubsuperscriptBox["V", 
            RowBox[{"y", ";", "i"}], 
            RowBox[{"t", ";", "s"}]]},
          {
           SubsuperscriptBox["V", 
            RowBox[{"z", ";", "i"}], 
            RowBox[{"t", ";", "s"}]]}
         }], ")"}]}]}]}]}], TraditionalForm]],ExpressionUUID->
  "42b3285d-e3b4-4af6-94f4-db356b53147d"],
 "\nCartesian to curvilinear:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", GridBox[{
       {
        SuperscriptBox["\[ScriptCapitalJ]", "1"]},
       {
        SuperscriptBox["\[ScriptCapitalJ]", "2"]},
       {
        SuperscriptBox["\[ScriptCapitalJ]", "3"]}
      }], ")"}], "=", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{
         RowBox[{
          SubscriptBox["\[ScriptCapitalJ]", "x"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "x"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"]}]}], "+", 
         RowBox[{
          SubscriptBox["\[ScriptCapitalJ]", "y"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "y"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"]}]}], "+", 
         RowBox[{
          SubscriptBox["\[ScriptCapitalJ]", "z"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "z"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "1"]}]}]}]},
       {
        RowBox[{
         RowBox[{
          SubscriptBox["\[ScriptCapitalJ]", "x"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "x"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"]}]}], "+", 
         RowBox[{
          SubscriptBox["\[ScriptCapitalJ]", "y"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "y"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"]}]}], "+", 
         RowBox[{
          SubscriptBox["\[ScriptCapitalJ]", "z"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "z"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "2"]}]}]}]},
       {
        RowBox[{
         RowBox[{
          SubscriptBox["\[ScriptCapitalJ]", "x"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "x"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"]}]}], "+", 
         RowBox[{
          SubscriptBox["\[ScriptCapitalJ]", "y"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "y"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"]}]}], "+", 
         RowBox[{
          SubscriptBox["\[ScriptCapitalJ]", "z"], 
          RowBox[{
           SubscriptBox[
            OverscriptBox["e", "^"], "z"], "\[CenterDot]", 
           SuperscriptBox[
            OverscriptBox["g", "\[RightVector]"], "3"]}]}]}]}
      }], ")"}]}], TraditionalForm]],ExpressionUUID->
  "dabbbad5-8d97-4fa6-9cac-402ac958549e"]
}], "Text",ExpressionUUID->"4b8e7b31-f5c5-49da-9836-8538cf778466"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "icdf", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"icdf", ":=", 
  RowBox[{"icdf", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"cdf", "=", 
        RowBox[{"Function", "[", 
         RowBox[{"v", ",", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             RowBox[{"2", " ", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"-", 
                SuperscriptBox["v", "2"]}]], " ", "v"}], 
             SqrtBox["\[Pi]"]]}], "+", 
           RowBox[{"Erf", "[", "v", "]"}]}]}], "]"}]}], ",", 
       RowBox[{"n", "=", "1000"}], ",", 
       RowBox[{"vmax", "=", "4."}]}], "}"}], ",", 
     RowBox[{"Interpolation", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"cdf", "[", 
           RowBox[{"vmax", " ", 
            RowBox[{"i", "/", "n"}]}], "]"}], ",", 
          RowBox[{"vmax", " ", 
           RowBox[{"i", "/", "n"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "n"}], "}"}]}], "]"}], "]"}]}], 
    "]"}]}]}]}], "Input",ExpressionUUID->"410b688e-e2f3-4e15-b714-\
2fa7a2629dfb"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"icdf", "[", "i", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]], "Input",ExpressionUUID->\
"1cd6d324-5f1a-4d4d-8958-67d03364ea74"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Nc", "=", "1000"}], ",", 
     RowBox[{"Nx", "=", "2"}], ",", 
     RowBox[{"n0", "=", "1."}], ",", 
     RowBox[{"\[Theta]", "=", "1."}], ",", 
     RowBox[{"S", "=", 
      RowBox[{"Function", "[", 
       RowBox[{"x", 
        RowBox[{"(*", 
         RowBox[{"0", "\[LessEqual]", "x", "\[LessEqual]", "1"}], "*)"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "-", "x"}], ",", "x"}], "}"}], "//", "N"}]}], 
       "]"}]}]}], "}"}], ",", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "rng", ",", "x", ",", "v", ",", "vx", ",", "vy", ",", "vz", ",", 
       "\[Psi]"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rng", ":=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", 
         RowBox[{"Nc", "*", "Nx"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"x", "=", "rng"}], ";", "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{
        RowBox[{"icdf", "[", "rng", "]"}], "\[Theta]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vx", "=", 
       RowBox[{"v", " ", 
        RowBox[{"(", 
         RowBox[{"\[Psi]", "=", 
          RowBox[{"1", "-", 
           RowBox[{"2", "rng"}]}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"v", " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[Psi]", "2"]}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vy", "=", 
       RowBox[{"v", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Psi]", "=", 
          RowBox[{"2", "\[Pi]", " ", "rng"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vz", "=", 
       RowBox[{"v", " ", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"TableForm", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Function", "[", 
          RowBox[{"v", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"v", "//", "Mean"}], ",", 
             RowBox[{
              RowBox[{"Mean", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Total", "[", 
                    RowBox[{"v", "#"}], "]"}], "&"}], "/@", 
                  RowBox[{"S", "[", "x", "]"}]}], ")"}], "/", "Nc"}], "]"}], 
              "n0"}]}], "}"}]}], "]"}], "/@", 
         RowBox[{"{", 
          RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}]}], ",", 
        RowBox[{"TableHeadings", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\"\<\!\(\*SubscriptBox[\(v\), \(x\)]\)\>\"", ",", 
             "\"\<\!\(\*SubscriptBox[\(v\), \(y\)]\)\>\"", ",", 
             "\"\<\!\(\*SubscriptBox[\(v\), \(z\)]\)\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<\[LeftAngleBracket]\[DoubleStruckV]\[RightAngleBracket]\>\"",
              ",", "\"\<2nd Mom \[Times] \!\(\*SubsuperscriptBox[\(n\), \
\(s\), \(0\)]\)\>\""}], "}"}]}], "}"}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "]"}]], "Input",ExpressionUUID->"ce0adfe1-a58f-4f6b-bdce-\
c11947e83776"],

Cell[TextData[{
 "Average second velocity moment weighted by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["n", 
     RowBox[{"t", ";", "s"}], "i"], "/", 
    SubscriptBox["n", 
     RowBox[{"0", ";", "s"}]]}], TraditionalForm]],ExpressionUUID->
  "12469d9f-52d7-458a-9d7b-18c7261520ac"],
 ":\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"2", 
      SubscriptBox["\[DoubleStruckW]", "s"]}], 
     SubscriptBox["m", "s"]], "=", 
    RowBox[{
     RowBox[{"\[LeftAngleBracket]", 
      RowBox[{
       SubsuperscriptBox["\[DoubleStruckV]", "i", 
        RowBox[{"t", ";", "s"}]], 
       SubsuperscriptBox["\[DoubleStruckV]", "i", 
        RowBox[{"t", ";", "s"}]]}], "\[RightAngleBracket]"}], "=", 
     RowBox[{
      RowBox[{
       SubsuperscriptBox["n", 
        RowBox[{"0", ";", "s"}], "i"], 
       RowBox[{
        SubscriptBox["\[Sum]", "p"], 
        RowBox[{
         SubsuperscriptBox["\[DoubleStruckV]", "p", 
          RowBox[{"t", ";", "s"}]], 
         SubsuperscriptBox["\[DoubleStruckV]", "p", 
          RowBox[{"t", ";", "s"}]], 
         FractionBox[
          RowBox[{"S", "[", 
           RowBox[{
            SubsuperscriptBox["x", 
             RowBox[{"t", ";", "s"}], 
             RowBox[{"1", ";", "p"}]], "-", 
            SuperscriptBox["x", 
             RowBox[{"1", ";", "i"}]]}], "]"}], 
          SubsuperscriptBox["N", 
           RowBox[{"c", ";", "s"}], 
           RowBox[{"0", ";", "i"}]]]}]}]}], "=", 
      RowBox[{
       SubscriptBox["n", 
        RowBox[{"0", ";", "s"}]], 
       RowBox[{
        SubscriptBox["\[Sum]", "p"], 
        RowBox[{
         SubsuperscriptBox["\[DoubleStruckV]", "p", 
          RowBox[{"t", ";", "s"}]], 
         SubsuperscriptBox["\[DoubleStruckV]", "p", 
          RowBox[{"t", ";", "s"}]], 
         FractionBox[
          RowBox[{"S", "[", 
           RowBox[{
            SubsuperscriptBox["x", 
             RowBox[{"t", ";", "s"}], 
             RowBox[{"1", ";", "p"}]], "-", 
            SuperscriptBox["x", 
             RowBox[{"1", ";", "i"}]]}], "]"}], 
          SubsuperscriptBox["N", 
           RowBox[{"c", ";", "s"}], "0"]]}]}]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"6aed44af-ac2b-469f-a5e2-0a5999cc91f3"],
 ".\nKinetic energy density (equivalent to pressure):\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubsuperscriptBox["\[CurlyEpsilon]", "i", 
     RowBox[{"t", ";", "s"}]], "=", 
    RowBox[{
     RowBox[{
      FractionBox[
       SubsuperscriptBox["\[CapitalOmega]", "0", "2"], 
       SubsuperscriptBox["\[CapitalOmega]", "s", "2"]], 
      FractionBox[
       SubsuperscriptBox["\[Omega]", 
        RowBox[{"s", ";", "i"}], "2"], 
       SuperscriptBox["c", "2"]], 
      RowBox[{
       SubscriptBox["\[Sum]", "p"], 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"(", GridBox[{
           {
            SubsuperscriptBox["v", 
             RowBox[{"x", ";", "p"}], "2"]},
           {
            SubsuperscriptBox["v", 
             RowBox[{"y", ";", "p"}], "2"]},
           {
            SubsuperscriptBox["v", 
             RowBox[{"z", ";", "p"}], "2"]}
          }], ")"}], 
        FractionBox[
         RowBox[{"S", "[", 
          RowBox[{
           SubsuperscriptBox["x", 
            RowBox[{"t", ";", "s"}], 
            RowBox[{"1", ";", "p"}]], "-", 
           SuperscriptBox["x", 
            RowBox[{"1", ";", "i"}]]}], "]"}], 
         SubsuperscriptBox["N", 
          RowBox[{"c", ";", "s"}], 
          RowBox[{"0", ";", "i"}]]]}]}]}], "=", 
     RowBox[{
      FractionBox[
       SubsuperscriptBox["\[CapitalOmega]", "0", "2"], 
       SubsuperscriptBox["\[CapitalOmega]", "s", "2"]], 
      FractionBox[
       SubsuperscriptBox["\[Omega]", 
        RowBox[{"s", ";", "0"}], "2"], 
       SuperscriptBox["c", "2"]], 
      RowBox[{
       SubscriptBox["\[Sum]", "p"], 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{"(", GridBox[{
           {
            SubsuperscriptBox["v", 
             RowBox[{"x", ";", "p"}], "2"]},
           {
            SubsuperscriptBox["v", 
             RowBox[{"y", ";", "p"}], "2"]},
           {
            SubsuperscriptBox["v", 
             RowBox[{"z", ";", "p"}], "2"]}
          }], ")"}], 
        FractionBox[
         RowBox[{"S", "[", 
          RowBox[{
           SubsuperscriptBox["x", 
            RowBox[{"t", ";", "s"}], 
            RowBox[{"1", ";", "p"}]], "-", 
           SuperscriptBox["x", 
            RowBox[{"1", ";", "i"}]]}], "]"}], 
         SubsuperscriptBox["N", 
          RowBox[{"c", ";", "s"}], "0"]]}]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"8b4abd05-da6f-4d16-a704-7baaf831a59b"],
 ".\nThermal speed squared:\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"(", GridBox[{
        {
         SubsuperscriptBox["\[CapitalDelta]v", 
          RowBox[{"x", ",", 
           RowBox[{"s", ";", "i"}]}], "2"]},
        {
         SubsuperscriptBox["\[CapitalDelta]v", 
          RowBox[{"y", ",", 
           RowBox[{"s", ";", "i"}]}], "2"]},
        {
         SubsuperscriptBox["\[CapitalDelta]v", 
          RowBox[{"z", ",", 
           RowBox[{"s", ";", "i"}]}], "2"]}
       }], ")"}], "\[RightAngleBracket]"}], "=", 
    RowBox[{
     FractionBox[
      SubscriptBox["n", 
       RowBox[{"0", ";", "s"}]], 
      SubsuperscriptBox["n", 
       RowBox[{"t", ";", "s"}], "i"]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Sum]", "p"], 
        RowBox[{
         RowBox[{"(", GridBox[{
            {
             SubsuperscriptBox["v", 
              RowBox[{"x", ";", "p"}], "2"]},
            {
             SubsuperscriptBox["v", 
              RowBox[{"y", ";", "p"}], "2"]},
            {
             SubsuperscriptBox["v", 
              RowBox[{"z", ";", "p"}], "2"]}
           }], ")"}], 
         FractionBox[
          RowBox[{"S", "[", 
           RowBox[{
            SubsuperscriptBox["x", 
             RowBox[{"t", ";", "s"}], 
             RowBox[{"1", ";", "p"}]], "-", 
            SuperscriptBox["x", 
             RowBox[{"1", ";", "i"}]]}], "]"}], 
          SubsuperscriptBox["N", 
           RowBox[{"c", ";", "s"}], "0"]]}]}], "-", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", GridBox[{
            {
             SubsuperscriptBox["V", 
              RowBox[{"x", ";", "i"}], 
              RowBox[{"t", ";", "s"}]]},
            {
             SubsuperscriptBox["V", 
              RowBox[{"y", ";", "i"}], 
              RowBox[{"t", ";", "s"}]]},
            {
             SubsuperscriptBox["V", 
              RowBox[{"z", ";", "i"}], 
              RowBox[{"t", ";", "s"}]]}
           }], ")"}], "2"], "/", 
        FractionBox[
         SubsuperscriptBox["n", 
          RowBox[{"t", ";", "s"}], "i"], 
         SubscriptBox["n", 
          RowBox[{"0", ";", "s"}]]]}]}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"385a22d6-da6a-4e07-b0fb-446e3a3f4e58"],
 "."
}], "Text",ExpressionUUID->"c269a811-6c20-4ec2-9138-4d3b98812bc8"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Nc", "=", "1000"}], ",", 
     RowBox[{"Nx", "=", "2"}], ",", 
     RowBox[{"n0", "=", "1."}], ",", 
     RowBox[{"\[Theta]", "=", "1."}], ",", 
     RowBox[{"S", "=", 
      RowBox[{"Function", "[", 
       RowBox[{"x", 
        RowBox[{"(*", 
         RowBox[{"0", "\[LessEqual]", "x", "\[LessEqual]", "1"}], "*)"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "-", "x"}], ",", "x"}], "}"}], "//", "N"}]}], 
       "]"}]}]}], "}"}], ",", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "rng", ",", "x", ",", "v", ",", "vx", ",", "vy", ",", "vz", ",", 
       "\[Psi]"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rng", ":=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", 
         RowBox[{"Nc", "*", "Nx"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"x", "=", "rng"}], ";", "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{
        RowBox[{"icdf", "[", "rng", "]"}], "\[Theta]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vx", "=", 
       RowBox[{"v", " ", 
        RowBox[{"(", 
         RowBox[{"\[Psi]", "=", 
          RowBox[{"1", "-", 
           RowBox[{"2", "rng"}]}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"v", " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["\[Psi]", "2"]}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vy", "=", 
       RowBox[{"v", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Psi]", "=", 
          RowBox[{"2", "\[Pi]", " ", "rng"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vz", "=", 
       RowBox[{"v", " ", 
        RowBox[{"Sin", "[", "\[Psi]", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{"Flatten", "[", 
           SuperscriptBox[
            RowBox[{"{", 
             RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}], "2"], "]"}], "]"}], 
         "/", "2"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Total", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["vx", "2"], "+", 
                 SuperscriptBox["vy", "2"], "+", 
                 SuperscriptBox["vz", "2"]}], ")"}], 
               RowBox[{"#", "/", "2"}]}], "]"}], "/", "Nc"}], "&"}], "/@", 
           RowBox[{"S", "[", "x", "]"}]}], "]"}], "*", "Nc"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "]"}]], "Input",ExpressionUUID->"4796ec80-\
888a-4512-954f-8a6f09a2344e"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1307, 1179},
WindowMargins->{{Automatic, 453}, {24, Automatic}},
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (June 19, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"df4277a1-8672-4142-81d9-78c5edd95384"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 89, 0, 67, "Section",ExpressionUUID->"98f60438-238c-49f7-a2be-78fd60abd294"],
Cell[CellGroupData[{
Cell[694, 26, 95, 0, 54, "Subsection",ExpressionUUID->"60be49ab-8d81-409d-8bc9-7546a121a65e"],
Cell[792, 28, 1812, 56, 150, "Text",ExpressionUUID->"1dd6616b-e8f8-4544-b951-5a3556ea34ed"],
Cell[2607, 86, 476, 14, 58, "Text",ExpressionUUID->"ea9a4192-2aec-4b1d-9375-1e75ca196da4"],
Cell[3086, 102, 1180, 36, 114, "Text",ExpressionUUID->"e928ad21-de0c-4bba-a819-0bfb41a39a27"],
Cell[4269, 140, 4668, 145, 289, "Text",ExpressionUUID->"10531d08-595c-4099-b84b-0cc8da1a8ca6"],
Cell[8940, 287, 5862, 184, 480, "Text",ExpressionUUID->"3de990f7-fe78-4ab8-b34d-c60118674253"],
Cell[14805, 473, 1175, 32, 94, "Text",ExpressionUUID->"1ead1ffe-99f7-483d-b7ad-d2eb1efebd58"],
Cell[15983, 507, 3688, 116, 253, "Text",ExpressionUUID->"18c9f654-f3f0-4e24-928a-48ada1cbef30"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19708, 628, 99, 0, 54, "Subsection",ExpressionUUID->"5593d14d-ab98-4ecd-b232-518d25807eeb"],
Cell[19810, 630, 2362, 73, 214, "Text",ExpressionUUID->"1d55d8c6-05c5-496e-826e-e1177ab9951c"],
Cell[22175, 705, 2217, 68, 174, "Text",ExpressionUUID->"e9b742c7-f260-4742-ad46-d525c2ba769d"],
Cell[24395, 775, 548, 16, 61, "Text",ExpressionUUID->"f86f895a-40f7-4d01-bfd3-cd70821d3cc6"],
Cell[24946, 793, 1088, 32, 94, "Text",ExpressionUUID->"2e76a4f2-0040-4ba3-944c-44be0134b9f1"],
Cell[26037, 827, 1147, 34, 98, "Text",ExpressionUUID->"f030f6e9-193f-45c5-b50c-c8c165382755"],
Cell[27187, 863, 5905, 176, 283, "Text",ExpressionUUID->"dd318524-e19a-4180-a048-ecf72f601003"],
Cell[33095, 1041, 1558, 45, 110, "Text",ExpressionUUID->"661cd1e9-44aa-4fdb-a829-31ad6568d022"],
Cell[34656, 1088, 4214, 127, 275, "Text",ExpressionUUID->"d672e2e5-c36d-47b5-be7a-f804f3394e79"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38907, 1220, 115, 0, 54, "Subsection",ExpressionUUID->"6a963e5d-0959-4a3a-868c-45bf1604788d"],
Cell[39025, 1222, 3538, 115, 203, "Text",ExpressionUUID->"f3a02e4a-0eb5-4ec4-b469-b1d92045ef38"],
Cell[42566, 1339, 736, 24, 69, "Text",ExpressionUUID->"db8fc41e-20bb-4548-837a-de969032a7f4"],
Cell[43305, 1365, 1060, 32, 101, "Text",ExpressionUUID->"8e8d5028-b4c7-4bf5-8d0d-3f5df7bba8b0"],
Cell[44368, 1399, 4074, 121, 192, "Text",ExpressionUUID->"59dae126-f10e-4ef6-bdaf-20485f8adbf5"],
Cell[48445, 1522, 5103, 166, 328, "Text",ExpressionUUID->"cec5d88b-531b-43c0-aa28-51756645b720"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53585, 1693, 130, 0, 54, "Subsection",ExpressionUUID->"df5d4812-b343-47b6-abcc-5ef8bb1677b0"],
Cell[53718, 1695, 7402, 226, 242, "Text",ExpressionUUID->"72a699aa-bea1-4ecc-8f67-f6289b35b09b"],
Cell[CellGroupData[{
Cell[61145, 1925, 9661, 250, 19, "Input",ExpressionUUID->"7063d1bc-e7bb-4976-8aac-764234e1fca9",
 CellOpen->False],
Cell[70809, 2177, 5781, 109, 302, "Output",ExpressionUUID->"987154df-fe5e-4d49-84ef-58e2a6c496ad"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[76639, 2292, 100, 0, 54, "Subsection",ExpressionUUID->"71d8df89-8dc7-43a7-9bbb-27460bfeaee1"],
Cell[76742, 2294, 7471, 226, 242, "Text",ExpressionUUID->"47cb1a90-c3b6-494c-86c1-f829b47b5941"],
Cell[CellGroupData[{
Cell[84238, 2524, 9661, 250, 19, "Input",ExpressionUUID->"24ececd0-d501-46c2-9a01-d07868be0773",
 CellOpen->False],
Cell[93902, 2776, 5781, 109, 302, "Output",ExpressionUUID->"0f7a4f9f-9606-4e71-aa67-4315e7203019"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[99744, 2892, 88, 0, 67, "Section",ExpressionUUID->"735867a3-e5a7-485e-b7a9-2fffb01620a9"],
Cell[99835, 2894, 7500, 237, 253, "Text",ExpressionUUID->"0bf41702-681c-4068-a283-fb1deffc92cf"],
Cell[107338, 3133, 1781, 54, 69, "Text",ExpressionUUID->"2ea5d700-e6d5-4547-8f10-2b540adbf53f"],
Cell[109122, 3189, 2678, 90, 179, "Text",ExpressionUUID->"2709995f-79b9-4654-8c6e-dcd02d4f5c07"],
Cell[CellGroupData[{
Cell[111825, 3283, 247, 7, 54, "Subsection",ExpressionUUID->"a2142f9e-1dc8-48da-bfef-f8b9da8f4271"],
Cell[CellGroupData[{
Cell[112097, 3294, 97, 0, 45, "Subsubsection",ExpressionUUID->"1f0683d3-9e38-4868-81e5-da16eac4a98a"],
Cell[112197, 3296, 1081, 28, 179, "Text",ExpressionUUID->"f247c1ea-359f-40a1-aac7-f8a14703cfa7"],
Cell[CellGroupData[{
Cell[113303, 3328, 4378, 122, 19, "Input",ExpressionUUID->"2b6ee556-d754-41ba-bf75-3397923095ea",
 CellOpen->False],
Cell[117684, 3452, 1446, 29, 90, "Output",ExpressionUUID->"2028200f-a510-4da7-88db-a5a4eba484e7"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[119179, 3487, 101, 0, 45, "Subsubsection",ExpressionUUID->"fb6b39f5-8799-4aa8-a8ce-21e0009a5abe"],
Cell[119283, 3489, 3355, 105, 161, "Text",ExpressionUUID->"ea180c80-1d45-4c8e-b169-0a13ac3cec31"],
Cell[122641, 3596, 4752, 143, 225, "Text",ExpressionUUID->"5a9fed65-c44e-47db-939e-da9302f55582"]
}, Open  ]],
Cell[CellGroupData[{
Cell[127430, 3744, 101, 0, 45, "Subsubsection",ExpressionUUID->"41eaf251-6f3e-47eb-ae80-da78b37dbb03"],
Cell[127534, 3746, 4620, 137, 161, "Text",ExpressionUUID->"484bfdcd-5ff3-4130-b6e2-7731b48e9897"],
Cell[132157, 3885, 4674, 143, 225, "Text",ExpressionUUID->"09a334d1-0b00-4340-ad74-e61e7a711d23"]
}, Open  ]],
Cell[CellGroupData[{
Cell[136868, 4033, 95, 0, 45, "Subsubsection",ExpressionUUID->"9702f1ed-9629-406b-9309-30a50865f5fa"],
Cell[136966, 4035, 2774, 85, 115, "Text",ExpressionUUID->"15fc059f-3db7-454a-b869-6d8c724caef5"],
Cell[139743, 4122, 504, 14, 37, "Text",ExpressionUUID->"802f5501-9506-4b3d-8d00-ab35752ed2e9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[140284, 4141, 149, 2, 45, "Subsubsection",ExpressionUUID->"65487bfb-867e-421b-b381-db68cd6843d9"],
Cell[140436, 4145, 9703, 308, 402, "Text",ExpressionUUID->"c3990e72-d5ea-4e55-af7d-409b5977a4a6"],
Cell[150142, 4455, 10253, 325, 398, "Text",ExpressionUUID->"dd6487c6-7f2f-4c02-ab85-e3b06526af0b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[160432, 4785, 110, 0, 45, "Subsubsection",ExpressionUUID->"cd1c9823-f092-41bb-8582-ab06a06d2c09"],
Cell[160545, 4787, 5769, 176, 355, "Text",ExpressionUUID->"3c7b42f0-d3c1-414b-8a7f-4fd101de6620"],
Cell[166317, 4965, 1113, 33, 94, "Input",ExpressionUUID->"dac6d09b-7866-4b87-81e2-0ec0db3c2d41"],
Cell[167433, 5000, 8735, 275, 401, "Text",ExpressionUUID->"4b8e7b31-f5c5-49da-9836-8538cf778466"],
Cell[176171, 5277, 1232, 36, 84, "Input",ExpressionUUID->"410b688e-e2f3-4e15-b714-2fa7a2629dfb"],
Cell[177406, 5315, 278, 7, 30, "Input",ExpressionUUID->"1cd6d324-5f1a-4d4d-8958-67d03364ea74"],
Cell[177687, 5324, 3346, 91, 240, "Input",ExpressionUUID->"ce0adfe1-a58f-4f6b-bdce-c11947e83776"],
Cell[181036, 5417, 7057, 217, 290, "Text",ExpressionUUID->"c269a811-6c20-4ec2-9138-4d3b98812bc8"],
Cell[188096, 5636, 2883, 81, 263, "Input",ExpressionUUID->"4796ec80-888a-4512-954f-8a6f09a2344e"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

